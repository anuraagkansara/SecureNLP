Suspect JJ O O
# $ O O
4 CD O O
is VBZ O O
the DT O O
fourth JJ O O
out IN O O
of IN O O
a DT O O
row NN O O
of IN O O
malware NN O O
samples NNS O O
, , O O
which WDT O O
are VBP O O
believed VBN O O
to TO O O
stem VB O O
from IN O O
the DT O O
same JJ O O
malicious JJ O O
actor NN O O
. . O O

Insights NNS O O
on IN O O
the DT O O
campaign NN O O
were VBD O O
first RB O O
presented VBN O O
at IN O O
Hack.lu NNP O O
Conference NNP O O
2014 CD O O
in IN O O
Luxembourg NNP O O
. . O O

The DT O O
name NN O O
' `` O O
EvilBunny NNP O O
' '' O O
is VBZ O O
derived VBN O O
from IN O O
a DT O O
link NN O O
to IN O O
debug JJ O O
information NN O O
embedded VBN O O
in IN O O
the DT O O
dropper NN O O
binary NN O O
of IN O O
suspect NN O O
# $ O O
4 CD O O
. . O O

The DT O O
path NN O O
to IN O O
the DT O O
associated VBN O O
.pdb NN O O
- HYPH O O
file NN O O
contains VBZ O O
the DT O O
name NN O O
of IN O O
the DT O O
project NN O O
and CC O O
sub NN O O
project NN O O
, , O O
namely RB O O
' POS O O
bunny NN O O
2.3.2 CD O O
' '' O O
and CC O O
' '' O O
Transporter2 NNP O O
' '' O O
. . O O

EvilBunny NNP B-Entity 1
has VBZ O O
been VBN O O
seen VBN O O
spreading VBG B-Action 2
through IN B-Modifier 3
a DT O O
malicious JJ B-Entity 4
PDF NN I-Entity O
document NN I-Entity O
, , O O
exploiting VBG O O
CVE- NNP O O
2011 CD O O
- : O O
4369 CD O O
on IN O O
20th NN O O
of IN O O
December NNP O O
2011 CD O O
. . O O

The DT O O
exploit NN B-Entity 1
would MD O O
download VB B-Action 2
the DT O O
bunny NN B-Entity 3
dropper VBZ I-Entity O
and CC O O
install VB B-Action 4
suspect NN O O
# $ B-Entity 5
4 CD I-Entity O
on IN B-Modifier 6
the DT O O
infected JJ B-Entity 7
system NN I-Entity O
. . O O

Both DT O O
, , O O
dropper NN O O
and CC O O
payload NN O O
were VBD O O
compiled VBN O O
on IN O O
25th NN O O
of IN O O
October NNP O O
2011 CD O O
, , O O
while IN O O
CVE-2011 NNP O O
- HYPH O O
4369 NNP O O
was VBD O O
released VBN O O
only RB O O
on IN O O
16 CD O O
th NNS O O
of IN O O
December NNP O O
. . O O

It PRP O O
is VBZ O O
unclear JJ O O
as IN O O
of IN O O
when WRB O O
the DT O O
attacks NNS O O
started VBD O O
; : O O
although IN O O
, , O O
clearly RB O O
, , O O
either CC O O
the DT O O
attackers NNS O O
adopted VBD O O
the DT O O
vulnerability NN O O
within IN O O
4 CD O O
days NNS O O
or CC O O
the DT O O
attacks NNS O O
were VBD O O
performed VBN O O
using VBG O O
an DT O O
AdobeReader NNP O O
0-day NN O O
. . O O

The DT O O
functionality NN O O
of IN O O
the DT O O
dropper NN O O
can MD O O
be VB O O
summarized VBN O O
in IN O O
the DT O O
following VBG O O
steps NNS O O
. . O O

Searching VBG B-Action 1
for IN B-Modifier 2
a DT O O
sandbox NN B-Entity 3
environment NN I-Entity O
, , O O
the DT O O
malware NN O O
takes VBZ O O
a DT O O
number NN O O
of IN O O
simple JJ O O
steps NNS O O
to TO O O
verify VB O O
. . O O

It PRP O O
tests VBZ O O
the DT O O
module NN O O
file NN O O
name NN O O
to TO O O
see VB O O
if IN O O
it PRP O O
is VBZ O O
less JJR O O
than IN O O
5 CD O O
characters NNS O O
long JJ O O
or CC O O
if IN O O
it PRP O O
contains VBZ O O
either DT O O
of IN O O
the DT O O
four CD O O
strings NNS O O
' POS O O
klavme NN O O
' '' O O
, , O O
' '' O O
myapp NN O O
' '' O O
, , O O
' '' O O
TESTAPP NNP O O
' '' O O
or CC O O
' '' O O
afyjevmv.exe ADD O O
' '' O O
. . O O

Also RB O O
, , O O
it PRP O O
verifies VBZ O O
if IN O O
less JJR O O
than IN O O
15 CD O O
processes NNS O O
are VBP O O
running VBG O O
in IN O O
the DT O O
environment NN O O
, , O O
using VBG O O
the DT O O
API NN O O
call NN O O
EnumProcesses NNP O O
. . O O

In IN O O
case NN O O
any DT O O
of IN O O
the DT O O
conditions NNS O O
is VBZ O O
met VBN O O
execution NN O O
will MD O O
abort VB O O
. . O O

Up IN O O
to IN O O
the DT O O
time NN O O
of IN O O
writing VBG O O
it PRP O O
remains VBZ O O
unclear JJ O O
which WDT O O
environment NN O O
the DT O O
mentioned VBN O O
strings NNS O O
aim VBP O O
to TO O O
identify VB O O
, , O O
if IN O O
any DT O O
. . O O

Accessing VBG O O
the DT O O
systems NNS O O
WMI NNP O O
( -LRB- O O
Windows NNP O O
Management NNP O O
Interface NNP O O
) -RRB- O O
the DT B-Entity 1
malware NN I-Entity O
queries NNS B-Action 2
the DT O O
installed VBN B-Entity 3
AntiVirus NNP I-Entity O
software NN I-Entity O
by IN O O
issuing VBG O O
' '' O O
SELECT VB O O
* NFP O O
FROM IN O O
AntiVirusProduct NNP O O
' '' O O
. . O O

More RBR O O
specifically RB O O
, , O O
the DT O O
malware NN O O
is VBZ O O
interested JJ O O
in IN O O
the DT O O
data NN O O
fields NNS O O
' `` O O
productUptoDate NN O O
' '' O O
, , O O
' '' O O
VersionNumber NNP O O
' '' O O
, , O O
' '' O O
DisplayName NNP O O
' '' O O
and CC O O
' `` O O
productState NN O O
' '' O O
. . O O

The DT O O
information NN O O
about IN O O
AntiVirus NNP O O
provided VBN O O
by IN O O
WMI NNP O O
differs NNS O O
between IN O O
Windows NNP O O
versions NNS O O
, , O O
so IN O O
the DT O O
requests NNS O O
address VBP O O
different JJ O O
namespaces NNS O O
, , O O
' '' O O
ROOT\SecurityCenter NN O O
' '' O O
for IN O O
WindowsXP NNP O O
and CC O O
' `` O O
ROOT\SecurityCenter2 NNP O O
' '' O O
for IN O O
Windows NNP O O
Vista NNP O O
and CC O O
newer JJR O O
versions NNS O O
. . O O

Names NNS O O
of IN O O
AntiVirus NNP O O
products NNS O O
are VBP O O
represented VBN O O
as IN O O
hard RB O O
coded VBN O O
SHA-256 NNP O O
hashes NNS O O
, , O O
namely RB O O
the DT O O
following VBG O O
. . O O

d4634c9d57c06983e1d2d6dc92e74e6103c132a97f8dc3e7158fa89420647ec3 NN O O
4db3801a45802041baa44334303e0498c2640cd5dfd6892545487bf7c8c9219f CD O O
bfe74ca464620a62f11b8c47a3778bb132d84fecd90ce7c75817970f2eeeca51 NN O O
Antivirus NNP O O
443b6fb65fa57d57ee3113e48e9b4ed1db2921d5352e27fa85064cd60553c3ff CD O O
BitDefender NNP O O
e1625a7f2f6947ea8e9328e66562a8b255bc4d5721d427f943002bb2b9fc5645 NN O O
588730213eb6ace35caadcb651217bfbde3f615d94a9cca41a31ee9fa09b186c CD O O
f1761a5e3856dceb3e14d4555af92d3d1ac47604841f69fc72328b53ab45ca56 NN O O
Kaspersky NNP O O
Only RB O O
three CD O O
of IN O O
the DT O O
seven CD O O
hashes NNS O O
were VBD O O
identified VBN O O
. . O O

If IN O O
any DT O O
of IN O O
the DT O O
indicated VBN O O
products NNS O O
is VBZ O O
installed VBN O O
and CC O O
active JJ O O
on IN O O
the DT O O
machine NN O O
execution NN O O
will MD O O
abort VB O O
. . O O

The DT O O
dropper NN O O
comes VBZ O O
with IN O O
its PRP$ O O
payload NN O O
attached VBN O O
in IN O O
the DT O O
resource NN O O
section NN O O
. . O O

The DT O O
resource NN O O
RCData NNP O O
contains VBZ O O
the DT O O
entire JJ O O
netmgr.exe JJ O O
binary NN O O
; : O O
alleged VBN O O
suspect JJ O O
# $ O O
4 CD O O
. . O O

The DT O O
binary NN O O
is VBZ O O
dropped VBN O O
as IN O O
netmgr.exe NNS O O
, , O O
either CC O O
located VBN O O
in IN O O
% NN O O
APPDATA%\Perf NNP O O
Manager\ NNP O O
or CC O O
% NN O O
WINDIR%\msapps\. NNP O O

The DT O O
final JJ O O
directory NN O O
location NN O O
depends VBZ O O
whether IN O O
the DT O O
dropper NN O O
is VBZ O O
running VBG O O
with IN O O
administrative JJ O O
privileges NNS O O
or CC O O
not RB O O
. . O O

Interestingly RB O O
, , O O
the DT O O
dropper NN O O
also RB O O
changes VBZ O O
the DT O O
creation NN O O
time NN O O
stamp NN O O
of IN O O
the DT O O
newly RB O O
created VBN O O
binary JJ O O
to IN O O
time NN O O
stamp NN O O
of IN O O
the DT O O
system NN O O
executable JJ O O
explorer.exe NN O O
. . O O

This DT O O
serves VBZ O O
to IN O O
avoid VB B-Action 1
raising VBG O O
suspicion NN B-Entity 2
of IN I-Entity O
a DT I-Entity O
forensic JJ I-Entity O
analysts NNS I-Entity O
or CC I-Entity O
tools NNS I-Entity O
. . O O

As IN B-Modifier 1
a DT O O
means NN B-Entity 2
of IN I-Entity O
persistence NN I-Entity O
the DT O O
dropper NN B-Entity 3
creates VBZ B-Action 4
an DT O O
entry NN B-Entity 5
under IN I-Entity O
[ -LRB- I-Entity O
HKLM| NNP I-Entity O
HKCU]\ NNP I-Entity O
... NFP I-Entity O
\CurrentVersion\Run XX I-Entity O
which WDT O O
points VBZ O O
to IN O O
the DT O O
dropped VBN O O
netmgr.exe JJ O O
binary NN O O
. . O O

This DT O O
ensures VBZ B-Action 1
that IN B-Modifier 2
netmgr.exe NN O O
will MD B-Entity 3
be VB I-Entity O
executed VBN I-Entity O
every DT I-Entity O
time NN I-Entity O
the DT I-Entity O
system NN I-Entity O
boots NNS I-Entity O
. . O O

Furthermore RB O O
, , O O
the DT B-Entity 1
dropper NN I-Entity O
generates VBZ B-Action 2
another DT O O
entry NN B-Entity 3
in IN I-Entity O
the DT I-Entity O
Windows NNP I-Entity O
registry NN I-Entity O
, , O O
under IN O O
[ -LRB- O O
HKLM| NNP O O
HKCU]\Software\Microsoft\IPSec NNP O O
. . O O

This DT O O
entry NN O O
is VBZ O O
named VBN O O
' `` O O
isakmpAutoNegociate NN O O
' '' O O
and CC O O
points VBZ O O
to IN O O
the DT O O
dropper NN O O
binary NN O O
. . O O

This DT O O
key NN O O
will MD O O
be VB O O
requested VBN O O
by IN O O
netmgr.exe CC B-Entity 1
later RB O O
to TO O O
locate VB O O
the DT O O
dropper NN O O
binary NN O O
and CC O O
delete VBP B-Action 2
it PRP B-Entity 3
. . O O

The DT O O
naming NN O O
of IN O O
the DT O O
key NN O O
for IN O O
cleanup NN O O
of IN O O
the DT O O
dropper NN O O
is VBZ O O
chosen VBN O O
to TO O O
confuse VB O O
analysts NNS O O
, , O O
although IN O O
the DT O O
name NN O O
is VBZ O O
clearly RB O O
misspelled VBN O O
. . O O

Another DT O O
interesting JJ O O
side NN O O
fact NN O O
is VBZ O O
that IN O O
the DT O O
dropper NN O O
does VBZ O O
not RB O O
start VB O O
the DT O O
dropped VBN O O
malware NN O O
, , O O
neither CC O O
does VBZ O O
it PRP O O
contain VB O O
code NN O O
which WDT O O
could MD O O
even RB O O
do VB O O
so RB O O
. . O O

This DT O O
implies VBZ O O
, , O O
the DT O O
final JJ O O
infection NN O O
stage NN O O
does VBZ O O
not RB O O
start VB O O
unless IN O O
the DT O O
infected VBN O O
machine NN O O
is VBZ O O
rebooted VBN O O
. . O O

Also RB O O
, , O O
the DT O O
dropper NN O O
binary NN O O
will MD O O
not RB O O
be VB O O
deleted VBN O O
in IN O O
the DT O O
meanwhile NN O O
. . O O

Suspect JJ O O
# $ O O
4 CD O O
was VBD O O
the DT O O
fourth JJ O O
discovered VBN O O
sample NN O O
in IN O O
a DT O O
row NN O O
of IN O O
malware NN O O
related VBN O O
to IN O O
the DT O O
EvilBunny NNP O O
attacks NNS O O
; : O O
even RB O O
before IN O O
its PRP$ O O
dropper NN O O
. . O O

Yet RB O O
, , O O
it PRP O O
is VBZ O O
by IN O O
far RB O O
the DT O O
most RBS O O
interesting JJ O O
one NN O O
. . O O

It PRP O O
is VBZ O O
a DT O O
multi- NN O O
threaded VBN O O
bot NN O O
with IN O O
an DT O O
integrated VBN O O
scripting VBG O O
engine NN O O
. . O O

It PRP O O
incorporates VBZ O O
a DT O O
Lua NNP O O
engine NN O O
and CC O O
downloads NNS O O
and CC O O
executes VBZ O O
Lua NNP O O
scripts NNS O O
to TO O O
reach VB O O
a DT O O
certain JJ O O
level NN O O
of IN O O
polymorphism NN O O
. . O O

The DT O O
Lua NNP B-Entity 1
scripts NNS I-Entity O
can MD O O
call VB O O
back RB O O
into IN O O
the DT O O
C++ NNP O O
code NN O O
to TO O O
alter VB B-Action 2
the DT O O
malware JJ B-Entity 3
behavior NN I-Entity O
at IN B-Modifier 4
runtime NN B-Entity 5
. . O O

The DT O O
malware NN B-Entity 1
seeks VBZ O O
to TO O O
keep VB B-Action 2
a DT O O
low JJ B-Entity 3
profile NN I-Entity O
on IN B-Modifier 4
the DT O O
infected VBN B-Entity 5
machine NN I-Entity O
, , O O
while IN O O
executing VBG B-Action 6
the DT O O
botmaster NN B-Entity 7
's POS I-Entity O
commands NNS I-Entity O
and CC I-Entity O
Lua NNP I-Entity O
scripts NNS I-Entity O
. . O O

In IN O O
total JJ O O
Suspect JJ O O
# $ O O
4 CD O O
exhibits VBZ O O
three CD O O
different JJ O O
methods NNS O O
for IN O O
receiving VBG O O
C&C NNP O O
input NN O O
and CC O O
executing VBG O O
commands NNS O O
; : O O
directly RB O O
via IN O O
HTTP NN O O
, , O O
through IN O O
a DT O O
downloaded JJ O O
database NN O O
file NN O O
or CC O O
as IN O O
a DT O O
scheduled JJ O O
task NN O O
. . O O

Also RB O O
, , O O
the DT B-Entity 1
malware NN I-Entity O
will MD O O
generate VB O O
numerous JJ O O
files NNS O O
to TO O O
help VB O O
its PRP$ O O
execution NN O O
and CC O O
frequently RB O O
reply NN B-Action 2
back RB I-Action O
to IN B-Modifier 3
the DT O O
C&C NNP B-Entity 4
with IN B-Modifier 5
status NN O O
messages NNS B-Entity 6
. . O O

The DT O O
initial JJ O O
purpose NN O O
of IN O O
the DT O O
malware NN O O
seems VBZ O O
to TO O O
be VB O O
sharing VBG O O
execution NN O O
load NN O O
among IN O O
infected JJ O O
host NN O O
machines NNS O O
. . O O

However RB O O
, , O O
due IN O O
to IN O O
the DT O O
lack NN O O
of IN O O
the DT O O
original JJ O O
Lua NNP O O
scripts NNS O O
and CC O O
the DT O O
extensive JJ O O
functionality NN O O
of IN O O
the DT O O
embedded VBN O O
Lua NNP O O
engine NN O O
the DT O O
original JJ O O
intentions NNS O O
of IN O O
the DT O O
attackers NNS O O
remain VBP O O
unknown JJ O O
. . O O

Suspect JJ O O
# $ O O
4 CD O O
is VBZ O O
written VBN O O
in IN O O
C++ NNP O O
, , O O
and CC O O
just RB O O
like IN O O
its PRP$ O O
dropper NN O O
, , O O
it PRP O O
is VBZ O O
not RB O O
protected VBN O O
by IN O O
any DT O O
runtime NN O O
packer NN O O
or CC O O
crypter NN O O
. . O O

It PRP O O
is VBZ O O
, , O O
however RB O O
, , O O
compiled VBN O O
with IN O O
a DT O O
performance NN O O
optimization NN O O
option NN O O
which WDT O O
causes VBZ O O
a DT O O
lot NN O O
of IN O O
code NN O O
in IN O O
- HYPH O O
lining NN O O
and CC O O
duplicate VB O O
code NN O O
in IN O O
the DT O O
binary NN O O
. . O O

Duplication NN O O
also RB O O
applies VBZ O O
to IN O O
string VBG O O
constants NNS O O
, , O O
as IN O O
every DT O O
string NN O O
is VBZ O O
present JJ O O
once IN O O
per IN O O
function NN O O
, , O O
if IN O O
the DT O O
given VBN O O
function NN O O
uses VBZ O O
it PRP O O
. . O O

This DT O O
might MD O O
accelerate VB O O
execution NN O O
speed NN O O
of IN O O
the DT O O
bot NN O O
at IN O O
runtime NN O O
, , O O
but CC O O
implicitly RB O O
or CC O O
even RB O O
on IN O O
purpose NN O O
hinders NNS O O
static JJ O O
analysis NN O O
of IN O O
the DT O O
binary JJ O O
code NN O O
. . O O

Cross NNP O O
referencing NN O O
of IN O O
strings NNS O O
or CC O O
helper NN O O
functions NNS O O
is VBZ O O
ineffective JJ O O
due IN O O
to IN O O
the DT O O
duplications NNS O O
. . O O

Only RB O O
few JJ B-Entity 1
anti JJ I-Entity O
- HYPH I-Entity O
analysis NN I-Entity O
measures NNS I-Entity O
can MD O O
be VB B-Action 2
found VBN I-Action O
in IN B-Modifier 3
the DT O O
binary JJ B-Entity 4
. . O O

One CD O O
function NN O O
exists VBZ O O
, , O O
which WDT O O
resembles VBZ O O
the DT O O
sandbox NN O O
check NN O O
of IN O O
its PRP$ O O
dropper NN O O
with IN O O
minor JJ O O
extensions NNS O O
. . O O

This DT O O
sandbox NN O O
detection NN O O
consists VBZ O O
of IN O O
three CD O O
parts NNS O O
. . O O

Another DT O O
evasion NN B-Entity 1
trick NN I-Entity O
implemented VBD B-Action 2
by IN O O
the DT B-Entity 3
malware NN I-Entity O
is VBZ O O
the DT O O
partial JJ O O
obfuscation NN O O
of IN O O
API NNP O O
names NNS O O
. . O O

For IN O O
no DT O O
obvious JJ O O
reason NN O O
though RB O O
, , O O
the DT O O
obfuscation NN O O
algorithm NN O O
is VBZ O O
only RB O O
applied VBN O O
to IN O O
a DT O O
small JJ O O
subset NN O O
of IN O O
APIs NNS O O
used VBN O O
in IN O O
the DT O O
code NN O O
. . O O

The DT O O
algorithm NN O O
uses VBZ O O
the DT O O
fixed VBN O O
value NN O O
AB34CD77h NNP O O
and CC O O
a DT O O
combination NN O O
of IN O O
XOR NNP O O
and CC O O
ROL NNP O O
instructions NNS O O
to TO O O
calculate VB O O
hashes NNS O O
from IN O O
the DT O O
export NN O O
names NNS O O
of IN O O
kernel32.dll NN O O
, , O O
advapi32.dll NN O O
and CC O O
psapi.dll NN O O
. . O O

It PRP O O
is VBZ O O
important JJ O O
to TO O O
note VB O O
that IN O O
this DT O O
obfuscation NN O O
trick NN O O
and CC O O
the DT O O
according VBG O O
hash NN O O
function NN O O
remain VBP O O
consistent JJ O O
through IN O O
out RB O O
all DT O O
related VBN O O
samples NNS O O
. . O O

Similar JJ O O
to IN O O
its PRP$ O O
dropper NN O O
, , O O
suspect NN B-Entity 1
# $ I-Entity O
4 CD I-Entity O
enumerates VBZ B-Action 2
the DT O O
system NN B-Entity 3
's POS I-Entity O
installed VBN I-Entity O
AntiVirus NNP I-Entity O
product NN I-Entity O
and CC O O
checks NNS B-Action 4
firewall NN O O
settings NNS B-Entity 5
. . O O

For IN O O
AntiVirus NNP O O
detection NN O O
it PRP O O
utilizes VBZ O O
WMI NNP O O
and CC O O
issues NNS O O
' POS O O
SELECT NNP O O
* NFP O O
FROM IN O O
AntiVirusProduct NNP O O
' '' O O
. . O O

Identification NN O O
of IN O O
installed VBN O O
products NNS O O
is VBZ O O
achieved VBN O O
by IN O O
comparing VBG O O
the DT O O
hashed JJ O O
product NN O O
name NN O O
to IN O O
a DT O O
set NN O O
of IN O O
SHA-256 NNP O O
hashes NNS O O
; : O O
although IN O O
, , O O
a DT O O
different JJ O O
and CC O O
much RB O O
bigger JJR O O
set NN O O
than IN O O
used VBN O O
by IN O O
its PRP$ O O
dropper NN O O
. . O O

With IN O O
the DT O O
help NN O O
of IN O O
hash NN O O
tables NNS O O
from IN O O
perturb.org ADD O O
and CC O O
md5decoder.org VB O O
it PRP O O
is VBZ O O
possible JJ O O
to TO O O
revert VB O O
some DT O O
of IN O O
the DT O O
hashes NNS O O
to IN O O
their PRP$ O O
original JJ O O
text NN O O
form NN O O
. . O O

The DT O O
malware NN O O
retrieves VBZ O O
the DT O O
attributes NNS O O
' `` O O
productState NN O O
' '' O O
, , O O
' '' O O
DisplayName NNP O O
' '' O O
and CC O O
on IN O O
WindowsXP NNP O O
also RB O O
' `` O O
productUptoDate NN O O
' '' O O
. . O O

It PRP O O
is VBZ O O
noteworthy JJ O O
though RB O O
, , O O
that IN O O
for IN O O
netmgr.exe PDT O O
the DT O O
existence NN O O
of IN O O
any DT O O
of IN O O
the DT O O
indicated VBN O O
AntiVirus NNP O O
products NNS O O
does VBZ O O
not RB O O
pose VB O O
a DT O O
reason NN O O
to TO O O
end VB O O
execution NN O O
. . O O

In IN O O
fact NN O O
, , O O
these DT O O
hashes NNS O O
are VBP O O
the DT O O
only JJ O O
measure NN O O
for IN O O
obfuscating VBG O O
strings NNS O O
in IN O O
the DT O O
binary NN O O
. . O O

Firewall NNP O O
detection NN O O
works VBZ O O
equally RB O O
via IN O O
querying VBG O O
WMI NNP O O
through IN O O
" `` O O
SELECT VB O O
* NFP O O
FROM IN O O
FirewallProduct NNP O O
" '' O O
, , O O
while IN O O
this DT O O
time NN O O
the DT O O
malware NN O O
searches NNS O O
for IN O O
the DT O O
attributes NNS O O
' `` O O
enabled VBD O O
' '' O O
, , O O
' '' O O
VersionNumber NNP O O
' '' O O
and CC O O
' `` O O
DisplayName NNP O O
' '' O O
. . O O

AntiVirus NNP O O
and CC O O
firewall NN O O
information NN O O
is VBZ O O
stored VBN O O
in IN O O
objects NNS O O
in IN O O
a DT O O
linked VBN O O
list NN O O
at IN O O
runtime NN O O
. . O O

It PRP B-Entity 1
will MD O O
later RB O O
either RB O O
be VB B-Action 2
exfiltrated VBN I-Action O
to IN B-Modifier 3
a DT O O
C&C NNP B-Entity 4
server NN I-Entity O
directly RB I-Entity O
or CC O O
dumped VBD B-Action 5
to IN B-Modifier 6
a DT O O
local JJ B-Entity 7
file NN I-Entity O
on IN I-Entity O
disk NN I-Entity O
. . O O

Either DT O O
way NN O O
, , O O
the DT O O
results NNS O O
of IN O O
this DT O O
check NN O O
do VBP O O
not RB O O
influence VB O O
the DT O O
flow NN O O
of IN O O
execution NN O O
. . O O

After IN O O
start NN O O
- HYPH O O
up RP O O
the DT B-Entity 1
malware NN I-Entity O
aims VBZ O O
to TO O O
inject VB B-Action 2
itself PRP B-Entity 3
to IN B-Modifier 4
an DT O O
svchost.exe JJ B-Entity 5
process NN I-Entity O
. . O O

For IN O O
stealthiness NN O O
the DT B-Entity 1
malware NN I-Entity O
can MD O O
either CC O O
inject VBP B-Action 2
itself PRP B-Entity 3
as IN B-Modifier 4
a DT O O
remote JJ B-Entity 5
thread NN I-Entity O
to IN I-Entity O
a DT I-Entity O
running NN I-Entity O
svchost.exe NN I-Entity O
process NN I-Entity O
or CC O O
perform VB O O
the DT O O
same JJ O O
procedure NN O O
on IN O O
a DT O O
newly RB O O
created VBN O O
one CD O O
. . O O

As IN B-Modifier 1
a DT O O
singular JJ B-Entity 2
means NN I-Entity O
of IN I-Entity O
persistence NN I-Entity O
the DT O O
malware NN B-Entity 3
relies VBZ B-Action 4
on IN B-Modifier 5
the DT O O
auto NN B-Entity 6
- HYPH I-Entity O
start NN I-Entity O
registry NN I-Entity O
key NN I-Entity O
created VBN I-Entity O
by IN I-Entity O
its PRP$ I-Entity O
dropper NN I-Entity O
under IN I-Entity O
[ -LRB- I-Entity O
HKLM|HKCU]\ NNP I-Entity O
... : I-Entity O
\CurrentVersion\Run NN I-Entity O
, , I-Entity O
which WDT I-Entity O
will MD I-Entity O
start VB I-Entity O
netmgr.exe CD I-Entity O
on IN I-Entity O
every DT I-Entity O
system NN I-Entity O
boot NN I-Entity O
. . O O

Also RB O O
, , O O
the DT B-Entity 1
payload NN I-Entity O
retrieves VBZ O O
the DT O O
dropper NN O O
's POS O O
path NN O O
from IN O O
' `` O O
isakmpAutoNegociate NN O O
' '' O O
under IN O O
[ -LRB- O O
HKLM| NNP O O
HKCU]\Software\Microsoft\IPSec NNP O O
, , O O
then RB O O
deletes VBZ B-Action 2
the DT O O
binary NN B-Entity 3
and CC I-Entity O
the DT I-Entity O
' `` I-Entity O
isakmpAutoNegociate NN I-Entity O
' '' I-Entity O
registry NN I-Entity O
key JJ I-Entity O
. . O O

At IN O O
start NN O O
- HYPH O O
up NN O O
netmgr.exe CC O O
decrypts VBZ O O
a DT O O
configuration NN O O
file NN O O
stored VBN O O
in IN O O
its PRP$ O O
resource NN O O
section NN O O
, , O O
revealing VBG O O
three CD O O
URLs NNS O O
, , O O
among IN O O
timeout NN O O
settings NNS O O
and CC O O
encryption NN O O
keys NNS O O
. . O O

All DT O O
three CD O O
of IN O O
these DT O O
URLs NNS O O
served VBD O O
as IN O O
C&C NNP O O
contacts VBZ O O
when WRB O O
the DT O O
attack NN O O
was VBD O O
still RB O O
ongoing VBG O O
, , O O
sending VBG O O
commands NNS O O
or CC O O
Lua NNP O O
scripts NNS O O
to IN O O
the DT O O
infected JJ O O
host NN O O
. . O O

Interesting JJ O O
is VBZ O O
that IN O O
two CD O O
of IN O O
the DT O O
domains NNS O O
are VBP O O
actual JJ O O
fake JJ O O
domains NNS O O
resembling VBG O O
legitimate JJ O O
websites NNS O O
while IN O O
one CD O O
is VBZ O O
a DT O O
legitimate JJ O O
domain NN O O
nowadays RB O O
. . O O

Le NNP O O
- HYPH O O
progres.net NNP O O
could MD O O
be VB O O
easily RB O O
confused JJ O O
with IN O O
leprogres.fr ADD O O
, , O O
the DT O O
official JJ O O
website NN O O
of IN O O
the DT O O
Lyon NNP O O
news NN O O
paper NN O O
Le NNP O O
Progres NNP O O
. . O O

Usthb NNP O O
- HYPH O O
dz.org NNP O O
is VBZ O O
remarkably RB O O
similar JJ O O
to IN O O
usthb.dz ADD O O
, , O O
the DT O O
website NN O O
of IN O O
the DT O O
University NNP O O
of IN O O
Sciences NNPS O O
and CC O O
Technology NNP O O
Houari NNP O O
Boumediene NNP O O
in IN O O
Algiers NNP O O
, , O O
Algeria NNP O O
. . O O

The DT O O
third JJ O O
domain NN O O
though RB O O
, , O O
ghatreh.com ADD O O
, , O O
is VBZ O O
the DT O O
legitimate JJ O O
address NN O O
of IN O O
an DT O O
Iranian JJ O O
news NN O O
website NN O O
. . O O

According VBG O O
to IN O O
domaintools.com ADD O O
, , O O
this DT O O
domain NN O O
has VBZ O O
been VBN O O
created VBN O O
in IN O O
November NNP O O
2004 CD O O
while IN O O
the DT O O
last JJ O O
change NN O O
happened VBD O O
in IN O O
September NNP O O
2012 CD O O
. . O O

Also RB O O
, , O O
domaintools.com ADD O O
reveals VBZ O O
14 CD O O
unique JJ O O
IP NN O O
addresses NNS O O
and CC O O
4 CD O O
different JJ O O
registrars NNS O O
. . O O

It PRP O O
is VBZ O O
assumed VBN O O
that IN O O
the DT O O
domain NN O O
has VBZ O O
been VBN O O
dropped VBN O O
by IN O O
the DT O O
attackers NNS O O
in IN O O
2012 CD O O
and CC O O
picked VBD O O
up RP O O
by IN O O
legitimate JJ O O
operators NNS O O
. . O O

The DT O O
IP NNP O O
addresses NNS O O
of IN O O
the DT O O
domains NNS O O
in IN O O
2011 CD O O
, , O O
at IN O O
a DT O O
time NN O O
when WRB O O
dropper NN O O
, , O O
payload NN O O
and CC O O
C&Cs NNP O O
were VBD O O
still RB O O
active JJ O O
, , O O
were VBD O O
69.90.160.65 CD O O
, , O O
70.38.107.13 CD O O
and CC O O
70.38.12.10 CD O O
. . O O

All DT O O
three CD O O
IPs NNS O O
are VBP O O
located VBN O O
in IN O O
Canada NNP O O
, , O O
two CD O O
relate VBP O O
to TO O O
Montr NNP O O
al NNP O O
, , O O
one CD O O
to TO O O
Oakville NNP O O
. . O O

The DT O O
complete JJ O O
passive JJ O O
DNS NN O O
history NN O O
can MD O O
be VB O O
reviewed VBN O O
in IN O O
appendix NN O O
A. NN O O

The DT O O
binary NN O O
also RB O O
contains VBZ O O
the DT O O
URL NN O O
' `` O O
http://1.9.32.11/bunny/test.php?rec=nvista ADD O O
' '' O O
, , O O
but CC O O
the DT O O
purpose NN O O
of IN O O
it PRP O O
remains VBZ O O
unclear JJ O O
. . O O

This DT O O
IP NN O O
address NN O O
is VBZ O O
never RB O O
contacted VBN O O
by IN O O
the DT O O
malware NN O O
. . O O

Find VB O O
the DT O O
entire JJ O O
decrypted JJ O O
configuration NN O O
below RB O O
. . O O

< XX O O
COMMAND_KEY XX O O
> XX O O
wqNbo8DSbWZiq1QZ4NnmTcibYRJIFxmlSBQh1zdF8IlDKin2zkNOVtKvlx92Q0QOQnA XX O O
Nt1NCbDItwVQWY0HBQ2GKYPecpfuQ6JPZG0dQRarhCy7nTT3ukET9YzQEPN81</COMMAND_KEY XX O O
> XX O O
< XX O O
STORAGE_KEY XX O O
> XX O O
lbuLmdAouhUkSsMXckMUevjNf87S4ATWYwLYGLM44O1ortQEE2vr34QGzjPhrWeosFB XX O O
YQpT6dRwDuPPuP13zzqZhW3PeCQA7OUEghovMwEGYx1annboIwRxKbhUOIMsf</STORAGE_KEY XX O O
> XX O O
< XX O O
RESPONSE_KEY>8kMQOWondQc2ZgYgirg9NHg0QUiIIBdPe0YtIVfvxa9rvJ9wtFGx8ko4oFY34PrSkW XX O O
9cKzEFZYDnM54qeWcvSMIi9sBAkcD5ggFDmQOGdO42ef344I7s9wAKoAXKeq1s</RESPONSE_KEY XX O O
> XX O O
< XX O O
COMMAND_FILE_PATH_AND_PREFIX>%SELFDIR%\net.cap</COMMAND_FILE_PATH_AND_PREFIX XX O O
> XX O O
< XX O O
URL1>http://le XX O O
- HYPH O O
progres.net NN O O
/ , O O
images NNS O O
/ SYM O O
php RB O O
/ SYM O O
test.php?rec=11206 RB O O
- HYPH O O
01</URL1 JJ O O
> XX O O
< XX O O
URL2>http://ghatreh.com NNP O O
/ SYM O O
skins NNS O O
/ SYM O O
php RB O O
/ SYM O O
test.php?rec=11206 RB O O
- HYPH O O
01</URL2 JJ O O
> XX O O
< XX O O
URL3>http://www.usthb XX O O
- HYPH O O
dz.org NNP O O
/ NFP O O
includes VBZ O O
/ SYM O O
php RB O O
/ SYM O O
test.php?rec=11206 RB O O
- HYPH O O
01</URL3 JJ O O
> XX O O
< XX O O
INJECTED>0</INJECTED XX O O
> XX O O
< XX O O
STARTDELAY>0</STARTDELAY XX O O
> XX O O
< XX O O
DIEDELAY>120</DIEDELAY NNP O O
> XX O O
The DT O O
configuration NN O O
provides VBZ O O
three CD O O
keys NNS O O
for IN O O
encryption NN O O
and CC O O
decryption NN O O
of IN O O
data NNS O O
. . O O

The DT O O
command_key NN O O
is VBZ O O
used VBN O O
to IN O O
decrypt VB O O
commands NNS O O
received VBN O O
from IN O O
the DT O O
C&C NNP O O
server NN O O
, , O O
the DT O O
storage_key NN O O
is VBZ O O
used VBN O O
to TO O O
encrypt VB O O
and CC O O
decrypt VB O O
data NNS O O
being VBG O O
stored VBN O O
to IN O O
files NNS O O
on IN O O
disk NN O O
and CC O O
the DT O O
response_key NN O O
will MD O O
encrypt VB O O
callbacks NNS O O
to IN O O
the DT O O
C&C NNP O O
server NN O O
. . O O

All DT O O
data NNS O O
exchanged VBD O O
with IN O O
any DT O O
of IN O O
the DT O O
C&C NNP O O
servers NNS O O
as RB O O
well RB O O
as IN O O
data NNS O O
stored VBN O O
to IN O O
a DT O O
file NN O O
on IN O O
disk NN O O
is VBZ O O
encrypted VBN O O
with IN O O
the DT O O
according VBG O O
key NN O O
. . O O

Diedelay NN O O
and CC O O
startdelay NN O O
are VBP O O
timeout NN O O
settings NNS O O
, , O O
the DT O O
exact JJ O O
use NN O O
of IN O O
the DT O O
parameter NN O O
injected VBN O O
is VBZ O O
unclear JJ O O
up RP O O
to IN O O
the DT O O
time NN O O
of IN O O
writing NN O O
. . O O

Command_file_path_and_prefix NN O O
defines VBZ O O
the DT O O
name NN O O
of IN O O
the DT O O
file NN O O
which WDT O O
will MD O O
holds VBZ O O
C&C NNP O O
commands NNS O O
and CC O O
Lua NNP O O
scripts NNS O O
at IN O O
runtime NN O O
. . O O

The DT O O
malware NN O O
performs VBZ O O
C&C NNP O O
command NN O O
parsing NN O O
and CC O O
Lua NN O O
script NN O O
execution NN O O
with IN O O
dedicated JJ O O
threads NNS O O
, , O O
of IN O O
which WDT O O
every DT O O
thread NN O O
creates VBZ O O
its PRP$ O O
own JJ O O
net.cap NNS O O
file VBP O O
, , O O
extending VBG O O
the DT O O
name NN O O
by IN O O
a DT O O
fixed VBN O O
digit NN O O
namely RB O O
0 NFP O O
, , O O
1 CD O O
, , O O
3 CD O O
or CC O O
4 CD O O
. . O O

At IN O O
runtime NN O O
the DT O O
malware NN O O
adds VBZ O O
additional JJ O O
configuration NN O O
parameters NNS O O
, , O O
which WDT O O
are VBP O O
not RB O O
assigned VBN O O
an DT O O
obvious JJ O O
name NN O O
like IN O O
those DT O O
retrieved VBN O O
from IN O O
the DT O O
resource NN O O
section NN O O
. . O O

The DT O O
synonyms NN O O
for IN O O
all DT O O
encrypted JJ O O
configuration NN O O
values NNS O O
as IN O O
they PRP O O
are VBP O O
stored VBN O O
in IN O O
Windows NNP O O
registry NN O O
are VBP O O
. . O O

After IN O O
the DT O O
configuration NN O O
is VBZ O O
retrieved VBN O O
from IN O O
the DT O O
resource NN O O
section NN O O
the DT B-Entity 1
malware NN I-Entity O
will MD O O
create VB B-Action 2
a DT O O
subkey NN B-Entity 3
for IN I-Entity O
every DT I-Entity O
parameter NN I-Entity O
under IN B-Modifier 4
[ -LRB- O O
HKLM|HKCU]\Software\Microsoft\IPSec NNP B-Entity 5
. . O O

This DT O O
key NN B-Entity 1
has VBZ O O
initially RB O O
been VBN B-Action 2
created VBN I-Action O
by IN O O
the DT B-Entity 3
dropper NN I-Entity O
. . O O

The DT O O
attributes NNS O O
are VBP O O
encrypted VBN O O
before IN O O
being VBG O O
written VBN O O
to IN O O
registry NN O O
, , O O
and CC O O
will MD O O
be VB O O
decrypted VBN O O
on IN O O
the DT O O
fly NN O O
every DT O O
time NN O O
the DT O O
malware NN O O
requests VBZ O O
a DT O O
specific JJ O O
parameter NN O O
. . O O

Suspect JJ O O
# $ O O
4 CD O O
comes VBZ O O
with IN O O
a DT O O
solid JJ O O
multi NN O O
- HYPH O O
threading VBG O O
model NN O O
, , O O
which WDT O O
seeks VBZ O O
to TO O O
assure VB O O
fail VB O O
- HYPH O O
safe JJ O O
and CC O O
high JJ O O
- HYPH O O
performance NN O O
execution NN O O
. . O O

The DT O O
malware NN O O
runs VBZ O O
a DT O O
main JJ O O
thread NN O O
, , O O
which WDT O O
manages VBZ O O
four CD O O
worker NN O O
threads NNS O O
and CC O O
performs VBZ O O
C&C NNP O O
command NN O O
parsing NN O O
and CC O O
Lua NN O O
script NN O O
execution NN O O
. . O O

The DT O O
worker NN B-Entity 1
threads VBZ I-Entity O
are VBP O O
dedicated VBN O O
to IN O O
receive VB B-Action 2
commands NNS O O
and CC B-Entity 3
scripts NNS I-Entity O
through IN B-Modifier 4
different JJ O O
ways NNS B-Entity 5
. . O O

Next RB O O
to IN O O
that DT O O
, , O O
the DT O O
main JJ O O
thread NN O O
also RB O O
runs VBZ O O
sub NN B-Entity 1
threads NNS I-Entity O
to TO O O
maintain VB B-Action 2
log NN O O
files VBZ B-Entity 3
the DT I-Entity O
malware NN I-Entity O
creates VBZ I-Entity O
at IN I-Entity O
during IN I-Entity O
execution NN I-Entity O
and CC O O
to TO O O
keep VB B-Action 4
track NN I-Action O
of IN B-Modifier 5
the DT O O
overall JJ B-Entity 6
system NN I-Entity O
load NN I-Entity O
the DT I-Entity O
malware NN I-Entity O
creates VBZ I-Entity O
. . O O

The DT O O
threads NNS O O
are VBP O O
coordinated VBN O O
via IN O O
named VBN O O
events NNS O O
, , O O
global JJ O O
flag NN O O
variables NNS O O
, , O O
in IN O O
some DT O O
cases NNS O O
also RB O O
mutexes VBP O O
or CC O O
semaphores NNS O O
are VBP O O
used VBN O O
. . O O

The DT O O
main JJ O O
action NN O O
of IN O O
the DT O O
malware NN O O
is VBZ O O
carried VBN O O
out RP O O
in IN O O
the DT O O
main JJ O O
thread NN O O
, , O O
which WDT O O
parses VBZ O O
commands NNS O O
and CC O O
executes VBZ O O
Lua NNP O O
scripts NNS O O
, , O O
provided VBN O O
by IN O O
the DT O O
worker NN O O
threads NNS O O
via IN O O
command NN O O
files NNS O O
. . O O

The DT O O
threading NN O O
model NN O O
is VBZ O O
summarized VBN O O
in IN O O
the DT O O
following VBG O O
graphic JJ O O
. . O O

A DT O O
dedicated JJ B-Entity 1
thread NN I-Entity O
is VBZ O O
present JJ O O
for IN O O
monitoring VBG B-Action 2
the DT O O
CPU NN B-Entity 3
load NN I-Entity O
the DT I-Entity O
malware NN I-Entity O
itself PRP I-Entity O
generates VBZ I-Entity O
. . O O

Therefor NNP O O
the DT O O
thread NN O O
enumerates VBZ O O
all DT O O
threads NNS O O
from IN O O
the DT O O
current JJ O O
process NN O O
and CC O O
calculates VBZ O O
their PRP$ O O
execution NN O O
time NN O O
. . O O

The DT O O
user- NN O O
and CC O O
kernel NN O O
land NN O O
execution NN O O
time NN O O
is VBZ O O
measured VBN O O
for IN O O
every DT O O
thread NN O O
using VBG O O
the DT O O
kernel32 NN O O
! . O O
GetThreadTimes VBZ O O
API NNP O O
; : O O
then RB O O
aggregated VBN O O
, , O O
so RB O O
the DT O O
final JJ O O
value NN O O
holds VBZ O O
the DT O O
overall JJ O O
CPU NN O O
usage NN O O
time NN O O
of IN O O
the DT O O
malware NN O O
process NN O O
. . O O

The DT O O
thread NN O O
keeps VBZ O O
track NN O O
of IN O O
the DT O O
time NN O O
passing VBG O O
between IN O O
executions NNS O O
. . O O

If IN O O
the DT O O
malware NN O O
's POS O O
active JJ O O
execution NN O O
time NN O O
in IN O O
percentage NN O O
of IN O O
this DT O O
delta NN O O
exceeds VBZ O O
a DT O O
configured VBN O O
threshold NN O O
, , O O
the DT O O
malware NN O O
will MD O O
suspend VB O O
all DT O O
threads NNS O O
of IN O O
its PRP$ O O
process NN O O
for IN O O
at RB O O
least RBS O O
5s CD O O
. . O O

The DT O O
threshold NN O O
is VBZ O O
retrieved VBN O O
from IN O O
configuration NN O O
in IN O O
Windows NNP O O
registry NN O O
, , O O
and CC O O
can MD O O
be VB O O
controlled VBN O O
by IN O O
the DT O O
botmaster NN O O
via IN O O
the DT O O
C&C NNP O O
command NN O O
setcpulimit NN O O
( -LRB- O O
see VB O O
section NN O O
2.5 CD O O
) -RRB- O O
. . O O

This DT O O
clearly RB O O
is VBZ O O
an DT O O
attempt NN O O
to IN O O
keeping VBG O O
a DT O O
low JJ O O
profile NN O O
on IN O O
the DT O O
infected VBN O O
machine NN O O
. . O O

By IN O O
maintaining VBG O O
its PRP$ O O
own JJ O O
execution NN O O
load NN O O
the DT O O
bot NN O O
's POS O O
compromised VBN O O
svchost.exe NN O O
process NN O O
will MD O O
not RB O O
catch VB O O
attention NN O O
on IN O O
the DT O O
process NN O O
list NN O O
. . O O

The DT O O
backfile NN O O
launching VBG O O
thread NN O O
got VBD O O
its PRP$ O O
name NN O O
from IN O O
the DT O O
named VBN O O
event NN O O
' `` O O
backfilelaunching VBG O O
' '' O O
which WDT O O
is VBZ O O
set NN O O
to TO O O
indicate VB O O
that IN O O
the DT O O
dedicated JJ O O
thread NN O O
has VBZ O O
started VBN O O
. . O O

Also RB O O
in IN O O
a DT O O
1s CD O O
- HYPH O O
frequency NN O O
the DT O O
malware NN O O
runs VBZ O O
the DT O O
backfile NN O O
thread NN O O
to TO O O
push VB O O
dump VB O O
files NNS O O
to IN O O
one CD O O
of IN O O
its PRP$ O O
remote JJ O O
servers NNS O O
. . O O

The DT O O
files NNS O O
are VBP O O
named VBN O O
Perflib_Perfdat_dmpbX.dat NNP O O
, , O O
where WRB O O
X NNP O O
is VBZ O O
an DT O O
index NN O O
number NN O O
starting VBG O O
with IN O O
0 CD O O
. . O O

The DT O O
data NNS O O
written VBN O O
to IN O O
the DT O O
file NN O O
are VBP O O
status NN O O
messages NNS O O
including VBG O O
a DT O O
time NN O O
stamp NN O O
, , O O
which WDT O O
are VBP O O
returned VBN O O
by IN O O
command NN O O
and CC O O
Lua NN O O
script NN O O
execution NN O O
. . O O

The DT O O
data NN O O
is VBZ O O
encrypted VBN O O
using VBG O O
the DT O O
response_key NN O O
from IN O O
the DT O O
configuration NN O O
. . O O

The DT O O
term NN O O
' `` O O
hearer NN O O
' '' O O
can MD O O
be VB O O
found VBN O O
plenty NN O O
of IN O O
times NNS O O
in IN O O
the DT O O
binary NN O O
, , O O
it PRP O O
is VBZ O O
assumed VBN O O
that IN O O
it PRP O O
is VBZ O O
equivalent JJ O O
to IN O O
' `` O O
listener NN O O
' '' O O
of IN O O
some DT O O
sort NN O O
. . O O

All DT O O
together RB O O
suspect NN O O
# $ O O
4 CD O O
manages VBZ O O
4 CD O O
hearer JJ O O
threads NNS O O
including VBG O O
one CD O O
command NN O O
file NN O O
per IN O O
thread NN O O
. . O O

The DT O O
command NN O O
file NN O O
is VBZ O O
named VBN O O
net.capX CD O O
, , O O
where WRB O O
X NNP O O
is VBZ O O
the DT O O
index NN O O
of IN O O
the DT O O
thread NN O O
; : O O
0 CD O O
, , O O
1 CD O O
, , O O
3 CD O O
or CC O O
4 CD O O
. . O O

The DT O O
hearer NN B-Entity 1
thread NN I-Entity O
's POS I-Entity O
purpose NN O O
is VBZ O O
to IN O O
receive VB B-Action 2
instructions NNS O O
from IN B-Entity 3
the DT I-Entity O
remote JJ I-Entity O
servers NNS I-Entity O
and CC O O
provide VB O O
them PRP O O
to IN O O
the DT O O
main JJ O O
thread NN O O
. . O O

Such JJ O O
instructions NNS O O
are VBP O O
commands NNS O O
and/or CC O O
one CD O O
or CC O O
more JJR O O
Lua NNP O O
scripts NNS O O
. . O O

Each DT O O
hearer NN O O
has VBZ O O
a DT O O
dedicated JJ O O
method NN O O
to TO O O
receive VB O O
instructions NNS O O
which WDT O O
is VBZ O O
either CC O O
separately RB O O
via IN O O
HTTP NNP O O
from IN O O
the DT O O
server NN O O
, , O O
aggregated VBN O O
through IN O O
a DT O O
downloaded JJ O O
data NNS O O
file NN O O
or CC O O
as IN O O
tasks NNS O O
to TO O O
be VB O O
configured VBN O O
as IN O O
scheduled VBN O O
tasks NNS O O
. . O O

The DT O O
hearer NN O O
threads NNS O O
dump VBP O O
the DT O O
received JJ O O
instructions NNS O O
to IN O O
their PRP$ O O
net.cap-files NNS O O
, , O O
from IN O O
where WRB O O
the DT O O
main JJ O O
thread NN O O
's POS O O
command NN O O
parsing VBG O O
routine NN O O
fetches VBZ O O
and CC O O
executes VBZ O O
them PRP O O
. . O O

The DT O O
data NN O O
is VBZ O O
encrypted VBN O O
with IN O O
the DT O O
storage_key NN O O
before IN O O
written VBN O O
to IN O O
disk NN O O
. . O O

Generic JJ O O
hearer NN O O
thread NN O O
. . O O

Started VBN O O
, , O O
but CC O O
not RB O O
involved VBN O O
in IN O O
command NN O O
fetching NN O O
and CC O O
parsing NN O O
. . O O

Hearer NNP O O
1 CD B-Entity 1
receives VBZ B-Action 2
commands NNS O O
and CC B-Entity 3
Lua NNP I-Entity O
scripts NNS I-Entity O
directly RB O O
via IN B-Modifier 4
HTTP NNP B-Entity 5
from IN B-Modifier 6
one CD O O
of IN B-Entity 7
the DT I-Entity O
C&C NNP I-Entity O
servers NNS I-Entity O
. . O O

These DT O O
are VBP O O
encrypted VBN O O
with IN O O
the DT O O
storage_key NN O O
and CC O O
stored VBN O O
to IN O O
net.cap1 CD O O
in IN O O
the DT O O
malware NN O O
's POS O O
working NN O O
directory NN O O
. . O O

Interestingly RB O O
, , O O
the DT O O
malware NN O O
handles VBZ O O
successful JJ O O
downloads NNS O O
with IN O O
the DT O O
HTTP NN O O
status NN O O
code NN O O
418 CD O O
. . O O

This DT O O
code NN O O
is VBZ O O
not RB O O
part NN O O
of IN O O
the DT O O
original JJ O O
HTTP NNP O O
standard NN O O
, , O O
but CC O O
was VBD O O
introduced VBN O O
in IN O O
RFC2324 NNP O O
, , O O
1998 CD O O
's POS O O
traditional JJ O O
IETF NNP O O
April NNP O O
Fool NNP O O
's POS O O
joke NN O O
. . O O

The DT O O
textual JJ O O
representation NN O O
of IN O O
status NN O O
418 CD O O
is VBZ O O
" `` O O
I PRP O O
'm VBP O O
a DT O O
teapot NN O O
. . O O
" '' O O
. . O O

Hearer NNP O O
2 CD O O
is VBZ O O
responsible JJ O O
for IN O O
managing VBG O O
the DT O O
scheduled VBN O O
tasks NNS O O
, , O O
titled VBD O O
' `` O O
crontasks NNS O O
' '' O O
by IN O O
the DT O O
malware NN O O
. . O O

The DT O O
tasks NNS O O
are VBP O O
stored VBN O O
in IN O O
a DT O O
file NN O O
named VBN O O
perf.tmp NN O O
, , O O
and CC O O
when WRB O O
due JJ O O
for IN O O
execution NN O O
are VBP O O
copied VBN O O
to IN O O
the DT O O
according VBG O O
net.cap-file NN O O
, , O O
net.cap2 XX O O
in IN O O
this DT O O
case NN O O
. . O O

From IN O O
there RB O O
the DT O O
main JJ O O
thread NN O O
can MD O O
fetch VB O O
and CC O O
execute VB O O
them PRP O O
in IN O O
its PRP$ O O
command NN O O
parsing NN O O
loop NN O O
. . O O

Hearer NNP O O
2 CD O O
also RB O O
creates VBZ O O
a DT O O
swap NN O O
file NN O O
named VBN O O
perf.tmp2 NN O O
, , O O
which WDT O O
helps VBZ O O
in IN O O
selectively RB O O
editing VBG O O
the DT O O
initial JJ O O
task NN O O
file NN O O
and CC O O
in IN O O
managing VBG O O
the DT O O
task NN O O
list NN O O
. . O O

Hearer NN O O
3 CD O O
searches NNS O O
for IN O O
a DT O O
file NN O O
named VBN O O
netdump.db CD O O
in IN O O
its PRP$ O O
local JJ O O
working VBG O O
directory NN O O
. . O O

If IN O O
found VBN O O
, , O O
the DT B-Entity 1
thread NN I-Entity O
will MD O O
read VB B-Action 2
its PRP$ O O
content JJ B-Entity 3
in IN B-Modifier 4
chunks VBZ O O
representing VBG B-Entity 5
different JJ I-Entity O
commands NNS I-Entity O
and CC O O
paste VB O O
these DT O O
to IN O O
net.cap3 CD O O
. . O O

Again RB O O
, , O O
the DT O O
data NN O O
is VBZ O O
encrypted VBN O O
with IN O O
the DT O O
storage_key NN O O
. . O O

No DT O O
functionality NN O O
could MD O O
be VB O O
found VBN O O
in IN O O
the DT O O
malware NN O O
code NN O O
to TO O O
write VB O O
to IN O O
netdump.db NN O O
, , O O
which WDT O O
leaves VBZ O O
the DT O O
conclusion NN O O
that IN O O
this DT B-Entity 1
file NN I-Entity O
will MD O O
be VB B-Action 2
downloaded VBN I-Action O
from IN B-Modifier 3
a DT O O
C&C NNP B-Entity 4
server NN I-Entity O
. . O O

After IN O O
initializing VBG O O
and CC O O
starting VBG O O
all DT O O
four CD O O
hearer NN O O
threads NNS O O
the DT O O
main JJ O O
thread NN O O
enters VBZ O O
a DT O O
command NN O O
parsing NN O O
loop NN O O
. . O O

For IN O O
every DT O O
hearer NN O O
the DT O O
main JJ O O
thread NN O O
invokes VBZ O O
the DT O O
command NN O O
and CC O O
script NN O O
execution NN O O
function NN O O
. . O O

Therefor NNP O O
data NNS O O
is VBZ O O
read VBN O O
from IN O O
the DT O O
encrypted JJ O O
net.capX- JJ O O
file NN O O
, , O O
where WRB O O
X NNP O O
indicates VBZ O O
the DT O O
index NN O O
of IN O O
the DT O O
hearer NN O O
; : O O
0 CD O O
, , O O
1 CD O O
, , O O
3 CD O O
or CC O O
4 CD O O
. . O O

Once RB O O
decrypted VBN O O
, , O O
this DT O O
data NN O O
is VBZ O O
parsed VBN O O
to TO O O
find VB O O
valid JJ O O
C&C NNP O O
commands NNS O O
and CC O O
/ SYM O O
or CC O O
valid JJ O O
Lua NNP O O
scripts NNS O O
to TO O O
execute VB O O
. . O O

More JJR O O
details NNS O O
on IN O O
command NN O O
and CC O O
script NN O O
execution NN O O
can MD O O
be VB O O
found VBN O O
in IN O O
section NN O O
2.6 CD O O
. . O O

Notable NNP O O
is VBZ O O
that IN O O
the DT O O
command NN O O
parsing NN O O
and CC O O
execution NN O O
happens VBZ O O
in IN O O
a DT O O
serial JJ O O
fashion NN O O
, , O O
while IN O O
Lua NNP O O
script NN O O
execution NN O O
is VBZ O O
handed VBN O O
over RP O O
to IN O O
dedicated JJ O O
threads NNS O O
. . O O

Also RB O O
, , O O
no DT O O
direct JJ O O
relation NN O O
between IN O O
C&C NNP O O
commands NNS O O
and CC O O
Lua NNP O O
script NN O O
execution NN O O
could MD O O
be VB O O
identified VBN O O
. . O O

The DT O O
most RBS O O
notable JJ O O
actions NNS O O
of IN O O
the DT O O
bot NN O O
can MD O O
be VB O O
summarized VBN O O
as IN O O
follows VBZ O O
. . O O

However RB O O
, , O O
suspect JJ O O
# $ O O
4 LS O O
does VBZ O O
accept VB O O
a DT O O
list NN O O
of IN O O
hard JJ O O
coded JJ O O
commands NNS O O
to TO O O
be VB O O
sent VBN O O
by IN O O
the DT O O
C&C NNP O O
server NN O O
. . O O

These DT O O
mainly RB O O
serve VBP O O
the DT O O
purpose NN O O
of IN O O
controlling VBG O O
operation NN O O
of IN O O
the DT O O
bot NN O O
on IN O O
the DT O O
infected JJ O O
machine NN O O
, , O O
such JJ O O
as IN O O
restarting VBG B-Action 1
threads NNS B-Entity 2
or CC O O
setting VBG B-Action 3
configuration NN O O
parameters NNS B-Entity 4
. . O O

The DT O O
full JJ O O
list NN O O
of IN O O
C&C NNP O O
commands NNS O O
can MD O O
be VB O O
found VBN O O
below IN O O
. . O O

Every DT O O
command NN O O
execution NN O O
function NN O O
returns VBZ O O
a DT O O
status NN O O
line NN O O
, , O O
such JJ O O
as IN O O
for IN O O
example NN O O
" `` O O
ftp FW O O
command NN O O
succeeded VBD O O
for IN O O
: : O O
% NN O O
s!\n NN O O
" '' O O
. . O O

The DT O O
initial JJ B-Entity 1
command NN I-Entity O
, , I-Entity O
the DT I-Entity O
status NN I-Entity O
line NN I-Entity O
and CC I-Entity O
a DT I-Entity O
current JJ I-Entity O
time NN I-Entity O
stamp NN I-Entity O
are VBP O O
encrypted VBD B-Action 2
and CC O O
sent VBD B-Action 3
back RB I-Action O
to IN B-Modifier 4
the DT O O
C&C NNP B-Entity 5
server NN I-Entity O
. . O O

Additionally RB O O
, , O O
the DT B-Entity 1
same JJ I-Entity O
data NNS I-Entity O
is VBZ O O
written VBN B-Action 2
to IN B-Modifier 3
the DT O O
Perflib_Perfdat_dmpbX.dat NNP B-Entity 4
file NN I-Entity O
which WDT O O
is VBZ O O
regularly RB O O
pushed VBD B-Action 5
to IN B-Modifier 6
the DT O O
C&C NNP B-Entity 7
by IN B-Modifier 8
the DT O O
backfile NN B-Entity 9
thread NN I-Entity O
. . O O

For IN O O
hearer NN O O
1 CD O O
and CC O O
3 CD O O
the DT O O
command NN O O
parsing VBG O O
routine NN O O
will MD O O
additionally RB O O
manage VB O O
two CD O O
continuous JJ O O
log NN O O
files NNS O O
which WDT O O
are VBP O O
named VBN O O
Perflib_Perfdata41X.dat NNP O O
and CC O O
Perflib_Perfdata_42X.dat NNP O O
, , O O
where WRB O O
X NNP O O
is VBZ O O
the DT O O
respective JJ O O
hearer NN O O
thread NN O O
's POS O O
index NN O O
. . O O

More RBR O O
specifically RB O O
, , O O
command NN O O
parsing NN O O
will MD O O
increment VB O O
a DT O O
global JJ O O
variable NN O O
holding VBG O O
the DT O O
total JJ O O
amount NN O O
of IN O O
executed VBN O O
commands NNS O O
and CC O O
scripts NNS O O
. . O O

This DT O O
4-byte IN O O
value NN O O
is VBZ O O
appended VBN O O
to IN O O
Perflib_Perfdata41X.dat NNP O O
before RB O O
and CC O O
Perlfib_Perfdata42X.dat NNP O O
after IN O O
command NN O O
execution NN O O
. . O O

These DT O O
files NNS B-Entity 1
survive VBP B-Action 2
restart NN O O
or CC B-Entity 3
cleanup NN I-Entity O
, , O O
so RB O O
every DT O O
time NN O O
the DT B-Entity 4
malware NN I-Entity O
boots NNS O O
it PRP O O
reads VBZ B-Action 5
the DT O O
current JJ B-Entity 6
status NN I-Entity O
from IN B-Modifier 7
these DT O O
logs VBZ B-Entity 8
and CC O O
continues VBZ O O
from IN O O
the DT O O
latest JJS O O
value NN O O
. . O O

This DT O O
mechanism NN O O
helps VBZ O O
the DT O O
botmaster NN O O
to TO O O
keep VB O O
track NN O O
of IN O O
the DT O O
bots NNS O O
activity NN O O
on IN O O
an DT O O
infected JJ O O
host NN O O
and CC O O
could MD O O
also RB O O
be VB O O
helpful JJ O O
in IN O O
trouble NN O O
shooting VBG O O
. . O O

Suspect JJ O O
# $ O O
4 CD O O
incorporates VBZ O O
an DT O O
interpreter NN O O
for IN O O
Lua NNP O O
5.1 CD O O
, , O O
LuaSocket NNP O O
2.0.2 CD O O
and CC O O
C NNP O O
/ , O O
Invoke NNP O O
Lua NNP O O
bindings NNS O O
. . O O

Lua NNP O O
is VBZ O O
a DT O O
lightweight JJ O O
programming NN O O
language NN O O
designed VBN O O
as IN O O
a DT O O
scripting NN O O
language NN O O
which WDT O O
can MD O O
be VB O O
embedded VBN O O
into IN O O
applications NNS O O
, , O O
providing VBG O O
a DT O O
C NNP O O
API NN O O
for IN O O
doing VBG O O
so RB O O
. . O O

C NN O O
bindings NNS O O
are VBP O O
provided VBN O O
through IN O O
C NNP O O
/ SYM O O
Invoke NNP O O
and CC O O
enable VB O O
Lua NNP O O
scripts NNS O O
to TO O O
perform VB O O
callbacks NNS O O
to IN O O
C NNP O O
/ SYM O O
C++ NNP O O
code NN O O
. . O O

This DT O O
constellation NN O O
can MD O O
be VB O O
found VBN O O
in IN O O
many JJ O O
video NN O O
game NN O O
engines NNS O O
to TO O O
provide VB O O
polymorphic JJ O O
behavior NN O O
in IN O O
games NNS O O
. . O O

Engine NN O O
and CC O O
game NN O O
play NN O O
features NNS O O
are VBP O O
injected VBN O O
through IN O O
Lua NNP O O
scripts NNS O O
, , O O
which WDT O O
instrument NN O O
the DT O O
game NN O O
engine NN O O
code NN O O
. . O O

The DT O O
Lua NNP O O
interpreter NN O O
is VBZ O O
very RB O O
small JJ O O
, , O O
compiled VBN O O
roughly RB O O
180kB RB O O
, , O O
thus RB O O
can MD O O
easily RB O O
be VB O O
integrated VBN O O
in IN O O
an DT O O
application NN O O
. . O O

The DT O O
C NNP O O
/ SYM O O
Invoke NNP O O
bindings NNS O O
enable VBP O O
Lua JJ O O
to TO O O
be VB O O
completely RB O O
independent JJ O O
from IN O O
the DT O O
C NNP O O
/ SYM O O
C++ NNP O O
application NN O O
, , O O
so RB O O
injected VBN O O
scripts NNS O O
can MD O O
be VB O O
pure JJ O O
Lua NNP O O
code NN O O
. . O O

A DT O O
script NN O O
, , O O
if IN O O
delivered VBN O O
to IN O O
one CD O O
of IN O O
the DT O O
hearer NN O O
threads NNS O O
, , O O
will MD O O
be VB O O
provided VBN O O
through IN O O
the DT O O
corresponding VBG O O
net.cap-file NN O O
of IN O O
the DT O O
hearer NN O O
along IN O O
with IN O O
a DT O O
C&C NNP O O
command NN O O
. . O O

If IN O O
a DT O O
script NN O O
is VBZ O O
included VBN O O
in IN O O
the DT O O
data NNS O O
read VBP O O
from IN O O
the DT O O
net.cap-file NN O O
, , O O
this DT O O
is VBZ O O
indicated VBN O O
by IN O O
the DT O O
start NN O O
sentinel NN O O
' '' O O
< XX O O
$ $ O O
' '' O O
. . O O

Likewise RB O O
, , O O
the DT O O
end NN O O
of IN O O
a DT O O
script NN O O
is VBZ O O
indicated VBN O O
by IN O O
' $ O O
$ $ O O
> CD O O
' '' O O
. . O O

Command NNP O O
execution NN O O
goes VBZ O O
hand NN O O
in IN O O
hand NN O O
with IN O O
Lua NNP O O
script NN O O
execution NN O O
, , O O
thus RB O O
is VBZ O O
dependent JJ O O
of IN O O
the DT O O
four CD O O
hearer NN O O
threads NNS O O
. . O O

The DT O O
work NN O O
flow NN O O
for IN O O
each DT O O
hearer NN O O
per IN O O
execution NN O O
loop NN O O
in IN O O
the DT O O
main JJ O O
thread NN O O
is VBZ O O
as IN O O
follows VBZ O O
. . O O

After IN O O
starting VBG O O
the DT B-Entity 1
Lua NNP I-Entity O
thread NN I-Entity O
requests VBZ B-Action 2
a DT O O
value NN B-Entity 3
from IN I-Entity O
Windows NNP I-Entity O
registry NN I-Entity O
named VBN I-Entity O
' `` I-Entity O
EnableLua NNP I-Entity O
' '' I-Entity O
under IN I-Entity O
SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System NNP I-Entity O
. . O O

This DT O O
key JJ O O
name NN O O
stands VBZ O O
for IN O O
enable NN O O
limited JJ O O
user NN O O
account NN O O
. . O O

When WRB O O
set VBN O O
to IN O O
zero CD O O
this DT O O
key NN O O
effectively RB O O
disables VBZ O O
UAC NNP O O
( -LRB- O O
User NNP O O
Account NNP O O
Control NNP O O
) -RRB- O O
. . O O

The DT O O
malware NN O O
only RB O O
requests VBZ O O
the DT O O
key JJ O O
value NN O O
but CC O O
does VBZ O O
not RB O O
change VB O O
it PRP O O
. . O O

The DT O O
value NN O O
is VBZ O O
later RB O O
used VBN O O
by IN O O
a DT O O
callback NN O O
function NN O O
named VBN O O
' '' O O
popenWin NN O O
' '' O O
to TO O O
decide VB O O
on IN O O
a DT O O
way NN O O
how WRB O O
a DT O O
sub NN O O
process NN O O
should MD O O
be VB O O
started VBN O O
. . O O

Options NNS O O
are VBP O O
via IN O O
WMIC NNP O O
using VBG O O
wmic.exe NN O O
, , O O
Microsoft NNP O O
CScript NNP O O
engine NN O O
using VBG O O
cscript.exe NN O O
or CC O O
directly RB O O
via IN O O
spawning VBG O O
a DT O O
command NN O O
line NN O O
through IN O O
cmd.exe NN O O
. . O O

However RB O O
, , O O
spawning VBG O O
sub NN O O
processes NNS O O
is VBZ O O
not RB O O
the DT O O
only JJ O O
feature NN O O
which WDT O O
comes VBZ O O
with IN O O
Lua NNP O O
. . O O

The DT O O
Lua NNP O O
interpreter NN O O
is VBZ O O
a DT O O
powerful JJ O O
code NN O O
base NN O O
which WDT O O
enables VBZ O O
suspect JJ O O
# $ O O
4 CD O O
to TO O O
change VB O O
functionality NN O O
on IN O O
the DT O O
fly NN O O
, , O O
as IN O O
different JJ O O
scripts NNS O O
are VBP O O
downloaded VBN O O
and CC O O
executed VBN O O
. . O O

The DT O O
scripts NNS O O
define VBP O O
the DT O O
functionality NN O O
as IN O O
they PRP O O
perform VBP O O
callbacks NNS O O
to IN O O
the DT O O
C NNP O O
/ SYM O O
C++ NNP O O
code NN O O
in IN O O
the DT O O
malware JJ O O
binary NN O O
. . O O

The DT O O
potential NN O O
of IN O O
the DT O O
Lua NNP O O
interpreter NN O O
can MD O O
be VB O O
investigated VBN O O
on IN O O
the DT O O
project NN O O
homepage NN O O
. . O O

Like IN O O
command NN O O
execution NN O O
, , O O
Lua NNP B-Entity 1
script NN I-Entity O
execution NN I-Entity O
also RB O O
returns VBZ B-Action 2
a DT O O
status NN B-Entity 3
message NN I-Entity O
which WDT I-Entity O
is VBZ I-Entity O
extended VBN I-Entity O
by IN I-Entity O
a DT I-Entity O
time NN I-Entity O
stamp NN I-Entity O
and CC O O
forwarded VBD B-Action 4
to IN B-Modifier 5
one CD O O
of IN B-Entity 6
the DT I-Entity O
C&C NNP I-Entity O
servers NNS I-Entity O
, , O O
as RB O O
well RB O O
as IN O O
written VBN B-Action 7
to IN B-Modifier 8
the DT O O
backfile NN B-Entity 9
log NN I-Entity O
in IN I-Entity O
Perflib_Perfdat_dmpbX.dat NNP I-Entity O
. . O O

Likewise RB O O
, , O O
the DT B-Entity 1
Lua NNP I-Entity O
threads NNS I-Entity O
log NN B-Action 2
their PRP$ O O
activity NN B-Entity 3
to IN B-Modifier 4
Perflib_Perfdata_41X.dat/42X.dat NNP B-Entity 5
. . O O

Due IN O O
to IN O O
the DT O O
absence NN O O
of IN O O
C&C NNP O O
servers NNS O O
which WDT O O
hold VBP O O
the DT O O
Lua NNP O O
scripts NNS O O
for IN O O
the DT O O
bot NN O O
's POS O O
Lua NNP O O
interpreter NN O O
the DT O O
true JJ O O
nature NN O O
of IN O O
this DT O O
feature NN O O
remains VBZ O O
unclear JJ O O
. . O O

Throughout IN O O
analysis NN O O
and CC O O
due IN O O
to IN O O
the DT O O
help NN O O
of IN O O
Paul NNP O O
Rascagni NNP O O
res VBZ O O
a DT O O
number NN O O
of IN O O
binaries NNS O O
which WDT O O
relate VBP O O
to IN O O
EvilBunny NNP O O
were VBD O O
identified VBN O O
. . O O

The DT O O
binaries NNS O O
share VBP O O
parts NNS O O
of IN O O
source NN O O
code NN O O
, , O O
most RBS O O
notably RB O O
is VBZ O O
the DT O O
identical JJ O O
API NNP O O
name NN O O
obfuscation NN O O
algorithm NN O O
and CC O O
respective JJ O O
key JJ O O
AB34CD77h NN O O
. . O O

The DT O O
indicators NNS O O
of IN O O
a DT O O
relation NN O O
among IN O O
all DT O O
samples NNS O O
or CC O O
a DT O O
subset NN O O
of IN O O
samples NNS O O
are VBP O O
the DT O O
following VBG O O
. . O O

Mentioned VBN O O
set NN O O
of IN O O
malware NN O O
also RB O O
shows VBZ O O
parallels NNS O O
in IN O O
coding NN O O
style NN O O
and CC O O
structure NN O O
. . O O

However RB O O
, , O O
it PRP O O
has VBZ O O
to TO O O
be VB O O
pointed VBN O O
out RP O O
that DT O O
suspect NN O O
# $ O O
4 CD O O
without IN O O
doubt NN O O
sticks VBZ O O
out RP O O
in IN O O
terms NNS O O
of IN O O
complexity NN O O
and CC O O
functionality NN O O
. . O O

It PRP O O
is VBZ O O
assumed VBN O O
that IN O O
suspect NN O O
# $ O O
4 CD O O
was VBD O O
created VBN O O
by IN O O
the DT O O
same JJ O O
authors NNS O O
, , O O
but CC O O
this DT O O
can MD O O
not RB O O
be VB O O
proved VBN O O
. . O O

Four CD O O
of IN O O
the DT O O
set NN O O
of IN O O
identified VBN O O
samples NNS O O
are VBP O O
identical JJ O O
in IN O O
functionality NN O O
and CC O O
capability NN O O
. . O O

They PRP O O
possess VBP O O
respectable JJ O O
flooding NN O O
capabilities NNS O O
and CC O O
also RB O O
provide VB O O
remote JJ O O
access NN O O
. . O O

However RB O O
, , O O
they PRP O O
do VBP O O
not RB O O
support VB O O
data NNS O O
stealing VBG O O
or CC O O
any DT O O
spying NN O O
functionality NN O O
. . O O

Two CD O O
more JJR O O
C&C NNP O O
domains NNS O O
were VBD O O
identified VBN O O
for IN O O
this DT O O
group NN O O
. . O O

Regarding VBG O O
the DT O O
nature NN O O
of IN O O
the DT O O
attack NN O O
or CC O O
the DT O O
actor NN O O
behind IN O O
EvilBunny NNP O O
only RB O O
vague JJ O O
conclusions NNS O O
can MD O O
be VB O O
drawn VBN O O
. . O O

There EX O O
has VBZ O O
been VBN O O
public JJ O O
contemplation NN O O
that IN O O
the DT O O
actor NN O O
might MD O O
be VB O O
french JJ O O
and CC O O
that IN O O
the DT O O
malware NN O O
might MD O O
be VB O O
related VBN O O
to IN O O
samples NNS O O
analyzed VBN O O
by IN O O
the DT O O
Canadian JJ O O
CSEC NNP O O
. . O O

However RB O O
, , O O
there EX O O
hasn't RB O O
been VBN O O
any DT O O
hard JJ O O
evidence NN O O
which WDT O O
links VBZ O O
the DT O O
attack NN O O
to IN O O
a DT O O
group NN O O
or CC O O
a DT O O
geographical JJ O O
location NN O O
. . O O

Attribution NN O O
is VBZ O O
a DT O O
tricky JJ O O
task NN O O
and CC O O
assumptions NNS O O
must MD O O
not RB O O
be VB O O
drawn VBN O O
easily RB O O
. . O O

For IN O O
providing VBG O O
technical JJ O O
insights NNS O O
, , O O
support NN O O
and CC O O
if IN O O
I PRP O O
remember VBP O O
right RB O O
even RB O O
water NN O O
, , O O
coffee NN O O
or CC O O
occationally RB O O
rum NN O O
, , O O
I PRP O O
want VBP O O
to TO O O
express VB O O
my PRP$ O O
deepest JJS O O
gratitude NN O O
to IN O O
Morgan NNP O O
Marquis NNP O O
- HYPH O O
Boire NNP O O
, , O O
Sebastien NNP O O
Larinier NNP O O
, , O O
Paul NNP O O
Rascagni NNP O O
res NNS O O
, , O O
Nicolas NNP O O
Brulez NNP O O
, , O O
Michael NNP O O
Shalyt NNP O O
and CC O O
Inbar NNP O O
Raz NNP O O
. . O O

Further RB O O
I PRP O O
want VBP O O
to TO O O
thank VB O O
Fred NNP O O
Arbogast NNP O O
, , O O
Alexandre NNP O O
Dulaunoy NNP O O
, , O O
Raphael NNP O O
Vinot NNP O O
and CC O O
the DT O O
remaining VBG O O
organizing NN O O
team NN O O
of IN O O
Hack.lu NNP O O
for IN O O
their PRP$ O O
advice NN O O
and CC O O
effort NN O O
, , O O
even RB O O
in IN O O
situations NNS O O
of IN O O
widespread JJ O O
insomnia NN O O
. . O O

All DT O O
of IN O O
you PRP O O
 . O O
such JJ O O
wow UH O O
, , O O
very RB O O
awesome JJ O O
; : O O
rock NN O O
on RB O O
! . O O
[ -LRB- O O
1 CD O O
] -RRB- O O
An NNP O O
Analysis NNP O O
Of IN O O
CVE-2011 NNP O O
- HYPH O O
4369 CD O O
http://blog.9bplus.com/analyzing-cve-2011-4369-part-one/ ADD O O
[ -LRB- O O
2 CD O O
] -RRB- O O
ThreatExpert NNP O O
Report NNP O O
on IN O O
c40e3ee23cf95d992b7cd0b7c01b8599 NNP O O
http://www.threatexpert.com/report.aspx?md5=c40e3ee23cf95d992b7cd0b7c01b8599 ADD O O
[ -LRB- O O
3 CD O O
] -RRB- O O
How WRB O O
to TO O O
disable VB O O
UAC NNP O O
https://social.technet.microsoft.com ADD O O
/ SYM O O
Forums NNP O O
/ SYM O O
windowsserver RB O O
/ SYM O O
en RB O O
- HYPH O O
US/0aeac9d8 NNP O O
- HYPH O O
3591 CD O O
- HYPH O O
4294- CD O O
b13e-825705b27730/how NN O O
- HYPH O O
to IN O O
- HYPH O O
disable VB O O
- HYPH O O
uac NN O O
[ -LRB- O O
4 CD O O
] -RRB- O O
The DT O O
Lua NNP O O
Project NNP O O
http://www.lua.org/ ADD O O
[ -LRB- O O
5 CD O O
] -RRB- O O
The DT O O
C NNP O O
/ SYM O O
Invoke NNP O O
Project NNP O O
http://www.nongnu.org/cinvoke/ NNP O O
[ -LRB- O O
6 CD O O
] -RRB- O O
Lua NNP O O
scriptable JJ O O
game NN O O
engines NNS O O
( -LRB- O O
Wikipedia NNP O O
) -RRB- O O
http://en.wikipedia.org/wiki/Category:Lua-scriptable_game_engines ADD O O
[ -LRB- O O
7 CD O O
] -RRB- O O
All DT O O
file NN O O
hashes VBZ O O
related JJ O O
to IN O O
the DT O O
EvilBunny NNP O O
malware NN O O
http://pastebin.com/7iedeFF5 ADD O O
[ -LRB- O O
8 CD O O
] -RRB- O O
Hack.lu ADD O O
2014 CD O O
Keynote NNP O O
on IN O O
TS NNP O O
/ SYM O O
NOFORN NNP O O
http://www.slideshare.net/pinkflawd/tsnoforn ADD O O
[ -LRB- O O
9 CD O O
] -RRB- O O
Quand NNP O O
les FW O O
Canadiens NNP O O
partent NN O O
en IN O O
chasse FW O O
de FW O O
Babar NNP O O
http://www.lemonde.fr ADD O O
/ SYM O O
international JJ O O
/ SYM O O
article/2014/03/21/quand RB O O
- HYPH O O
les RB O O
- HYPH O O
canadiens JJ O O
- HYPH O O
partent NN O O
- HYPH O O
en- JJ O O
chasse NN O O
- HYPH O O
de NN O O
- HYPH O O
babar_4387233_3210.html NN O O
Marked NNP O O
in IN O O
Grey NNP O O
is VBZ O O
the DT O O
data NNS O O
of IN O O
sinkholes NNS O O
for IN O O
the DT O O
mentioned VBN O O
domains NNS O O
, , O O
currently RB O O
operated VBN O O
by IN O O
Kaspersky NNP O O
. . O O

