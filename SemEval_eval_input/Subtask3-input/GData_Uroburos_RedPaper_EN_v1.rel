G NNP O O
Data NNP O O
Red NNP O O
Paper NNP O O
February NNP O O
2014 CD O O
: : O O
Uroburos NNP O O
G NNP O O
Data NNP O O
Red NNP O O
Paper NNP O O
February NNP O O
2014 CD O O
: : O O
Uroburos NNP O O
G NNP O O
Data NNP O O
Security NNP O O
experts NNS O O
have VBP O O
analyzed VBN O O
a DT B-Entity 1
very RB I-Entity O
complex JJ I-Entity O
and CC I-Entity O
sophisticated JJ I-Entity O
piece NN I-Entity O
of IN I-Entity O
malware NN I-Entity O
, , O O
designed VBN O O
to IN O O
steal VB B-Action 2
confidential JJ O O
data NNS B-Entity 3
. . O O

G NN O O
Data NNP O O
refers VBZ O O
to IN O O
it PRP O O
as IN O O
Uroburos NNP O O
, , O O
in IN O O
correspondence NN O O
with IN O O
a DT O O
string NN O O
found VBN O O
in IN O O
the DT O O
malware NN O O
's POS O O
code NN O O
and CC O O
following VBG O O
an DT O O
ancient JJ O O
symbol NN O O
depicting VBG O O
a DT O O
serpent NN O O
or CC O O
dragon NN O O
eating VBG O O
its PRP$ O O
own JJ O O
tail NN O O
. . O O

Uroburos NNP O O
is VBZ O O
a DT O O
rootkit NN O O
, , O O
composed VBN O O
of IN O O
two CD O O
files NNS O O
, , O O
a DT O O
driver NN O O
and CC O O
an DT O O
encrypted JJ O O
virtual JJ O O
file NN O O
system NN O O
. . O O

The DT O O
rootkit NN B-Entity 1
is VBZ O O
able JJ O O
to TO O O
take VB B-Action 2
control NN O O
of IN B-Entity 3
an DT I-Entity O
infected VBN I-Entity O
machine NN I-Entity O
, , O O
execute VB B-Action 4
arbitrary JJ O O
commands NNS B-Entity 5
and CC O O
hide VB B-Action 6
system NN O O
activities NNS B-Entity 7
. . O O

It PRP B-Entity 1
can MD O O
steal VB B-Action 2
information NN B-Entity 3
( -LRB- O O
most RBS O O
notably RB O O
: : O O
files NNS O O
) -RRB- O O
and CC O O
it PRP B-Entity 4
is VBZ O O
also RB O O
able JJ O O
to TO O O
capture VB B-Action 5
network NN O O
traffic NN B-Entity 6
. . O O

Its PRP$ O O
modular JJ O O
structure NN O O
allows VBZ O O
extending VBG O O
it PRP O O
with IN O O
new JJ O O
features NNS O O
easily RB O O
, , O O
which WDT O O
makes VBZ O O
it PRP O O
not RB O O
only RB O O
highly RB O O
sophisticated JJ O O
but CC O O
also RB O O
highly RB O O
flexible JJ O O
and CC O O
dangerous JJ O O
. . O O

Uroburos NNP O O
' POS O O
driver NN O O
part NN O O
is VBZ O O
extremely RB O O
complex JJ O O
and CC O O
is VBZ O O
designed VBN O O
to TO O O
be VB O O
very RB O O
discrete JJ O O
and CC O O
very RB O O
difficult JJ O O
to TO O O
identify VB O O
. . O O

The DT O O
development NN O O
of IN O O
a DT O O
framework NN O O
like IN O O
Uroburos NNP O O
is VBZ O O
a DT O O
huge JJ O O
investment NN O O
. . O O

The DT O O
development NN O O
team NN O O
behind IN O O
this DT O O
malware NN O O
obviously RB O O
comprises VBZ O O
highly RB O O
skilled JJ O O
computer NN O O
experts NNS O O
, , O O
as IN O O
you PRP O O
can MD O O
infer VB O O
from IN O O
the DT O O
structure NN O O
and CC O O
the DT O O
advanced JJ O O
design NN O O
of IN O O
the DT O O
rootkit NN O O
. . O O

We PRP O O
believe VBP O O
that IN O O
the DT O O
team NN O O
behind IN O O
Uroburos NNP O O
has VBZ O O
continued VBN O O
working VBG O O
on IN O O
even RB O O
more RBR O O
advanced JJ O O
variants NNS O O
, , O O
which WDT O O
are VBP O O
still RB O O
to TO O O
be VB O O
discovered VBN O O
. . O O

Uroburos NNP O O
is VBZ O O
designed VBN O O
to TO O O
work VB O O
in IN O O
peer NN O O
- HYPH O O
to IN O O
- HYPH O O
peer NN O O
mode NN O O
, , O O
meaning VBG O O
that IN O O
infected VBN B-Entity 1
machines NNS I-Entity O
communicate VBP O O
among IN O O
each DT O O
other JJ O O
, , O O
commanded VBD B-Action 2
by IN B-Modifier 3
the DT O O
remote JJ B-Entity 4
attackers NNS I-Entity O
. . O O

By IN O O
commanding VBG O O
one CD O O
infected VBN O O
machine NN O O
that WDT O O
has VBZ O O
Internet NN O O
connection NN O O
, , O O
the DT B-Entity 1
malware NN I-Entity O
is VBZ O O
able JJ O O
to TO O O
infect VB B-Action 2
further JJ O O
machines NNS B-Entity 3
within IN B-Modifier 4
the DT O O
network NN B-Entity 5
, , O O
even RB O O
the DT O O
ones NNS O O
without IN O O
Internet NN O O
connection NN O O
. . O O

It PRP B-Entity 1
can MD O O
spy VB B-Action 2
on IN B-Modifier 3
each DT O O
and CC B-Entity 4
every DT I-Entity O
infected VBN I-Entity O
machine NN I-Entity O
and CC O O
manages VBZ O O
to TO O O
send VB B-Action 5
the DT O O
exfiltrated JJ B-Entity 6
information NN I-Entity O
back RB O O
to IN B-Modifier 7
the DT O O
attackers NNS B-Entity 8
, , O O
by IN B-Modifier 9
relaying VBG O O
this DT B-Entity 10
exfiltrated VBN I-Entity O
data NN I-Entity O
through IN I-Entity O
infected VBN I-Entity O
machines NNS I-Entity O
to IN I-Entity O
one CD I-Entity O
machine NN I-Entity O
with IN I-Entity O
Internet NN I-Entity O
connection NN I-Entity O
. . O O

This DT O O
malware JJ O O
behavior NN O O
is VBZ O O
typical JJ O O
for IN O O
propagation NN O O
in IN O O
networks NNS O O
of IN O O
huge JJ O O
companies NNS O O
or CC O O
public JJ O O
authorities NNS O O
. . O O

The DT O O
attackers NNS O O
expect VBP O O
that IN O O
their PRP$ O O
target NN O O
does VBZ O O
have VB O O
computers NNS O O
cut VBN O O
off RP O O
from IN O O
the DT O O
Internet NN O O
and CC O O
uses VBZ O O
this DT O O
technique NN O O
as IN O O
a DT O O
kind NN O O
of IN O O
workaround NN O O
to TO O O
achieve VB O O
their PRP$ O O
goal NN O O
. . O O

Uroburos NNP O O
supports VBZ O O
32-bit NNP O O
and CC O O
64-bit CD O O
Microsoft NNP O O
Windows NNP O O
systems NNS O O
. . O O

Due IN O O
to IN O O
the DT O O
complexity NN O O
of IN O O
this DT O O
malware NN O O
and CC O O
the DT O O
supposed JJ O O
spying NN O O
techniques NNS O O
used VBN O O
by IN O O
it PRP O O
, , O O
we PRP O O
assume VBP O O
that IN O O
this DT O O
rootkit NN O O
targets VBZ O O
governments NNS O O
, , O O
research NN O O
institutes NNS O O
, , O O
or CC O O
/ SYM O O
and CC O O
big JJ O O
companies NNS O O
. . O O

Due IN O O
to IN O O
many JJ O O
technical JJ O O
details NNS O O
( -LRB- O O
file NN O O
name NN O O
, , O O
encryption NN O O
keys NNS O O
, , O O
behavior NN O O
and CC O O
more JJR O O
details NNS O O
mentioned VBN O O
in IN O O
this DT O O
report NN O O
) -RRB- O O
, , O O
we PRP O O
assume VBP O O
that IN O O
the DT O O
group NN O O
behind IN O O
Uroburos NNP O O
is VBZ O O
the DT O O
same JJ O O
group NN O O
that WDT O O
performed VBD O O
a DT O O
cyberattack NN O O
against IN O O
the DT O O
United NNP O O
States NNP O O
of IN O O
America NNP O O
in IN O O
2008 CD O O
with IN O O
a DT O O
malware NN O O
called VBN O O
Agent NNP O O
. . O O
BTZ NN O O
. . O O

Uroburos NNP O O
checks NNS O O
for IN O O
the DT O O
presence NN O O
of IN O O
Agent NNP O O
. . O O
BTZ NNP O O
and CC O O
remains VBZ O O
inactive JJ O O
if IN O O
it PRP O O
is VBZ O O
installed VBN O O
. . O O

It PRP O O
appears VBZ O O
that IN O O
the DT O O
authors NNS O O
of IN O O
Uroburos NNP O O
speak VBP O O
Russian NNP O O
( -LRB- O O
the DT O O
language NN O O
appears VBZ O O
in IN O O
a DT O O
sample NN O O
) -RRB- O O
, , O O
which WDT O O
corroborates VBZ O O
the DT O O
relation NN O O
to IN O O
Agent NNP O O
. . O O
BTZ NN O O
. . O O

Furthermore RB O O
, , O O
according VBG O O
to IN O O
public JJ O O
newspaper NN O O
articles NNS O O
, , O O
this DT O O
fact NN O O
, , O O
the DT O O
usage NN O O
of IN O O
Russian NNP O O
, , O O
also RB O O
applied VBD O O
for IN O O
the DT O O
authors NNS O O
of IN O O
Agent NNP O O
. . O O
BTZ NN O O
. . O O

According VBG O O
to IN O O
all DT O O
indications NNS O O
we PRP O O
gathered VBD O O
from IN O O
the DT O O
malware NN O O
analyses NNS O O
and CC O O
the DT O O
research NN O O
, , O O
we PRP O O
are VBP O O
sure JJ O O
of IN O O
the DT O O
fact NN O O
that IN O O
attacks NNS O O
carried VBN O O
out RP O O
with IN O O
Uroburos NNP O O
are VBP O O
not RB O O
targeting VBG O O
John NNP O O
Doe NNP O O
but CC O O
high JJ O O
profile NN O O
enterprises NNS O O
, , O O
nation NN O O
states NNS O O
, , O O
intelligence NN O O
agencies NNS O O
and CC O O
similar JJ O O
targets NNS O O
. . O O

The DT O O
Uroburos NNP O O
rootkit NN O O
is VBZ O O
one CD O O
of IN O O
the DT O O
most RBS O O
advanced JJ O O
rootkits NNS O O
we PRP O O
have VBP O O
ever RB O O
analyzed VBN O O
in IN O O
this DT O O
environment NN O O
. . O O

The DT O O
oldest JJS O O
driver NN O O
we PRP O O
identified VBD O O
was VBD O O
compiled VBN O O
in IN O O
2011 CD O O
, , O O
which WDT O O
means VBZ O O
that IN O O
the DT O O
campaign NN O O
remained VBD O O
undiscovered JJ O O
for IN O O
at RB O O
least RBS O O
three CD O O
years NNS O O
. . O O

At IN O O
the DT O O
current JJ O O
stage NN O O
of IN O O
the DT O O
investigations NNS O O
it PRP O O
is VBZ O O
unknown JJ O O
how WRB O O
Uroburos NNP O O
initially RB O O
infiltrates VBZ O O
high JJ O O
profile NN O O
networks NNS O O
. . O O

Many JJ O O
infection NN O O
vectors NNS O O
are VBP O O
conceivable JJ O O
. . O O

E.g. RB O O

spear NN O O
phishing NN O O
, , O O
drive VB O O
- HYPH O O
by IN O O
- HYPH O O
infections NNS O O
, , O O
USB NN O O
sticks NNS O O
, , O O
or CC O O
social JJ O O
engineering NN O O
attacks NNS O O
. . O O

The DT O O
G NNP O O
Data NNP O O
SecurityLabs NNP O O
discovered VBD O O
the DT O O
rootkit NN O O
dubbed VBN O O
Uroburos NNP O O
during IN O O
2013 CD O O
. . O O

We PRP O O
decided VBD O O
to TO O O
investigate VB O O
in IN O O
depth NN O O
soon RB O O
after IN O O
we PRP O O
identified VBD O O
the DT O O
following VBG O O
three CD O O
interesting JJ O O
aspects NNS O O
. . O O

Uroburos NNP O O
is VBZ O O
a DT O O
direct JJ O O
reference NN O O
to IN O O
the DT O O
Greek JJ O O
word NN O O
Ouroboros NNP O O
( -LRB- O O
Οὐροβόρος NNP O O
) -RRB- O O
. . O O

The DT O O
Ouroboros NNP O O
is VBZ O O
an DT O O
ancient JJ O O
symbol NN O O
depicting VBG O O
a DT O O
serpent NN O O
or CC O O
dragon NN O O
eating VBG O O
its PRP$ O O
own JJ O O
tail NN O O
. . O O

The DT O O
name NN O O
of IN O O
this DT O O
rootkit NN O O
is VBZ O O
inspired VBN O O
by IN O O
a DT O O
plain JJ O O
text NN O O
string NN O O
available JJ O O
in IN O O
several JJ O O
driver NN O O
files NNS O O
: : O O
Ur0bUr()sGotyOu NN O O
# NN O O
Furthermore RB O O
, , O O
we PRP O O
identified VBD O O
other JJ O O
references NNS O O
to IN O O
the DT O O
ancient JJ O O
serpent NN O O
/ SYM O O
dragon NN O O
symbol NN O O
within IN O O
the DT O O
rootkit NN O O
's POS O O
code NN O O
, , O O
for IN O O
example NN O O
the DT O O
following VBG O O
strings NNS O O
. . O O

Another DT O O
interesting JJ O O
notion NN O O
: : O O
The DT O O
exact JJ O O
spelling NN O O
, , O O
Uroburos NNP O O
, , O O
can MD O O
even RB O O
be VB O O
found VBN O O
in IN O O
a DT O O
webcomic NN O O
called VBN O O
Homestuck NNP O O
. . O O

In IN O O
this DT O O
interactive JJ O O
webcomic NN O O
, , O O
the DT O O
reader NN O O
/ , O O
player NN O O
needs VBZ O O
two CD O O
codes NNS O O
to TO O O
receive VB O O
virtual JJ O O
magic JJ O O
objects NNS O O
( -LRB- O O
called VBN O O
juju NN O O
) -RRB- O O
. . O O

Those DT O O
two CD O O
codes NNS O O
are VBP O O
in IN O O
fact NN O O
uROBuROS NNP O O
and CC O O
UrobUros NNP O O
. . O O

We PRP O O
can MD O O
notice VB O O
that IN O O
the DT O O
uppercase NN O O
and CC O O
lowercase JJ O O
character NN O O
order NN O O
matches VBZ O O
the DT O O
string NN O O
found VBD O O
within IN O O
the DT O O
malware NN O O
code NN O O
. . O O

The DT O O
rootkit NN O O
is VBZ O O
basically RB O O
composed VBN O O
of IN O O
two CD O O
files NNS O O
. . O O

We PRP O O
identified VBD O O
several JJ O O
file NN O O
names NNS O O
for IN O O
the DT O O
driver NN O O
, , O O
for IN O O
example NN O O
: : O O
Ultra3.sys NNP O O
, , O O
msw32.sys NN O O
, , O O
vstor32.sys NN O O
. . O O

We PRP O O
have VBP O O
encountered VBN O O
32-bit CD O O
and CC O O
64-bit CD O O
driver NN O O
versions NNS O O
. . O O

The DT O O
two CD O O
binaries NNS O O
may MD O O
be VB O O
installed VBN O O
simultaneously RB O O
on IN O O
one CD O O
system NN O O
. . O O

The DT O O
file NN O O
containing VBG O O
the DT O O
virtual JJ O O
file NN O O
system NN O O
has VBZ O O
a DT O O
random JJ O O
name NN O O
, , O O
followed VBN O O
by IN O O
the DT O O
extension NN O O
.dat NN O O
. . O O

Furthermore RB O O
, , O O
this DT O O
file NN O O
is VBZ O O
located VBN O O
in IN O O
the DT O O
same JJ O O
directory NN O O
as IN O O
the DT O O
driver NN O O
file NN O O
. . O O

The DT O O
installation NN O O
directory NN O O
does VBZ O O
change NN O O
, , O O
but CC O O
we PRP O O
were VBD O O
able JJ O O
to TO O O
identify VB O O
the DT O O
following VBG O O
pattern NN O O
. . O O

The DT O O
malware NN O O
's POS O O
persistence NN O O
is VBZ O O
established VBN O O
by IN O O
the DT O O
creation NN O O
of IN O O
a DT O O
service NN O O
which WDT O O
automatically RB O O
executes VBZ O O
during IN O O
each DT O O
startup NN O O
of IN O O
the DT O O
system NN O O
. . O O

The DT O O
service NN O O
is VBZ O O
located VBN O O
in IN O O
The DT O O
driver NN O O
is VBZ O O
needed VBN O O
to IN O O
A DT O O
rootkit NN O O
naturally RB O O
tries VBZ O O
to TO O O
hide VB B-Action 1
its PRP$ O O
activities NNS B-Entity 2
from IN B-Modifier 3
the DT O O
user NN B-Entity 4
and CC O O
so RB O O
does VBZ O O
Uroburos NNP B-Entity 5
. . O O

The DT O O
driver NN O O
uses VBZ O O
inline NN O O
patching VBG O O
to TO O O
perform VB O O
the DT O O
hooks NNS O O
, , O O
which WDT O O
is VBZ O O
a DT O O
common JJ O O
way NN O O
to TO O O
perform VB O O
this DT O O
task NN O O
. . O O

Inline NNP O O
patching NN O O
is VBZ O O
carried VBN O O
out RP O O
by IN O O
modifying VBG O O
the DT O O
beginning NN O O
of IN O O
a DT O O
targeted JJ O O
system NN O O
's POS O O
function NN O O
in IN O O
order NN O O
to TO O O
redirect VB O O
the DT O O
execution NN O O
flow NN O O
to IN O O
a DT O O
custom NN O O
code NN O O
before IN O O
jumping VBG O O
back RB O O
to IN O O
the DT O O
original JJ O O
function NN O O
. . O O

In IN O O
the DT O O
current JJ O O
case NN O O
, , O O
the DT O O
inline NN O O
patching VBG O O
adds VBZ O O
a DT O O
new JJ O O
interrupt JJ O O
instruction NN O O
( -LRB- O O
int NN O O
0xc3 CD O O
) -RRB- O O
at IN O O
the DT O O
beginning NN O O
of IN O O
the DT O O
hooked JJ O O
function NN O O
. . O O

Doing VBG O O
this DT O O
, , O O
the DT O O
malware NN O O
adds VBZ O O
malicious JJ O O
behavior NN O O
to IN O O
legitimate JJ O O
functions NNS O O
. . O O

The DT O O
main JJ O O
hooked JJ O O
functions NNS O O
are VBP O O
. . O O

The DT O O
Uroburos NNP O O
rootkit NN O O
uses VBZ O O
two CD O O
virtual JJ O O
file NN O O
systems NNS O O
– . O O
one CD O O
NTFS NNP O O
file NN O O
system NN O O
and CC O O
one CD O O
FAT NNP O O
file NN O O
system NN O O
. . O O

They PRP O O
are VBP O O
stored VBN O O
locally RB O O
, , O O
on IN O O
the DT O O
infected VBN O O
machine NN O O
. . O O

This DT O O
means VBZ O O
that IN O O
the DT O O
victim NN O O
's POS O O
computer NN O O
contains VBZ O O
an DT O O
encrypted VBN O O
file NN O O
, , O O
which WDT O O
, , O O
in IN O O
reality NN O O
, , O O
hosts VBZ O O
another DT O O
file NN O O
system NN O O
. . O O

The DT O O
virtual JJ O O
file NN O O
systems NNS O O
are VBP O O
used VBN O O
as IN O O
a DT O O
work NN O O
space NN O O
by IN O O
the DT O O
attackers NNS O O
. . O O

They PRP O O
can MD O O
store VB O O
third JJ O O
party NN O O
tools NNS O O
, , O O
post NN O O
- HYPH O O
exploitation NN O O
tools NNS O O
, , O O
temporary JJ O O
files NNS O O
and CC O O
binary JJ O O
output NN O O
. . O O

The DT O O
virtual JJ O O
file NN O O
systems NNS O O
can MD O O
be VB O O
accessed VBN O O
through IN O O
the DT O O
devices NNS O O
\Device\RawDisk1 NFP O O
and CC O O
\Device\RawDisk2 NFP O O
and CC O O
the DT O O
volume NN O O
\\.\Hd1 NNP O O
and CC O O
\\.\Hd2 NNP O O
. . O O

The DT O O
encryption NN O O
used VBD O O
for IN O O
the DT O O
file NN O O
systems NNS O O
is VBZ O O
CAST-128 NNP O O
1 CD O O
. . O O

The DT O O
respective JJ O O
encryption NN O O
key NN O O
is VBZ O O
hardcoded VBN O O
within IN O O
the DT O O
driver NN O O
file NN O O
. . O O

Once RB O O
decrypted VBN O O
, , O O
the DT O O
virtual JJ O O
file NN O O
system NN O O
is VBZ O O
a DT O O
classic JJ O O
NTFS NNP O O
volume NN O O
, , O O
which WDT O O
can MD O O
be VB O O
simply RB O O
accessed VBN O O
through IN O O
the DT O O
standard JJ O O
Microsoft NNP O O
file NN O O
system NN O O
APIs NNS O O
. . O O

During IN O O
our PRP$ O O
analysis NN O O
, , O O
we PRP O O
identified VBD O O
several JJ O O
files NNS O O
the DT O O
file NN O O
systems NNS O O
contained VBD O O
. . O O

The DT O O
.bat NN O O
scripts NNS O O
contain VBP O O
some DT O O
net JJ O O
use NN O O
commands NNS O O
to TO O O
map VB O O
a DT O O
remote JJ O O
file NN O O
server NN O O
, , O O
netstat JJ O O
commands NNS O O
to TO O O
have VB O O
network NN O O
information NN O O
, , O O
system NN O O
info NN O O
commands VBZ O O
to TO O O
get VB O O
a DT O O
complete JJ O O
view NN O O
of IN O O
the DT O O
system NN O O
configuration NN O O
. . O O

1 CD O O
http://en.wikipedia.org/wiki/CAST-128 ADD O O
Copyright NN O O
2014 CD O O
G NNP O O
Data NNP O O
Software NNP O O
AG NNP O O
6 CD O O
G NNP O O
Data NNP O O
Red NNP O O
Paper NNP O O
February NNP O O
2014 CD O O
: : O O
Uroburos NNP O O
The DT O O
queue NN O O
file NN O O
is VBZ O O
the DT O O
most RBS O O
interesting JJ O O
and CC O O
complex JJ O O
part NN O O
of IN O O
the DT O O
virtual JJ O O
file NN O O
system NN O O
. . O O

Each DT O O
message NN O O
in IN O O
the DT O O
queue NN O O
contains VBZ O O
a DT O O
unique JJ O O
ID NN O O
, , O O
a DT O O
type NN O O
, , O O
a DT O O
timestamp NN O O
and CC O O
content NN O O
. . O O

The DT O O
content NN O O
is VBZ O O
also RB O O
encrypted VBN O O
using VBG O O
the DT O O
CAST-128 NNP O O
algorithm NN O O
and CC O O
the DT O O
respective JJ O O
key NN O O
is VBZ O O
stored VBN O O
in IN O O
a DT O O
message NN O O
, , O O
too RB O O
. . O O

The DT O O
messages NNS O O
can MD O O
contain VB O O
the DT O O
following VBG O O
information NN O O
. . O O

We PRP O O
found VBD O O
classic JJ O O
post NN O O
- HYPH O O
exploitation NN O O
tools NNS O O
, , O O
used VBN O O
by IN O O
a DT O O
lot NN O O
of IN O O
different JJ O O
APT NN O O
actors NNS O O
. . O O

The DT O O
following JJ O O
list NN O O
provides VBZ O O
an DT O O
overview NN O O
of IN O O
the DT O O
tools NNS O O
found VBN O O
in IN O O
the DT O O
virtual JJ O O
file NN O O
system NN O O
. . O O

The DT O O
driver NN O O
injects VBZ O O
several JJ O O
libraries NNS O O
into IN O O
user NN O O
land NN O O
. . O O

These DT O O
libraries NNS O O
are VBP O O
stored VBN O O
in IN O O
encrypted VBN O O
form NN O O
in IN O O
the DT O O
queue NN O O
file NN O O
. . O O

These DT O O
files NNS O O
are VBP O O
used VBN O O
to TO O O
create VB O O
a DT O O
kind NN O O
of IN O O
" `` O O
proxy NN O O
" '' O O
between IN O O
the DT O O
kernel NN O O
land NN O O
and CC O O
the DT O O
user NN O O
land NN O O
. . O O

The DT O O
driver NN O O
injects VBZ O O
two CD O O
noteworthy JJ O O
libraries NNS O O
. . O O

If IN O O
the DT O O
infected JJ O O
system NN O O
is VBZ O O
a DT O O
64-bit CD O O
system NN O O
, , O O
Win32 NNP O O
is VBZ O O
replaced VBN O O
by IN O O
Win64 NNP O O
. . O O

The DT O O
libraries NNS O O
are VBP O O
very RB O O
huge JJ O O
( -LRB- O O
more JJR O O
than IN O O
150 CD O O
functions NNS O O
) -RRB- O O
and CC O O
contain VB O O
a DT O O
lot NN O O
of IN O O
features NNS O O
. . O O

They PRP O O
are VBP O O
able JJ O O
to TO O O
manipulate VB O O
the DT O O
queue NN O O
file NN O O
from IN O O
the DT O O
user NN O O
land NN O O
. . O O

Following VBG O O
, , O O
a DT O O
list NN O O
of IN O O
functions NNS O O
dedicated VBN O O
to IN O O
the DT O O
queue NN O O
management NN O O
( -LRB- O O
qm UH O O
) -RRB- O O
. . O O

The DT O O
libraries NNS O O
have VBP O O
the DT O O
capability NN O O
to TO O O
create VB O O
and CC O O
manage VB O O
a DT O O
pcap NN O O
3 CD O O
capture NN O O
. . O O

The DT O O
purpose NN O O
of IN O O
this DT B-Entity 1
feature NN I-Entity O
is VBZ O O
to TO O O
generate VB B-Action 2
a DT O O
snapshot NN B-Entity 3
of IN I-Entity O
the DT I-Entity O
network NN I-Entity O
traffic NN I-Entity O
. . O O

The DT O O
libraries NNS O O
are VBP O O
furthermore RB O O
used VBN O O
to TO O O
exfiltrate VB O O
data NNS O O
to IN O O
the DT O O
outside JJ O O
world NN O O
, , O O
namely RB O O
the DT O O
attackers NNS O O
. . O O

We PRP O O
identified VBD O O
several JJ O O
protocols NNS O O
to TO O O
perform VB O O
this DT O O
task NN O O
: : O O
generally RB O O
, , O O
the DT O O
configuration NN O O
needed VBN O O
for IN O O
each DT O O
protocol NN O O
is VBZ O O
stored VBN O O
in IN O O
the DT O O
queue NN O O
file NN O O
and CC O O
not RB O O
within IN O O
the DT O O
library NN O O
itself PRP O O
. . O O

 JJ O O
HTTP NNP O O
protocol NN O O
the DT B-Entity 1
attackers NNS I-Entity O
can MD O O
choose VB O O
to IN O O
use NN B-Action 2
a DT O O
website NN B-Entity 3
to IN B-Modifier 4
exfiltrate NN O O
data NNS B-Entity 5
. . O O

The DT O O
rootkit NN O O
supports VBZ O O
GET NNP O O
and CC O O
POST NNP O O
requests NNS O O
and CC O O
proxy NN O O
authentication NN O O
, , O O
too RB O O
. . O O

The DT O O
default NN O O
URI NNP O O
is VBZ O O
http://%s ADD O O
/ SYM O O
default.asp RB O O
but CC O O
it PRP O O
is VBZ O O
configurable JJ O O
. . O O

The DT O O
media NNS O O
type NN O O
of IN O O
the DT O O
request NN O O
is VBZ O O
chosen VBN O O
from IN O O
the DT O O
following JJ O O
list NN O O
. . O O

The DT O O
design NN O O
chosen VBN O O
by IN O O
the DT O O
developers NNS O O
is VBZ O O
truly RB O O
efficient JJ O O
: : O O
to TO O O
add VB O O
a DT O O
new JJ O O
protocol NN O O
and CC O O
a DT O O
new JJ O O
capability NN O O
, , O O
the DT O O
attackers NNS O O
do VBP O O
not RB O O
need VB O O
to TO O O
recompile VB O O
( -LRB- O O
or CC O O
reinstall VB O O
) -RRB- O O
the DT O O
entire JJ O O
rootkit NN O O
. . O O

They PRP O O
simply RB O O
need VBP O O
to TO O O
adjust VB O O
the DT O O
library NN O O
and CC O O
replace VB O O
the DT O O
library NN O O
in IN O O
the DT O O
queue NN O O
file NN O O
with IN O O
the DT O O
adjusted JJ O O
one CD O O
. . O O

The DT O O
library NN O O
usage NN O O
results NNS O O
in IN O O
modularity NN O O
well RB O O
thought VBN O O
out RP O O
. . O O

Thanks NNS O O
to IN O O
the DT O O
protocol NN O O
described VBD O O
previously RB O O
, , O O
the DT O O
attacker NN O O
can MD O O
even RB O O
target VB O O
victims NNS O O
not RB O O
directly RB O O
connected VBN O O
to IN O O
the DT O O
Internet NN O O
. . O O

The DT O O
following JJ O O
figure NN O O
shows VBZ O O
an DT O O
example NN O O
of IN O O
a DT O O
network NN O O
scheme NN O O
we PRP O O
discovered VBD O O
in IN O O
2013 CD O O
. . O O

The DT O O
targeted VBN O O
machine NN O O
( -LRB- O O
A NNP O O
) -RRB- O O
is VBZ O O
a DT O O
machine NN O O
with IN O O
access NN O O
to IN O O
sensitive JJ O O
data NNS O O
, , O O
e.g. RB O O

a DT O O
server NN O O
. . O O

The DT O O
rootkit NN O O
installed VBD O O
on IN O O
the DT O O
system NN O O
opens VBZ O O
a DT O O
Microsoft NNP O O
named VBN O O
pipe NN O O
and CC O O
waits NNS O O
for IN O O
an DT O O
incoming JJ O O
connection NN O O
. . O O

This DT O O
machine NN O O
can MD O O
be VB O O
named VBN O O
" `` O O
spied VBN O O
- HYPH O O
on RP O O
node NN O O
" '' O O
. . O O

The DT O O
second JJ O O
machine NN O O
( -LRB- O O
B NNP O O
) -RRB- O O
is VBZ O O
an DT O O
office NN O O
machine NN O O
with IN O O
the DT O O
capability NN O O
to TO O O
connect VB O O
to IN O O
the DT O O
Internet NN O O
. . O O

The DT O O
rootkit NN O O
is VBZ O O
configured VBN O O
to TO O O
connect VB O O
to IN O O
system NN O O
( -LRB- O O
A NNP O O
) -RRB- O O
, , O O
with IN O O
the DT O O
help NN O O
of IN O O
the DT O O
named VBN O O
pipe NN O O
, , O O
and CC O O
administrate VB O O
the DT O O
machine NN O O
remotely RB O O
. . O O

Finally RB O O
, , O O
machine NN B-Entity 1
( -LRB- I-Entity O
B NNP I-Entity O
) -RRB- I-Entity O
is VBZ O O
able JJ O O
to TO O O
pass VB B-Action 2
on IN I-Action O
all DT O O
data NNS B-Entity 3
received VBD I-Entity O
from IN I-Entity O
machine NN I-Entity O
( -LRB- I-Entity O
A NNP I-Entity O
) -RRB- I-Entity O
to IN B-Modifier 4
the DT O O
Internet NN B-Entity 5
. . O O

This DT O O
machine NN O O
( -LRB- O O
B NNP O O
) -RRB- O O
could MD O O
be VB O O
named VBN O O
" `` O O
proxy NN O O
node NN O O
" '' O O
. . O O

This DT O O
peer NN O O
- HYPH O O
to IN O O
- HYPH O O
peer NN O O
design NN O O
is VBZ O O
really RB O O
efficient JJ O O
, , O O
scalable JJ O O
and CC O O
resilient JJ O O
. . O O

In IN O O
case NN O O
a DT O O
" `` O O
proxy NN O O
node NN O O
" '' O O
is VBZ O O
not RB O O
available JJ O O
/ SYM O O
detected VBD O O
, , O O
the DT O O
attackers NNS O O
can MD O O
use VB O O
another DT O O
infected VBN O O
one NN O O
. . O O

The DT O O
advantage NN O O
for IN O O
the DT O O
attackers NNS O O
: : O O
even RB O O
if IN O O
a DT O O
security NN O O
specialist NN O O
finds VBZ O O
one CD O O
" `` O O
spied VBN O O
- HYPH O O
on RP O O
node NN O O
" '' O O
, , O O
he PRP O O
can MD O O
not RB O O
easily RB O O
find VB O O
the DT O O
" `` O O
proxy NN O O
node NN O O
" '' O O
, , O O
due IN O O
to IN O O
the DT O O
fact NN O O
that IN O O
this DT O O
node NN O O
is VBZ O O
a DT O O
passive JJ O O
node NN O O
. . O O

Furthermore RB O O
, , O O
the DT O O
analyst NN O O
does VBZ O O
not RB O O
automatically RB O O
have VB O O
the DT O O
command NN O O
and CC O O
control NN O O
URL NNP O O
. . O O

In IN O O
case NN O O
of IN O O
incident NN O O
response NN O O
, , O O
this DT O O
design NN O O
is VBZ O O
complicated VBN O O
to TO O O
apprehend VB O O
and CC O O
it PRP O O
is VBZ O O
hard JJ O O
to TO O O
contain VB O O
the DT O O
infection NN O O
. . O O

Due IN O O
to IN O O
the DT O O
complexity NN O O
of IN O O
the DT O O
Uroburos NNP O O
rootkit NN O O
, , O O
we PRP O O
estimate VBP O O
that IN O O
it PRP O O
was VBD O O
designed VBN O O
to TO O O
target VB O O
government NN O O
institutions NNS O O
, , O O
research NN O O
institutions NNS O O
or CC O O
companies NNS O O
dealing VBG O O
with IN O O
sensitive JJ O O
information NN O O
as RB O O
well RB O O
as IN O O
similar JJ O O
high JJ O O
- HYPH O O
profile NN O O
targets NNS O O
. . O O

Concerning VBG O O
the DT O O
attribution NN O O
, , O O
we PRP O O
found VBD O O
some DT O O
technical JJ O O
information NN O O
which WDT O O
allows VBZ O O
us PRP O O
to TO O O
link VB O O
the DT O O
Uroburos NNP O O
rootkit NN O O
to IN O O
a DT O O
cyber NN O O
- HYPH O O
attack NN O O
against IN O O
the DT O O
United NNP O O
States NNP O O
of IN O O
America NNP O O
, , O O
carried VBD O O
out RP O O
in IN O O
2008 CD O O
4 CD O O
and CC O O
, , O O
particularly RB O O
, , O O
to IN O O
the DT O O
worm NN O O
used VBN O O
by IN O O
the DT O O
attackers NNS O O
, , O O
called VBN O O
Agent NNP O O
. . O O
BTZ NN O O
. . O O

During IN O O
this DT O O
2008 CD O O
campaign NN O O
, , O O
a DT O O
USB NN O O
stick NN O O
was VBD O O
deliberately RB O O
" `` O O
lost VBN O O
" '' O O
in IN O O
the DT O O
parking NN O O
lot NN O O
of IN O O
the DT O O
United NNP O O
States NNP O O
Department NNP O O
of IN O O
Defense NNP O O
. . O O

This DT O O
USB NN O O
stick NN O O
contained VBD O O
malicious JJ O O
code NN O O
and CC O O
infected VBD O O
the DT O O
military NN O O
's POS O O
network NN O O
. . O O

The DT O O
following VBG O O
leads VBZ O O
make VB O O
us PRP O O
link VB O O
what WP O O
we PRP O O
discovered VBD O O
during IN O O
our PRP$ O O
analysis NN O O
with IN O O
the DT O O
cyber NN O O
- HYPH O O
attack NN O O
carried VBN O O
out RP O O
in IN O O
2008 CD O O
. . O O

In IN O O
an DT O O
article NN O O
published VBN O O
by IN O O
Reuters NNP O O
, , O O
in IN O O
2011 CD O O
, , O O
the DT O O
journalist NN O O
mentioned VBD O O
that IN O O
" `` O O
U.S. NNP O O

government NN O O
strongly RB O O
suspects VBZ O O
that IN O O
the DT O O
original JJ O O
attack NN O O
was VBD O O
crafted VBN O O
by IN O O
Russian NNP O O
Intelligence NNP O O
. . O O
" '' O O
5 CD O O
We PRP O O
found VBD O O
Uroburos NNP O O
samples NNS O O
with IN O O
a DT O O
resource NN O O
in IN O O
Russian JJ O O
language NN O O
. . O O

In IN O O
case NN O O
someone NN O O
from IN O O
the DT O O
audience NN O O
of IN O O
this DT O O
report NN O O
notices VBZ O O
an DT O O
infection NN O O
caused VBN O O
by IN O O
the DT O O
Uroburos NNP O O
rootkit NN O O
and CC O O
needs VBZ O O
help NN O O
, , O O
would MD O O
like VB O O
to TO O O
receive VB O O
further JJ O O
technical JJ O O
information NN O O
or CC O O
would MD O O
like VB O O
to TO O O
contribute VB O O
any DT O O
information NN O O
about IN O O
this DT O O
case NN O O
, , O O
please UH O O
feel VB O O
free JJ O O
to TO O O
contact VB O O
us PRP O O
by IN O O
email NN O O
using VBG O O
the DT O O
following VBG O O
mailbox NN O O
: : O O
intelligence@gdata.de ADD O O
The DT O O
Uroburos NNP O O
rootkit NN O O
is VBZ O O
one CD O O
of IN O O
the DT O O
most RBS O O
advanced JJ O O
rootkits NNS O O
we PRP O O
have VBP O O
ever RB O O
analyzed VBN O O
. . O O

The DT O O
oldest JJS O O
driver NN O O
we PRP O O
identified VBD O O
was VBD O O
compiled VBN O O
in IN O O
2011 CD O O
, , O O
which WDT O O
means VBZ O O
that IN O O
the DT O O
campaign NN O O
remained VBD O O
undiscovered JJ O O
for IN O O
at RB O O
least RBS O O
three CD O O
years NNS O O
. . O O

The DT O O
investment NN O O
to TO O O
develop VB O O
a DT O O
complete JJ O O
framework NN O O
such JJ O O
as IN O O
Uroburos NNP O O
is VBZ O O
extremely RB O O
high JJ O O
. . O O

The DT O O
developer NN O O
team NN O O
behind IN O O
the DT O O
development NN O O
and CC O O
the DT O O
design NN O O
of IN O O
such PDT O O
an DT O O
enhanced JJ O O
framework NN O O
is VBZ O O
really RB O O
skilled JJ O O
. . O O

We PRP O O
believe VBP O O
that IN O O
, , O O
until IN O O
today NN O O
, , O O
the DT O O
team NN O O
behind IN O O
Uroburos NNP O O
has VBZ O O
developed VBN O O
an DT O O
even RB O O
more RBR O O
sophisticated JJ O O
framework NN O O
, , O O
which WDT O O
still RB O O
remains VBZ O O
undiscovered JJ O O
. . O O

The DT O O
design NN O O
is VBZ O O
highly RB O O
professional JJ O O
; : O O
the DT O O
fact NN O O
the DT O O
attackers NNS O O
use VBP O O
a DT O O
driver NN O O
and CC O O
a DT O O
virtual JJ O O
file NN O O
system NN O O
in IN O O
two CD O O
separate JJ O O
files NNS O O
which WDT O O
can MD O O
only RB O O
work VB O O
in IN O O
combination NN O O
, , O O
makes VBZ O O
the DT O O
analysis NN O O
really RB O O
complicated VBD O O
. . O O

One PRP O O
needs VBZ O O
to TO O O
have VB O O
the DT O O
two CD O O
components NNS O O
to TO O O
correctly RB O O
analyze VB O O
the DT O O
framework NN O O
. . O O

The DT O O
driver NN O O
contains VBZ O O
all DT O O
of IN O O
the DT O O
necessary JJ O O
functionality NN O O
and CC O O
the DT O O
file NN O O
system NN O O
alone RB O O
simply RB O O
can MD O O
not RB O O
be VB O O
decrypted VBN O O
. . O O

The DT O O
network NN O O
design NN O O
is VBZ O O
extraordinarily RB O O
efficient JJ O O
, , O O
too RB O O
; : O O
for IN O O
an DT O O
incident NN O O
response NN O O
team NN O O
, , O O
it PRP O O
is VBZ O O
always RB O O
complicated JJ O O
to TO O O
deal VB O O
with IN O O
peer NN O O
- HYPH O O
to IN O O
- HYPH O O
peer NN O O
infrastructure NN O O
. . O O

It PRP O O
is VBZ O O
also RB O O
hard JJ O O
to TO O O
handle VB O O
passive JJ O O
nodes NNS O O
, , O O
because IN O O
one PRP O O
can MD O O
not RB O O
quickly RB O O
identify VB O O
the DT O O
link NN O O
between IN O O
the DT O O
different JJ O O
infected JJ O O
machines NNS O O
. . O O

This DT O O
kind NN O O
of IN O O
data NNS O O
stealing VBG O O
software NN O O
is VBZ O O
too RB O O
expensive JJ O O
to TO O O
be VB O O
used VBN O O
as IN O O
common JJ O O
spyware NN O O
. . O O

We PRP O O
assume VBP O O
that IN O O
the DT O O
attackers NNS O O
reserve VBP O O
the DT O O
Uroburos NNP O O
framework NN O O
for IN O O
dedicated JJ O O
and CC O O
critical JJ O O
targets NNS O O
. . O O

This DT O O
is VBZ O O
the DT O O
main JJ O O
reason NN O O
why WRB O O
the DT O O
rootkit NN O O
was VBD O O
only RB O O
detected VBN O O
many JJ O O
years NNS O O
after IN O O
the DT O O
suspected VBN O O
first JJ O O
infection NN O O
. . O O

Furthermore RB O O
, , O O
we PRP O O
assume VBP O O
that IN O O
the DT O O
framework NN O O
is VBZ O O
designed VBN O O
to TO O O
perform VB O O
cyber JJ O O
espionage NN O O
within IN O O
governments NNS O O
and CC O O
high JJ O O
profile NN O O
enterprises NNS O O
but CC O O
, , O O
due IN O O
to IN O O
its PRP$ O O
modularity NN O O
, , O O
it PRP O O
can MD O O
be VB O O
easily RB O O
extended VBN O O
to TO O O
gain VB O O
new JJ O O
features NNS O O
and CC O O
perform VB O O
further JJ O O
attacks NNS O O
as RB O O
long RB O O
as IN O O
it PRP O O
remains VBZ O O
undetected JJ O O
within IN O O
its PRP$ O O
target NN O O
. . O O

There EX O O
are VBP O O
some DT O O
strong JJ O O
indications NNS O O
which WDT O O
suggest VBP O O
that IN O O
the DT O O
group NN O O
behind IN O O
Uroburos NNP O O
is VBZ O O
the DT O O
same JJ O O
as IN O O
the DT O O
one NN O O
behind IN O O
Agent NNP O O
. . O O
BTZ NNP O O
, , O O
which WDT O O
allegedly RB O O
was VBD O O
part NN O O
of IN O O
an DT O O
intelligence NN O O
agency NN O O
cyberattack NN O O
targeting VBG O O
US NNP O O
military JJ O O
bases NNS O O
in IN O O
2008 CD O O
. . O O

Notable JJ O O
hints NNS O O
include VBP O O
the DT O O
usage NN O O
of IN O O
the DT O O
exact JJ O O
same JJ O O
encryption NN O O
key NN O O
then RB O O
and CC O O
now RB O O
, , O O
as RB O O
well RB O O
as IN O O
the DT O O
presence NN O O
of IN O O
Russian JJ O O
language NN O O
in IN O O
both DT O O
cases NNS O O
. . O O

SHA256 NN O O
: : O O
BF1CFC65B78F5222D35DC3BD2F0A87C9798BCE5A48348649DD271CE395656341 ADD O O
MD5 NN O O
: : O O
320F4E6EE421C1616BD058E73CFEA282 CD O O
Filesize NNP O O
: : O O
210944 CD O O
For IN O O
further JJ O O
information NN O O
contact NN O O
intelligence@gdata.de ADD O O

