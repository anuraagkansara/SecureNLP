Hereby O
Group O
- O
IB O
and O
Fox O
- O
IT O
inform O
that O
: O
This O
report O
describes O
the O
details O
and O
type O
of O
op- O
erations O
carried O
out O
by O
an O
organized O
criminal O
group O
that O
focuses O
on O
financial O
industry O
, O
such O
as O
banks O
and O
payment O
providers O
, O
retail O
industry O
and O
news O
, O
media O
and O
PR O
companies O
. O
 
The O
group O
has O
its O
origin O
in O
more O
common O
financial O
fraud O
including O
theft O
from O
con- O
sumer O
and O
corporate O
bank O
accounts O
in O
Europe O
and O
Russia O
, O
using O
standard O
banking O
malware O
, O
mainly O
Carberp O
. O
 
After O
the O
arrests O
of O
Carberp O
group O
members O
in O
Russia O
, O
some O
of O
the O
members O
were O
out O
of O
work O
, O
however O
, O
their O
experience O
gained O
from O
many O
years O
of O
crime O
has O
allowed O
them O
to O
enter O
a O
new O
niche O
. O
 
One O
of O
the O
members O
quickly O
realized O
that O
they O
can O
steal O
$ O
2000 O
a O
thousand O
times O
, O
and O
earn O
$ O
2 O
million O
, O
but O
also O
they O
can O
steal O
it O
in O
one O
time O
and O
immediately O
get O
it O
with O
much O
less O
effort O
. O
 
The O
anti O
- O
fraud O
measures O
employed O
by O
banks O
has O
pushed O
the O
criminals O
to O
search O
for O
new O
ways O
to O
make O
money O
with O
less O
bar- O
riers O
, O
compromising O
and O
modifying O
or O
taking O
data O
from O
banks O
, O
payment O
providers O
, O
retail O
and O
media/ O
PR O
companies O
are O
some O
of O
these O
methods O
. O
 
From O
2013 O
an O
organized O
criminal O
group O
intensi- O
fied O
its O
activity O
focused O
on O
banks O
and O
electronic O
pay- O
ment O
systems O
in O
Russia O
and O
in O
the O
post O
- O
Soviet O
space O
. O
 
The O
key O
is O
that O
fraud O
occurs O
within O
the O
corporate O
network O
using O
internal O
payment O
gateways O
and O
in- O
ternal O
banking O
systems O
. O
 
Thus O
money O
is O
stolen O
from O
the O
banks O
and O
payment O
systems O
, O
and O
not O
from O
their O
customers O
. O
 
While O
this O
is O
their O
main O
and O
most O
lucra- O
tive O
activity O
, O
the O
gang O
has O
also O
ventured O
into O
other O
areas O
including O
the O
compromise O
of O
media O
groups O
and O
other O
organizations O
for O
industrial O
espionage O
and O
likely O
a O
trading O
advantage O
on O
the O
stock O
market O
. O
 
In O
cases O
where O
the O
group O
got O
access O
to O
the O
government O
agency O
networks O
their O
aim O
was O
espionage O
related O
. O
 
The O
organized O
criminal O
group O
backbone O
are O
citizens O
of O
both O
Russian O
and O
Ukrainian O
origin O
, O
but O
the O
group O
also O
sources O
a O
number O
of O
mainstream O
and O
specialized O
services O
from O
individuals O
and O
groups O
originating O
from O
Russia O
, O
Ukraine O
and O
Belarus O
. O
 
The O
average O
sum O
of O
theft O
in O
the O
Russian O
terri- O
tory O
and O
in O
the O
post O
- O
Soviet O
space O
is O
$ O
2 O
million O
per O
incident O
. O
 
Since O
2013 O
they O
have O
successfully O
gained O
access O
to O
networks O
of O
more O
than O
50 O
Russian O
banks O
and O
5 O
payment O
systems O
, O
and O
2 O
of O
these O
institutions O
were O
deprived O
of O
their O
banking O
license O
. O
 
To O
date O
the O
total O
amount O
of O
theft O
is O
over O
1 O
billion O
rubles O
( O
about O
25 O
million O
dollars O
) O
, O
most O
of O
it O
has O
been O
stolen O
in O
the O
second O
half O
of O
2014 O
. O
 
The O
average O
time O
from O
the O
moment O
of O
penetration O
into O
the O
financial O
institutions O
internal O
network O
till O
successful O
theft O
is O
42 O
days O
. O
 
As O
a O
result O
of O
access O
to O
internal O
bank O
networks O
the O
attackers O
also O
managed O
to O
gain O
access O
to O
ATM O
management O
infrastructure O
and O
infect O
those O
sys- O
tems O
with O
their O
own O
malicious O
software O
that O
further O
allows O
theft O
from O
the O
banks O
ATM O
systems O
on O
the O
attackers O
command O
. O
 
Since O
2014 O
the O
organized O
criminal O
group O
mem- O
bers O
began O
actively O
taking O
an O
interest O
in O
US O
and O
Eu- O
ropean O
based O
retail O
organizations O
. O
 
While O
they O
were O
already O
familiar O
with O
POS O
malware O
and O
compromis- O
ing O
POS O
terminals O
, O
the O
widespread O
media O
attention O
around O
the O
Target O
breach O
and O
other O
related O
breaches O
were O
the O
reason O
for O
this O
move O
. O
 
While O
the O
scale O
of O
breaches O
in O
this O
industry O
is O
still O
relatively O
low O
, O
with O
at O
least O
3 O
successful O
card O
breaches O
and O
over O
a O
dozen O
retailers O
compromised O
this O
activity O
is O
quickly O
becom- O
ing O
a O
lucrative O
endeavor O
for O
this O
group O
. O
 
To O
penetrate O
into O
the O
internal O
networks O
this O
organized O
criminal O
group O
employs O
targeted O
emailing O
( O
spear O
phishing O
) O
and O
infections O
sources O
from O
other O
botnets O
. O
 
This O
is O
the O
main O
reason O
why O
the O
group O
is O
keeping O
in O
touch O
with O
owners O
of O
large O
botnets O
. O
 
Since O
August O
2014 O
the O
group O
began O
to O
create O
their O
own O
large O
botnet O
using O
a O
mass O
emailing O
, O
but O
not O
using O
typical O
exploit O
driveby O
infections O
. O
 
This O
last O
move O
is O
likely O
to O
reduce O
the O
need O
for O
external O
contacts O
. O
 
The O
first O
successful O
bank O
robbery O
was O
committed O
by O
this O
group O
in O
January O
2013 O
. O
 
In O
all O
first O
cases O
the O
attackers O
used O
the O
program O
RDPdoor O
for O
remote O
access O
to O
the O
bank O
network O
and O
the B-Entity
program I-Entity
" I-Entity
MBR I-Entity
Eraser I-Entity
" I-Entity
to O
remove B-Action
traces B-Entity
and O
to B-Action
crack I-Action
Windows O
computers B-Entity
and O
servers B-Entity
. O
 
Both O
programs O
were O
used O
by O
the O
members O
of O
the O
Carberp O
criminal O
group O
under O
the O
guidance O
of O
a O
person O
named O
Germes O
. O
 
To O
reduce O
the O
risk O
of O
losing O
access O
to O
the O
internal O
bank O
network O
the O
attackers O
, O
in O
addition O
to O
malicious O
programs O
, O
were O
also O
used O
for O
remote O
access O
legitimate O
pro- O
grams O
such O
as O
Ammy O
Admin O
and O
Team O
Viewer O
. O
 
Lat- O
er O
the O
attackers O
completely O
abandoned O
from O
usage O
of O
RDPdoor O
and O
Team O
Viewer O
. O
 
In O
addition O
to O
banking O
and O
payment O
systems O
, O
hackers B-Entity
got B-Action
access B-Entity
to B-Modifier
e O
- B-Entity
mail I-Entity
servers I-Entity
to O
control B-Action
all O
internal B-Entity
communications I-Entity
. O
 
This O
approach O
allowed O
them O
to O
find O
out O
that O
the O
anomalous O
activity O
in O
the O
bank O
network O
was O
identified O
, O
what O
technique O
was O
used O
to O
identify O
this O
activity O
and O
what O
measures O
the O
bank O
employees O
took O
to O
solve O
the O
problem O
. O
 
Email O
control O
was O
successfully O
installed O
regardless O
of O
used O
email O
system O
, O
MS O
Exchange O
or O
Lotus O
. O
 
This O
approach O
allowed O
them O
to O
take O
countermeasures O
that O
created O
for O
bank O
and O
payment O
system O
employees O
the O
feeling O
that O
the O
problem O
had O
been O
solved O
. O
 
The O
main O
steps O
of O
the O
attack O
progression O
are O
the O
following O
ones O
: O
To O
carry O
out O
target O
attacks O
in O
2014 O
the O
hackers O
have O
finalized O
development O
of O
their O
core O
malware O
Anunak O
that O
is O
used O
along O
with O
the O
following O
tools O
. O
 
According O
to O
our O
laboratory O
classification O
the O
main O
malware O
is O
" O
Anunak O
" O
. O
 
This O
trojan O
is O
used O
for O
target O
attacks O
only O
, O
mainly O
on O
banks O
and O
payment O
systems O
. O
 
Target O
usage O
of O
this O
program O
allows O
it O
to O
remain O
poorly O
explored O
, O
providing O
it O
a O
good O
surviv- O
ability O
inside O
corporate O
networks O
. O
 
The O
source O
code O
of O
the O
bank O
trojan O
program O
Carberp O
was O
used O
in O
some O
places O
of O
this O
malware O
. O
 
" O
Anunak O
" O
has O
the O
following O
feature O
set O
. O
 
There O
is O
the O
ability O
to O
download B-Action
arbitrary O
exe- B-Entity
cutable I-Entity
files I-Entity
from I-Entity
the I-Entity
management I-Entity
server I-Entity
and O
run B-Action
them B-Entity
. O
 
One O
of O
these O
files O
is O
the O
program O
" O
AmmyAd- O
min O
" O
that O
may O
be O
run O
with O
the O
arguments O
" O
-service O
" O
and O
" O
-nogui O
" O
that O
force O
it O
to O
start O
as O
a O
service O
without O
user O
interface O
. O
 
" O
AmmyAdmin O
" O
allows O
to O
connect O
with O
another O
computer O
that O
has O
the O
same O
software O
through O
the O
server O
" O
rl.ammyy.com O
" O
using O
the O
IP O
address O
and O
the O
unique O
identifier O
. O
 
As O
a O
result O
, O
the B-Entity
attacker I-Entity
gets B-Action
remote O
access B-Entity
to B-Modifier
the O
user B-Entity
computer I-Entity
with O
the O
running O
program O
" O
AmmyAdmin O
" O
bypassing O
firewalls O
. O
 
The O
window O
screenshot O
is O
shown O
in O
the O
figure O
below O
. O
 
When O
the B-Entity
attackers I-Entity
gain O
access O
to O
servers O
running O
operating O
systems O
of O
the O
Linux O
family O
they O
use B-Action
SSH O
backdoor B-Entity
that O
transmits B-Action
to B-Modifier
the O
malicious B-Entity
server I-Entity
the O
login B-Entity
/ I-Entity
password I-Entity
data I-Entity
used I-Entity
to I-Entity
access I-Entity
the I-Entity
servers I-Entity
and O
provides B-Action
attackers B-Entity
remote O
access B-Entity
to I-Entity
the I-Entity
servers I-Entity
. O
 
To O
provide O
access O
to O
the O
server O
of O
interest O
the B-Entity
at- I-Entity
tackers I-Entity
may O
appropriately O
modify B-Action
rules O
for B-Entity
firewalls I-Entity
Microsoft I-Entity
TMG I-Entity
, I-Entity
CISCO I-Entity
, I-Entity
etc I-Entity
. O
 
When O
the O
attackers O
yet O
had O
no O
major O
malware O
that O
would O
secretly O
install O
the O
program O
" O
AmmyAd- O
min O
" O
and O
report O
to O
the O
attackers O
a O
remote O
access O
password O
, O
they O
used O
a O
malicious O
program O
known O
as O
" O
Barus O
" O
. O
 
This O
malware O
is O
used O
rarely O
and O
the O
last O
time O
we O
met O
it O
in O
2013 O
. O
 
This O
malicious O
program O
is O
developed O
by O
Russian O
- O
speaking O
authors O
. O
 
In O
the O
control O
panel O
you O
can O
notice O
a O
field O
" O
Ammy O
ID O
" O
, O
its O
usage O
allowed O
the O
attackers O
to O
connect O
remotely O
. O
 
At O
the O
very O
beginning O
of O
their O
activity O
in O
2013 O
due O
to O
lack O
of O
the O
target O
Trojan O
the O
attackers O
began O
to O
distribute O
Andromeda O
and O
Pony O
. O
 
They O
distributed O
these O
malware O
using O
Driveby O
through O
a O
bunch O
of O
Neutrino O
Exploit O
Kit O
exploits O
as O
shown O
in O
the O
figure O
below O
. O
 
It O
is O
interesting O
that O
in O
the O
autumn O
2013 O
they O
used O
the O
site O
http://php.net/ O
as O
traffic O
source O
to O
Magnitude O
EK O
. O
 
They O
redirected O
the O
traffic O
from O
this O
resource O
since O
July O
2013 O
, O
but O
this O
fact O
was O
discov- O
ered O
much O
later O
. O
 
The O
name O
of O
one O
of O
the O
streams O
to O
distribute O
the O
malware O
is O
" O
LOL O
BANK O
FUCKIUNG O
" O
that O
corresponded O
to O
the O
attacker O
activities O
. O
 
Parallel O
to O
this O
technique O
they O
also O
use O
another O
infection O
method O
, O
which O
was O
one O
of O
the O
principal O
methods O
. O
 
The O
main O
method O
of O
distribution O
is O
send- O
ing O
emails O
with O
malicious O
attachments O
on O
behalf O
of O
the O
Central O
Bank O
of O
the O
Russian O
Federation O
, O
a O
poten- O
tial O
client O
or O
an O
real O
counterparty O
( O
at O
first O
the O
attack- O
ers O
had O
cracked O
this O
counterparty O
account O
, O
then O
they O
used O
emailing O
with O
the O
cracked O
contact O
list O
) O
. O
 
Another O
used O
method O
is O
to O
install O
a O
special O
malware O
to O
carry O
out O
targeted O
attacks O
via O
another O
malware O
that O
might O
appear O
in O
the O
local O
network O
by O
accident O
. O
 
To O
find O
such O
malicious O
programs O
the O
criminal O
group O
keeps O
in O
touch O
with O
several O
owners O
of O
large O
botnets O
that O
massively O
distributes O
their O
mal- O
ware O
. O
 
The O
attackers O
buy O
from O
these O
botnet O
owners O
the O
information O
about O
IP O
- O
addresses O
of O
computers O
where O
the O
botnet O
owners O
have O
installed O
malware O
and O
then O
check O
whether O
the O
IP O
- O
address O
belongs O
to O
the O
financial O
and O
government O
institutions O
. O
 
If O
the O
mal- O
ware O
is O
in O
the O
subnet O
of O
interest O
, O
the O
attackers O
pay O
the O
large O
botnet O
owner O
for O
installation O
of O
their O
target O
malware O
. O
 
Such O
partner O
relations O
were O
established O
with O
owners O
of O
botnets O
Zeus O
, O
Shiz O
Ranbyus O
. O
 
All O
of O
these O
trojans O
are O
bank O
Trojans O
, O
their O
usage O
is O
ex- O
plained O
by O
the O
previously O
established O
relationships O
. O
 
In O
late O
2013 O
the O
hacker O
under O
the O
alias O
Dinhold O
be- O
gan O
to O
build O
his O
own O
botnet O
using O
modified O
Carberp O
, O
having O
uploaded O
its O
source O
code O
for O
public O
access O
. O
 
The O
attackers O
were O
trying O
to O
create O
similar O
relations O
with O
this O
hacker O
, O
but O
in O
2014 O
he O
was O
arrested O
, O
having O
not O
developed O
his O
botnet O
up O
to O
the O
required O
level O
. O
 
To O
check O
whether O
the O
IP O
- O
address O
belongs O
to O
the O
desired O
network O
the O
following O
script O
is O
used O
. O
 
The O
most O
dangerous O
emailings O
are O
those O
that O
are O
sent O
on O
behalf O
of O
partners O
with O
whom O
financial O
and O
government O
institutions O
communicates O
permanently O
by O
email O
. O
 
An O
example O
of O
such O
emailing O
occurred O
on O
Septem- O
ber O
25 O
, O
2014 O
, O
at O
14:11 O
, O
from O
the O
e O
- O
mail O
address O
" O
Elina O
Shchekina O
< O
e.shekina@rbkmoney.com O
> O
" O
with O
the O
subject O
" O
Updated O
agree- O
ment O
version O
" O
. O
 
The O
attachment O
" O
agreement.doc O
" O
exploits O
the O
vul- O
nerability O
CVE-2012 O
- O
2539 O
and O
CVE-2012 O
- O
0158 O
. O
 
The O
emailing O
was O
conducted O
for O
more O
than O
70 O
addresses O
of O
various O
compa- O
nies O
( O
where O
multiple O
recipient O
addresses O
may O
be O
within O
one O
company O
) O
. O
 
The O
letter O
with O
malicious O
attachment O
( O
md5 O
: O
AA36BA9F- O
4DE5892F1DD427B7B2100B06 O
) O
in O
the O
archive O
with O
a O
password O
from O
a O
potential O
client O
was O
sent O
to O
a O
bank O
manager O
after O
a O
pre- O
liminary O
telephone O
conversation O
with O
him O
. O
 
The O
call O
origin O
is O
Saint O
Petersburg O
. O
 
Contents O
of O
a O
text O
file O
named O
" O
реквизиты.doc O
" O
( O
partner O
de- O
tais.doc O
) O
" O
Company O
Our O
Century O
" O
, O
Ltd. O
 
109387 O
, O
Russia O
, O
Moscow O
, O
Anosov O
str O
. O
, O
24 O
, O
office O
409 O
Tel O
. O
 
( O
495 O
) O
124 O
- O
99 O
- O
77 O
Fax O
: O
( O
495)124 O
- O
99 O
- O
77 O
Mobile O
( O
962 O
) O
7135296 O
E O
- O
mail O
: O
x60x@nxt O
. O
 
ru O
INN O
7329001307 O
KPP O
732901001 O
Account O
40702810613310001709 O
Branch O
of O
VTB O
24 O
( O
JSC O
) O
, O
Moscow O
Correspondent O
account O
30101810700000000955 O
BIC O
043602955 O
A O
letter O
on O
behalf O
of O
the O
Central O
Bank O
of O
Russia O
with O
a O
malicious O
attachment O
( O
md5 O
: O
8FA296EFAF87FF4D- O
9179283D42372C52 O
) O
exploited O
the O
vulnerability O
CVE-2012- O
2539 O
in O
order O
to O
execute O
arbi- O
trary O
code O
. O
 
There O
were O
also O
other O
exam- O
ples O
of O
emails O
with O
malicious O
attachments O
, O
such O
as O
emailing O
with O
the O
file O
" O
001 O
. O
 
photo.exe O
" O
. O
 
A O
more O
detailed O
list O
of O
such O
attachments O
you O
can O
see O
in O
the O
Table O
" O
Email O
attachments O
" O
. O
 
Availability O
of O
access O
to O
bank O
internal O
networks O
opens O
great O
opportunities O
for O
the O
hackers O
. O
 
One O
of O
these O
opportunities O
is O
access O
to O
ATMs O
from O
spe- O
cial O
network O
segments O
that O
had O
to O
be O
isolated O
. O
 
It O
is O
confirmed O
that O
this O
criminal O
group O
gained O
access O
to O
52 O
ATMs O
. O
 
The O
amount O
of O
damage O
exceeds O
50 O
million O
rubles O
. O
 
As O
a O
result O
of O
access O
to O
ATMs O
, O
depending O
on O
the O
ATM O
model O
, O
hackers O
used O
different O
patterns O
. O
 
Having O
access O
, O
the B-Entity
attackers I-Entity
downloaded B-Action
mali- O
cious B-Entity
scripts I-Entity
and I-Entity
changed I-Entity
denominations I-Entity
of I-Entity
issued I-Entity
banknotes I-Entity
in I-Entity
the I-Entity
ATM I-Entity
operating I-Entity
system I-Entity
registry I-Entity
. O
 
As O
a O
result O
, O
for O
query O
to O
get O
10 O
notes O
with O
denomination O
of O
100 O
roubles O
the O
attackers O
received O
10 O
banknotes O
with O
denomination O
of O
5,000 O
roubles O
. O
 
The O
used O
malicious O
script O
and O
program O
were O
developed O
for O
the O
platform O
Wincor O
. O
 
The O
malicious O
script O
contains O
the O
following O
commands O
. O
 
Contents O
of O
the O
file O
" O
1.bat O
" O
REG O
ADD O
" O
HKEY_LOCAL_MACHINE\SOFTWARE\ O
Wincor O
Nixdorf\ProTopas\CurrentVersion\LYNX- O
PAR\CASH_DISPENSER O
" O
/v O
VALUE_1 O
/t O
REG_SZ O
/d O
" O
5000 O
" O
/f O
REG O
ADD O
" O
HKEY_LOCAL_MACHINE\SOFTWARE\ O
Wincor O
Nixdorf\ProTopas\CurrentVersion\LYNX- O
PAR\CASH_DISPENSER O
" O
/v O
VALUE_2 O
/t O
REG_SZ O
/d O
" O
1000 O
" O
/f O
REG O
ADD O
" O
HKEY_LOCAL_MACHINE\SOFTWARE\ O
Wincor O
Nixdorf\ProTopas\CurrentVersion\LYNX- O
PAR\CASH_DISPENSER O
" O
/v O
VALUE_3 O
/t O
REG_SZ O
/d O
" O
500 O
" O
/f O
REG O
ADD O
" O
HKEY_LOCAL_MACHINE\SOFTWARE\ O
Wincor O
Nixdorf\ProTopas\CurrentVersion\LYNX- O
PAR\CASH_DISPENSER O
" O
/v O
VALUE_4 O
/t O
REG_SZ O
/d O
" O
100 O
" O
/f O
REG O
ADD O
" O
HKEY_LOCAL_MACHINE\SOFTWARE\ O
Wincor O
Nixdorf\ProTopas\CurrentVersion\LYNX- O
PAR\CASH_DISPENSER O
" O
/v O
VALUE_1 O
/t O
REG_SZ O
/d O
" O
100 O
" O
/f O
REG O
ADD O
" O
HKEY_LOCAL_MACHINE\SOFTWARE\ O
Wincor O
Nixdorf\ProTopas\CurrentVersion\LYNX- O
PAR\CASH_DISPENSER O
" O
/v O
VALUE_4 O
/t O
REG_SZ O
/d O
" O
5000 O
" O
/f O
shutdown O
-r O
-t O
0 O
–f O
Execution O
of O
this B-Entity
file I-Entity
changed B-Action
registry O
keys B-Entity
in I-Entity
the I-Entity
registry I-Entity
branch I-Entity
" I-Entity
" I-Entity
HKEY_LOCAL_MACHINE\ I-Entity
SOFTWARE\Wincor I-Entity
Nixdorf\ProTopas\Current- I-Entity
Version\LYNXPAR\CASH_DISPENSER I-Entity
" I-Entity
" I-Entity
that I-Entity
are I-Entity
responsible I-Entity
for I-Entity
cassette I-Entity
denominations I-Entity
in I-Entity
an I-Entity
ATM I-Entity
. O
 
As O
a O
result O
of O
this O
file O
execution O
the O
registry O
key O
that O
is O
in O
charge O
of O
the O
cassette O
number O
1 O
( O
VALUE_1 O
) O
is O
takes O
the O
value O
" O
100 O
" O
, O
and O
the O
registry O
key O
respon- O
sible O
for O
the O
cassette O
number O
4 O
( O
VALUE_4 O
) O
is O
set O
to O
" O
5000 O
" O
. O
 
Then O
the O
command O
to O
restart O
the O
computer O
is O
issued O
. O
 
The O
registry O
key O
reference O
values O
: O
If O
the O
ATM O
actual O
load O
corresponds O
to O
the O
refer- O
ence O
one O
and O
registry O
keys O
have O
been O
changed O
, O
then O
the O
banknotes O
from O
the O
cassette O
No.1 O
will O
be O
issued O
with O
denomination O
" O
5000 O
" O
instead O
of O
" O
100 O
" O
. O
 
In O
addition O
, O
the O
attackers O
used O
a O
modified O
debug O
program O
that O
allows O
by O
the O
command O
to O
issue O
mon- O
ey O
from O
the O
dispenser O
. O
 
The O
original O
debug O
program O
issues O
money O
through O
the O
dispenser O
only O
when O
the O
open O
ATM O
housing O
and O
the O
vault O
door O
are O
fixed O
. O
 
In O
order O
to O
ensure O
money O
issuance O
from O
the O
closed O
ATM O
the O
attackers O
had O
to O
modify O
the O
original O
program O
" O
KDIAG32 O
" O
( O
the O
original O
file O
: O
size O
of O
1,128,960 O
MD5 O
4CC1A6E049942EB- O
DA395244C74179EFF O
) O
. O
 
A O
comparison O
of O
the O
original O
version O
of O
the O
pro- O
gram O
with O
the O
modified O
version O
showed O
that O
the O
only O
difference O
is O
in O
ignoring O
error O
" O
" O
Door O
not O
opened O
or O
missing O
! O
" O
" O
. O
 
The O
figure O
below O
shows O
an O
error O
message O
that O
will O
be O
never O
displayed O
to O
the O
user O
in O
the O
file O
under O
investigation O
. O
 
All O
traces O
found O
during O
investigation O
of O
one O
incident O
showed O
that O
the O
same O
criminal O
group O
had O
worked O
. O
 
Ammy O
Admin O
was O
used O
for O
remote O
access O
, O
the O
same O
SSHD O
backdoor O
was O
installed O
on O
Unix O
servers O
and O
, O
In O
addi- O
tion O
, O
it O
was O
loaded O
from O
the O
same O
hacked O
server O
as O
in O
other O
cases O
of O
trojan O
Anunak O
usage O
. O
 
However O
, O
in O
this O
case O
Androm- O
eda O
is O
used O
as O
the O
main O
trojan O
instead O
of O
Anunak O
. O
 
The O
man- O
agement O
servers O
were O
located O
in O
Kazakhstan O
, O
Germany O
and O
Ukraine O
. O
 
Check O
of O
the O
manage- O
ment O
servers O
showed O
that O
it O
was O
the O
hosting O
Bulletproof O
that O
, O
in O
addition O
to O
servers O
, O
provides O
a O
service O
of O
traffic O
proxying O
through O
its O
infrastructure O
as O
well O
as O
TOR O
and O
VPN O
usage O
, O
so O
this O
pattern O
is O
significantly O
differs O
from O
the O
Anunak O
host- O
ing O
patern O
. O
 
Check O
of O
money O
cashout O
showed O
that O
the O
same O
cashout O
criminal O
group O
had O
worked O
as O
for O
Anunak O
and O
this O
fact O
again O
confirmed O
their O
cooperation O
. O
 
Obtained O
Andromeda O
trojan O
copies O
were O
being O
distributed O
from O
August O
2014 O
by O
e O
- O
mail O
. O
 
The O
value O
754037e7be8f61cbb1b85ab46c7da77d O
, O
which O
is O
the O
MD5 O
hash O
of O
the O
string O
" O
go O
fuck O
yourself O
" O
, O
was O
used O
as O
the O
RC4 O
encryption O
key O
. O
 
As O
a O
result O
of O
this O
distri- O
bution O
from O
August O
to O
late O
October O
the O
Andromeda O
botnet O
rose O
up O
to O
260,000 O
bots O
. O
 
Successful O
infection O
in O
one O
subnet O
resulted O
in O
sending O
such O
letters O
to O
other O
bank O
employees O
. O
 
Example O
of O
forwarding O
from O
an O
infected O
bank O
network O
to O
employees O
of O
another O
bank O
is O
shown O
below O
. O
 
As O
a O
result O
of O
this O
radial O
mailing O
many O
oil O
and O
gas O
companies O
, O
banks O
and O
government O
agencies O
were O
in- O
fected O
. O
 
In O
Russia O
at O
least O
15 O
banks O
and O
two O
payment O
systems O
were O
infected O
this O
way O
. O
 
Letters O
with O
similar O
attachments O
were O
being O
dis- O
tributed O
with O
the O
following O
subjects O
: O
" O
My O
new O
photo O
" O
" O
Alert O
Transactions O
Report O
by O
users O
from O
2014- O
09 O
- O
28 O
to O
2014 O
- O
09 O
- O
28 O
" O
Previously O
, O
it O
should O
be O
noted O
the O
fact O
that O
the O
process O
of O
stolen O
money O
withdrawal O
( O
cashout O
) O
was O
differed O
, O
firstly O
by O
the O
theft O
method O
, O
secondly O
by O
the O
victim O
type O
( O
a O
bank O
or O
a O
payment O
system O
) O
, O
thirdly O
by O
the O
total O
stolen O
sum O
. O
 
The O
victims O
by O
their O
type O
were O
divided O
rather O
by O
counterparty O
types O
and O
by O
limitations O
imposed O
by O
operation O
with O
the O
counterparties O
. O
 
For O
example O
, O
all O
payments O
were O
required O
to O
go O
through O
a O
certain O
pool O
of O
mediators O
. O
 
In O
addition O
, O
the O
" O
improper O
" O
pool O
of O
counterparties O
could O
cause O
suspicion O
and O
unneces- O
sary O
testing O
( O
manual O
processing O
of O
payment O
orders O
) O
. O
 
Bank O
( O
amounts O
up O
to O
100 O
million O
roubles O
) O
. O
 
While O
the O
attacks O
in O
Russia O
against O
banks O
and O
payment O
systems O
have O
occurred O
over O
the O
past O
two O
years O
, O
the O
attacks O
against O
the O
retail O
industry O
is O
only O
something O
which O
started O
in O
the O
second O
quarter O
of O
2014 O
. O
 
With O
at O
least O
three O
confirmed O
breaches O
where O
card O
track O
data O
was O
obtainedand O
a O
total O
of O
at O
least O
16 O
breaches O
at O
retail O
organizations O
, O
it O
is O
also O
becoming O
a O
serious O
threat O
. O
 
Apart O
from O
retail O
organizations O
it O
is O
also O
known O
that O
a O
number O
of O
media O
and O
PR O
companies O
have O
been O
breached O
in O
2014 O
. O
 
While O
it O
is O
not O
entirely O
cer- O
tain O
, O
the O
type O
of O
breaches O
suggest O
that O
the O
attackers O
are O
looking O
for O
inside O
information O
, O
a O
type O
of O
indus- O
trial O
espionage O
, O
allowing O
them O
to O
gain O
an O
advantage O
on O
the O
stock O
market O
. O
 
As O
there O
is O
nothing O
specifically O
missing O
and O
the O
resulting O
fraud O
is O
hard O
to O
match O
with O
anything O
, O
these O
incidents O
typically O
are O
never O
linked O
. O
 
From O
the O
retail O
perspective O
, O
the O
first O
infections O
in O
2014 O
were O
sourced O
from O
a O
botnet O
which O
employs O
a O
widely O
deployed O
crypto O
- O
currency O
mining O
malware O
based O
on O
the O
Gozi O
/ O
ISFB O
( O
banking O
) O
malware O
family O
. O
 
Based O
on O
our O
insights O
we O
believe O
during O
the O
first O
half O
of O
2014 O
over O
half O
a O
million O
systems O
had O
been O
compromised O
by O
this O
malware O
from O
over O
the O
whole O
world O
, O
however O
Russia O
and O
a O
number O
of O
post O
- O
Soviet O
states O
were O
clean O
of O
infections O
. O
 
To O
find O
interesting O
infections O
within O
this O
large O
set O
of O
compromised O
systems O
, O
the O
malware O
extracts O
relevant O
information O
from O
the O
systems O
including O
Microsoft O
Windows O
organization O
registration O
information O
and O
network/ O
Windows O
domain O
information O
. O
 
The O
Gozi B-Entity
/ I-Entity
ISFB I-Entity
based I-Entity
malware I-Entity
was O
used O
to O
drop B-Action
additional O
components B-Entity
on I-Entity
interesting I-Entity
systems I-Entity
, O
which O
included O
Metasploit O
/ O
Meterpreter O
payloads O
and O
Anunak O
variants O
. O
 
This O
was O
one O
of O
the O
main O
methods O
for O
the O
group O
using O
Anunak O
to O
obtain O
in- O
teresting O
infections O
in O
the O
middle O
of O
2014 O
, O
sourcing O
infections O
from O
other O
botnet O
operators O
. O
More O
recent- O
ly O
other O
infection O
methods O
, O
including O
spear O
phishing O
using O
English O
language O
and O
possibly O
also O
usage O
of O
the O
teams O
own O
Andromeda O
, O
but O
also O
SQL O
injection O
to O
breach O
an O
organization O
directly O
from O
the O
outside O
, O
has O
been O
employed O
by O
this O
team O
. O
 
The O
first O
known O
attacks O
with O
Anunak O
targeted O
a O
specific O
brand O
of O
POS O
systems O
which O
revolved O
around O
the O
Epicor O
/ O
NSB O
brand O
. O
 
To O
do O
this O
Anunak O
has O
specific O
code O
to O
target O
POS O
devices O
equipped O
with O
this O
software O
, O
which O
in O
contrary O
to O
the O
more O
common O
memory O
scanning O
track O
data O
scrapers O
, O
logs O
a O
wealth O
of O
information O
from O
the O
payments O
done O
by O
the O
cards O
. O
 
The O
first O
case O
this O
was O
seen O
active O
was O
in O
July O
2014 O
, O
but O
it O
might O
have O
been O
earlier O
as O
well O
. O
 
More O
recent O
breaches O
have O
used O
a O
new O
custom O
developed O
POS O
malware O
, O
which O
is O
a O
more O
simple O
but O
reliable O
track O
data O
memory O
scraper O
. O
 
The O
initial O
version O
from O
the O
early O
fall O
of O
2014 O
used O
a O
simple O
blacklist O
, O
scraped O
every O
process O
and O
dumped O
track O
data O
in O
plain O
text O
. O
 
More O
recent O
versions O
scanned O
only O
configuration O
specified O
processes O
and O
used O
RC4 O
to O
encrypt O
the O
extracted O
track O
data O
records O
on O
disk O
. O
 
While O
the O
retail O
industry O
is O
one O
of O
its O
main O
targets O
due O
to O
its O
payment O
processing O
capabilities O
, O
other O
compromises O
might O
occur O
indirectly O
, O
for O
example O
to O
obtain O
databases O
with O
information O
or O
other O
informa- O
tion O
that O
is O
of O
value O
to O
the O
organized O
criminal O
group O
. O
 
One O
of O
the O
possibilities O
is O
obtaining O
lists O
of O
corporate O
email O
addresses O
to O
have O
a O
higher O
chance O
of O
interest- O
ing O
infections O
. O
 
At O
this O
moment O
we O
have O
no O
evidence O
of O
successful O
compromise O
or O
theft O
of O
banks O
and O
payment O
systems O
outside O
of O
Russia O
, O
but O
several O
infections O
in O
the O
east O
of O
Europe O
( O
specifically O
Ukraine O
and O
Latvia O
) O
were O
active O
in O
2014 O
. O
 
These O
specific O
infections O
were O
related O
to O
infrastructure O
of O
organizations O
based O
in O
Russia O
or O
with O
significant O
interests O
in O
Russia O
, O
thus O
more O
likely O
related O
to O
the O
breaches O
at O
the O
same O
organization O
in O
Russia O
. O
 
The O
majority O
of O
infections O
from O
Europe O
were O
from O
dedicated O
servers O
used O
as O
exit O
node O
for O
VPN O
services O
, O
the O
systems O
infected O
were O
likely O
from O
Eastern O
Euro- O
pean O
or O
Russian O
origin O
, O
and O
possibly O
test O
infections O
from O
the O
attackers O
. O
 
We O
have O
no O
evidence O
of O
compro- O
mises O
against O
banks O
in O
Western O
Europe O
or O
United O
States O
, O
but O
it O
should O
be O
noted O
that O
the O
attackers O
methods O
could O
be O
utilized O
against O
banks O
outside O
of O
Russia O
as O
well O
. O
 
The O
group O
uses O
Metasploit O
as O
one O
of O
their O
main O
hacking O
tools O
, O
either O
stand O
alone O
or O
as O
part O
of O
a O
framework O
. O
 
The O
activity O
includes O
port O
scanning O
and O
system O
reconnaissance O
, O
escalating O
privileges O
on O
systems O
by O
using O
for O
example O
the O
recent O
CVE-2014- O
4113 O
vulnerability O
, O
gathering O
credentials O
and O
hop- O
ping O
on O
to O
other O
systems O
and O
networks O
. O
 
Metasploit O
is O
being O
used O
to O
its O
full O
potential O
with O
scanning O
, O
exploiting O
, O
privilege O
escalation O
and O
post O
exploitation O
persistence O
being O
achieved O
with O
its O
standard O
toolset O
. O
 
On O
interesting O
and O
critical O
systems O
typical O
hack- O
ing O
tools O
might O
be O
found O
to O
establish O
tunnels O
out O
of O
the O
network O
, O
either O
tools O
that O
are O
part O
of O
the O
Metasploit O
framework O
such O
as O
Meterpreter O
, O
but O
also O
other O
tools O
to O
achieve O
persistence O
on O
those O
systems O
. O
 
The O
connect O
back O
methods O
seen O
are O
typically O
SSL O
over O
port O
443 O
, O
but O
also O
DNS O
based O
methods O
were O
observed O
. O
 
The O
attackers O
use O
BITS O
to O
download O
files O
, O
but O
also O
make O
use O
of O
Windows O
built O
- O
in O
PowerShell O
to O
download O
tools O
and O
execute O
commands O
. O
 
Finally O
on O
the O
critical O
systems O
freshly O
crypted O
and O
non O
- O
detected O
versions O
of O
Anunak O
are O
deployed O
, O
typically O
these O
are O
used O
in O
very O
limited O
deployments O
thus O
their O
spread O
is O
limited O
and O
detection O
by O
Anti O
- O
Virus O
is O
very O
rare O
. O
 
Various O
stealth O
methods O
including O
the O
aforemen- O
tioned O
backconnect O
SSL O
and O
DNS O
tunneling O
for O
compromise O
persistence O
and O
data O
exfiltration O
are O
used O
. O
 
The O
Anunak O
malware O
has O
multiple O
ways O
of O
connecting O
to O
backends O
, O
which O
includes O
a O
PHP O
based O
backend O
reachable O
over O
HTTP O
and O
HTTPS O
, O
and O
a O
Windows O
server O
based O
component O
using O
a O
propri- O
etary O
protocol O
. O
 
The O
use O
of O
VNC O
scanning O
and O
password O
brute O
forcing O
, O
the O
adding O
of O
additional O
administrator O
accounts O
, O
use O
of O
RDP O
Wrapper O
to O
allow O
concurrent O
RDP O
sessions O
are O
all O
methods O
to O
gain O
access O
and O
achieve O
persistent O
access O
to O
compromised O
systems O
employed O
by O
this O
group O
. O
 
Additionally O
various O
ways O
of O
creating O
incidental O
and O
regular O
screen O
captures O
of O
the O
desktop O
of O
persons O
of O
interest O
within O
com- O
promised O
organizations O
were O
methods O
employed O
by O
these O
attackers O
. O
 
This O
also O
includes O
video O
captures O
made O
by O
the O
Anunak O
malware O
, O
allowing O
attackers O
to O
observe O
the O
behavior O
of O
users O
of O
certain O
applications O
. O
 
Group O
- O
IB O
is O
one O
of O
the O
leading O
international O
companies O
specializing O
in O
preventing O
and O
investigat- O
ing O
high O
- O
tech O
cyber O
crimes O
and O
fraud O
. O
 
The O
company O
offers O
a O
range O
of O
services O
on O
preventing O
financial O
and O
reputational O
damages O
, O
consulting O
and O
auditing O
of O
information O
security O
systems O
, O
and O
on O
computer O
forensics O
. O
 
The O
company O
also O
develops O
a O
number O
of O
innovative O
software O
products O
used O
to O
monitor O
, O
detect O
and O
prevent O
emerging O
cyber O
threats O
. O
 
The O
Group O
- O
IB O
team O
is O
made O
up O
of O
experts O
with O
unique O
skills O
and O
solid O
practical O
experience O
. O
 
They O
are O
internationally O
certified O
by O
CISSP O
, O
CISA O
, O
CISM O
, O
CEH O
, O
CWSP O
, O
GCFA O
and O
also O
have O
information O
security O
state O
certificates O
. O
 
In O
2013 O
, O
computer O
secu- O
rity O
incident O
response O
team O
CERT O
- O
GIB O
operated O
by O
Group O
- O
IB O
became O
a O
member O
of O
FIRST O
- O
Forum O
of O
Incident O
Response O
and O
Security O
Teams O
. O
 
In O
2013 O
, O
the O
company O
became O
a O
member O
of O
the O
international O
cyber O
security O
alliance O
IMPACT O
( O
In- O
ternational O
Multilateral O
Partnership O
Against O
Cyber O
Threats O
) O
. O
 
www.group-ib.com O
Fox O
- O
IT O
creates O
innovative O
cyber O
security O
solutions O
for O
a O
more O
secure O
society O
. O
 
We O
are O
dedicated O
to O
our O
clients O
, O
our O
values O
, O
and O
our O
integrity O
. O
 
Fox O
- O
IT O
delivers O
solutions O
before O
, O
during O
and O
after O
attacks O
. O
 
InTELL O
is O
the O
real O
- O
time O
cyber O
intelligence O
product O
from O
Fox O
- O
IT O
. O
 
It O
provides O
a O
layered O
intelligence O
approach O
: O
actionable O
data O
feeds O
into O
operational O
risk O
decision O
systems O
. O
 
Real O
time O
threat O
information O
allows O
for O
tactical O
decisions O
and O
mitigation O
. O
 
InTELL O
provides O
a O
full O
real O
- O
time O
insight O
in O
the O
global O
threat O
landscape O
. O
 
We O
base O
our O
intelligence O
around O
actor O
attribu- O
tion O
. O
 
This O
angle O
drives O
a O
unique O
visibility O
on O
online O
threats O
- O
InTELL O
sees O
threats O
before O
they O
enter O
the O
botnet O
. O
 
Information O
is O
delivered O
through O
our O
col- O
laboration O
portal O
, O
alerting O
, O
and O
through O
automated O
feeds O
powered O
by O
industry O
standard O
transports O
. O
 
www.fox-it.com O
 
