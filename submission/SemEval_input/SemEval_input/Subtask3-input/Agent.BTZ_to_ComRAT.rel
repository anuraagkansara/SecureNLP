In IN O O
November NNP O O
2014 CD O O
, , O O
the DT O O
experts NNS O O
of IN O O
the DT O O
G NNP O O
DATA NNP O O
SecurityLabs NNP O O
published VBD O O
an DT O O
article NN O O
about IN O O
ComRAT NNP O O
, , O O
the DT O O
Agent NNP O O
. . O O
BTZ NNP O O
successor NN O O
. . O O

We PRP O O
explained VBD O O
that IN O O
this DT O O
case NN O O
is VBZ O O
linked VBN O O
to IN O O
the DT O O
Uroburos NNP O O
rootkit NN O O
. . O O

We PRP O O
assume VBP O O
that IN O O
the DT O O
actor NN O O
behind IN O O
these DT O O
campaigns NNS O O
uses VBZ O O
several JJ O O
different JJ O O
malware NN O O
strains NNS O O
is VBZ O O
order NN O O
to TO O O
compromise VB O O
the DT O O
targeted JJ O O
infrastructure NN O O
: : O O
Uroburos NNP O O
, , O O
a DT O O
rootkit NN O O
; : O O
Agent NNP O O
. . O O
BTZ NNP O O
/ SYM O O
ComRAT NNP O O
, , O O
remote JJ O O
administration NN O O
tools NNS O O
or CC O O
Linux NNP O O
malware NN O O
and CC O O
maybe RB O O
even RB O O
more JJR O O
. . O O

We PRP O O
decided VBD O O
to TO O O
have VB O O
an DT O O
even RB O O
closer JJR O O
look NN O O
at IN O O
Agent NNP O O
. . O O
BTZ NN O O
and CC O O
ComRAT NNP O O
and CC O O
therefore RB O O
analyzed VBD O O
the DT O O
evolution NN O O
of IN O O
this DT O O
RAT NN O O
, , O O
covering VBG O O
seven CD O O
years NNS O O
of IN O O
development NN O O
. . O O

Here RB O O
is VBZ O O
a DT O O
table NN O O
with IN O O
the DT O O
minimal JJ O O
information NN O O
about IN O O
46 CD O O
different JJ O O
samples NNS O O
. . O O

Thanks NNS O O
to IN O O
the DT O O
versioning NN O O
, , O O
we PRP O O
can MD O O
deduce VB O O
that IN O O
the DT O O
compilation NN O O
dates VBZ O O
we PRP O O
saw VBD O O
and CC O O
currently RB O O
see VBP O O
actually RB O O
seem VB O O
to TO O O
be VB O O
legit JJ O O
– . O O
except IN O O
for IN O O
the DT O O
last JJ O O
known VBN O O
version NN O O
, , O O
in IN O O
which WDT O O
the DT O O
author NN O O
modified VBD O O
the DT O O
compilation NN O O
date NN O O
in IN O O
order NN O O
to TO O O
make VB O O
the DT O O
analysis NN O O
more RBR O O
complex JJ O O
. . O O

We PRP O O
can MD O O
see VB O O
that IN O O
this DT O O
malware NN O O
was VBD O O
really RB O O
active JJ O O
in IN O O
2007 CD O O
and CC O O
2008 CD O O
. . O O

New JJ O O
versions NNS O O
declined VBD O O
in IN O O
frequency NN O O
in IN O O
2009 CD O O
and CC O O
only RB O O
one CD O O
new JJ O O
sample NN O O
was VBD O O
identified VBN O O
in IN O O
2010 CD O O
. . O O

We PRP O O
did VBD O O
not RB O O
encounter VB O O
any DT O O
new JJ O O
sample NN O O
from IN O O
2011 CD O O
, , O O
but CC O O
the DT O O
malware NN O O
appeared VBD O O
back RB O O
in IN O O
2012 CD O O
, , O O
with IN O O
a DT O O
new JJ O O
major JJ O O
version NN O O
. . O O

To TO O O
describe VB O O
the DT O O
evolution NN O O
of IN O O
the DT O O
development NN O O
, , O O
we PRP O O
decided VBD O O
to TO O O
compare VB O O
ten CD O O
major JJ O O
versions NNS O O
. . O O

The DT O O
following VBG O O
chapter NN O O
will MD O O
present VB O O
the DT O O
main JJ O O
differences NNS O O
between IN O O
the DT O O
versions NNS O O
mentioned VBN O O
above RB O O
. . O O

Here RB O O
is VBZ O O
the DT O O
resemblance NN O O
ratio NN O O
for IN O O
each DT O O
version NN O O
, , O O
comparing VBG O O
direct JJ O O
neighbor NN O O
versions NNS O O
only RB O O
, , O O
created VBN O O
using VBG O O
BinDiff NNP O O
. . O O

The DT O O
biggest JJS O O
code NN O O
update NN O O
has VBZ O O
occurred VBN O O
between IN O O
version NN O O
2.14.1 CD O O
and CC O O
version NN O O
3.00 CD O O
. . O O

The DT O O
gap NN O O
matches VBZ O O
the DT O O
absence NN O O
of IN O O
samples NNS O O
during IN O O
two CD O O
years NNS O O
and CC O O
this DT O O
fundamental JJ O O
modification NN O O
is VBZ O O
what WP O O
we PRP O O
call VBP O O
the DT O O
death NN O O
of IN O O
Agent NNP O O
. . O O
BTZ NN O O
and CC O O
the DT O O
birth NN O O
of IN O O
ComRAT NNP O O
. . O O

Differences NNS O O
between IN O O
version NN O O
Ch NNP O O
1.0 CD O O
( -LRB- O O
2007 CD O O
- SYM O O
06 CD O O
) -RRB- O O
to IN O O
Ch VB O O
1.5 CD O O
( -LRB- O O
2008 CD O O
- SYM O O
03 CD O O
) -RRB- O O
The DT O O
analyzed VBN O O
samples NNS O O
are VBP O O
. . O O

We PRP O O
did VBD O O
not RB O O
identify VB O O
strong JJ O O
modification NN O O
between IN O O
the DT O O
two CD O O
samples NNS O O
. . O O

However RB O O
, , O O
we PRP O O
can MD O O
notice VB O O
the DT O O
following VBG O O
. . O O

Differences NNS O O
between IN O O
version NN O O
Ch NNP O O
1.5 CD O O
( -LRB- O O
2008 CD O O
- SYM O O
03 CD O O
) -RRB- O O
and CC O O
Ch NNP O O
2.03 CD O O
( -LRB- O O
2008 CD O O
- SYM O O
05 CD O O
) -RRB- O O
The DT O O
analyzed VBN O O
samples NNS O O
are VBP O O
. . O O

In IN O O
version NN O O
2.03 CD O O
of IN O O
Agent NNP O O
. . O O
BTZ NNP O O
, , O O
the DT O O
authors NNS O O
changed VBD O O
the DT O O
following VBG O O
. . O O

They PRP O O
added VBD O O
obfuscation NN O O
in IN O O
order NN O O
to TO O O
hide VB O O
sensitive JJ O O
strings NNS O O
; : O O
The DT O O
communication NN O O
protocol NN O O
was VBD O O
modified VBN O O
in IN O O
order NN O O
to TO O O
include VB O O
the DT O O
flag NN O O
" '' O O
< XX O O
CHCMD NNP O O
> XX O O
" `` O O
we PRP O O
assume VBP O O
that IN O O
" `` O O
CH NNP O O
" '' O O
has VBZ O O
the DT O O
same JJ O O
meaning NN O O
than IN O O
" `` O O
Ch NNP O O
" '' O O
before IN O O
the DT O O
version NN O O
number NN O O
and CC O O
" `` O O
CMD NNP O O
" '' O O
is VBZ O O
the DT O O
abbreviation NN O O
for IN O O
command NN O O
; : O O
From IN O O
now RB O O
on RB O O
, , O O
the DT B-Entity 1
malware NN I-Entity O
supports VBZ O O
" `` O O
runas NNS O O
" '' O O
in IN O O
order NN O O
to IN O O
execute VB B-Action 2
commands VBZ B-Entity 3
as IN B-Modifier 4
administrator NN B-Entity 5
. . O O

This DT O O
command NN O O
was VBD O O
implemented VBN O O
by IN O O
Microsoft NNP O O
in IN O O
Windows NNP O O
Vista NNP O O
in IN O O
2007 CD O O
. . O O

We PRP O O
assume VBP O O
that IN O O
the DT O O
author NN O O
implemented VBD O O
this DT O O
feature NN O O
because IN O O
several JJ O O
targets NNS O O
switched VBD O O
to IN O O
this DT O O
version NN O O
of IN O O
Windows NNP O O
in IN O O
2008 CD O O
. . O O

According VBG O O
to IN O O
an DT O O
article NN O O
, , O O
version NN O O
1.5 CD O O
was VBD O O
used VBN O O
against IN O O
the DT O O
US NNP O O
Pentagon NNP O O
. . O O

We PRP O O
assume VBP O O
that IN O O
the DT O O
string NN O O
obfuscation NN O O
was VBD O O
performed VBN O O
in IN O O
order NN O O
to TO O O
bypass VB O O
security NN O O
measures NNS O O
being VBG O O
capable JJ O O
of IN O O
detecting VBG O O
an DT O O
intrusion NN O O
. . O O

Differences NNS O O
between IN O O
version NN O O
Ch NNP O O
2.03 CD O O
( -LRB- O O
2008 CD O O
- SYM O O
05 CD O O
) -RRB- O O
and CC O O
Ch NNP O O
2.11 CD O O
( -LRB- O O
2009 CD O O
- SYM O O
09 CD O O
) -RRB- O O
The DT O O
analyzed VBN O O
samples NNS O O
are VBP O O
. . O O

The DT O O
codes NNS O O
of IN O O
these DT O O
two CD O O
versions NNS O O
are VBP O O
extremely RB O O
similar JJ O O
to IN O O
each DT O O
other JJ O O
, , O O
we PRP O O
can MD O O
only RB O O
notice VB O O
small JJ O O
changes NNS O O
. . O O

Differences NNS O O
between IN O O
version NN O O
Ch NNP O O
2.11 CD O O
( -LRB- O O
2009 CD O O
- SYM O O
09 CD O O
) -RRB- O O
and CC O O
Ch NNP O O
2.14.1 CD O O
( -LRB- O O
2010 CD O O
- SYM O O
02 CD O O
) -RRB- O O
The DT O O
analyzed VBN O O
samples NNS O O
are VBP O O
. . O O

These DT O O
codes NNS O O
are VBP O O
really RB O O
similar JJ O O
to IN O O
each DT O O
other JJ O O
, , O O
too RB O O
. . O O

We PRP O O
can MD O O
notice VB O O
only RB O O
two CD O O
changes NNS O O
. . O O

The DT O O
four CD O O
exported VBN O O
libraries NNS O O
show VBP O O
that IN O O
the DT O O
malware NN O O
has VBZ O O
started VBN O O
to TO O O
support VB O O
the DT O O
OLE NNP O O
Component NNP O O
Object NNP O O
Model NNP O O
( -LRB- O O
COM NNP O O
) -RRB- O O
. . O O

This DT O O
version NN O O
is VBZ O O
the DT O O
first JJ O O
version NN O O
able JJ O O
to TO O O
be VB O O
registered VBN O O
as IN O O
a DT O O
COM NNP O O
object NN O O
. . O O

Three CD O O
of IN O O
the DT O O
four CD O O
functions NNS O O
are VBP O O
empty JJ O O
. . O O

The DT O O
fourth JJ O O
one NN O O
executes VBZ O O
the DT O O
malware NN O O
. . O O

Differences NNS O O
between IN O O
version NN O O
2.14.1 CD O O
( -LRB- O O
2010 CD O O
- SYM O O
02 CD O O
) -RRB- O O
and CC O O
Ch NNP O O
3.00 CD O O
( -LRB- O O
2012 CD O O
- SYM O O
01 CD O O
) -RRB- O O
The DT O O
analyzed VBN O O
samples NNS O O
are VBP O O
. . O O

These DT O O
codes NNS O O
really RB O O
differ VBP O O
from IN O O
each DT O O
other JJ O O
, , O O
even RB O O
if IN O O
some DT O O
parts NNS O O
of IN O O
version NN O O
2.14.1 CD O O
were VBD O O
retained VBN O O
. . O O

Moreover RB O O
, , O O
the DT O O
developers NNS O O
changed VBD O O
the DT O O
compiler NN O O
; : O O
they PRP O O
switched VBD O O
from IN O O
Visual NNP O O
Studio NNP O O
6.0 CD O O
to IN O O
Visual NNP O O
Studio NNP O O
9.0/10.0 CD O O
, , O O
which WDT O O
is VBZ O O
a DT O O
strong JJ O O
indicator NN O O
for IN O O
the DT O O
huge JJ O O
differences NNS O O
. . O O
Version NN O O
3.00 CD O O
is VBZ O O
what WP O O
the DT O O
G NNP O O
DATA NNP O O
SecurityLabs NNP O O
experts NNS O O
call VBP O O
ComRAT NNP O O
. . O O

We PRP O O
can MD O O
say VB O O
that IN O O
version NN O O
2.14.1 CD O O
is VBZ O O
the DT O O
last JJ O O
version NN O O
of IN O O
Agent NNP O O
. . O O
BTZ NN O O
. . O O

Here RB O O
are VBP O O
the DT O O
main JJ O O
differences NNS O O
between IN O O
Agent NNP O O
. . O O
BTZ NN O O
and CC O O
ComRAT NNP O O
. . O O

On IN O O
several JJ O O
3.00 CD O O
samples NNS O O
, , O O
the DT O O
author NN O O
forgot VBD O O
to TO O O
remove VB O O
the DT O O
compilation NN O O
path NN O O
, , O O
here RB O O
are VBP O O
some DT O O
examples NNS O O
. . O O

Thanks NNS O O
to IN O O
these DT O O
compilation NN O O
paths NNS O O
, , O O
we PRP O O
assume VBP O O
that IN O O
the DT O O
original JJ O O
name NN O O
of IN O O
the DT O O
RAT NNP O O
is VBZ O O
" `` O O
Chinch NNP O O
" '' O O
, , O O
which WDT O O
leads VBZ O O
us PRP O O
to IN O O
the DT O O
assumption NN O O
that IN O O
the DT O O
" `` O O
CH NNP O O
" '' O O
characters NNS O O
in IN O O
the DT O O
version NN O O
name NN O O
and CC O O
in IN O O
the DT O O
flag NN O O
" '' O O
< XX O O
CHCMD NNP O O
> XX O O
" `` O O
stands VBZ O O
for IN O O
" `` O O
Chinch NNP O O
" '' O O
. . O O

In IN O O
English NNP O O
, , O O
chinch NN O O
is VBZ O O
the DT O O
word NN O O
for IN O O
a DT O O
small JJ O O
North NNP O O
American JJ O O
bug NN O O
, , O O
Blissus NNP O O
leucopterus NN O O
. . O O

This DT O O
word NN O O
is VBZ O O
derived VBN O O
from IN O O
the DT O O
Spanish JJ O O
word NN O O
chinche NN O O
, , O O
meaning VBG O O
pest NN O O
. . O O

Differences NNS O O
between IN O O
version NN O O
3.00 CD O O
( -LRB- O O
2012 CD O O
- SYM O O
01 CD O O
) -RRB- O O
and CC O O
Ch NNP O O
3.10 CD O O
( -LRB- O O
2012 CD O O
- SYM O O
12 CD O O
) -RRB- O O
The DT O O
analyzed VBN O O
samples NNS O O
are VBP O O
. . O O

The DT O O
codes NNS O O
are VBP O O
similar JJ O O
to IN O O
each DT O O
other JJ O O
, , O O
but CC O O
the DT O O
authors NNS O O
added VBD O O
several JJ O O
features NNS O O
. . O O

The DT O O
last JJ O O
new JJ O O
feature NN O O
is VBZ O O
really RB O O
interesting JJ O O
: : O O
if IN O O
the DT O O
compromised VBN O O
targets NNS O O
block VBP O O
a DT O O
specific JJ O O
command NN O O
and CC O O
control NN O O
server NN O O
, , O O
the DT O O
malware NN O O
will MD O O
continue VB O O
to TO O O
work VB O O
, , O O
thanks NNS O O
to IN O O
two CD O O
alternative JJ O O
command NN O O
and CC O O
control NN O O
servers NNS O O
. . O O

Differences NNS O O
between IN O O
version NN O O
3.10 CD O O
( -LRB- O O
2012 CD O O
- SYM O O
12 CD O O
) -RRB- O O
and CC O O
Ch NNP O O
3.20 CD O O
( -LRB- O O
2013 CD O O
- SYM O O
06 CD O O
) -RRB- O O
The DT O O
analyzed VBN O O
samples NNS O O
are VBP O O
. . O O

The DT O O
major JJ O O
new JJ O O
feature NN O O
in IN O O
the DT O O
version NN O O
is VBZ O O
the DT O O
new JJ O O
exports NNS O O
function NN O O
called VBN O O
InstallW NNP O O
( -LRB- O O
) -RRB- O O
. . O O

This DT O O
exported VBN O O
function NN O O
is VBZ O O
used VBN O O
by IN O O
the DT B-Entity 1
dropper NN I-Entity O
to IN O O
add VB B-Action 2
persistence NN B-Entity 3
in IN B-Modifier 4
the DT O O
registry NN B-Entity 5
and CC O O
to IN O O
drop NN B-Action 6
a DT O O
second JJ B-Entity 7
file NN I-Entity O
( -LRB- O O
as IN O O
explained VBN O O
in IN O O
our PRP$ O O
previous JJ O O
article NN O O
) -RRB- O O
. . O O

Version NN O O
3.20 CD O O
uses VBZ O O
the DT O O
following VBG O O
CLSID NNP O O
in IN O O
order NN O O
to TO O O
hijack VB O O
COM NNP O O
object NN O O
: : O O
B196B286-BAB4- ADD O O
101A CD O O
- HYPH O O
B69C-00AA00341D07 NNP O O
. . O O

This DT O O
object NN O O
is VBZ O O
the DT O O
IConnectionPoint NN O O
interface NN O O
. . O O

The DT O O
CLSID NNP O O
was VBD O O
only RB O O
used VBN O O
in IN O O
this DT O O
version NN O O
. . O O

We PRP O O
assume VBP O O
that IN O O
the DT O O
performed VBN O O
COM NNP O O
object NN O O
hijacking NN O O
generates VBZ O O
some DT O O
trouble NN O O
on IN O O
the DT O O
infected JJ O O
system NN O O
, , O O
that DT O O
's VBZ O O
why WRB O O
the DT O O
author NN O O
changed VBD O O
related JJ O O
things NNS O O
in IN O O
the DT O O
next JJ O O
version NN O O
. . O O

Furthermore RB O O
, , O O
the DT O O
CLSID NNP O O
was VBD O O
stored VBN O O
in IN O O
plain JJ O O
text NN O O
within IN O O
the DT O O
sample NN O O
. . O O

Differences NNS O O
between IN O O
version NN O O
Ch NNP O O
3.20 CD O O
( -LRB- O O
2013 CD O O
- SYM O O
06 CD O O
) -RRB- O O
and CC O O
Ch NNP O O
3.25 CD O O
( -LRB- O O
2014 CD O O
- SYM O O
02 CD O O
) -RRB- O O
The DT O O
analyzed VBN O O
samples NNS O O
are VBP O O
. . O O

In IN O O
the DT O O
3.25 CD O O
version NN O O
, , O O
the DT O O
author NN O O
switched VBD O O
to IN O O
the DT O O
CLSID NNP O O
: : O O
42aedc87 CD O O
- HYPH O O
2188 CD O O
- HYPH O O
41fd NN O O
- HYPH O O
b9a3 NN O O
- HYPH O O
0c966feabec1 NNP O O
as IN O O
described VBN O O
in IN O O
our PRP$ O O
article NN O O
. . O O

Furthermore RB O O
, , O O
the DT O O
strings NNS O O
in IN O O
the DT O O
sample NN O O
are VBP O O
obfuscated VBN O O
. . O O

The DT O O
main JJ O O
new JJ O O
feature NN O O
is VBZ O O
the DT O O
obfuscation NN O O
– . O O
almost RB O O
all DT O O
strings NNS O O
are VBP O O
obfuscated VBN O O
and CC O O
the DT O O
XML NN O O
pattern NN O O
is VBZ O O
not RB O O
written VBN O O
in IN O O
plain JJ O O
text NN O O
anymore RB O O
. . O O

Differences NNS O O
between IN O O
version NN O O
Ch NNP O O
3.25 CD O O
( -LRB- O O
2014 CD O O
- SYM O O
02 CD O O
) -RRB- O O
and CC O O
Ch NNP O O
3.26 CD O O
( -LRB- O O
2013 CD O O
- SYM O O
01 CD O O
; : O O
date NN O O
has VBZ O O
been VBN O O
modified VBN O O
) -RRB- O O
The DT O O
analyzed VBN O O
samples NNS O O
are VBP O O
. . O O

The DT O O
version NN O O
3.26 CD O O
is VBZ O O
the DT O O
latest JJS O O
known VBN O O
version NN O O
. . O O

In IN O O
this DT O O
version NN O O
. . O O

This DT O O
analysis NN O O
shows VBZ O O
us PRP O O
seven CD O O
years NNS O O
of IN O O
the DT O O
evolution NN O O
of IN O O
a DT O O
Remote NNP O O
Administration NNP O O
Tool NNP O O
, , O O
used VBN O O
by IN O O
a DT O O
group NN O O
which WDT O O
targeted VBD O O
extremely RB O O
sensitive JJ O O
entities NNS O O
, , O O
such JJ O O
as IN O O
the DT O O
US NNP O O
Pentagon NNP O O
in IN O O
2008 CD O O
or CC O O
the DT O O
Belgium NNP O O
Ministry NNP O O
of IN O O
Foreign NNP O O
Affairs NNPS O O
in IN O O
2014 CD O O
as RB O O
well RB O O
as IN O O
the DT O O
Finnish NNP O O
Ministry NNP O O
of IN O O
Foreign NNP O O
Affairs NNPS O O
. . O O

Except IN O O
for IN O O
version NN O O
3.00 CD O O
, , O O
the DT O O
modifications NNS O O
made VBN O O
are VBP O O
rather RB O O
marginal JJ O O
. . O O

We PRP O O
can MD O O
see VB O O
that IN O O
the DT O O
authors NNS O O
adapted VBD O O
features NNS O O
to IN O O
the DT O O
Windows NNP O O
versions NNS O O
, , O O
patched VBN O O
bugs NNS O O
, , O O
added VBD O O
obfuscation NN O O
etc NN O O
… . O O
The DT O O
biggest JJS O O
update NN O O
was VBD O O
performed VBN O O
to IN O O
version NN O O
3.00 CD O O
, , O O
after IN O O
two CD O O
years NNS O O
of IN O O
silence NN O O
. . O O

Visibly RB O O
, , O O
this DT O O
RAT NN O O
was VBD O O
used VBN O O
alongside IN O O
the DT O O
Uroburos NNP O O
rootkit NN O O
. . O O

Nevertheless RB O O
, , O O
it PRP O O
is VBZ O O
not RB O O
entirely RB O O
clear JJ O O
how WRB O O
and CC O O
when WRB O O
the DT O O
attackers NNS O O
choose VBP O O
to TO O O
use VB O O
the DT O O
RAT NN O O
or CC O O
the DT O O
rootkit NN O O
or CC O O
whether IN O O
both DT O O
are VBP O O
used VBN O O
in IN O O
parallel NN O O
. . O O

Taking VBG O O
everything NN O O
into IN O O
consideration NN O O
, , O O
G NNP O O
DATA NNP O O
SecurityLabs NNP O O
experts NNS O O
are VBP O O
sure JJ O O
that IN O O
the DT O O
group NN O O
behind IN O O
Uroburos NNP O O
/ SYM O O
Agent NNP O O
. . O O
BTZ NNP O O
/ SYM O O
ComRAT NNP O O
/ SYM O O
Linux NNP O O
tool/ NN O O
… NN O O
will MD O O
remain VB O O
an DT O O
active JJ O O
player NN O O
in IN O O
the DT O O
malware NN O O
and CC O O
APT NNP O O
field NN O O
. . O O

The DT O O
newest JJS O O
revelations NNS O O
made VBN O O
and CC O O
connections NNS O O
drawn VBN O O
let VBD O O
us PRP O O
believe VB O O
that IN O O
there EX O O
is VBZ O O
even RB O O
more JJR O O
to TO O O
come VB O O
. . O O

