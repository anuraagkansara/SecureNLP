Energetic O
Bear O
/ O
Crouching O
Yeti O
is O
an O
actor O
involved O
in O
several O
advanced O
persistent O
threat O
( O
APT O
) O
campaigns O
that O
have O
been O
active O
going O
back O
to O
at O
least O
the O
end O
of O
2010 O
. O

Targeted O
sectors O
include O
. O

Most O
of O
the O
victims O
we O
identified O
fall O
into O
the O
industrial O
/ O
machinery O
building O
sector O
, O
indicating O
this O
is O
of O
special O
interest O
. O

To O
infect O
the O
victims O
, O
the O
attackers O
rely O
on O
three O
methods O
. O

During O
the O
attacks O
, O
the O
Crouching O
Yeti O
uses O
several O
malware O
/ O
Trojans O
, O
which O
exclusively O
infect O
Windows O
systems O
. O

For B-Modifier
command O
and B-Entity
control I-Entity
, O
these O
connect B-Action
to B-Modifier
a O
large B-Entity
network I-Entity
of I-Entity
hacked I-Entity
websites I-Entity
. O

These O
sites B-Entity
host O
malware O
modules O
, O
victim O
information O
and O
issue B-Action
commands B-Entity
to B-Modifier
infected O
systems B-Entity
. O

The O
dozens O
of O
known O
Yeti O
exploit O
sites O
and O
their O
referrer O
sites O
were O
legitimate O
, O
compromised O
sites O
. O

They O
ran O
vulnerable O
content O
management O
systems O
or O
vulnerable O
web O
applications O
. O

None O
of O
the O
exploits O
used O
to O
compromise O
the O
servers O
were O
known O
to O
be O
zero O
- O
day O
. O

None O
of O
the O
client O
side O
exploits O
re O
- O
used O
from O
the O
open O
source O
metasploit O
framework O
were O
zero O
- O
day O
. O

Overall O
, O
we O
observed O
about O
2,800 O
victims O
worldwide O
, O
the O
most O
prevalent O
attack O
tool O
being O
the O
Havex O
Trojan O
. O

We O
believe O
this O
group O
is O
highly O
determined O
and O
focused O
on O
a O
very O
specific O
industrial O
sector O
of O
vital O
interest O
. O

It O
uses O
a O
variety O
of O
ways O
to O
infect O
its O
victims O
and O
exfiltrate O
strategic O
information O
. O

The O
analyzed O
data O
seems O
to O
suggest O
the O
following O
points O
. O

This O
report O
provides O
technical O
details O
on O
how O
they O
perform O
their O
operations O
. O

This O
section O
analyzes O
all O
the O
aspects O
we O
could O
find O
about O
how O
this O
actor O
performs O
its O
campaigns O
. O

The O
Crouching O
Yeti O
actor O
performed O
a O
massive O
surveillance O
operation O
targeting O
strategic O
victims O
, O
many O
of O
them O
in O
the O
industrial O
/ O
manufacturing O
sector O
. O

There O
were O
different O
ways O
of O
delivering O
of O
its O
malware O
including O
waterholing O
, O
spearphishing O
and O
adding O
malware O
to O
legitimate O
installers O
. O

Once O
the O
victims O
were O
infected O
, O
Crouching B-Entity
Yeti I-Entity
selected B-Action
different O
RATs B-Entity
for B-Modifier
its O
operations B-Entity
. O

These O
RATs B-Entity
communicated B-Action
with B-Modifier
Command O
and B-Entity
Control I-Entity
servers I-Entity
on I-Entity
compromised I-Entity
servers I-Entity
around I-Entity
the I-Entity
world I-Entity
, O
using B-Modifier
a O
simple B-Entity
PHP I-Entity
backend I-Entity
. O

We O
were O
able O
to O
identify O
several O
victims O
, O
including O
high O
- O
profile O
ones O
and O
dozens O
of O
domains O
used O
in O
the O
campaign O
. O

As O
far O
as O
we O
know O
the O
group O
behind O
Crouching O
Yeti O
delivers O
its O
malware O
using O
at O
least O
three O
different O
methods O
. O

The O
first O
method O
uses O
a O
legitimate O
software O
installer O
repackaged O
to O
contain O
the O
malicious O
DLL O
. O

Such O
modified B-Entity
self I-Entity
- I-Entity
extracting I-Entity
archives I-Entity
could O
have O
been O
uploaded O
directly O
to O
a O
compromised O
server O
, O
replacing O
the O
original O
file O
, O
or O
sent B-Action
to B-Modifier
the O
victim B-Entity
by B-Modifier
email B-Entity
. O

One O
example O
of O
this O
method O
was O
a B-Entity
hijacked I-Entity
SwissRanger I-Entity
camera I-Entity
driver I-Entity
( O
libMesaSR O
version O
1.0.14.706 O
) O
that O
was O
used O
to O
drop B-Action
the O
Sysmain B-Entity
backdoor I-Entity
to O
. O

% O
APPDATA%\sydmain.dll O
and O
set B-Action
the O
Run B-Entity
registry I-Entity
value I-Entity
to B-Modifier
load O
malicious B-Entity
DLL I-Entity
upon I-Entity
next I-Entity
system I-Entity
startup I-Entity
. O

In O
a O
similar O
manner O
, O
as O
early O
as O
January O
2014 O
, O
Havex B-Entity
version I-Entity
038 I-Entity
appears O
to O
have O
been B-Action
dropped O
by B-Modifier
a O
legitimate B-Entity
~40 I-Entity
MB I-Entity
software I-Entity
installer I-Entity
from I-Entity
the I-Entity
eWon I-Entity
web I-Entity
site I-Entity
. O

hxxp://www.ewon.biz O
/ O
software O
/ O
eCatcher O
/ O
eCatcherSetup.exe O
" O
eWon O
" O
is O
a O
Belgian O
producer O
of O
SCADA O
and O
industrial O
network O
equipment O
, O
which O
helps O
define O
this O
attack O
method O
as O
a O
watering O
hole O
attack O
. O

" O
Breaking O
the O
barrier O
between O
industrial O
applications O
and O
IT O
standards O
, O
the O
mission O
of O
eWON O
is O
to O
connect O
industrial O
machines O
securely O
to O
the O
Internet O
, O
enabling O
easy O
remote O
access O
and O
gathering O
all O
types O
of O
technical O
data O
originating O
from O
industrial O
machines O
... O
Connecting O
machines O
across O
the O
Internet O
is O
our O
mission O
. O
" O
Sometimes O
, O
the B-Entity
Havex I-Entity
loader I-Entity
was O
dropped B-Action
from B-Modifier
" O
eCatcherSetup_v4.exe B-Entity
" I-Entity
, O
so O
it O
seems O
that O
the O
site O
operators O
may O
have O
removed O
a O
previous O
file O
and O
the O
attackers O
replaced O
it O
with O
their O
trojanized O
installer O
, O
and O
so O
on O
. O

Likely O
, O
the O
attackers O
gained O
access O
to O
eWon O
's O
ftp O
site O
and O
replaced O
the O
legitimate O
file O
with O
one O
that O
is O
bound O
with O
the O
Havex O
dropper O
several O
times O
. O

Another O
example O
that O
involves O
a O
hijacked O
application O
from O
a O
PLC O
- O
related O
vendor O
is O
a O
Trojanized O
mbCHECK O
installer O
which O
replaced O
the O
original O
legitimate O
version O
freely O
downloadable O
from O
the O
vendor O
's O
website O
. O

The O
legitimate O
version O
can O
be O
downloaded O
for O
free O
from O
the O
vendor O
's O
website O
. O

The O
vendor O
- O
MB O
Connect O
Line O
- O
is O
a O
company O
which O
specializes O
in O
software O
for O
remote O
maintenance O
of O
PLC O
systems O
: O
MB O
Connect O
Line O
GmbH(hxxp://www.mbconnectline.com O
/ O
index.php O
/ O
en/ O
) O
. O

In O
this O
case O
, O
the O
dropped O
DLL O
was O
Havex O
version O
043 O
. O

The O
second O
method O
relies O
on O
a B-Entity
malicious I-Entity
XDP I-Entity
file I-Entity
containing I-Entity
the I-Entity
PDF I-Entity
/ I-Entity
SWF I-Entity
exploit I-Entity
( O
CVE-2011- O
0611 O
) O
and O
was O
most O
probably O
used B-Action
in B-Modifier
spear O
- B-Entity
phishing I-Entity
attacks I-Entity
. O

This O
exploit O
drops O
the O
Havex O
loader O
DLL O
, O
which O
is O
stored O
in O
an O
encrypted O
form O
in O
the O
XDP O
file O
. O

The O
exploit O
is O
delivered O
as O
an O
XDP O
file O
( O
XML O
Data O
Package O
) O
which O
is O
actually O
a O
PDF O
file O
packaged O
within O
an O
XML O
container O
. O

This O
is O
a O
known O
the O
PDF O
obfuscation O
method O
and O
serves B-Action
as B-Modifier
an O
additional B-Entity
anti I-Entity
- I-Entity
detection I-Entity
layer I-Entity
. O

The O
XDP O
file O
contains O
an O
SWF O
exploit O
and O
two O
files O
( O
encrypted O
with O
XOR O
) O
stored O
in O
the O
invalid O
section O
of O
the O
PDF O
. O

One O
of O
the O
files O
is O
Havex O
DLL O
( O
version O
038 O
) O
, O
the O
other O
is O
a O
small O
JAR O
file O
which O
is O
used O
to O
copy O
and O
run O
the O
DLL O
by O
executing O
the O
following O
command O
. O

cmd O
/c O
copy O
< O
fname_passed_as_param O
> O
% O
TEMP%\\explore.dll O
/y O
& O
rundll32.exe O
% O
TEMP%\\explore.dll O
, O
RunDllEntry O
SWF O
executes O
the O
action O
script O
, O
which O
contains O
another O
SWF O
file O
which O
in O
turn O
uses O
the O
CVE- O
2011 O
- O
0611 O
vulnerability O
to O
run O
the O
shellcode O
. O

The O
shellcode O
then O
looks O
for O
a O
specific O
signature O
in O
the O
memory O
( O
which O
signs O
the O
start O
of O
encrypted O
DLL O
) O
, O
decrypts O
and O
loads O
it O
. O

Finally O
, O
this O
actor O
actively O
compromises O
legitimate O
websites O
for O
watering O
hole O
attacks O
. O

These O
hacked O
websites O
in O
turn O
redirect O
to O
malicious O
JAR O
or O
html O
files O
hosted O
on O
other O
sites O
maintained O
by O
the O
group O
( O
exploiting O
CVE-2013 O
- O
2465 O
, O
CVE-2013 O
- O
1347 O
, O
and O
CVE-2012 O
- O
1723 O
in O
Java O
6 O
, O
Java O
7 O
, O
IE O
7 O
and O
IE O
8) O
, O
which O
then O
drop O
the O
Havex O
loader O
, O
the O
Karagany O
backdoor O
and O
helper O
tools O
. O

These O
sites O
run O
an O
exploit O
kit O
known O
as O
" O
LightsOut O
" O
. O

It O
appears O
that O
the O
" O
LightsOut O
" O
exploit O
kit O
is O
exclusively O
used O
by O
Energetic O
Bear O
/ O
Crouching O
Yeti O
. O

From O
the O
dozens O
of O
Yeti O
exploit O
sites O
we O
reviewed O
, O
the O
malicious O
code O
was O
nothing O
more O
than O
slightly O
modified O
metasploit O
java O
exploits O
delivering O
the O
Havex O
loader O
. O

Some O
sort O
of O
internal O
review O
must O
have O
pushed O
them O
towards O
the O
LightsOut O
EK O
. O

KSN O
data O
records O
help O
provide O
a O
list O
of O
Crouching O
Yeti O
related O
exploit O
delivery O
from O
dozens O
of O
these O
sites O
. O

In O
earlier O
cases O
( O
July O
2013 O
) O
, O
successful O
Java O
exploitation O
served O
from O
nahoonservices.com O
would O
cascade O
into O
more O
Yeti O
components O
planted O
on O
victim O
systems O
. O

The O
java O
exploit O
downloaded O
Karagany O
backdoors O
, O
which O
in O
turn O
downloaded O
stealers O
from O
91.203.6.71 O
. O

Ksn O
data O
recorded O
at O
least O
20 O
victim O
sites O
that O
were O
compromised O
and O
injected O
with O
Yeti O
iframes O
, O
redirecting O
hundreds O
of O
visitors O
to O
compromised O
Yeti O
exploit O
sites O
. O

Most O
of O
these O
redirector O
sites O
were O
owned O
by O
western O
and O
Eastern O
European O
power O
players O
, O
investors O
, O
legal O
advisors O
and O
advocates O
, O
and O
European O
and O
US O
industrial O
IT O
equipment O
makers O
. O

The O
compromised O
sites O
hosting O
the O
LightsOut O
Exploit O
Kit O
were O
fairly O
trafficked O
, O
legitimate O
sites O
. O

Their O
content O
varies O
widely O
, O
from O
California O
winemakers O
to O
Cuban O
travel O
agencies O
and O
Iranian O
general O
interest O
/ O
religious O
inspiration O
sites O
. O

Finally O
, O
other O
second O
stage O
tools O
were O
simply O
retrieved O
by O
the O
downloaders O
over O
http O
from O
various O
servers O
. O

Some O
of O
these O
Yeti O
sites O
, O
like O
kinoporno.org O
, O
served O
both O
Havex O
and O
these O
tools O
. O

KSN O
events O
recorded O
the O
sites O
serving O
Windows O
Credential O
Editor O
and O
custom O
credential O
and O
document O
stealing O
tools O
. O

The O
Crouching O
Yeti O
group O
has O
different O
tools O
of O
choice O
for O
their O
operations O
. O

This O
section O
describes O
them O
from O
a O
technical O
perspective O
. O

The O
main O
functionality O
of O
this O
component O
is O
to O
download B-Action
and O
load B-Action
additional O
DLL B-Entity
modules I-Entity
into B-Modifier
the O
memory B-Entity
. O

These O
are O
stored O
on O
compromised B-Entity
websites I-Entity
that O
act B-Action
as B-Modifier
C&C O
servers B-Entity
. O

In O
order O
to O
do O
that O
, O
the B-Entity
malware I-Entity
injects B-Action
itself B-Entity
into B-Modifier
the O
EXPLORER.EXE B-Entity
process I-Entity
, O
sends B-Action
a O
GET B-Entity
/ I-Entity
POST I-Entity
request I-Entity
to B-Modifier
the O
PHP B-Entity
script I-Entity
on I-Entity
the I-Entity
compromised I-Entity
website I-Entity
, O
then O
reads B-Action
the O
HTML B-Entity
document I-Entity
returned I-Entity
by I-Entity
the I-Entity
script I-Entity
, O
looking O
for O
a O
base64 O
encrypted O
data O
between O
the O
two O
" O
havex O
" O
strings O
in O
the O
comment O
tag O
< O
! O
--havexhavex-- O
> O
and O
writes O
this O
data O
it O
to O
a O
% O
TEMP%\<tmp>.xmd O
file O
( O
filename O
is O
generated O
by O
GetTempFilename O
function O
) O
. O

In O
the O
meantime O
, O
another O
routine O
is O
constantly O
checking O
the O
% O
TEMP% O
folder O
for O
all O
* O
.xmd O
files O
. O

For O
each O
file O
it O
finds O
, O
it O
decompresses O
the O
content O
, O
decrypts O
( O
if O
encrypted O
) O
and O
loads B-Action
into B-Modifier
the O
memory B-Entity
as B-Modifier
the O
DLL B-Entity
. O

In O
order O
to O
run B-Action
on B-Modifier
each O
system B-Entity
boot I-Entity
, O
malware B-Entity
copies B-Action
itself B-Entity
to O
: O
< O
path>\TMPprovider0XX.dll O
and O
creates B-Action
the O
autorun B-Entity
registry I-Entity
key I-Entity
. O

All O
samples O
of O
this O
component O
contain O
a O
statically O
linked O
bzip2 O
library O
. O

Versions O
> O
= O
01B O
also O
contain O
an O
RSAeuro O
library O
, O
used O
to O
encrypt O
log O
files O
and O
decrypt O
downloadable O
modules O
. O

Public O
keys O
for O
encryption O
are O
hardcoded O
in O
the O
binary O
and/or O
stored O
in O
the O
configuration O
section O
. O

In O
some O
cases O
, O
these B-Entity
keys I-Entity
are O
written B-Action
to B-Modifier
the O
registry B-Entity
values I-Entity
. O

In O
total O
, O
we O
identified O
124 O
different O
samples O
of O
Havex O
loaders O
, O
belonging O
to O
27 O
different O
versions O
. O

As O
of O
June O
2014 O
, O
the O
latest O
version O
number O
we O
have O
is O
044 O
. O

The O
URL O
addresses O
of O
the O
C&C O
servers O
( O
which O
are O
indeed O
compromised O
websites O
) O
are O
either O
hardcoded O
in O
the O
binary O
, O
or O
- O
in O
versions O
= O
> O
038 O
- O
specified O
in O
the O
configuration O
section O
inside O
the O
ICT O
resource O
. O

This O
resource O
is O
compressed O
with O
bzip2 O
and O
encrypted O
with O
XOR O
. O

There O
are O
usually O
2 O
- O
4 O
URLs O
per O
binary O
, O
different O
for O
each O
malware O
version O
and O
sometimes O
also O
different O
between O
samples O
of O
the O
same O
version O
. O

Malware B-Entity
sends B-Action
a O
GET B-Entity
request I-Entity
( O
versions O
< O
017 O
) O
or O
POST B-Entity
request I-Entity
to B-Modifier
the O
first B-Entity
available I-Entity
URL I-Entity
. O

The O
request O
contents O
depends O
on O
the O
malware O
version O
and O
it O
may O
include O
such O
information O
as O
unique O
bot O
i O
d O
, O
malware O
version O
number O
, O
OS O
version O
number O
, O
and O
some O
other O
data O
from O
configuration O
, O
as O
well O
as O
the O
harvested O
information O
logged O
into O
the O
* O
.yls O
file O
( O
if O
any O
) O
. O

Then O
the O
malware O
searches O
the O
HTML O
code O
of O
each O
returned O
page O
for O
havex O
markers O
and O
saves O
the O
data O
between O
the O
markers O
into O
a O
temporary O
file O
. O

These O
modules O
are O
hosted O
between O
the O
havex O
markers O
in O
the O
HTML O
code O
of O
compromised O
websites O
. O

The O
module O
code O
is O
usually O
XORed O
with O
" O
1312312 O
" O
then O
compressed O
with O
BZIP2 O
and O
finally O
base64 O
encoded O
. O

Once O
downloaded O
into O
the O
% O
TEMP%\*.xmd O
file O
by O
the O
main O
Havex O
DLL O
, O
the O
code O
is O
decoded O
, O
decompressed O
, O
saved O
into O
the O
temporary O
DLL O
file O
and O
loaded O
into O
the O
memory O
. O

The O
modules O
perform O
a O
variety O
of O
different O
actions O
, O
including O
collecting B-Action
information B-Entity
about B-Modifier
the O
victim B-Entity
's I-Entity
system I-Entity
and I-Entity
other I-Entity
machines I-Entity
in I-Entity
the I-Entity
local I-Entity
network I-Entity
, O
harvesting B-Action
passwords B-Entity
, O
listing B-Action
documents B-Entity
, O
etc O
. O

In O
order O
to O
do O
that O
, O
some O
of O
the O
modules O
make O
use O
of O
additional O
3rd O
stage O
3rd O
party O
executables O
. O

Each O
module O
contains O
configuration O
information O
stored O
in O
an O
encrypted O
and O
compressed O
form O
inside O
a O
resource O
. O

Configuration O
data O
includes O
29-byte O
UID O
( O
unique O
ID O
) O
, O
a O
1024-bit O
RSA O
Public O
key O
( O
base64 O
encoded O
) O
and O
other O
necessary O
info O
( O
like O
file O
paths O
, O
etc O
. O
) O
. O

All O
harvested O
data O
is O
compressed O
, O
encrypted O
and O
written O
into O
the O
% O
TEMP%\*.yls O
files O
, O
which O
are O
then O
sent O
to O
the O
C&C O
by O
the O
main O
Havex O
/ O
Sysmain O
module O
. O

The O
" O
yls O
" O
files O
are O
encrypted O
with O
the O
3DES O
crypto O
algorithm O
using O
a O
random O
192-bit O
key O
( O
168 O
bit O
effective O
) O
. O

The O
3DES O
key O
is O
encrypted O
using O
the O
public O
RSA O
1024 O
key O
and O
therefore O
never O
transferred O
in O
plain O
text O
to O
attackers O
. O

In O
- O
depth O
analysis O
of O
the O
cryptography O
used O
by O
log O
files O
is O
presented O
in O
Appendix O
2 O
This B-Entity
module I-Entity
is O
designed O
to O
collect B-Action
detailed O
data B-Entity
about I-Entity
the I-Entity
OPC I-Entity
servers I-Entity
running I-Entity
in I-Entity
the I-Entity
local I-Entity
network I-Entity
and O
save B-Action
them B-Entity
to B-Modifier
a O
% B-Entity
TEMP%\{rand}.yls I-Entity
file I-Entity
. O

To O
query O
the O
OPC O
servers O
, O
it O
uses O
the O
following O
interfaces O
. O

This O
module B-Entity
collects B-Action
basic O
information B-Entity
about I-Entity
the I-Entity
system I-Entity
it I-Entity
's I-Entity
running I-Entity
on I-Entity
, O
and O
saves B-Action
it B-Entity
to B-Modifier
the O
% B-Entity
TEMP%\{rand}.yls I-Entity
file I-Entity
. O

Harvested O
data O
includes O
. O

This O
module O
collects O
contact O
details O
stored O
in O
all O
outlook.nk2 O
files O
and O
writes O
them O
to O
the O
% O
TEMP%\{rand}.yls O
file O
. O

Outlook.nk2 O
is O
the O
file O
where O
Outlook O
( O
version O
since O
2007 O
) O
keeps O
contact O
details O
in O
order O
to O
use O
them O
with O
the O
AutoComplete O
feature O
. O

This O
module B-Entity
uses O
the O
embedded O
BrowserPasswordDecryptor O
2.0 O
tool O
( O
hxxp://securityxploded.com O
/ O
browser O
- O
password O
- O
decryptor.php O
) O
to O
dump B-Action
login O
credentials B-Entity
stored I-Entity
by I-Entity
the I-Entity
password I-Entity
managers I-Entity
of I-Entity
various I-Entity
browsers I-Entity
. O

Decrypted O
passwords B-Entity
are O
saved B-Action
into B-Modifier
the O
% B-Entity
TEMP%\~tmp1237.txt I-Entity
file I-Entity
, O
which O
is O
then O
copied B-Action
by O
the B-Entity
parent I-Entity
module I-Entity
into B-Modifier
an O
encrypted B-Entity
* I-Entity
.tmp.yls I-Entity
file I-Entity
. O

List O
of O
browsers O
supported O
by O
the O
tool O
( O
from O
the O
product O
's O
website O
) O
. O

This O
module B-Entity
is O
designed O
to O
scan B-Action
the O
local B-Entity
network I-Entity
and O
look O
for O
all O
hosts O
listening O
on O
ports O
related O
to O
OPC O
/ O
SCADA O
software O
. O

Information O
about B-Entity
these I-Entity
hosts I-Entity
is O
then O
saved B-Action
to B-Modifier
the O
% B-Entity
TEMP%\~tracedscn.yls I-Entity
file I-Entity
. O

In O
- O
depth O
analysis O
of O
the O
Havex O
loader O
and O
its O
related O
modules O
is O
presented O
in O
Appendix O
2 O
. O

This O
component O
is O
a O
simple O
downloader O
with O
a O
functionality O
similar O
to O
the O
Havex O
component O
. O

It B-Entity
sends B-Action
requests B-Entity
to B-Modifier
the O
PHP B-Entity
script I-Entity
at I-Entity
the I-Entity
C&C I-Entity
( O
compromised O
website O
) O
and O
looks O
for O
specific O
data O
in O
the O
returned O
HTML O
code O
. O

It O
writes O
the O
data O
( O
some O
ASCII O
strings O
) O
from O
between O
< O
I6></I6 O
> O
tags O
to O
the O
file O
in O
% O
TEMP%\Low\~task.tmp O
and O
the O
data O
( O
binary O
data O
XORed O
with O
0x0A O
) O
from O
between O
< O
B6></B6 O
> O
tags O
into O
the O
% O
TEMP%\Low\~ldXXXX.TMP O
file O
. O

Then O
it O
decrypts O
the O
ldXXXX.TMP O
file O
and O
loads O
it O
into O
memory O
. O

Based O
on O
the O
compilation O
times O
, O
we O
may O
assume O
that O
this B-Entity
loader I-Entity
was O
used O
to O
download B-Action
and O
run B-Action
modules B-Entity
before O
it O
was O
replaced O
by O
Havex O
. O

The O
Ddex O
loader O
is O
analyzed O
in O
more O
detail O
in O
Appendix O
4 O
. O

This O
malware O
can O
be O
described O
as O
a O
classical O
RAT O
( O
Remote O
Access O
Trojan O
) O
, O
since O
it B-Entity
gives B-Action
the O
attacker B-Entity
a O
wide B-Entity
range I-Entity
of I-Entity
opportunities I-Entity
to I-Entity
control I-Entity
and I-Entity
interact I-Entity
with I-Entity
the I-Entity
victim I-Entity
machine I-Entity
. O

The O
autonomous B-Entity
part I-Entity
of I-Entity
Sysmain I-Entity
installs O
and O
registers B-Action
itself B-Entity
to B-Modifier
be O
persistent B-Entity
in I-Entity
the I-Entity
system I-Entity
. O

Then O
it B-Entity
gathers B-Action
general O
information B-Entity
about I-Entity
the I-Entity
victim I-Entity
system I-Entity
, O
like O
When O
ready O
, O
this B-Entity
data I-Entity
is O
submitted B-Action
to B-Modifier
one O
of B-Entity
the I-Entity
C&C I-Entity
- I-Entity
servers I-Entity
. O

After O
that O
, O
it B-Entity
checks B-Action
periodically O
for B-Modifier
new O
commands B-Entity
from I-Entity
C&C I-Entity
( O
pulling O
via O
HTTP O
) O
. O

With O
a O
set O
of O
11 O
commands O
, O
the O
malware O
is O
able O
to O
. O

There O
are O
also O
commands O
used O
for O
maintenance O
purposes O
. O

Among O
others O
, O
there O
are O
commands O
to O
change B-Action
the O
pubkey B-Entity
for I-Entity
C&C I-Entity
- I-Entity
communication I-Entity
or O
delete B-Action
its O
traces B-Entity
in I-Entity
the I-Entity
registry I-Entity
. O

It B-Entity
receives B-Action
its O
commands B-Entity
from B-Modifier
one O
of B-Entity
four I-Entity
static I-Entity
command I-Entity
- I-Entity
and I-Entity
- I-Entity
control I-Entity
servers I-Entity
. O

Every O
variant O
of O
this O
malware O
has O
its O
own O
set O
of O
servers O
. O

As O
usual O
, O
the O
attackers O
are O
using O
webservers O
- O
most O
likely O
compromised O
ones O
- O
as O
part O
of O
their O
C&C O
- O
infrastructure O
. O

To O
communicate O
with O
the O
C&C O
- O
server O
, O
the O
Trojan O
makes O
use O
of O
asymmetric O
encryption O
with O
a O
hardcoded O
pair O
of O
private O
and O
public O
keys O
. O

Another O
public O
key O
is O
used O
to O
encrypt O
files O
, O
which O
are O
collected O
in O
a O
local O
dropzone O
on O
the O
victim O
's O
file O
system O
. O

The O
files O
in O
that O
dropzone O
will O
be O
submitted O
to O
the O
attacker O
later O
, O
all O
in O
one O
go O
. O

Appendix O
3 O
provides O
in O
- O
depth O
analysis O
of O
the O
Sysmain O
backdoor O
. O

This O
component O
is O
written O
in O
.NET O
and O
is O
very O
similar O
to O
The O
Sysmain O
backdoor O
. O

The O
settings O
of O
the O
RAT O
are O
stored O
in O
the O
registry O
as O
BASE64 O
encoded O
values O
. O

The O
RAT B-Entity
gets B-Action
its O
commands B-Entity
by O
sending B-Action
a O
request B-Entity
to I-Entity
a I-Entity
PHP I-Entity
script I-Entity
on I-Entity
the I-Entity
C&C I-Entity
( O
compromised O
server O
) O
as O
usual O
, O
and O
looks O
for O
specific O
data O
in O
the O
returned O
HTML O
code O
. O

The O
data O
in O
this O
case O
is O
stored O
between O
the O
havexhavex O
tags O
, O
it O
is O
then O
decrypted O
and O
decoded O
( O
base64 O
) O
. O

The O
RAT O
supports O
13 O
commands O
including O
. O

Each O
time O
a O
command O
( O
task O
) O
is O
executed O
, O
the B-Entity
result I-Entity
of I-Entity
that I-Entity
command I-Entity
is O
stored B-Action
in B-Modifier
the O
registry B-Entity
under I-Entity
a I-Entity
subkey I-Entity
named I-Entity
" I-Entity
done I-Entity
" I-Entity
or I-Entity
" I-Entity
doneEXT I-Entity
" I-Entity
. O

The O
results B-Entity
( O
which O
are O
called O
" O
answers O
" O
by O
the O
authors O
) O
are O
then O
POSTED B-Action
to B-Modifier
the O
C&C B-Entity
server I-Entity
. O

The O
ClientX O
backdoor O
is O
analyzed O
in O
depth O
in O
Appendix O
5 O
. O

Karagany B-Entity
is O
a O
simple O
backdoor O
that O
connects B-Action
to B-Modifier
the O
C&C B-Entity
and O
keeps O
waiting B-Action
for B-Modifier
commands B-Entity
. O

It B-Entity
can O
download B-Action
and O
run B-Action
additional O
executables B-Entity
, O
load B-Action
/ I-Action
delete I-Action
modules B-Entity
, O
read B-Action
file O
content B-Entity
, O
reboot O
the O
computer O
, O
update B-Action
itself B-Entity
and O
remove B-Action
all O
components B-Entity
. O

Besides O
backdoor O
functionality O
, O
it B-Entity
also O
extracts B-Action
credentials B-Entity
from B-Modifier
Internet O
Explorer B-Entity
's I-Entity
password I-Entity
manager I-Entity
to B-Modifier
the O
prx.jpg B-Entity
file I-Entity
and O
injects B-Action
a O
small B-Entity
DLL I-Entity
into B-Modifier
the O
processes B-Entity
of I-Entity
web I-Entity
browsers I-Entity
. O

This O
DLL B-Entity
keeps O
listening B-Action
to B-Modifier
outgoing O
network B-Entity
traffic I-Entity
and O
looking B-Action
for I-Action
basic O
access B-Entity
authentication I-Entity
details I-Entity
sent I-Entity
over I-Entity
unencrypted I-Entity
HTTP I-Entity
. O

Affected O
browsers O
include O
Internet O
Explorer O
, O
Firefox O
, O
Mozilla O
and O
Opera O
. O

When O
executed O
, O
it B-Entity
copies B-Action
itself B-Entity
to B-Modifier
the O
folder B-Entity
under I-Entity
% I-Entity
APPDATA% I-Entity
and O
creates B-Action
a O
.lnk B-Entity
file I-Entity
in B-Modifier
the O
% B-Entity
STARTUP% I-Entity
directory I-Entity
. O

The O
folder O
name O
and O
filename O
are O
chosen O
from O
a O
list O
of O
strings O
hardcoded O
in O
the O
binary O
. O

It O
also O
creates O
the O
C:\ProgramData\Mail\MailAg\ O
folder O
, O
where O
the O
information O
harvested O
by O
downloaded O
modules O
will O
be O
stored O
. O

After O
checking O
if O
a O
connection O
to O
the O
Internet O
is O
up O
, O
it B-Entity
sends B-Action
an O
initial B-Entity
POST I-Entity
request I-Entity
to B-Modifier
the O
C&C B-Entity
server I-Entity
. O

Known O
parameters O
used O
in O
C&C O
communication O
are O
. O

This O
module O
is O
used O
to O
drop O
and O
run O
the O
DuckLink O
CmdCapture O
tool O
- O
a O
3rd O
party O
freeware O
AutoIt O
application O
for O
capturing O
screenshots O
( O
hxxp://www.ducklink.com/ O
) O
. O

A O
screenshot B-Entity
of I-Entity
the I-Entity
desktop I-Entity
is O
saved B-Action
into B-Modifier
the O
C:\ProgramData\Mail\MailAg\scs.jpg B-Entity
file I-Entity
. O

Additionally O
, O
other B-Entity
system I-Entity
information I-Entity
- O
such O
as O
the O
date O
and O
time O
of O
capture O
, O
computer O
name O
, O
username O
, O
cpu O
architecture O
, O
os O
version O
, O
IP O
address O
, O
logon O
domain O
and O
logon O
server O
, O
desktop O
details O
( O
height O
, O
width O
, O
depth O
, O
refresh O
rate O
) O
and O
environmental O
variables O
- O
are B-Action
logged I-Action
in B-Modifier
C:\ProgramData\Mail\MailAg\scs.txt O
file B-Entity
. O

This O
module B-Entity
is O
used O
to O
list B-Action
all O
files B-Entity
and I-Entity
documents I-Entity
with I-Entity
specified I-Entity
extensions I-Entity
, I-Entity
or I-Entity
which I-Entity
have I-Entity
names I-Entity
containing I-Entity
specified I-Entity
strings I-Entity
in I-Entity
the I-Entity
C:\ProgramData\Mail\MailAg\fls.txt I-Entity
file I-Entity
. O

Saved O
information O
includes O
path O
, O
size O
and O
modification O
time O
. O

File O
matching O
patterns O
. O

The O
Command O
and O
Control O
Servers O
are O
compromised O
legitimate O
websites O
, O
like O
Blogs O
, O
from O
different O
countries O
. O

In O
total O
we O
have O
identified O
219 O
unique O
domain O
names O
for O
these O
C&C O
servers O
hosted O
in O
21 O
different O
countries O
. O

We O
found O
most O
hosted O
C&Cs O
in O
the O
United O
States O
( O
81 O
servers O
) O
, O
Germany O
( O
33 O
servers O
) O
, O
the O
Russian O
Federation O
( O
19 O
servers O
) O
and O
the O
United O
Kingdom O
( O
7 O
servers O
) O
. O

The O
table O
below O
shows O
the O
distribution O
of O
victims O
affected O
by O
the O
samples O
identified O
according O
to O
our O
KSN O
data O
. O

Victims O
infected O
with O
samples O
from O
any O
of O
the O
Crouching O
Yeti O
group O
's O
malware O
were O
found O
in O
. O

65 O
of O
these O
C&C O
servers O
, O
in O
the O
following O
countries O
, O
were O
monitored O
during O
our O
investigation O
. O

This O
monitoring O
enabled O
us O
to O
get O
a O
list O
of O
the O
victims O
connected O
to O
them O
. O

The O
C&C O
Backend O
is O
written O
in O
PHP O
, O
consisting O
of O
3 O
files O
. O

The O
Backdoors O
interact O
with O
" O
source.php O
" O
, O
which O
is O
the O
control O
script O
. O

These O
are O
its O
functions O
on O
execution O
. O

1 O
. O

Collect O
the O
following O
information O
. O

2 O
. O

Write O
the O
above O
information O
to O
" O
testlog.php O
" O
, O
separated O
by O
" O
Tabulator O
" O
and O
base64- O
encoded O
, O
with O
the O
following O
syntax O
. O

< O
timestamp>\t O
< O
victim O
ip O
- O
address>\t O
< O
proxy>\t O
< O
botID>\t O
< O
request O
- O
uri>\t O
< O
useragent O
> O
3 O
. O

Write O
all O
transferred O
HTTP O
- O
GET O
Variables O
to O
" O
< O
botID>.log O
" O
, O
separated O
by O
" O
Tabulator O
" O
and O
base64-encoded O
. O

4 O
. O

If O
the O
bot O
executes O
an O
HTTP O
- O
POST O
- O
request O
, O
the O
transferred O
data O
is O
written O
to O
the O
file O
" O
< O
botID>.ans O
" O
, O
enclosed O
in O
" O
xdata O
"- O
Tag O
with O
timestamp O
. O

( O
" O
ans O
" O
is O
the O
acronym O
for O
" O
Answer O
" O
) O
. O

5 O
. O

Check O
for O
any O
" O
< O
botID>_*.txt O
" O
files O
a. O

If O
found O
the O
first O
step O
is O
to O
append O
the O
timestamp O
, O
filename O
and O
a O
" O
sent O
" O
Status O
indicated O
to O
" O
< O
botID>.log O
" O
. O

Then O
the O
file O
content O
is O
transferred O
to O
the O
bot O
, O
embedded O
into O
HTML O
with O
the O
HTML O
- O
Body O
" O
No O
data O
! O
" O
and O
the O
HTML O
- O
Comment O
" O
havex O
" O
, O
which O
contains O
the O
data O
to O
be O
transferred O
. O

Finally O
the O
file O
on O
the O
server O
is O
removed O
. O

If O
this O
removal O
fails O
it O
is O
logged O
to O
" O
< O
botID>.log O
" O
. O

b. O

If O
no O
matching O
file O
is O
found O
, O
an O
HTML O
- O
Response O
is O
sent O
with O
an O
empty O
" O
havex O
" O
HTML O
- O
Comment O
and O
HTML O
- O
Body O
text O
" O
Sorry O
, O
no O
data O
corresponding O
to O
your O
request O
. O
" O
The O
term O
" O
victim O
" O
in O
this O
section O
refers O
to O
a O
botID O
( O
unique O
String O
of O
the O
Backdoor O
) O
, O
connecting O
to O
one O
or O
more O
C&C O
Servers O
. O

Based O
on O
the O
45 O
C&C O
Servers O
wemonitored O
, O
a O
total O
of O
2,811 O
unique O
Victims O
were O
discovered O
. O

The O
average O
number O
of O
victims O
per O
C&C O
is O
70 O
. O

The O
following O
chart O
depicts O
the O
first O
( O
red O
line O
) O
and O
last O
( O
blue O
line O
) O
appearance O
of O
each O
victim O
on O
the O
C&C. O

The O
" O
FirstHit O
" O
shows O
how O
the O
rate O
of O
accumulating O
new O
victims O
has O
accelerated O
over O
the O
course O
of O
2014 O
. O

" O
LastHit O
" O
shows O
how O
the O
last O
connection O
of O
victims O
to O
C&C O
servers O
also O
increases O
over O
time O
. O

This O
could O
mean O
victims O
are O
disinfecting O
their O
computers O
, O
or O
it O
may O
be O
that O
they O
simply O
report O
to O
a O
different O
C&C O
server O
that O
we O
do O
not O
monitor O
. O

Mapping O
the O
unique O
hits O
of O
victims O
per O
day O
also O
indicates O
a O
decrease O
of O
" O
active O
" O
infections O
. O

The O
following O
chart O
clearly O
shows O
a O
difference O
between O
weekdays O
( O
groups O
of O
five O
higher O
bars O
) O
and O
weekends O
( O
two O
lower O
bars O
) O
. O

The O
daily O
unique O
hit O
- O
rate O
fell O
by O
about O
half O
from O
around O
800 O
connections O
at O
the O
beginning O
of O
2014 O
to O
around O
400 O
connections O
per O
week O
- O
day O
by O
the O
middle O
of O
the O
year O
. O

More O
than O
half O
of O
the O
victims O
always O
connect O
from O
the O
same O
IP O
address O
. O

Fewer O
than O
half O
of O
the O
victims O
connect O
from O
two O
or O
more O
different O
IP O
addresses O
as O
the O
following O
graph O
shows O
. O

This O
might O
indicate O
that O
some O
of O
the O
victims O
are O
behind O
proxies O
, O
which O
makes O
sense O
for O
corporate O
environments O
. O

Victims O
using O
many O
different O
IP O
addresses O
may O
indicate O
laptops O
. O

The O
following O
chart O
visualizes O
all O
the O
unique O
victims O
connecting O
to O
C&C O
servers O
. O

The O
main O
C&C O
Servers O
can O
be O
clearly O
seen O
in O
Russia O
and O
the O
USA O
. O

The O
victims O
are O
distributed O
across O
99 O
different O
countries O
. O

From O
the O
total O
of O
2,811 O
victims O
, O
it O
was O
possible O
to O
accurately O
identify O
106 O
of O
them O
. O

Appendix O
8 O
contains O
a O
brief O
description O
about O
the O
sector O
/ O
company O
in O
which O
these O
victims O
operate O
. O

The O
table O
below O
summarizes O
the O
distribution O
of O
the O
identified O
victims O
by O
sector O
. O

Based O
on O
our O
monitoring O
, O
the O
most O
widespread O
Backdoor O
is O
Havex O
with O
a O
total O
of O
2,470 O
infected O
systems O
, O
mostly O
based O
in O
USA O
and O
Spain O
. O

32 O
different O
versions O
of O
Havex O
are O
used O
among O
all O
victims O
, O
with O
51 O
victims O
left O
without O
any O
identifiable O
Havex O
version O
. O

Havex O
Version O
024 O
, O
compiled O
at O
the O
end O
of O
2012 O
, O
is O
the O
most O
widespread O
. O

Besides O
the O
Havex O
version O
, O
the B-Entity
OS I-Entity
Version I-Entity
of I-Entity
the I-Entity
victim I-Entity
computer I-Entity
is O
also O
communicated B-Action
to B-Modifier
the O
C&C B-Entity
server I-Entity
. O

The O
most O
common O
Operating O
System O
among O
victims O
is O
Windows O
XP O
, O
but O
Windows O
8.1 O
is O
also O
on O
the O
list O
. O

The O
Sysmain O
victims O
connect O
to O
six O
of O
the O
monitored O
C&C O
servers O
, O
where O
261 O
unique O
victims O
were O
counted O
, O
located O
in O
38 O
different O
countries O
. O

Victims O
of O
the O
Clientx O
backdoor O
connect O
to O
2 O
of O
the O
monitored O
C&C O
Servers O
, O
where O
10 O
unique O
Victims O
were O
counted O
in O
5 O
different O
countries O
. O

Based O
on O
the O
analysis O
of O
the O
monitored O
C&C O
Servers O
we O
can O
identify O
some O
clusters O
based O
on O
malware O
versions O
and O
the O
victims O
. O

This O
graph O
visualizes O
these O
relations O
. O

Every O
dot O
represents O
a O
victim O
, O
different O
Backdoors O
and O
versions O
are O
colored O
differently O
. O

The O
C&C O
Servers O
are O
also O
represented O
as O
dots O
where O
several O
clients O
connect O
. O

Grey O
lines O
are O
connections O
from O
a O
victim O
to O
its O
C&C O
Server O
. O

Some O
C&C O
Servers O
are O
dedicated O
to O
a O
given O
version O
of O
a O
backdoor O
( O
big O
Cluster O
) O
. O

Others O
share O
connections O
with O
different O
backdoor O
versions O
and O
different O
backdoors O
. O

Breaking O
this O
down O
to O
the O
sectors O
of O
the O
identified O
victims O
, O
we O
can O
not O
see O
any O
correlation O
between O
C&Cs O
and O
victims O
. O

The O
same O
sectors O
are O
targeted O
with O
different O
backdoor O
versions O
. O

Compared O
to O
our O
other O
APT O
research O
the O
available O
data O
is O
more O
non O
- O
specific O
than O
usual O
. O

There O
simply O
is O
no O
one O
piece O
or O
set O
of O
data O
that O
would O
lead O
to O
the O
conclusion O
that O
the O
threat O
actor O
is O
Bear O
, O
Kitten O
, O
Panda O
, O
Salmon O
, O
or O
otherwise O
. O

Significant O
data O
points O
below O
. O

It O
is O
rare O
to O
see O
file O
timestamps O
used O
as O
a O
precise O
, O
primary O
source O
of O
information O
when O
it O
comes O
to O
threat O
actor O
attribution O
. O

In O
previous O
reports O
, O
these O
timestamps O
have O
been O
used O
as O
supporting O
, O
or O
secondary O
pieces O
of O
data O
. O

They O
may O
help O
to O
suggest O
or O
support O
a O
time O
range O
for O
attacker O
activity O
, O
but O
they O
are O
very O
easily O
modified O
. O

So O
it O
is O
not O
very O
helpful O
to O
focus O
on O
this O
data O
set O
. O

The O
strings O
present O
in O
the O
backdoors O
, O
web O
components O
, O
and O
exploits O
are O
in O
English O
. O

Almost O
200 O
malicious O
binaries O
and O
the O
related O
operational O
content O
all O
present O
a O
complete O
lack O
of O
Cyrillic O
content O
, O
the O
opposite O
of O
our O
documented O
findings O
from O
researching O
Red O
October O
, O
Miniduke O
, O
Cosmicduke O
, O
Snake O
, O
and O
TeamSpy O
. O

The O
OPC O
module O
strings O
include O
typos O
and O
bad O
grammar O
. O

Some O
are O
so O
bad O
they O
are O
almost O
silly O
and O
there O
does O
n't O
seem O
to O
be O
a O
consistent O
pattern O
here O
. O

Programm O
was O
started O
at O
% O
02i:%02i:%02i O
Start O
finging O
of O
LAN O
hosts O
... O

Finding O
was O
fault O
. O

Unexpective O
error O
Was O
found O
% O
i O
hosts O
in O
LAN O
: O
Hosts O
was't O
found O
. O

There O
are O
also O
three O
interesting O
strings O
inside O
the O
Karagany O
backdoor O
. O

identifiant O
( O
which O
is O
French O
for O
identifier O
) O
, O
fichier O
( O
French O
for O
file O
) O
and O
liteliteliteskot O
( O
lite O
scot O
is O
Swedish O
for O
little O
sheet O
) O
Timestamp O
analysis O
is O
based O
on O
a O
total O
of O
154 O
collected O
binaries O
. O

Highlights O
. O

Activity O
/ O
Year O
( O
all O
samples O
) O
. O

Activity O
/ O
Weekdays O
based O
on O
compilation O
time O
. O

Activity O
/ O
Hours O
( O
UTC O
) O
based O
on O
compilation O
time O
. O

All O
the O
exploit O
servers O
delivered O
slightly O
modified O
ripped O
content O
from O
open O
source O
repositories O
. O

All O
the O
servers O
appear O
to O
be O
hacked O
servers O
. O

According O
to O
the O
available O
data O
, O
no O
zero O
- O
day O
exploits O
were O
used O
in O
any O
of O
these O
attacks O
, O
either O
to O
compromise O
the O
servers O
in O
the O
first O
place O
, O
or O
delivered O
as O
client O
side O
attack O
exploits O
by O
the O
Lights O
Out O
Exploit O
Kit O
. O

While O
this O
purely O
malicious O
re O
- O
use O
of O
metasploit O
PoC O
highlights O
the O
danger O
that O
these O
attack O
tools O
pose O
, O
it O
is O
also O
unusual O
to O
see O
an O
exclusively O
metasploit O
attack O
toolset O
effectively O
used O
in O
this O
way O
, O
delivered O
from O
what O
appear O
to O
be O
a O
chain O
of O
higher O
value O
compromised O
sites O
. O

All O
of O
these O
compromised O
web O
applications O
were O
vulnerable O
to O
freely O
available O
offensive O
security O
tools O
. O

We O
acknowledge O
that O
many O
of O
the O
compromised O
referrer O
servers O
were O
related O
to O
power O
producers O
in O
some O
way O
. O

However O
, O
these O
targets O
almost O
seem O
an O
afterthought O
, O
as O
the O
exploit O
servers O
themselves O
were O
compromised O
web O
servers O
from O
Cuban O
travel O
agency O
sites O
, O
a O
Californian O
winery O
site O
, O
a O
US O
based O
women O
's O
fashion O
site O
, O
an O
Iranian O
general O
interest O
/ O
religious O
inspiration O
site O
, O
a O
number O
of O
dating O
and O
adult O
content O
websites O
, O
and O
a O
variety O
of O
others O
. O

Although O
, O
we O
note O
that O
the O
known O
Trojanized O
software O
packages O
were O
ICS O
/ O
SCADA O
related O
as O
well O
, O
possibly O
because O
those O
victim O
sets O
or O
environments O
required O
special O
attention O
. O

So O
, O
while O
there O
was O
a O
strong O
set O
of O
offensive O
activities O
on O
power O
producers O
during O
the O
campaigns O
, O
it O
was O
by O
no O
means O
the O
full O
focus O
of O
them O
. O

While O
it O
may O
be O
" O
shocking O
" O
to O
observe O
power O
producers O
around O
the O
world O
targeted O
by O
any O
one O
threat O
actor O
, O
this O
actor O
's O
attack O
activity O
does O
not O
appear O
to O
be O
constrained O
to O
power O
producers O
. O

The O
related O
industries O
of O
interest O
show O
a O
much O
broader O
global O
scope O
than O
previously O
discussed O
, O
and O
the O
geographic O
regions O
of O
interest O
have O
gone O
completely O
undiscussed O
. O

For O
example O
, O
Spain O
had O
the O
highest O
number O
of O
victims O
. O

However O
, O
it O
appears O
that O
there O
was O
no O
significant O
correlation O
between O
the O
victim O
location O
and O
the O
C&C O
geolocation O
. O

And O
, O
according O
to O
our O
data O
, O
the O
list O
also O
includes O
victim O
organizations O
fitting O
the O
following O
additional O
categories O
. O

The O
Crouching O
Yeti O
actor O
has O
been O
performing O
massive O
surveillance O
campaigns O
in O
recent O
years O
, O
since O
at O
least O
2010 O
. O

Their O
targets O
included O
thousands O
of O
victims O
of O
which O
we O
were O
able O
to O
identify O
a O
few O
, O
confirming O
Crouching O
Yeti O
's O
interest O
in O
several O
strategic O
sectors O
. O

The O
distribution O
strategy O
of O
the O
group O
focuses O
on O
methods O
following O
this O
targeted O
philosophy O
, O
including O
spear O
phishing O
and O
waterholing O
. O

Noticeably O
, O
they O
also O
compromised O
legitimate O
software O
packages O
from O
strategic O
actors O
in O
the O
SCADA O
sector O
in O
order O
to O
infect O
their O
final O
victims O
. O

The O
victim O
list O
confirms O
that O
the O
tactic O
proved O
successful O
. O

There O
is O
nothing O
especially O
sophisticated O
in O
their O
exploits O
, O
or O
in O
the O
malware O
they O
used O
to O
infect O
victims O
. O

Their O
RATs B-Entity
are O
flexible O
enough O
to O
perform B-Action
surveillance B-Entity
and O
data B-Entity
exfiltration I-Entity
efficiently O
. O

They O
used O
dozens O
of O
compromised O
servers O
as O
Command O
and O
Control O
domains O
with O
a O
simple O
, O
but O
effective O
, O
PHP O
backend O
. O

However O
there O
is O
an O
interesting O
connection O
with O
this O
group O
and O
the O
LightsOut O
Exploit O
Kit O
for O
the O
distribution O
of O
its O
malware O
in O
some O
waterholing O
attacks O
. O

We O
believe O
they O
are O
likely O
its O
only O
operators O
as O
of O
June O
2014 O
. O

Thanks O
to O
the O
monitoring O
of O
several O
of O
the O
Command O
and O
Control O
domains O
used O
by O
the O
group O
, O
we O
were O
able O
to O
identify O
several O
victims O
. O

This O
victims O
' O
list O
reinforces O
the O
interests O
shown O
by O
the O
Crouching O
Yeti O
actor O
in O
strategic O
targets O
, O
but O
also O
shows O
the O
interest O
of O
the O
group O
in O
many O
other O
not O
- O
so O
- O
obvious O
institutions O
. O

We O
believe O
they O
might O
be O
collateral O
victims O
, O
but O
it O
might O
also O
be O
fair O
to O
redefine O
the O
Crouching O
Yeti O
actor O
not O
only O
as O
a O
highly O
targeted O
one O
in O
a O
very O
specific O
area O
of O
interest O
, O
but O
a O
broad O
surveillance O
campaign O
with O
interests O
in O
different O
sectors O
. O

We O
will O
continue O
monitoring O
this O
actor O
. O

