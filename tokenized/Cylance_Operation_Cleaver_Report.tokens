A O
personal O
note O
from O
Cylance O
, O
CEO O
Stuart O
McClure O
On O
February O
24 O
, O
1989 O
, O
United O
Flight O
811 O
left O
Honolulu O
, O
Hawaii O
, O
on O
its O
way O
to O
Auckland O
, O
New O
Zealand O
, O
with O
364 O
souls O
on O
board O
. O
 
Somewhere O
between O
23,000 O
and O
24,000 O
feet O
an O
enormous O
explosion O
ejected O
nine O
passengers O
into O
the O
dark O
void O
over O
the O
Pacific O
Ocean O
. O
 
This O
aviation O
disaster O
was O
later O
determined O
to O
have O
been O
caused O
by O
a O
simple O
design O
flaw O
combined O
with O
the O
lack O
of O
corrective O
action O
. O
 
Boeing O
and O
the O
FAA O
had O
known O
about O
this O
problem O
for O
over O
one O
year O
prior O
to O
the O
accident O
. O
 
The O
result O
: O
nine O
people O
lost O
their O
lives O
. O
 
The O
other O
337 O
passengers O
plus O
18 O
crew O
members O
who O
survived O
, O
live O
with O
the O
memory O
every O
day O
; O
all O
of O
it O
due O
to O
a O
highly O
preventable O
design O
flaw O
. O
 
As O
a O
19-year-old O
young O
adult O
, O
I O
was O
grateful O
to O
have O
survived O
but O
I O
had O
no O
idea O
how O
that O
single O
event O
would O
impact O
my O
future O
in O
such O
a O
profound O
way O
. O
 
Much O
of O
my O
passion O
for O
cybersecurity O
can O
be O
directly O
attributed O
to O
that O
fateful O
day O
. O
 
The O
United O
Flight O
811 O
accident O
proves O
just O
how O
important O
it O
is O
to O
detect O
flaws O
before O
tragedy O
strikes O
. O
 
Preventable O
disasters O
like O
this O
are O
what O
motivates O
the O
Cylance O
team O
to O
create O
a O
safer O
world O
. O
 
We O
do O
everything O
we O
can O
to O
uncover O
the O
flaws O
in O
technologies O
before O
they O
damage O
the O
physical O
or O
cyber O
world O
. O
 
Our O
mission O
is O
simple O
: O
to O
protect O
the O
world O
. O
 
This O
report O
is O
an O
attempt O
to O
deliver O
on O
that O
mission O
. O
 
After O
tracking O
hackers O
both O
personally O
and O
professionally O
for O
more O
than O
26 O
years O
, O
there O
is O
no O
doubt O
in O
my O
mind O
that O
the O
release O
of O
the O
information O
contained O
in O
the O
Operation O
Cleaver O
report O
is O
vital O
to O
the O
security O
of O
the O
world's O
critical O
infrastructure O
. O
 
The O
focus O
of O
the O
Operation O
Cleaver O
report O
is O
on O
one O
particular O
Iranian O
team O
we O
've O
dubbed O
Tarh O
Andishan O
, O
the O
infrastructure O
they O
utilize O
, O
as O
well O
as O
their O
tactics O
, O
techniques O
and O
procedures O
. O
 
Roughly O
translated O
, O
'' O
Tarh O
Andishan O
'' O
means O
'' O
thinkers O
'' O
or O
'' O
innovators O
'' O
. O
 
This O
team O
displays O
an O
evolved O
skillset O
and O
uses O
a O
complex O
infrastructure O
to O
perform O
attacks O
of O
espionage O
, O
theft O
, O
and O
the O
potential O
destruction O
of O
control O
systems O
and O
networks O
. O
 
While O
our O
investigation O
is O
ongoing O
, O
and O
we O
presently O
have O
limited O
visibility O
inside O
many O
of O
the O
compromised O
networks O
, O
Cylance O
observed O
Tarh O
Andishan O
actively O
targeting O
, O
attacking O
, O
and O
compromising O
more O
than O
50 O
victims O
since O
at O
least O
2012 O
. O
 
Cylance O
is O
committed O
to O
responsible O
disclosure O
and O
has O
refrained O
from O
exaggeration O
and O
embellishment O
in O
this O
report O
, O
limiting O
our O
content O
to O
only O
that O
which O
can O
be O
definitively O
confirmed O
. O
 
However O
, O
we O
have O
speculated O
on O
the O
possible O
motivations O
behind O
these O
attacks O
, O
given O
our O
deep O
knowledge O
and O
understanding O
of O
the O
cyber O
landscape O
. O
 
We O
have O
made O
every O
effort O
to O
notify O
all O
affected O
entities O
prior O
to O
publishing O
this O
report O
. O
 
Additionally O
, O
all O
personally O
identifiable O
information O
about O
the O
members O
of O
Operation O
Cleaver O
has O
been O
withheld O
. O
 
We O
do O
n't O
care O
who O
the O
adversary O
is O
, O
where O
they O
work O
or O
reside O
, O
who O
they O
're O
dating O
or O
what O
party O
photos O
they O
upload O
to O
Facebook O
– O
all O
we O
care O
about O
is O
preventing O
campaigns O
like O
Operation O
Cleaver O
from O
negatively O
affecting O
the O
real O
world O
. O
 
This O
report O
is O
for O
the O
world O
's O
cyber O
defenders O
– O
never O
give O
up O
! O
Since O
at O
least O
2012 O
, O
Iranian B-Entity
actors I-Entity
have O
directly O
attacked O
, O
established B-Action
persistence B-Entity
in B-Modifier
, O
and O
extracted B-Action
highly B-Entity
sensitive I-Entity
materials I-Entity
from B-Modifier
the B-Entity
networks I-Entity
of I-Entity
government I-Entity
agencies I-Entity
and I-Entity
major I-Entity
critical I-Entity
infrastructure I-Entity
companies I-Entity
in I-Entity
the I-Entity
following I-Entity
countries I-Entity
: I-Entity
Canada I-Entity
, I-Entity
China I-Entity
, I-Entity
England I-Entity
, I-Entity
France I-Entity
, I-Entity
Germany I-Entity
, I-Entity
India I-Entity
, I-Entity
Israel I-Entity
, I-Entity
Kuwait I-Entity
, I-Entity
Mexico I-Entity
, I-Entity
Pakistan I-Entity
, I-Entity
Qatar I-Entity
, I-Entity
Saudi I-Entity
Arabia I-Entity
, I-Entity
South I-Entity
Korea I-Entity
, I-Entity
Turkey I-Entity
, I-Entity
United I-Entity
Arab I-Entity
Emirates I-Entity
, I-Entity
and I-Entity
the I-Entity
United I-Entity
States I-Entity
. O
 
Iran O
is O
the O
new O
China O
. O
 
Operation B-Entity
Cleaver I-Entity
has O
, O
over O
the O
past O
several O
years O
, O
conducted B-Action
a B-Entity
significant I-Entity
global I-Entity
surveillance I-Entity
and I-Entity
infiltration I-Entity
campaign I-Entity
. O
 
To O
date O
it B-Entity
has O
successfully O
evaded B-Action
detection B-Entity
by I-Entity
existing I-Entity
security I-Entity
technologies I-Entity
. O
 
The O
group O
is O
believed O
to O
work O
from O
Tehran O
, O
Iran O
, O
although O
auxiliary O
team O
members O
were O
identified O
in O
other O
locations O
including O
the O
Netherlands O
, O
Canada O
, O
and O
the O
UK O
. O
 
The O
group O
successfully O
leveraged O
both O
publicly O
available O
, O
and O
customized O
tools O
to O
attack O
and O
compromise O
targets O
around O
the O
globe O
. O
 
The O
targets O
include O
military O
, O
oil O
and O
gas O
, O
energy O
and O
utilities O
, O
transportation O
, O
airlines O
, O
airports O
, O
hospitals O
, O
telecommunications O
, O
technology O
, O
education O
, O
aerospace O
, O
Defense O
Industrial O
Base O
( O
DIB O
) O
, O
chemical O
companies O
, O
and O
governments O
. O
 
During O
intense O
intelligence O
gathering O
over O
the O
last O
24 O
months O
, O
we O
observed O
the O
technical O
capabilities O
of O
the O
Operation O
Cleaver O
team O
rapidly O
evolve O
faster O
than O
any O
previously O
observed O
Iranian O
effort O
. O
 
As O
Iran O
's O
cyber O
warfare O
capabilities O
continue O
to O
morph O
, O
the O
probability O
of O
an O
attack O
that O
could O
impact O
the O
physical O
world O
at O
a O
national O
or O
global O
level O
is O
rapidly O
increasing O
. O
 
Their O
capabilities O
have O
advanced O
beyond O
simple O
website O
defacements O
, O
Distributed O
Denial O
of O
Service O
( O
DDoS O
) O
attacks O
, O
and O
Hacking O
Exposed O
style O
techniques O
. O
 
With O
minimal O
separation O
between O
private O
companies O
and O
the O
Iranian O
government O
, O
their O
modus O
operandi O
seems O
clear O
: O
blur O
the O
line O
between O
legitimate O
engineering O
companies O
and O
state- O
sponsored O
cyber O
hacking O
teams O
to O
establish O
a O
foothold O
in O
the O
world O
's O
critical O
infrastructure O
. O
 
Iran O
's O
rising O
expertise O
, O
along O
with O
their O
choice O
of O
victims O
, O
has O
compelled O
us O
to O
release O
this O
report O
sooner O
than O
we O
would O
have O
liked O
in O
order O
to O
expose O
Operation O
Cleaver O
to O
the O
world O
. O
 
The O
evidence O
and O
indicators O
of O
compromise O
we O
provide O
in O
this O
report O
will O
allow O
potentially O
unaware O
victims O
to O
detect O
and O
eliminate O
Cleaver O
's O
incursions O
into O
their O
networks O
. O
 
Iran O
has O
been O
severely O
impacted O
by O
debilitating O
and O
extremely O
advanced O
malware O
campaigns O
since O
at O
least O
2009 O
. O
 
Famous B-Entity
examples I-Entity
of I-Entity
these I-Entity
efforts I-Entity
include B-Action
industrial B-Entity
sabotage I-Entity
via B-Modifier
Stuxnet B-Entity
( I-Entity
2009 I-Entity
- I-Entity
2010 I-Entity
) I-Entity
, O
and O
espionage B-Entity
with B-Modifier
Duqu B-Entity
( I-Entity
2009 I-Entity
- I-Entity
2011 I-Entity
) I-Entity
as I-Entity
well I-Entity
as I-Entity
Flame I-Entity
( I-Entity
2012 I-Entity
) I-Entity
. O
 
These O
campaigns O
have O
targeted O
Iran's O
nuclear O
program O
, O
and O
oil O
and O
gas O
operations O
. O
 
Stuxnet B-Entity
was O
an O
eye-opening O
event O
for O
Iranian O
authorities O
, O
exposing B-Action
them B-Entity
to B-Modifier
the B-Entity
world I-Entity
of I-Entity
physical I-Entity
destruction I-Entity
via I-Entity
electronic I-Entity
means I-Entity
. O
 
Hacking O
campaigns O
sourced O
out O
of O
Iran O
are O
nothing O
new O
. O
 
Since O
the O
early O
2000 O
's O
, O
the O
information O
security O
industry O
as O
a O
whole O
has O
tracked O
teams O
like O
the O
Iranian O
Cyber O
Army O
, O
which O
mainly O
focuses O
on O
patriotic O
hacking O
( O
website O
defacements O
) O
. O
 
After O
the O
release O
of O
Stuxnet O
, O
Iran O
's O
motivations O
appear O
to O
have O
shifted O
. O
 
Retaliation O
for O
Stuxnet O
began O
almost O
immediately O
in O
2011 O
with O
campaigns O
like O
the O
certificate O
compromises O
of O
Comodo O
and O
DigiNotar O
. O
 
These O
attacks O
served O
as O
a O
warning O
, O
showcasing O
the O
rapid O
evolution O
of O
Iran O
's O
hacking O
skills O
. O
 
A O
major O
retaliation O
came O
in O
the O
form O
of O
2012 O
's O
Shamoon O
campaign O
, O
which O
impacted O
RasGas O
and O
Saudi O
Aramco O
. O
 
It O
's O
estimated O
that O
Shamoon O
impacted O
over O
30,000 O
computer O
endpoints O
and O
cost O
the O
affected O
companies O
tens-of-thousands O
of O
hours O
recovering O
from O
the O
attacks O
. O
 
The O
direct O
financial O
impact O
from O
this O
retaliation O
and O
amount O
of O
downtime O
experienced O
were O
staggering O
. O
 
Shamoon O
was O
truly O
a O
watershed O
event O
for O
security O
defenders O
. O
 
It O
was O
the O
first O
glimpse O
into O
the O
real O
capabillity O
and O
intention O
of O
Iranian O
cyber O
operations O
. O
 
We O
see O
the O
same O
motivation O
and O
intent O
here O
in O
Operation O
Cleaver O
: O
establishing O
a O
beachhead O
for O
cyber O
sabotage O
. O
 
We O
saw O
further O
Iranian O
backlash O
in O
late O
2012 O
and O
early O
2013 O
in O
the O
form O
of O
Operation O
Ababil's O
Distributed O
Denial O
of O
Service O
( O
DDoS O
) O
attacks O
against O
US O
banks O
. O
 
These B-Entity
attacks I-Entity
were O
debilitating O
and O
impacted B-Action
the B-Entity
availability I-Entity
of I-Entity
online I-Entity
banking I-Entity
services I-Entity
. O
 
Yet O
more O
backlash O
was O
witnessed O
with O
FireEye's O
exposure O
of O
Operation O
Saffron O
Rose O
, O
an O
espionage O
campaign O
executed O
by O
the O
Ajax O
Security O
Team O
in O
2014 O
. O
 
In O
May O
2014 O
, O
evidence O
emerged O
of O
a B-Entity
highly I-Entity
targeted I-Entity
waterhole I-Entity
attack I-Entity
that O
leveraged B-Action
social B-Entity
media I-Entity
, O
dubbed O
Operation O
Newscaster O
, O
which O
was O
uncovered O
by O
iSight O
Partners O
. O
 
In O
June O
2013 O
, O
Israeli O
Prime O
Minister O
Benjamin O
Netanyahu O
accused O
Iran O
of O
carrying O
out O
'' O
non-stop O
'' O
attacks O
on O
'' O
[ O
Israel O
's O
] O
vital O
national O
systems O
'' O
including O
'' O
water O
, O
power O
and O
banking O
'' O
. O
 
The O
following O
September O
of O
2013 O
, O
the O
Wall O
Street O
Journal O
accused O
Iran O
of O
hacking O
into O
unclassified O
U.S. O
Navy O
computers O
in O
San O
Diego O
's O
NMCI O
( O
Navy O
Marine O
Corp O
Intranet O
) O
,5 O
which O
we O
can O
confirm O
was O
part O
of O
Operation O
Cleaver O
. O
 
While O
previously O
reported O
operations O
attributed O
to O
Iran O
have O
largely O
focused O
on O
Defense O
Industrial O
Base O
( O
DIB O
) O
companies O
, O
the O
United O
States O
Federal O
Government O
, O
or O
targets O
in O
Middle O
Eastern O
countries O
, O
Operation O
Cleaver O
has O
instead O
focused O
on O
a O
wide O
array O
of O
targets O
, O
including O
energy O
producers O
and O
utilities O
, O
commercial O
airlines O
and O
airports O
, O
military O
intelligence O
, O
aerospace O
, O
hospitals O
, O
and O
even O
universities O
– O
with O
only O
ten O
of O
the O
targets O
based O
in O
the O
United O
States O
. O
 
Such O
broad O
targeting O
demonstrates O
to O
the O
world O
that O
Iran O
is O
no O
longer O
content O
to O
retaliate O
against O
the O
US O
and O
Israel O
alone O
. O
 
They O
have O
bigger O
intentions O
: O
to O
position O
themselves O
to O
impact O
critical O
infrastructure O
globally O
. O
 
The O
string O
cleaver O
is O
found O
several O
times O
in O
a O
variety O
of O
custom O
software O
used O
in O
Operation O
Cleaver O
, O
including O
: O
We O
believe O
our O
visibility O
into O
this O
campaign O
represents O
only O
a O
fraction O
of O
Operation O
Cleaver O
's O
full O
scope O
. O
 
We O
believe O
that O
if O
the O
operation O
is O
left O
to O
continue O
unabated O
, O
it O
is O
only O
a O
matter O
of O
time O
before O
the O
world O
's O
physical O
safety O
is O
impacted O
by O
it O
. O
 
While O
the O
disclosure O
of O
this O
information O
will O
be O
a O
detriment O
to O
our O
ability O
to O
track O
the O
activity O
of O
this O
group O
, O
it O
will O
allow O
the O
security O
industry O
as O
a O
whole O
to O
defend O
against O
this O
threat O
. O
 
As O
such O
, O
we O
are O
exposing O
this O
cyber O
campaign O
early O
in O
an O
attempt O
to O
minimize O
additional O
real-world O
impact O
and O
prevent O
further O
victimization O
. O
 
• O
Persian O
hacker O
names O
are O
used O
throughout O
the O
campaign O
including O
: O
Salman O
Ghazikhani O
, O
Bahman O
Mohebbi O
, O
Kaj O
, O
Parviz O
, O
Alireza O
, O
and O
numerous O
others O
. O
 
• O
Numerous O
domains O
used O
in O
the O
campaign O
were O
registered O
in O
Iran O
. O
 
• O
Infrastructure O
leveraged O
in O
the O
attack O
was O
registered O
in O
Iran O
to O
the O
corporate O
entity O
Tarh O
Andishan O
, O
which O
translates O
to O
'' O
invention O
'' O
or O
'' O
innovation O
'' O
in O
Farsi O
. O
 
• O
Source O
netblocks O
and O
ASNs O
are O
registered O
to O
Iran O
. O
 
• O
Hacker O
tools O
warn O
when O
their O
external O
IP O
address O
traces O
back O
to O
Iran O
. O
 
• O
The O
infrastructure O
is O
hosted O
through O
Netafraz.com O
, O
an O
Iranian O
provider O
out O
of O
Isfahan O
, O
Iran O
. O
 
• O
The O
infrastructure O
utilized O
in O
the O
campaign O
is O
too O
significant O
to O
be O
a O
lone O
individual O
or O
a O
small O
group O
. O
 
We O
believe O
this O
work O
was O
sponsored O
by O
Iran O
. O
 
• O
US O
Military O
targets O
including O
NMCI O
in O
October O
2013 O
. O
 
Confirmed O
targeting O
of O
global O
government O
entities O
. O
 
• O
Networks O
and O
systems O
targeted O
in O
critical O
industries O
like O
energy O
and O
utilities O
, O
oil O
and O
gas O
, O
and O
chemical O
companies O
. O
 
• O
Assets B-Entity
( I-Entity
both I-Entity
cyber I-Entity
and I-Entity
physical I-Entity
) I-Entity
and I-Entity
logistics I-Entity
information I-Entity
were B-Action
compromised I-Action
at B-Modifier
major B-Entity
airline I-Entity
operators I-Entity
, I-Entity
airports I-Entity
, I-Entity
and I-Entity
transportation I-Entity
companies I-Entity
. O
 
• O
Various O
global O
telecommunications O
, O
technology O
, O
healthcare O
, O
aerospace O
, O
and O
defense O
companies O
were O
breached O
as O
part O
of O
the O
operation O
. O
 
• O
Confidential B-Entity
critical I-Entity
infrastructure I-Entity
documents I-Entity
were B-Action
harvested I-Action
from B-Modifier
major B-Entity
educational I-Entity
institutions I-Entity
around I-Entity
the I-Entity
world I-Entity
. O
 
• O
Initial B-Entity
compromise I-Entity
techniques I-Entity
include B-Action
SQL B-Entity
injection I-Entity
, I-Entity
web I-Entity
attacks I-Entity
, I-Entity
and I-Entity
creative I-Entity
deception- I-Entity
based I-Entity
attacks I-Entity
– O
all O
of O
which O
have O
been O
implemented O
in O
the O
past O
by O
Chinese O
and O
Russian O
hacking O
teams O
. O
 
• O
Pivoting B-Entity
and I-Entity
exploitation I-Entity
techniques I-Entity
leveraged B-Action
existing B-Entity
public I-Entity
exploits I-Entity
for I-Entity
MS08-067 I-Entity
and I-Entity
Windows I-Entity
privilege I-Entity
escalations I-Entity
, O
and O
were B-Action
coupled I-Action
with B-Modifier
automated B-Entity
, I-Entity
worm-like I-Entity
propagation I-Entity
mechanisms I-Entity
. O
 
• O
Customized B-Entity
private I-Entity
tools I-Entity
with I-Entity
functions I-Entity
that O
include B-Action
ARP B-Entity
poisoning I-Entity
, O
encryption B-Entity
, O
credential B-Entity
dumping I-Entity
, O
ASP.NET B-Entity
shells I-Entity
, O
web B-Entity
backdoors I-Entity
, O
process B-Entity
enumeration I-Entity
, O
WMI B-Entity
querying I-Entity
, O
HTTP B-Entity
and I-Entity
SMB I-Entity
communications I-Entity
, O
network B-Entity
interface I-Entity
sniffing I-Entity
, O
and O
keystroke B-Entity
logging I-Entity
. O
 
• O
The O
ability O
to O
build O
customized O
tools O
to O
compromise O
any O
target O
they O
choose O
. O
 
• O
Private B-Entity
signing I-Entity
certificates I-Entity
of I-Entity
one I-Entity
victim I-Entity
were B-Action
captured I-Action
allowing O
the B-Entity
Operation I-Entity
Cleaver I-Entity
team I-Entity
to O
compromise B-Action
the B-Entity
entirety I-Entity
of I-Entity
their I-Entity
organization I-Entity
. O
 
• O
Over O
the O
past O
two O
years O
, O
Cylance O
has O
collected O
over O
8GB O
of O
data O
including O
over O
80,000 O
files O
of O
exfiltrated O
data O
, O
hacker O
tools O
, O
victim O
logs O
, O
and O
highly O
sensitive O
reconnaissance O
data O
. O
 
• O
Data O
from O
sinkholed O
command O
and O
control O
servers O
has O
allowed O
us O
to O
track O
this O
active O
campaign O
. O
 
• O
Cylance O
is O
releasing O
more O
than O
150 O
IOCs O
and O
samples O
associated O
with O
the O
Cleaver O
campaign O
to O
empower O
the O
security O
community O
to O
detect O
existing O
compromises O
in O
their O
own O
organizations O
, O
as O
well O
as O
potentially O
block O
future O
attacks O
from O
these O
teams O
. O
 
• O
This O
campaign O
continues O
Iran O
's O
retaliation O
for O
Stuxnet O
, O
Duqu O
, O
and O
Flame O
. O
 
• O
This O
is O
a O
state-sponsored O
campaign O
. O
 
• O
There O
is O
a O
possibility O
that O
this O
campaign O
could O
affect O
airline O
passenger O
safety O
. O
 
• O
This O
campaign O
's O
intentions O
may O
be O
to O
damage O
Industrial O
Control O
Systems O
( O
ICS O
) O
, O
Supervisory O
Control O
and O
Data O
Acquisition O
( O
SCADA O
) O
systems O
, O
and O
impact O
Critical O
Infrastructure O
and O
Key O
Resources O
( O
CIKR O
) O
. O
 
• O
This O
campaign O
could O
be O
a O
way O
to O
demonstrate O
Iran O
's O
cyber O
capabilities O
for O
additional O
geopolitical O
leverage O
, O
due O
to O
the O
breadth O
and O
depth O
of O
their O
global O
targets O
. O
 
• O
There O
is O
an O
intense O
focus O
on O
CIKR O
companies O
in O
South O
Korea O
, O
which O
could O
give O
Iran O
additional O
clout O
in O
their O
burgeoning O
partnership O
with O
North O
Korea O
. O
 
In O
September O
2012 O
, O
Iran O
signed O
an O
extensive O
agreement O
for O
technology O
cooperation O
agreement O
with O
North O
Korea O
, O
which O
would O
allow O
for O
collaboration O
on O
various O
efforts O
including O
IT O
and O
security O
. O
 
• O
Iran O
is O
recruiting O
from O
within O
the O
universities O
and O
potentially O
using O
'hackers O
for O
hire O
' O
. O
 
The O
Cleaver O
team O
targets O
some O
of O
the O
most O
sensitive O
global O
critical O
infrastructure O
companies O
in O
the O
world O
, O
including O
military O
, O
oil O
and O
gas O
, O
airlines O
, O
airports O
, O
energy O
producers O
, O
utilities O
, O
transportation O
, O
healthcare O
, O
telecommunications O
, O
technology O
, O
manufacturing O
, O
education O
, O
aerospace O
, O
Defense O
Industrial O
Base O
( O
DIB O
) O
, O
chemical O
companies O
and O
governments O
. O
 
Countries O
impacted O
include O
Canada O
, O
China O
, O
England O
, O
France O
, O
Germany O
, O
India O
, O
Israel O
, O
Kuwait O
, O
Mexico O
, O
Pakistan O
, O
Qatar O
, O
Saudi O
Arabia O
, O
South O
Korea O
, O
Turkey O
, O
United O
Arab O
Emirates O
, O
and O
the O
US O
. O
 
The O
following O
is O
a O
breakdown O
by O
country O
of O
which O
industries O
were O
targeted O
and/or O
victimized O
: O
Cleaver B-Entity
's I-Entity
level I-Entity
of I-Entity
access I-Entity
into I-Entity
each I-Entity
organization I-Entity
varied O
greatly O
, O
including B-Action
completely B-Entity
compromised I-Entity
systems I-Entity
and I-Entity
networks I-Entity
, O
Active B-Entity
Directory I-Entity
domain I-Entity
controllers I-Entity
and I-Entity
credentials I-Entity
, O
compromised B-Entity
data I-Entity
repositories I-Entity
and O
stolen B-Entity
VPN I-Entity
credentials I-Entity
. O
 
Compromised B-Entity
systems I-Entity
include B-Action
Microsoft B-Entity
Windows I-Entity
web I-Entity
servers I-Entity
running I-Entity
IIS I-Entity
and I-Entity
ColdFusion I-Entity
, I-Entity
Apache I-Entity
with I-Entity
PHP I-Entity
, I-Entity
many I-Entity
variants I-Entity
of I-Entity
Microsoft I-Entity
Windows I-Entity
desktops I-Entity
and I-Entity
servers I-Entity
, I-Entity
and I-Entity
Linux I-Entity
servers I-Entity
. O
 
Compromised B-Entity
network I-Entity
infrastructure I-Entity
included B-Action
Cisco B-Entity
VPNs I-Entity
as I-Entity
well I-Entity
as I-Entity
Cisco I-Entity
switches I-Entity
and I-Entity
routers I-Entity
. O
 
Unlike O
Stuxnet O
, O
no O
exotic O
exploitations O
( O
such O
as O
0-days O
) O
were O
observed O
. O
 
Within O
our O
investigation O
, O
we O
had O
no O
direct O
evidence O
of O
a O
successful O
compromise O
of O
specific O
Industrial O
Control O
Systems O
( O
ICS O
) O
or O
Supervisory O
Control O
and O
Data O
Acquisition O
( O
SCADA O
) O
networks O
, O
but O
Cleaver B-Entity
did O
exfiltrate B-Action
extremely B-Entity
sensitive I-Entity
data I-Entity
from B-Modifier
many B-Entity
critical I-Entity
infrastructure I-Entity
companies I-Entity
allowing O
them O
to O
directly O
affect O
the O
systems O
they O
run O
. O
 
This O
data O
could O
enable O
them B-Entity
, I-Entity
or I-Entity
affiliated I-Entity
organizations I-Entity
, O
to O
target B-Action
and I-Action
potentially I-Action
sabotage I-Action
ICS B-Entity
and I-Entity
SCADA I-Entity
environments I-Entity
with B-Modifier
ease B-Entity
. O
 
We O
discovered O
over O
50 O
victims O
in O
our O
investigation O
, O
distributed O
around O
the O
globe O
. O
 
Ten O
of O
these O
victims O
are O
headquartered O
in O
the O
US O
and O
include O
a O
major O
airline O
, O
a O
medical O
university O
, O
an O
energy O
company O
specializing O
in O
natural O
gas O
production O
, O
an O
automobile O
manufacturer O
, O
a O
large O
defense O
contractor O
, O
and O
a O
major O
military O
installation O
. O
 
The O
four O
targets O
in O
Israel O
and O
the O
five O
targets O
in O
Pakistan O
are O
comprised O
of O
education O
, O
aerospace O
, O
airports O
, O
airlines O
, O
healthcare O
and O
technology O
. O
 
Further O
victims O
were O
identified O
in O
numerous O
Middle O
Eastern O
countries O
as O
well O
as O
ones O
in O
Northern O
Europe O
including O
the O
UK O
, O
France O
, O
and O
Germany O
. O
 
Central O
America O
was O
not O
immune O
either O
with O
a O
large O
oil O
and O
gas O
company O
on O
the O
list O
. O
 
In O
fact O
, O
oil O
and O
gas O
was O
a O
particular O
focal O
point O
for O
the O
Cleaver O
team O
, O
going O
after O
no O
less O
than O
nine O
of O
these O
companies O
around O
the O
world O
. O
 
Universities O
were O
targeted O
in O
the O
US O
, O
India O
, O
Israel O
, O
and O
South O
Korea O
. O
 
The B-Entity
attackers I-Entity
targeted B-Action
research B-Entity
efforts I-Entity
, I-Entity
student I-Entity
information I-Entity
, I-Entity
student I-Entity
housing I-Entity
, I-Entity
and I-Entity
financial I-Entity
aid I-Entity
systems I-Entity
. O
 
They O
had O
a O
penchant O
for O
pictures O
, O
passports O
, O
and O
any O
specifc O
identifying O
information O
. O
 
Perhaps O
the O
most O
bone-chilling O
evidence O
we O
collected O
in O
this O
campaign O
was O
the O
targeting O
and O
compromise O
of O
transportation O
networks O
and O
systems O
such O
as O
airlines O
and O
airports O
in O
South O
Korea O
, O
Saudi O
Arabia O
and O
Pakistan O
. O
 
The O
level O
of O
access O
seemed O
ubiquitous O
: O
Active B-Entity
Directory I-Entity
domains I-Entity
were B-Action
fully I-Action
compromised I-Action
, O
along B-Modifier
with I-Modifier
entire B-Entity
Cisco I-Entity
Edge I-Entity
switches I-Entity
, I-Entity
routers I-Entity
, I-Entity
and I-Entity
internal I-Entity
networking I-Entity
infrastructure I-Entity
. O
 
Fully B-Entity
compromised I-Entity
VPN I-Entity
credentials I-Entity
meant B-Action
their B-Entity
entire I-Entity
remote I-Entity
access I-Entity
infrastructure I-Entity
and I-Entity
supply I-Entity
chain I-Entity
was I-Entity
under I-Entity
the I-Entity
control I-Entity
of I-Entity
the I-Entity
Cleaver I-Entity
team I-Entity
, O
allowing B-Action
permanent B-Entity
persistence I-Entity
under B-Modifier
compromised B-Entity
credentials I-Entity
. O
 
They B-Entity
achieved B-Action
complete B-Entity
access I-Entity
to I-Entity
airport I-Entity
gates I-Entity
and I-Entity
their I-Entity
security I-Entity
control I-Entity
systems I-Entity
, O
potentially O
allowing B-Action
them B-Entity
to B-Modifier
spoof B-Entity
gate I-Entity
credentials I-Entity
. O
 
They B-Entity
gained B-Action
access B-Entity
to I-Entity
PayPal I-Entity
and I-Entity
Go I-Entity
Daddy I-Entity
credentials I-Entity
allowing B-Action
them B-Entity
to B-Modifier
make B-Entity
fraudulent I-Entity
purchases I-Entity
and O
allowed B-Action
unfettered B-Entity
access I-Entity
to I-Entity
the I-Entity
victim I-Entity
's I-Entity
domains I-Entity
. O
 
We O
were O
witnessed O
a O
shocking O
amount O
of O
access O
into O
the O
deepest O
parts O
of O
these O
companies O
and O
the O
airports O
in O
which O
they O
operate O
. O
 
Despite O
today O
's O
trend O
toward O
attacker O
attribution O
, O
we O
believe O
it O
offers O
little O
real O
benefit O
to O
the O
day-to-day O
cyber O
defender O
. O
 
However O
, O
in O
this O
report O
we O
offer O
our O
observations O
on O
the O
sources O
of O
Operation O
Cleaver O
in O
order O
to O
benefit O
those O
that O
rely O
on O
attribution O
such O
as O
Law O
Enforcement O
. O
 
Operation O
Cleaver O
is O
believed O
to O
consist O
of O
at O
least O
20 O
hackers O
and O
developers O
, O
collaborating O
on O
projects O
and O
missions O
to O
support O
Iranian O
interests O
. O
 
Many O
of O
the O
targets O
were O
predominately O
English-speaking O
and O
a O
majority O
of O
the O
team O
members O
were O
capable O
of O
reading O
and O
writing O
in O
English O
. O
 
We O
present O
evidence O
that O
this O
team O
is O
operating O
, O
at O
least O
in O
part O
, O
out O
of O
Iran O
and O
in O
the O
interests O
of O
Iran O
. O
 
The O
skills O
and O
behavior O
of O
the O
Operation O
Cleaver O
teams O
are O
consistent O
with O
, O
and O
in O
one O
case O
surpasses O
, O
Iran O
's O
cyber O
capabilities O
as O
we O
know O
them O
today O
. O
 
For O
a O
complete O
list O
of O
IPs O
and O
domains O
related O
to O
this O
campaign O
, O
please O
refer O
to O
the O
Indicators O
of O
Compromise O
section O
. O
 
Over O
the O
course O
of O
multiple O
incident O
response O
engagements O
related O
to O
Operation O
Cleaver O
, O
we O
were O
able O
to O
identify O
a B-Entity
small I-Entity
set I-Entity
of I-Entity
IP I-Entity
addresses I-Entity
which O
were B-Action
commonly I-Action
used I-Action
during B-Modifier
the B-Entity
initial I-Entity
stages I-Entity
of I-Entity
an I-Entity
attack I-Entity
. O
 
The B-Entity
IP I-Entity
address I-Entity
78.109.194.114 I-Entity
served B-Action
as B-Modifier
a B-Entity
source I-Entity
for I-Entity
one I-Entity
of I-Entity
the I-Entity
primary I-Entity
attackers I-Entity
. O
 
They B-Entity
were O
observed O
conducting B-Action
SQL B-Entity
injections I-Entity
, O
controlling B-Action
backdoors B-Entity
, O
as O
well O
as O
exfiltrating B-Action
information B-Entity
using B-Modifier
this B-Entity
address I-Entity
, O
and O
the O
address O
appears O
in O
multiple O
software O
configurations O
recovered O
from O
staging O
servers O
over O
a O
period O
of O
time O
. O
 
This O
IP O
address O
was O
also O
observed O
in O
multiple O
software O
configurations O
. O
 
This O
particular O
net O
block O
was O
used O
over O
an O
extended O
period O
of O
time O
, O
indicating O
these O
were O
under O
the O
Cleaver O
team's O
physical O
control O
. O
 
Additionally O
, O
prior O
netblocks O
used O
by O
the O
same O
team O
demonstrated O
to O
us O
that O
this O
was O
n't O
simply O
a O
case O
of O
proxying O
or O
'' O
island O
hopping O
'' O
. O
 
For O
more O
information O
see O
the O
Tarh O
Andishan O
section O
of O
this O
report O
. O
 
The B-Entity
IP I-Entity
address I-Entity
159.253.144.209 I-Entity
was B-Action
a B-Entity
source I-Entity
for I-Entity
a I-Entity
secondary I-Entity
attacker I-Entity
in I-Entity
various I-Entity
compromises I-Entity
. O
 
They B-Entity
were O
observed O
conducting B-Action
SQL B-Entity
injection I-Entity
attacks I-Entity
. O
 
While O
this O
IP O
was O
this O
registered O
in O
the O
Netherlands O
, O
we O
believe O
they O
used O
Softlayer O
's O
Citrix O
demo O
environment O
to O
launch O
these O
attacks O
which O
is O
consistent O
with O
proxying O
or O
'' O
island O
hopping O
'' O
. O
 
A O
number O
of O
Cleaver O
's O
attack O
methods O
require O
a O
persistent O
server O
. O
 
In O
many O
cases O
, O
these O
servers O
were O
referenced O
by O
domain O
names O
. O
 
The O
following O
malicious O
domains O
are O
operated O
by O
this O
organization O
and O
are O
grouped O
by O
the O
registrant O
's O
email O
address O
. O
 
As O
is O
typical O
with O
malicious O
domains O
, O
the O
Whois O
data O
for O
most O
of O
these O
domains O
contained O
falsified O
information O
. O
 
We O
managed O
to O
obtain O
a O
large O
collection O
of O
the O
internally O
developed O
tools O
used O
by O
the O
Cleaver O
team O
, O
many O
of O
which O
were O
developed O
by O
its O
members O
. O
 
Due O
to O
operational O
security O
failures O
, O
these O
tools O
contain O
information O
that O
provided O
us O
insight O
into O
their O
organization O
and O
operations O
. O
 
In O
the O
tool O
named O
Shell O
Creator O
2 O
, O
there O
are O
three O
main O
components O
. O
 
The B-Entity
creator I-Entity
generates B-Action
an B-Entity
ASPX I-Entity
web I-Entity
shell I-Entity
using B-Modifier
user B-Entity
input I-Entity
as I-Entity
well I-Entity
as I-Entity
a I-Entity
collection I-Entity
of I-Entity
templates I-Entity
. O
 
The B-Entity
web I-Entity
shell I-Entity
could O
then O
be B-Action
installed I-Action
via B-Modifier
xpcmdshell B-Entity
, I-Entity
or I-Entity
any I-Entity
other I-Entity
method I-Entity
which I-Entity
would I-Entity
grant I-Entity
the I-Entity
attacker I-Entity
write I-Entity
access I-Entity
. O
 
The O
web O
shell O
is O
accessible O
by O
the O
shell O
client O
directly O
. O
 
The O
shell O
client O
is O
a O
portion O
of O
Shell O
Creator O
2 O
that O
was O
not O
designed O
to O
be O
run O
on O
a O
compromised O
computer O
. O
 
We O
originally O
located O
it O
on O
a B-Entity
staging I-Entity
server I-Entity
being B-Action
utilized I-Action
for B-Modifier
multiple B-Entity
attacks I-Entity
as I-Entity
well I-Entity
as I-Entity
a I-Entity
tool I-Entity
for I-Entity
sharing I-Entity
data I-Entity
between I-Entity
members I-Entity
of I-Entity
the I-Entity
organization I-Entity
's I-Entity
team I-Entity
. O
 
The O
shell O
client O
, O
which O
is O
developed O
in O
Java O
and O
is O
easily O
decompiled O
, O
is O
a O
simple O
interface O
with O
a O
feature O
to O
protect O
the O
operator O
from O
making O
a O
critical O
mistake O
. O
 
When O
executed O
, O
and O
before O
any O
connection O
to O
an O
instance O
of O
the O
web O
shell O
is O
initiated O
, O
the B-Entity
shell I-Entity
client I-Entity
communicates B-Action
with B-Modifier
freegeoip.net B-Entity
in B-Modifier
order I-Modifier
to I-Modifier
get B-Entity
the I-Entity
external I-Entity
IP I-Entity
address I-Entity
of I-Entity
the I-Entity
current I-Entity
user I-Entity
. O
 
The O
country O
of O
origin O
is O
then O
shown O
to O
the O
user O
, O
to O
inform O
them O
of O
what O
country O
it O
appears O
they O
are O
connecting O
from O
. O
 
The O
assumed O
purpose O
of O
this O
feature O
is O
to O
ensure O
that O
a O
proper O
proxy O
is O
in O
use O
, O
and O
the O
real O
origin O
of O
the O
attacker O
is O
not O
revealed O
. O
 
After O
decompiling O
the O
shell O
client O
, O
we O
found O
the O
following O
code O
segment O
controlling O
the O
display O
of O
this O
IP O
location O
information O
. O
 
This O
code O
handles O
the O
XML O
response O
from O
freegeoip.net O
, O
and O
displays O
the O
information O
as O
different O
colors O
based O
on O
different O
attributes O
. O
 
For O
instance O
, O
if O
the O
string O
'' O
ERROR O
'' O
is O
in O
the O
response O
, O
the O
text O
is O
displayed O
with O
the O
color O
magenta O
. O
 
If O
the O
string O
IRAN O
is O
in O
the O
response O
, O
the O
text O
is O
displayed O
with O
the O
color O
red O
. O
 
It O
should O
be O
noted O
that O
no O
other O
country O
name O
contains O
the O
substring O
IRAN O
. O
 
Net B-Entity
Crawler I-Entity
is O
a O
tool O
developed O
in O
C O
# O
that O
exhibits B-Action
worm-like B-Entity
behavior I-Entity
in O
order O
to O
gather B-Action
cached B-Entity
credentials I-Entity
from B-Modifier
any B-Entity
and I-Entity
all I-Entity
accessible I-Entity
computers I-Entity
on I-Entity
an I-Entity
infected I-Entity
network I-Entity
. O
 
This O
is O
done O
with O
Windows O
Credential O
Editor O
( O
WCE O
) O
and O
Mimikatz O
in O
combination O
with O
PsExec O
. O
 
Different O
versions O
of O
this O
malware O
contain O
ASCII O
art O
which O
names O
the O
authoring O
group O
as O
Zhoupin O
( O
in O
'' O
leetspeak O
'' O
as O
'' O
Zh0up O
! O
n O
'' O
) O
. O
 
For O
more O
information O
on O
Net O
Crawler O
, O
see O
the O
Tactics O
, O
Techniques O
and O
Procedures O
section O
. O
 
TinyZBot O
is O
a O
bot O
written O
in O
C O
# O
and O
developed O
by O
the O
Cleaver O
team O
. O
 
It O
is O
the O
longest O
developed O
malware O
family O
discovered O
by O
this O
group O
, O
and O
has O
been O
used O
in O
campaigns O
for O
close O
to O
two O
years O
. O
 
How O
it O
operates O
can O
vary O
greatly O
from O
version O
to O
version O
. O
 
For O
a O
detailed O
technical O
analysis O
of O
TinyZBot O
, O
see O
the O
Tactics O
, O
Techniques O
and O
Procedures O
section O
. O
 
As O
TinyZBot O
is O
developed O
in O
C O
# O
, O
many O
versions O
can O
be O
decompiled O
to O
code O
very O
similar O
to O
their O
originals O
, O
including O
names O
of O
namespaces O
. O
 
Many B-Entity
versions I-Entity
were B-Action
obfuscated I-Action
with B-Modifier
a B-Entity
legitimate I-Entity
tool I-Entity
for I-Entity
developers I-Entity
named I-Entity
SmartAssembly I-Entity
, O
which O
makes O
the O
recovery O
of O
some O
names O
implausible O
. O
 
We O
obtained O
multiple O
versions O
from O
which O
we O
were O
able O
to O
recover O
many O
of O
the O
original O
names O
of O
variables O
and O
namespaces O
. O
 
In O
a O
number O
of O
these O
samples O
, O
the O
primary O
namespace O
for O
TinyZBot O
is O
named O
ZhoupinCleaver O
. O
 
In O
every O
version O
of O
TinyZBot O
that O
is O
not O
obfuscated O
, O
there O
is O
a O
code O
base O
referred O
to O
as O
Cleaver O
. O
 
This O
code O
base O
is O
also O
shared O
in O
other O
malware O
developed O
by O
this O
organization O
, O
such O
as O
Csext O
. O
 
PrivEsc O
is O
a O
blatant O
plagiarism O
of O
an O
existing O
exploit O
for O
Microsoft O
Windows O
released O
in O
January O
2010 O
called O
MS10-015 O
, O
'' O
Vulnerabilities O
in O
Windows O
Kernel O
Could O
Allow O
Escalation O
of O
Privilege O
'' O
, O
popularly O
known O
as O
the O
KiTrap0D O
exploit O
which O
was O
released O
publicly O
. O
 
The O
Cleaver O
team O
clearly O
modified O
the O
source O
code O
and O
compiled O
a O
new O
version O
. O
 
The O
only O
detectable O
modification O
was O
to O
change O
the O
original O
author O
's O
name O
to O
instead O
display O
the O
following O
: O
Zhopin O
Exploit O
Team O
This O
is O
not O
the O
only O
case O
of O
this O
team O
relabeling O
others O
' O
work O
as O
their O
own O
. O
 
Logger O
module O
is O
a O
component O
of O
the O
PVZ O
( O
PVZ O
is O
shorthand O
for O
Parviz O
, O
one O
of O
the O
members O
of O
the O
Cleaver O
team O
) O
bot O
tool O
chain O
. O
 
When O
executed O
, O
it B-Entity
will O
capture B-Action
the B-Entity
user I-Entity
's I-Entity
keystrokes I-Entity
and O
save B-Action
them B-Entity
to B-Modifier
a B-Entity
location I-Entity
which O
PVZ B-Entity
bot I-Entity
then O
exfiltrates B-Action
. O
 
The O
logger O
module O
binary O
's O
file O
description O
value O
is O
the O
following O
: O
Roughly O
translated O
from O
Persian O
, O
this O
text O
says O
: O
This O
text O
could O
potentially O
be O
a O
note O
intended O
to O
stay O
internal O
, O
or O
could O
be O
an O
attempt O
to O
persuade O
an O
unsuspecting O
victim O
to O
assume O
the O
file O
is O
not O
malicious O
. O
 
The O
Product O
Name O
value O
is O
GOOD O
FILE O
. O
 
For O
more O
information O
on O
the O
PVZ O
bot O
tool O
chain O
, O
see O
the O
Tactics O
, O
Techniques O
, O
and O
Procedures O
section O
. O
 
CCProxy O
is O
a O
publicly O
available O
proxy O
server O
for O
Windows O
, O
which O
can O
handle O
a O
variety O
of O
protocols O
. O
 
We O
do O
not O
believe O
that O
this O
organization O
was O
involved O
in O
the O
development O
or O
modification O
of O
CCProxy O
, O
but O
they O
have O
been O
observed O
using O
it O
. O
 
We O
recovered O
a O
CCProxy O
configuration O
, O
which O
exposed O
various O
operational O
details O
. O
 
The O
configuration O
allowed O
for O
remote O
connections O
, O
limited O
by O
a O
username O
as O
well O
as O
a O
limited O
IP O
range O
. O
 
The O
username O
was O
User-001 O
, O
which O
is O
the O
default O
value O
. O
 
The O
limited O
IP O
range O
covered O
one O
IP O
: O
78.109.194.114 O
. O
 
This O
IP O
address O
is O
located O
in O
Iran O
, O
and O
is O
owned O
by O
Tarh O
Andishan O
. O
 
The O
configuration O
also O
indicates O
which O
address O
the O
CCProxy O
server O
should O
listen O
on O
for O
incoming O
connections O
such O
as O
web O
( O
80 O
) O
and O
mail O
( O
25 O
) O
. O
 
Log O
output O
from O
the O
network O
port O
scanning O
application O
NMAP O
was O
recovered O
from O
a O
staging O
server O
. O
 
This O
log O
was O
generated O
during O
the O
usage O
of O
the B-Entity
nbrute I-Entity
utility I-Entity
, O
which O
brute-forces B-Action
network B-Entity
credentials I-Entity
and O
relies O
on O
NMAP O
to O
do O
so O
. O
 
The O
header O
of O
this O
NMAP O
log O
indicates O
that O
the O
computer O
used O
to O
run O
nbrute/nmap O
was O
set O
to O
Iran O
Daylight O
Time O
at O
the O
time O
of O
execution O
. O
 
With O
no O
known O
victims O
located O
in O
Iran O
, O
it O
is O
likely O
that O
this O
was O
executed O
on O
an O
attacker O
's O
computer O
, O
and O
not O
on O
a O
victim O
's O
computer O
. O
 
A O
configuration O
file O
for O
a O
Squid O
proxy O
server O
was O
recovered O
. O
 
Figure O
12 O
: O
Squid O
configuration O
file O
showing O
the O
use O
of O
Tarh O
Andishan O
's O
IP O
address O
. O
 
The O
net O
range O
of O
78.109.194.114/28 O
was O
inserted O
into O
the O
allowed O
local O
networks O
with O
an O
RFC O
comment O
appended O
in O
order O
to O
make O
it O
look O
like O
it O
was O
part O
of O
the O
default O
configuration O
. O
 
It O
is O
likely O
this O
is O
the O
same O
reason O
a O
/28 O
net O
range O
was O
used O
, O
in O
order O
to O
not O
look O
like O
it O
was O
intended O
to O
only O
allow O
one O
IP O
. O
 
This O
would O
give O
the O
same O
access O
to O
resources O
accessible O
from O
the O
Squid O
proxy O
server O
to O
this O
Iranian O
IP O
address O
. O
 
Tarh O
Andishan O
is O
listed O
as O
the O
registrant O
for O
a O
number O
of O
small O
net O
blocks O
based O
upon O
the O
email O
address O
tarh.andishan O
( O
at O
) O
yahoo.com O
. O
 
The O
net O
blocks O
appear O
to O
rotate O
over O
time O
and O
registrant O
information O
is O
altered O
to O
accommodate O
ongoing O
operations O
and O
avoid O
potential O
public O
exposure O
. O
 
The O
networks O
are O
included O
below O
as O
well O
as O
the O
last O
time O
that O
net O
block O
was O
observed O
as O
active O
. O
 
There O
are O
many O
seemingly O
legitimate O
Tarh O
Andishan O
related O
companies O
inside O
Tehran O
, O
but O
strong O
connections O
to O
Iranian O
backing O
have O
been O
difficult O
to O
prove O
definitively O
. O
 
'' O
Tarh O
Andishan O
'' O
is O
often O
translated O
as O
'' O
Thinkers O
'' O
, O
'' O
Innovators O
'' O
and O
'' O
Inventors O
'' O
. O
 
The O
net O
blocks O
above O
have O
strong O
associations O
with O
state-owned O
oil O
and O
gas O
companies O
. O
 
These O
companies O
have O
current O
and O
former O
employees O
who O
are O
ICS O
experts O
. O
 
Tarh O
Andishan O
has O
been O
suspected O
in O
the O
past O
of O
launching O
attacks O
in O
the O
interest O
of O
Iran O
. O
 
The B-Entity
operators I-Entity
of I-Entity
the I-Entity
blog I-Entity
IranRedLine.org I-Entity
, I-Entity
which I-Entity
comments I-Entity
on I-Entity
Iran I-Entity
's I-Entity
nuclear I-Entity
weapons I-Entity
efforts I-Entity
, O
has O
mentioned B-Action
in B-Modifier
multiple B-Entity
posts I-Entity
having B-Entity
been I-Entity
the I-Entity
target I-Entity
of I-Entity
debilitating I-Entity
brute-force I-Entity
authentication I-Entity
attacks I-Entity
from I-Entity
IP I-Entity
addresses I-Entity
registered I-Entity
to I-Entity
the I-Entity
same I-Entity
Tarh I-Entity
Andishan I-Entity
team I-Entity
found I-Entity
in I-Entity
Cleaver I-Entity
. O
 
In O
one O
of O
IranRedLine.org O
's O
blog O
posts O
, O
the O
author O
speculates O
on O
Tarh O
Andishan O
's O
involvement O
with O
the O
Iranian O
government O
by O
showing O
close O
proximity O
to O
SPND O
, O
the O
Organization O
of O
Defensive O
Innovation O
and O
Research O
; O
however O
, O
the O
phone O
number O
listed O
under O
the O
registrant O
contact O
information O
has O
yet O
to O
be O
completely O
validated O
. O
 
During O
this O
investigation O
, O
we O
were O
able O
to O
compile O
a O
considerable O
amount O
of O
information O
on O
some O
of O
the O
members O
of O
this O
organization O
. O
 
The O
following O
profiles O
were O
built O
from O
reverse O
engineering O
, O
code O
analysis O
, O
open O
source O
intelligence O
, O
incident O
response O
and O
forensics O
work O
. O
 
Personally O
identifiable O
information O
about O
these O
members O
is O
not O
being O
shared O
publicly O
as O
it O
could O
endanger O
their O
lives O
and O
would O
be O
irresponsible O
. O
 
Parviz O
is O
a O
developer O
who O
worked O
on O
a O
variety O
of O
projects O
, O
and O
was O
primarily O
active O
in O
2013 O
. O
 
His O
development O
skillset O
is O
based O
around O
his O
ability O
to O
develop O
in O
C/C++ O
. O
 
He O
has O
been O
observed O
using O
Visual O
Studio O
2010 O
, O
and O
his O
tools O
are O
written O
exclusively O
for O
Windows O
. O
 
Some O
of O
his O
tools O
were O
found O
to O
be O
packed O
with O
ASPack O
. O
 
Parviz O
is O
the O
primary O
developer O
of O
the O
PVZ O
bot O
and O
multiple O
parts O
of O
its O
tool O
chain O
. O
 
Parviz O
is O
likely O
associated O
with O
the O
PVZ O
bot O
as O
his O
name O
in O
hardcoded O
into O
the O
PDB O
file O
paths O
. O
 
The B-Entity
PVZ I-Entity
tool I-Entity
chain I-Entity
includes B-Action
a O
variety O
of O
functionality O
, O
such O
as O
HTTP B-Entity
command I-Entity
and I-Entity
control I-Entity
communications I-Entity
with I-Entity
an I-Entity
ASPX I-Entity
server-side I-Entity
component I-Entity
, O
a B-Entity
denial I-Entity
of I-Entity
service I-Entity
tool I-Entity
they I-Entity
developed I-Entity
, O
and O
the O
public O
project O
named O
XYNTService O
used O
to O
run O
ordinary O
applications O
as O
services O
. O
 
Nesha O
is O
one O
of O
the O
offensive O
members O
of O
this O
organization O
. O
 
Nesha B-Entity
was B-Action
seen I-Action
in B-Modifier
breaches B-Entity
involving I-Entity
SQL I-Entity
injection I-Entity
as I-Entity
well I-Entity
as I-Entity
other I-Entity
techniques I-Entity
. O
 
Nesha B-Entity
often O
utilized B-Action
web-based B-Entity
backdoors I-Entity
developed I-Entity
in I-Entity
ASPX I-Entity
, I-Entity
PHP I-Entity
as I-Entity
well I-Entity
as I-Entity
ColdFusion I-Entity
. O
 
A O
copy O
of O
an O
MS08-067 O
exploit O
developed O
in O
Python O
was O
recovered O
in O
which O
Nesha O
shamelessly O
replaced O
the O
original O
author O
's O
name O
with O
his O
own O
. O
 
Nesha O
's O
passwords O
very O
commonly O
include O
own O
handle O
. O
 
His O
passwords O
were O
frequently O
stored O
as O
hashes O
in O
backdoors O
, O
but O
common O
hash O
cracking O
methods O
were O
able O
to O
recover O
the O
plaintext O
versions O
. O
 
His O
observed O
password O
use O
is O
as O
follows O
: O
Cylance O
observed O
Nesha O
participating O
in O
compromises O
involving O
the O
following O
techniques O
: O
Nesha O
has O
additionally O
been O
identified O
using O
a O
variety O
of O
internally O
developed O
tools O
as O
well O
as O
the O
following O
publicly O
available O
tools O
: O
Alireza O
appears O
to O
be O
one O
of O
the O
senior O
developers O
of O
this O
organization O
. O
 
His O
tools O
are O
commonly O
developed O
in O
C++ O
, O
Java O
, O
and O
C O
# O
( O
desktop O
and O
ASPX O
) O
. O
 
These B-Entity
tools I-Entity
are O
often O
support O
tools O
, O
either O
monitoring B-Action
the B-Entity
activity I-Entity
of I-Entity
other I-Entity
tools I-Entity
or O
supplementing B-Action
the B-Entity
function I-Entity
of I-Entity
other I-Entity
tools I-Entity
gathering I-Entity
information I-Entity
during I-Entity
the I-Entity
infiltration I-Entity
process I-Entity
. O
 
Alireza O
's O
code O
appears O
to O
be O
reused O
internally O
on O
projects O
such O
as O
TinyZBot O
. O
 
Alireza O
appears O
to O
be O
using O
a O
version O
control O
system O
for O
his O
code O
, O
and O
it O
is O
likely O
that O
others O
are O
using O
the O
same O
system O
. O
 
Based O
on O
the O
paths O
, O
the O
version O
control O
system O
in O
use O
is O
likely O
Apache O
's O
Subversion O
. O
 
Use O
of O
a O
version O
control O
system O
is O
indicative O
of O
code O
sharing O
, O
but O
the O
use O
of O
an O
older O
system O
like O
Subversion O
, O
along O
with O
other O
evidence O
, O
suggests O
there O
is O
not O
a O
large O
amount O
of O
collaboration O
on O
projects O
and O
likely O
one O
developer O
working O
on O
each O
project O
at O
a O
time O
. O
 
This O
is O
not O
behavior O
typical O
of O
a O
professional O
development O
team O
. O
 
Alireza O
's O
C O
# O
tools O
include O
the O
following O
techniques O
: O
Alireza O
's O
Java O
tools O
include O
the O
following O
techniques O
: O
Alireza O
's O
C++ O
tools O
include O
the O
following O
techniques O
: O
kaJ O
is O
a O
.NET O
 
developer O
, O
and O
has O
only O
been O
observed O
working O
in O
C O
# O
. O
 
He O
has O
less O
English O
language O
proficiency O
than O
others O
in O
the O
organization O
, O
and O
likely O
has O
a O
supplemental O
role O
during O
compromises O
. O
 
He O
has O
been O
observed O
developing O
tools O
which O
cater O
to O
specific O
challenges O
in O
a O
compromise O
. O
 
His O
notable O
project O
was O
named O
Net O
Crawler O
, O
and O
a O
technical O
analysis O
of O
this O
tool O
can O
be O
found O
in O
the O
Tactics O
, O
Techniques O
and O
Procedures O
section O
. O
 
Thanks O
to O
a O
recovered O
test O
configuration O
for O
Net O
Crawler O
, O
we O
were O
able O
to O
determine O
that O
kaJ O
's O
development O
computer O
has O
the O
name O
dev-castle O
, O
where O
he O
has O
the O
username O
kaJ O
and O
the O
password O
oaolrJ O
@ O
vad O
. O
 
kaJ O
is O
believed O
to O
be O
the O
creator O
of O
the O
Zhoupin O
ASCII O
art O
displayed O
in O
Net O
Crawler O
. O
 
kaJ O
's O
projects O
include O
the O
following O
techniques O
. O
 
Jimbp O
is O
a O
.NET O
 
developer O
with O
minimal O
experience O
. O
 
His O
projects O
appear O
to O
be O
supplemental O
to O
TinyZBot O
and O
are O
very O
simplistic O
. O
 
It O
is O
believed O
he O
is O
the O
developer O
of O
the O
project O
Binder1 O
. O
 
This O
project O
was O
a O
simple O
malware O
binder O
which O
required O
manual O
configuration O
when O
compiling O
. O
 
His O
other O
work O
included O
creating O
a O
new O
service O
wrapper O
for O
TinyZBot O
. O
 
Of O
course O
many O
associated O
Iranian O
hacker O
teams O
have O
been O
identified O
in O
public O
and O
private O
security O
circles O
. O
 
Some O
of O
the O
teams O
publicly O
known O
today O
include O
Iranian O
Cyber O
Army O
, O
Ashiyane O
, O
Islamic O
Cyber O
Resistance O
Group O
, O
Izz O
ad-Din O
al-Qassam O
Cyber O
Fighters O
, O
Parastoo O
, O
Shabgard O
, O
Iran O
Black O
Hats O
and O
many O
others O
. O
 
However O
, O
even O
though O
the O
TTPs O
of O
the O
Cleaver O
team O
have O
some O
overlap O
to O
techniques O
used O
by O
Iranian O
Cyber O
Army O
( O
botnets O
) O
, O
Ashiyane O
( O
SQL O
injection O
) O
and O
Syrian O
Electronic O
Army O
( O
phishing O
and O
RATs O
) O
, O
we O
believe O
this O
is O
largely O
the O
work O
of O
a O
new O
team O
. O
 
Some O
connections O
to O
Ashiyane O
were O
discovered O
in O
our O
investigations O
including O
a O
reference O
to O
hussein1363 O
, O
who O
had O
prior O
ties O
to O
the O
hacker O
group O
. O
 
Additional O
connections O
between O
team O
members O
and O
individuals O
exist O
but O
are O
predominantly O
speculative O
and O
have O
only O
been O
shared O
with O
law O
enforcement O
. O
 
Ultimately O
we O
believe O
the O
Cleaver O
team O
is O
a O
mix O
of O
existing O
team O
members O
and O
new O
recruits O
pulled O
from O
the O
universities O
in O
Iran O
. O
 
The O
Cleaver O
campaign O
used O
a O
variety O
of O
methods O
in O
multiple O
stages O
of O
attacks O
. O
 
In O
this O
section O
we'll O
cover O
the O
commonly O
observed O
methods O
during O
different O
stages O
of O
the O
attack O
. O
 
The O
initial O
compromise O
gets O
the O
attackers O
their O
first O
foothold O
into O
the O
target O
network O
. O
 
Once O
the O
ability O
to O
execute O
arbitrary O
code O
has O
been O
established O
, O
an O
attacker O
's O
job O
becomes O
quite O
a O
bit O
easier O
. O
 
Since O
the O
vector O
of O
initial O
compromise O
is O
usually O
determined O
by O
what O
is O
vulnerable O
on O
the O
target O
, O
we O
'll O
cover O
just O
a O
few O
of O
the O
techniques O
we O
've O
seen O
Operation O
Cleaver O
use O
to O
initiate O
the O
compromise O
. O
 
SQL B-Entity
injection I-Entity
is B-Action
a B-Entity
very I-Entity
common I-Entity
and I-Entity
simple I-Entity
attack I-Entity
method I-Entity
. O
 
It O
is O
made O
possible O
by O
a O
lack O
of O
input O
sanitization O
by O
the O
vulnerable O
application O
before O
supplying O
that O
input O
into O
a O
SQL O
database O
query O
. O
 
SQL B-Entity
injection I-Entity
payloads I-Entity
used B-Action
by O
this B-Entity
organization I-Entity
have O
been B-Action
double I-Action
encoded I-Action
. O
 
Double B-Entity
encoding I-Entity
SQL I-Entity
injection I-Entity
payloads I-Entity
allows B-Action
for B-Modifier
bypassing B-Entity
of I-Entity
various I-Entity
anti-exploitation I-Entity
filters I-Entity
, I-Entity
such I-Entity
as I-Entity
those I-Entity
supplied I-Entity
by I-Entity
Web I-Entity
Application I-Entity
Firewalls I-Entity
( I-Entity
WAFs I-Entity
) I-Entity
. O
 
The O
attackers O
would O
enable O
xpcmdshell O
: O
Then O
connect B-Action
outbound B-Entity
via B-Modifier
anonymous B-Entity
FTP I-Entity
: O
Using B-Modifier
messaging B-Entity
methods I-Entity
such I-Entity
as I-Entity
email I-Entity
, O
attackers B-Entity
can O
social B-Action
engineer I-Action
users B-Entity
into B-Modifier
downloading B-Entity
and I-Entity
executing I-Entity
software I-Entity
, O
which O
quietly O
installs B-Action
malware B-Entity
alongside B-Modifier
of I-Modifier
the B-Entity
desired I-Entity
program I-Entity
. O
 
Operation O
Cleaver O
has O
employed O
this O
technique O
numerous O
times O
across O
different O
organizations O
. O
 
The O
domain O
EasyResumeCreatorPro.com O
was O
registered O
and O
a O
website O
setup O
which O
was O
a O
direct O
copy O
of O
a O
legitimate O
website O
at O
winresume.com O
. O
 
This O
is O
how O
the O
original O
site O
looked O
: O
That O
's O
not O
all O
they O
copied O
. O
 
In O
order O
to O
infect O
users O
, O
they B-Entity
combined B-Action
the B-Entity
original I-Entity
Easy I-Entity
Resume I-Entity
Creator I-Entity
Pro I-Entity
product I-Entity
with B-Modifier
malware B-Entity
by B-Modifier
using B-Entity
a I-Entity
binder I-Entity
they I-Entity
developed I-Entity
internally I-Entity
named I-Entity
Binder1 I-Entity
. O
 
A O
binder O
is O
an O
application O
, O
which O
combines O
two O
executables O
( O
desired O
software O
and O
malware O
) O
into O
a O
single O
executable O
. O
 
The B-Entity
resulting I-Entity
executable I-Entity
masquerades B-Action
as B-Modifier
the B-Entity
desired I-Entity
software I-Entity
. O
 
The O
purpose O
is O
deception O
, O
to O
make B-Action
the B-Entity
binder I-Entity
indistinguishable B-Entity
from I-Entity
the I-Entity
desired I-Entity
application I-Entity
. O
 
When O
executed O
, O
both B-Entity
applications I-Entity
are B-Action
written I-Action
to B-Modifier
a B-Entity
temporary I-Entity
directory I-Entity
and O
executed B-Action
. O
 
This O
way O
it O
appears O
that O
the O
desired O
application O
was O
executed O
, O
but O
the B-Entity
malware I-Entity
was B-Action
also I-Action
executed I-Action
silently O
. O
 
This O
attack O
evolved O
to O
appear O
more O
legitimate O
. O
 
The O
attackers O
made O
the O
victims O
feel O
like O
they O
had O
a O
pending O
job O
opportunity O
at O
the O
industrial O
conglomerate O
Teledyne O
. O
 
In B-Modifier
order I-Modifier
to I-Modifier
take B-Entity
advantage I-Entity
of I-Entity
this I-Entity
job I-Entity
opportunity I-Entity
, O
the B-Entity
victim I-Entity
needed O
to O
use B-Action
the B-Entity
fake I-Entity
résumé I-Entity
submission I-Entity
application I-Entity
supplied I-Entity
by I-Entity
the I-Entity
malicious I-Entity
recruiter I-Entity
. O
 
Multiple B-Entity
domains I-Entity
were B-Action
registered I-Action
in B-Modifier
order I-Modifier
to I-Modifier
make B-Entity
the I-Entity
download I-Entity
sites I-Entity
seem I-Entity
more I-Entity
realistic I-Entity
. O
 
These O
domains O
included O
other O
companies O
as O
they O
tried O
to O
hit O
a O
wider O
audience O
. O
 
At O
this O
point O
, O
the B-Entity
résumé I-Entity
submission I-Entity
application I-Entity
checks B-Action
the B-Entity
Internet I-Entity
connection I-Entity
. O
 
If O
it O
is O
unable O
to O
connect O
to O
the O
Internet O
, O
it B-Entity
will O
display B-Action
a B-Entity
window I-Entity
to B-Modifier
input B-Entity
proxy I-Entity
information I-Entity
. O
 
When O
this O
information O
is O
entered O
, O
the B-Entity
results I-Entity
are B-Action
cached I-Action
in B-Modifier
a B-Entity
location I-Entity
the I-Entity
dropped I-Entity
malware I-Entity
can I-Entity
access I-Entity
. O
 
After O
an B-Entity
Internet I-Entity
connection I-Entity
is B-Action
ensured I-Action
, O
the B-Entity
malware I-Entity
( I-Entity
TinyZbot I-Entity
) I-Entity
is B-Action
dropped I-Action
and O
executed B-Action
. O
 
This O
clever O
scheme O
makes O
sure O
the B-Entity
malware I-Entity
can O
connect B-Action
to B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
, O
and O
increases O
the O
chances O
that O
domain O
credentials O
are O
cached O
on O
the O
now O
infected O
machine O
. O
 
Shortly O
after O
, O
the B-Entity
main I-Entity
application I-Entity
is B-Action
launched I-Action
. O
 
The B-Entity
first I-Entity
résumé I-Entity
submission I-Entity
form I-Entity
requests B-Action
contact B-Entity
information I-Entity
. O
 
This B-Entity
form I-Entity
, O
like O
the O
rest O
of O
the O
submission O
forms O
, O
only O
stores B-Action
the B-Entity
submitted I-Entity
information I-Entity
while B-Modifier
the B-Entity
application I-Entity
is I-Entity
running I-Entity
. O
 
As O
the O
infected O
user O
is O
going O
through O
and O
filling O
out O
all O
this O
information O
, O
the B-Entity
malware I-Entity
is O
running O
in O
the O
background O
, O
logging B-Action
their B-Entity
keystrokes I-Entity
, O
retrieving B-Action
their B-Entity
stored I-Entity
passwords I-Entity
, O
etc O
. O
 
Once O
all O
the O
forms O
are O
filled O
out O
, O
the O
user O
goes O
to O
the O
submission O
form O
. O
 
When B-Modifier
the B-Entity
victim I-Entity
hits I-Entity
submit I-Entity
, O
the B-Entity
résumé I-Entity
submitter I-Entity
does B-Action
a B-Entity
GET I-Entity
request I-Entity
to B-Modifier
microsoft.com B-Entity
in B-Modifier
order I-Modifier
to I-Modifier
make B-Entity
it I-Entity
seem I-Entity
like I-Entity
it I-Entity
is I-Entity
submitting I-Entity
something I-Entity
, O
then O
claims O
success O
. O
 
This O
method O
is O
particularly O
effective O
not O
only O
because O
of O
its O
level O
of O
deception O
, O
but O
even O
if O
the O
victim O
suspects O
that O
they O
are O
infected O
with O
malware O
, O
they O
are O
not O
as O
likely O
to O
speak O
up O
about O
it O
, O
as O
they O
would O
need O
to O
explain O
why O
they O
were O
submitting O
a O
job O
application O
for O
another O
company O
. O
 
Privilege B-Entity
escalation I-Entity
is B-Action
a B-Entity
category I-Entity
of I-Entity
techniques I-Entity
that I-Entity
describe I-Entity
the I-Entity
process I-Entity
of I-Entity
going I-Entity
from I-Entity
a I-Entity
less I-Entity
privileged I-Entity
user I-Entity
on I-Entity
a I-Entity
compromised I-Entity
computer I-Entity
to I-Entity
a I-Entity
more I-Entity
privileged I-Entity
user I-Entity
. O
 
This B-Entity
increase I-Entity
in I-Entity
privileges I-Entity
allows B-Action
for O
the B-Entity
attacker I-Entity
to O
gain B-Action
access B-Entity
to I-Entity
privleged I-Entity
areas I-Entity
of I-Entity
the I-Entity
operating I-Entity
system I-Entity
as O
well O
as O
to O
infect B-Action
other B-Entity
computers I-Entity
on I-Entity
the I-Entity
target I-Entity
network I-Entity
. O
 
This O
team O
did O
not O
utilize O
any O
novel O
methods O
of O
privilege O
escalation O
, O
but O
they O
were O
observed O
using O
a O
variety O
of O
publicly O
known O
exploits O
. O
 
PrivEsc B-Entity
is O
a O
compiled O
exploit O
, O
which O
leverages B-Action
the B-Entity
vulnerability I-Entity
commonly I-Entity
referred I-Entity
to I-Entity
as I-Entity
KiTrap0D I-Entity
( I-Entity
CVE-2010-0232 I-Entity
) I-Entity
. O
 
The B-Entity
exploit I-Entity
allows B-Action
for B-Modifier
escalation B-Entity
of I-Entity
privileges I-Entity
on I-Entity
unpatched I-Entity
Windows I-Entity
operating I-Entity
systems I-Entity
from I-Entity
an I-Entity
unprivileged I-Entity
user I-Entity
to I-Entity
kernel-level I-Entity
privilege I-Entity
. O
 
This O
vulnerability O
and O
the O
corresponding O
exploit O
were O
discovered O
and O
developed O
in O
2010 O
. O
 
The O
plagiarized O
version O
used O
in O
Operation O
Cleaver O
was O
compiled O
in O
May O
2013 O
, O
with O
a O
slight O
modification O
to O
the O
public O
source O
code O
. O
 
This O
modification O
changed O
the O
author O
's O
details O
to O
Zhopin O
Exploit O
Team O
. O
 
Pivoting B-Entity
is B-Action
the B-Entity
process I-Entity
of I-Entity
leveraging I-Entity
access I-Entity
from I-Entity
one I-Entity
compromised I-Entity
computer I-Entity
in I-Entity
order I-Entity
to I-Entity
gain I-Entity
access I-Entity
to I-Entity
additional I-Entity
systems I-Entity
on I-Entity
the I-Entity
target I-Entity
network I-Entity
. O
 
This O
can O
involve O
launching B-Action
attacks B-Entity
from B-Modifier
the B-Entity
compromised I-Entity
computer I-Entity
, O
or O
simply O
abusing B-Action
access B-Entity
once B-Modifier
it B-Entity
has I-Entity
been I-Entity
gained I-Entity
. O
 
A O
very O
common O
method O
of O
pivoting O
on O
a O
predominantly O
Windows O
operating O
system O
based O
network O
is O
to O
extract B-Action
domain B-Entity
credentials I-Entity
which I-Entity
have I-Entity
been I-Entity
used I-Entity
on I-Entity
the I-Entity
compromised I-Entity
computer I-Entity
from I-Entity
a I-Entity
credential I-Entity
cache I-Entity
. O
 
There O
are O
a B-Entity
few I-Entity
well-known I-Entity
tools I-Entity
which O
are O
capable O
of O
doing O
this O
given B-Action
sufficient B-Entity
privileges I-Entity
on I-Entity
the I-Entity
infected I-Entity
host I-Entity
. O
 
Two O
of O
these O
tools O
used O
by O
Cleaver O
are O
Mimikatz O
and O
Windows O
Credential O
Editor O
. O
 
Two B-Entity
similar I-Entity
applications I-Entity
were O
developed O
by O
Operation O
Cleaver O
in O
order O
automate B-Action
the B-Entity
execution I-Entity
of I-Entity
Mimikatz I-Entity
. O
 
These O
applications O
are O
zhMimikatz O
and O
MimikatzWrapper O
. O
 
These O
applications O
store O
multiple O
versions O
of O
Mimikatz O
in O
their O
resources O
. O
 
When O
executed O
, O
they B-Entity
determine B-Action
which B-Entity
version I-Entity
of I-Entity
Mimikatz I-Entity
to I-Entity
use I-Entity
based B-Modifier
on I-Modifier
whether B-Entity
the I-Entity
computer I-Entity
's I-Entity
version I-Entity
of I-Entity
Windows I-Entity
is I-Entity
32-bit I-Entity
or I-Entity
64-bit I-Entity
. O
 
This O
technique O
is O
uncommon O
in O
malware O
and O
shows O
the O
advanced O
skillset O
of O
the O
Cleaver O
team O
. O
 
Both O
tools O
were O
developed O
in O
C O
# O
. O
 
In O
the O
following O
examples O
, O
the O
computer O
name O
is O
TheComputerName O
, O
the O
username O
of O
the O
logged O
in O
user O
is O
TheUser O
, O
and O
that O
user O
's O
password O
is O
ThePassword O
. O
 
At O
the O
time O
of O
execution O
, O
the O
system O
only O
has O
its O
own O
credentials O
available O
and O
no O
cached O
network O
credentials O
. O
 
zhMimikatz B-Entity
executes B-Action
the B-Entity
correct I-Entity
version I-Entity
of I-Entity
Mimikatz I-Entity
for I-Entity
the I-Entity
current I-Entity
system I-Entity
, O
and O
parses B-Action
the B-Entity
results I-Entity
for B-Modifier
any B-Entity
cached I-Entity
credentials I-Entity
. O
 
Output O
from O
MimikatzWrapper O
is O
essentially O
the O
same O
as O
zhMimikatz O
, O
despite O
being O
a O
different O
Visual O
Studio O
project O
. O
 
The O
only O
external O
difference O
is O
that O
MimikatzWrapper B-Entity
also O
logs B-Action
these B-Entity
results I-Entity
to B-Modifier
res.txt B-Entity
in B-Modifier
the B-Entity
executing I-Entity
directory I-Entity
. O
 
This O
can O
make O
it O
useful O
for O
tools B-Entity
like I-Entity
the I-Entity
PVZ I-Entity
tool I-Entity
chain I-Entity
and I-Entity
Csext I-Entity
to O
execute B-Action
with B-Modifier
logged B-Entity
results I-Entity
: O
Once O
an B-Entity
attacker I-Entity
has O
credentials B-Entity
extracted B-Action
from B-Modifier
the B-Entity
cache I-Entity
, O
whether O
in O
hash O
form O
or O
in O
plaintext O
form O
, O
PsExec B-Entity
can O
be O
used O
to O
run B-Action
commands B-Entity
on B-Modifier
any B-Entity
other I-Entity
computer I-Entity
which I-Entity
accepts I-Entity
those I-Entity
domain I-Entity
credentials I-Entity
. O
 
If O
this B-Entity
technique I-Entity
is B-Action
combined I-Action
with B-Modifier
cached B-Entity
credential I-Entity
dumping I-Entity
, O
it B-Entity
can O
be O
used O
to O
jump B-Action
from B-Modifier
computer B-Entity
to B-Modifier
computer B-Entity
on B-Modifier
a B-Entity
compromised I-Entity
network I-Entity
. O
 
Net B-Entity
Crawler I-Entity
utilizes B-Action
a B-Entity
cached I-Entity
credential I-Entity
dumping I-Entity
technique I-Entity
along B-Modifier
with I-Modifier
PsExec B-Entity
in O
order O
to O
worm B-Action
throughout B-Modifier
a B-Entity
network I-Entity
, O
collecting B-Action
any B-Entity
and I-Entity
all I-Entity
credentials I-Entity
that I-Entity
it I-Entity
can I-Entity
extract I-Entity
from I-Entity
credential I-Entity
caches I-Entity
. O
 
It O
has O
the O
ability O
to O
do O
this O
with O
both O
Windows O
Credential O
Editor O
and O
Mimikatz O
. O
 
It B-Entity
starts O
by O
first O
extracting B-Action
cached B-Entity
credentials I-Entity
from B-Modifier
the B-Entity
infected I-Entity
computer I-Entity
's I-Entity
cache I-Entity
. O
 
Once O
this O
is O
complete O
, O
it B-Entity
then O
continues O
to O
scan B-Action
a B-Entity
set I-Entity
of I-Entity
configured I-Entity
IP I-Entity
addresses I-Entity
on B-Modifier
the B-Entity
local I-Entity
subnet I-Entity
to B-Modifier
determine B-Entity
which I-Entity
IP I-Entity
addresses I-Entity
have I-Entity
SMB I-Entity
related I-Entity
ports I-Entity
open I-Entity
. O
 
Then O
an B-Entity
iterative I-Entity
methodology I-Entity
is O
applied O
to O
brute B-Action
forcing I-Action
each B-Entity
SMB I-Entity
enabled I-Entity
target I-Entity
with B-Modifier
each B-Entity
credential I-Entity
that I-Entity
was I-Entity
extracted I-Entity
from I-Entity
the I-Entity
cache I-Entity
. O
 
When O
a O
positive O
result O
has O
been O
achieved O
, O
it B-Entity
will O
create B-Action
a B-Entity
copy I-Entity
of I-Entity
itself I-Entity
with B-Modifier
a B-Entity
modified I-Entity
configuration I-Entity
stored I-Entity
as I-Entity
a I-Entity
PE I-Entity
resource I-Entity
, O
then O
send B-Action
and O
execute B-Action
the B-Entity
copy I-Entity
utilizing I-Entity
PsExec I-Entity
. O
 
This B-Entity
copy I-Entity
repeats B-Action
the B-Entity
behavior I-Entity
of I-Entity
the I-Entity
original I-Entity
, O
but B-Modifier
with I-Modifier
already B-Entity
discovered I-Entity
credentials I-Entity
as I-Entity
well I-Entity
as I-Entity
newly I-Entity
discovered I-Entity
ones I-Entity
on I-Entity
the I-Entity
newly I-Entity
infected I-Entity
host I-Entity
. O
 
Any O
credentials O
found O
are O
reported O
back O
to O
the O
original O
infection O
. O
 
The O
following O
is O
a O
sample O
of O
some O
of O
the O
recovered O
results O
of O
Net O
Crawler O
executing O
on O
a O
live O
network O
: O
A O
more O
in O
depth O
analysis O
of O
Net O
Crawler O
, O
as O
part O
of O
the O
A O
Study O
in O
Bots O
series O
, O
will O
be O
available O
on O
Cylance O
's O
blog O
. O
 
MS08-067 B-Entity
is B-Action
a B-Entity
vulnerability I-Entity
in I-Entity
Microsoft I-Entity
Windows I-Entity
made I-Entity
popular I-Entity
by I-Entity
the I-Entity
Conficker I-Entity
worm I-Entity
which I-Entity
can I-Entity
be I-Entity
exploited I-Entity
by I-Entity
a I-Entity
specially I-Entity
crafted I-Entity
packet I-Entity
to I-Entity
the I-Entity
operating I-Entity
system I-Entity
's I-Entity
RPC I-Entity
network I-Entity
interface I-Entity
. O
 
This O
vulnerability O
has O
been O
patched O
since O
October O
2008 O
, O
but O
many O
networks O
have O
failed O
to O
update O
their O
systems O
even O
to O
this O
day O
. O
 
Operation O
Cleaver O
used O
a O
plagiarized O
version O
of O
a O
publicly O
available O
exploit O
for O
this O
vulnerability O
developed O
in O
Python O
. O
 
Someone O
in O
the O
Cleaver O
team O
( O
presumed O
to O
be O
Nesha O
) O
modified O
the O
exploit O
to O
read O
'' O
By O
Nesha O
'' O
. O
 
Jasus B-Entity
is B-Action
an B-Entity
ARP I-Entity
cache I-Entity
poisoner I-Entity
developed I-Entity
by I-Entity
the I-Entity
Operation I-Entity
Cleaver I-Entity
team I-Entity
. O
 
It O
makes O
use O
of O
WinPcap O
and O
is O
developed O
in O
C. O
Compared O
to O
some O
other O
publicly O
available O
ARP O
cache O
poisoning O
utilities O
, O
Jasus O
is O
poorly O
developed O
and O
without O
many O
useful O
features O
. O
 
The B-Entity
primary I-Entity
positive I-Entity
attribute I-Entity
of I-Entity
Jasus I-Entity
is B-Action
its B-Entity
poor I-Entity
detection I-Entity
ratio I-Entity
by I-Entity
the I-Entity
antivirus I-Entity
industry I-Entity
. O
 
Cain O
& O
Abel O
is O
a O
publicly O
available O
toolkit O
, O
which O
covers O
a O
wide O
range O
of O
functionality O
that O
assists O
attackers O
once O
they O
have O
compromised O
a O
node O
on O
a O
network O
. O
 
It B-Entity
has O
the O
ability O
to O
dump B-Action
stored B-Entity
and I-Entity
cached I-Entity
credentials I-Entity
, O
and O
conduct B-Action
attacks B-Entity
like I-Entity
ARP I-Entity
cache I-Entity
poisoning I-Entity
in O
order O
to O
capture B-Action
credentials B-Entity
being I-Entity
transmitted I-Entity
on I-Entity
the I-Entity
network I-Entity
. O
 
It B-Entity
also O
has B-Action
a B-Entity
remotely I-Entity
installable I-Entity
trojan I-Entity
named I-Entity
Abel I-Entity
, O
which O
enables B-Action
some B-Entity
of I-Entity
its I-Entity
functionality I-Entity
on B-Modifier
a B-Entity
remote I-Entity
target I-Entity
. O
 
We O
observed O
the B-Entity
Operation I-Entity
Cleaver I-Entity
team I-Entity
using B-Action
Cain B-Entity
& I-Entity
Abel I-Entity
for B-Modifier
extracting B-Entity
credentials I-Entity
from I-Entity
caches I-Entity
and I-Entity
the I-Entity
network I-Entity
when O
they O
are O
confident O
that O
there O
is O
little O
to O
no O
antivirus O
protection O
on O
the O
infected O
target O
. O
 
Exfiltration B-Entity
is B-Action
the B-Entity
process I-Entity
of I-Entity
moving I-Entity
information I-Entity
to I-Entity
an I-Entity
external I-Entity
site I-Entity
. O
 
In O
this O
context O
, O
it B-Entity
is B-Action
the B-Entity
process I-Entity
of I-Entity
stealing I-Entity
information I-Entity
without I-Entity
being I-Entity
detected I-Entity
. O
 
Operation B-Entity
Cleaver I-Entity
has O
a O
strong O
focus O
on O
stealing B-Action
confidential/privileged B-Entity
information I-Entity
, O
and O
they O
have O
utilized O
a O
few O
methods O
in O
order O
to O
facilitate O
this O
objective O
. O
 
Cleaver B-Entity
Operations I-Entity
observed O
in O
2013 O
mainly O
utilized B-Action
FTP B-Entity
servers I-Entity
with B-Modifier
anonymous B-Entity
access I-Entity
enabled I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
pilfer B-Entity
large I-Entity
quantities I-Entity
of I-Entity
information I-Entity
. O
 
This O
allowed O
them B-Entity
to O
use B-Action
existing B-Entity
command I-Entity
line I-Entity
utilities I-Entity
available I-Entity
on I-Entity
their I-Entity
targets I-Entity
in O
order O
to O
upload B-Action
information B-Entity
. O
 
This O
is O
a O
versatile O
technique O
as O
it O
does O
not O
require O
any O
additional O
software O
which O
could O
be O
detected O
. O
 
These B-Entity
FTP I-Entity
servers I-Entity
were B-Action
also I-Action
observed I-Action
during B-Modifier
the B-Entity
infection I-Entity
process I-Entity
, O
as O
infected B-Entity
computers I-Entity
were O
often O
instructed O
to O
download B-Action
additional B-Entity
files I-Entity
from B-Modifier
these B-Entity
FTP I-Entity
servers I-Entity
, O
including O
backdoors O
and O
pivoting O
tools O
. O
 
The B-Entity
following I-Entity
IP I-Entity
addresses I-Entity
hosted B-Action
FTP B-Entity
servers I-Entity
that O
were B-Action
used I-Action
in B-Modifier
the B-Entity
infection I-Entity
of I-Entity
targets I-Entity
or O
in B-Modifier
the B-Entity
exfiltration I-Entity
of I-Entity
information I-Entity
. O
 
NetCat O
is O
a O
network O
tool O
which O
has O
many O
valid O
purposes O
but O
can O
also O
be O
used O
for O
malicious O
purposes O
. O
 
Its B-Entity
main I-Entity
functionality I-Entity
allows B-Action
for B-Modifier
a B-Entity
client I-Entity
and I-Entity
server I-Entity
communication I-Entity
channel I-Entity
, O
allowing B-Action
for B-Modifier
information B-Entity
to I-Entity
be I-Entity
transported I-Entity
over I-Entity
the I-Entity
network I-Entity
simply I-Entity
. O
 
NetCat O
has O
an O
option O
when O
being O
compiled O
to O
enable O
or O
disable O
the O
ability O
for O
NetCat B-Entity
to O
execute B-Action
a B-Entity
command I-Entity
after B-Modifier
the B-Entity
connection I-Entity
is I-Entity
established I-Entity
. O
 
This B-Entity
feature I-Entity
can O
be O
abused O
to O
enable B-Action
a B-Entity
reverse I-Entity
connecting I-Entity
shell I-Entity
, O
which O
can O
be O
used O
to O
remotely B-Action
control I-Action
a B-Entity
target I-Entity
. O
 
NetCat O
's O
network O
communications O
are O
in O
plaintext O
, O
and O
could O
be O
viewed O
by O
an O
egress O
filter O
looking O
to O
block O
the O
exfiltration O
of O
sensitive O
information O
. O
 
The B-Entity
Operation I-Entity
Cleaver I-Entity
team I-Entity
was O
observed O
attempting O
to O
use B-Action
NetCat B-Entity
to B-Modifier
exfiltrate B-Entity
information I-Entity
as O
well O
as O
use B-Action
it B-Entity
as B-Modifier
a B-Entity
reverse I-Entity
connecting I-Entity
shell I-Entity
. O
 
The O
use O
of O
NetCat O
was O
later O
replaced O
with O
zhCat O
. O
 
zhCat O
is O
a O
tool O
developed O
by O
the O
Operation O
Cleaver O
team O
which O
operates O
similarly O
to O
NetCat O
. O
 
Its B-Entity
main I-Entity
purpose I-Entity
is O
to O
create B-Action
a B-Entity
channel I-Entity
that I-Entity
is I-Entity
capable I-Entity
of I-Entity
transporting I-Entity
information I-Entity
over I-Entity
the I-Entity
network I-Entity
. O
 
The O
changes O
made O
in O
zhCat B-Entity
allow O
for O
this B-Entity
information I-Entity
to O
be B-Action
transferred I-Action
with B-Modifier
inline B-Entity
obfuscation I-Entity
and/ I-Entity
or I-Entity
encryption I-Entity
. O
 
This O
makes O
it O
more O
difficult O
to O
detect O
that O
privileged B-Entity
information I-Entity
is O
being B-Action
exfiltrated I-Action
. O
 
The O
command O
line O
help O
( O
of O
a O
particular O
version O
) O
shows O
the O
following O
options O
: O
Multiple O
obfuscation/encryption O
methods O
are O
available O
. O
 
The O
–h O
argument O
enables O
HTTP O
mode O
. O
 
This B-Entity
makes B-Action
the B-Entity
traffic I-Entity
between I-Entity
zhCat I-Entity
instances I-Entity
look B-Entity
like I-Entity
benign I-Entity
HTTP I-Entity
traffic I-Entity
. O
 
For O
instance O
, O
if O
the O
attackers O
set O
up O
a O
zhCat O
instance O
listening O
on O
port O
1000 O
on O
192.168.116.128 O
in O
HTTP O
mode O
, O
the O
client O
instance O
of O
zhCat O
would O
use O
the O
following O
command O
: O
The O
server O
instance O
would O
use O
the O
following O
command O
: O
When O
we O
run O
both O
of O
these O
, O
we O
can O
send O
information O
just O
by O
typing O
it O
into O
the O
terminal O
of O
the O
running O
application O
. O
 
Information O
can O
be O
supplied O
by O
standard O
input O
. O
 
If O
we O
observe O
the O
network O
communications O
during O
this O
transfer O
, O
we B-Entity
can O
see B-Action
the B-Entity
following I-Entity
HTTP I-Entity
POST I-Entity
request I-Entity
. O
 
Note O
: O
research O
into O
ebizmba.com O
did O
not O
turn O
up O
any O
additional O
evidence O
of O
being O
involved O
with O
the O
development O
of O
zhCat O
. O
 
On O
the O
server O
side O
, O
we O
can O
see O
our O
message O
has O
been O
received O
: O
If O
stricter O
egress O
filtering O
is O
enabled O
, O
the B-Entity
attackers I-Entity
can O
use B-Action
zhCat B-Entity
to B-Modifier
also B-Entity
XOR I-Entity
encrypt I-Entity
the I-Entity
traffic I-Entity
with I-Entity
a I-Entity
shared I-Entity
key I-Entity
. O
 
These O
keys O
are O
stored O
inside O
zhCat O
. O
 
The O
following O
is O
the B-Entity
key I-Entity
used B-Action
for B-Modifier
XOR B-Entity
encryption I-Entity
: O
The O
\n O
represents O
hex O
character O
0x0A O
, O
which O
is O
a O
new O
line O
character O
. O
 
An B-Entity
attacker I-Entity
could O
set B-Action
up I-Action
a B-Entity
server I-Entity
instance I-Entity
of I-Entity
zhCat I-Entity
with B-Modifier
the B-Entity
following I-Entity
command I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
enable B-Entity
both I-Entity
HTTP I-Entity
and I-Entity
XOR I-Entity
obfuscation I-Entity
: O
The O
client O
instance O
could O
then O
be O
invoked O
with O
the O
following O
command O
: O
Once O
again O
, O
information O
can O
be O
supplied O
via O
standard O
input O
. O
 
Upon O
inspecting O
the O
network O
traffic O
again O
, O
we B-Entity
see B-Action
the B-Entity
following I-Entity
HTTP I-Entity
POST I-Entity
request I-Entity
. O
 
On O
the O
server O
side O
, O
we O
can O
see O
this O
information O
being O
received O
: O
zhCat B-Entity
has B-Action
a B-Entity
variety I-Entity
of I-Entity
other I-Entity
features I-Entity
such I-Entity
as I-Entity
port I-Entity
mirroring I-Entity
as I-Entity
well I-Entity
as I-Entity
traffic I-Entity
redirecting I-Entity
. O
 
PLink O
is O
one O
of O
the O
many O
utilities O
provided O
in O
the O
PuTTY O
( O
SSH O
) O
suite O
, O
which O
has O
many O
benign O
purposes O
. O
 
It O
is O
capable O
of O
communicating O
over O
various O
protocols O
, O
the O
most O
notable O
being O
SSH O
. O
 
The O
SSH O
protocol O
is O
a O
heavily O
utilized O
encrypted O
protocol O
, O
most O
commonly O
used O
for O
remote O
administration O
of O
UNIX O
based O
operating O
systems O
. O
 
PLink O
is O
designed O
to O
implement O
some O
of O
the O
SSH O
functions O
related O
to O
forwarding O
traffic O
as O
well O
as O
other O
functionality O
. O
 
Operation B-Entity
Cleaver I-Entity
uses B-Action
PLink B-Entity
to B-Modifier
forward B-Entity
local I-Entity
RDP I-Entity
ports I-Entity
to I-Entity
remote I-Entity
SSH I-Entity
servers I-Entity
. O
 
This O
allows O
them B-Entity
to O
easily O
connect B-Action
to B-Modifier
RDP B-Entity
servers I-Entity
inside B-Modifier
the B-Entity
networks I-Entity
of I-Entity
their I-Entity
victims I-Entity
. O
 
These B-Entity
RDP I-Entity
connections I-Entity
can O
be O
used O
to O
exfiltrate B-Action
information B-Entity
visually O
, O
as O
well O
as O
to O
remotely B-Action
control I-Action
the B-Entity
computers I-Entity
hosting I-Entity
the I-Entity
RDP I-Entity
servers I-Entity
. O
 
Early B-Entity
Cleaver I-Entity
operations I-Entity
abused B-Action
SMTP B-Entity
in B-Modifier
order I-Modifier
to I-Modifier
exfiltrate B-Entity
information I-Entity
. O
 
The B-Entity
sending I-Entity
is B-Action
performed I-Action
by O
internally B-Entity
developed I-Entity
malware I-Entity
samples I-Entity
such I-Entity
as I-Entity
TinyZBot I-Entity
and I-Entity
Csext I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
exfiltrate B-Entity
information I-Entity
about I-Entity
the I-Entity
infected I-Entity
computer I-Entity
, I-Entity
as I-Entity
well I-Entity
as I-Entity
requested I-Entity
files I-Entity
and I-Entity
keystroke I-Entity
logging I-Entity
information I-Entity
. O
 
Messages B-Entity
were B-Action
sent I-Action
using B-Modifier
an B-Entity
open I-Entity
SMTP I-Entity
relay I-Entity
at I-Entity
BeyondSys.com I-Entity
with B-Modifier
the B-Entity
sender I-Entity
email I-Entity
address I-Entity
dyanachear I-Entity
( I-Entity
at I-Entity
) I-Entity
beyondsys.com I-Entity
. O
 
This O
allowed O
the B-Entity
attackers I-Entity
to O
use B-Action
infrastructure B-Entity
that I-Entity
was I-Entity
not I-Entity
theirs I-Entity
to B-Modifier
exfiltrate B-Entity
information I-Entity
. O
 
The O
known O
recipient O
addresses O
of O
this O
information O
were O
testmail00001 O
( O
at O
) O
yahoo.com O
and O
TerafficAnalyzer O
( O
at O
) O
yahoo O
. O
 
com O
. O
 
In O
order O
to O
deceive O
anyone O
reading O
these O
emails O
, O
they O
made O
them O
appear O
to O
be O
a O
spam O
message O
that O
most O
would O
not O
think O
twice O
about O
. O
 
The O
subject O
used O
is O
the O
following O
: O
The O
message O
used O
is O
the O
following O
: O
The B-Entity
files I-Entity
being I-Entity
exfiltrated I-Entity
are B-Action
added I-Action
to B-Modifier
the B-Entity
email I-Entity
as B-Modifier
attachments B-Entity
. O
 
SOAP B-Entity
is B-Action
a B-Entity
sub-protocol I-Entity
communicated I-Entity
via I-Entity
HTTP I-Entity
. O
 
In O
relation O
to O
Operation O
Cleaver O
, O
it B-Entity
is B-Action
used I-Action
as B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
protocol I-Entity
for I-Entity
TinyZBot I-Entity
, O
which O
was O
the O
preferred O
backdoor O
, O
and O
underwent O
long-term O
development O
. O
 
HTTP B-Entity
communications I-Entity
are B-Action
often I-Action
used I-Action
by O
botnets B-Entity
, O
but O
it O
is O
uncommon O
to O
use O
a O
sub-protocol O
such O
as O
SOAP O
. O
 
It O
is O
likely O
that O
SOAP B-Entity
was O
used O
because O
it O
is O
simple O
to O
implement O
in O
C O
# O
, O
and O
has O
the O
added O
benefit O
of O
blending B-Action
in I-Action
with B-Modifier
other B-Entity
benign I-Entity
HTTP I-Entity
traffic I-Entity
. O
 
As O
part O
of O
TinyZBot O
's O
command O
and O
control O
protocol O
, O
files B-Entity
can O
be B-Action
exfiltrated I-Action
over B-Modifier
SOAP B-Entity
to B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
. O
 
For O
more O
information O
about O
TinyZBot O
, O
see O
the O
Persistence O
section O
. O
 
Persistence B-Entity
is B-Action
the B-Entity
means I-Entity
of I-Entity
maintaining I-Entity
access I-Entity
to I-Entity
a I-Entity
compromised I-Entity
network I-Entity
. O
 
There O
are O
limitless O
methods O
of O
persistence O
; O
the B-Entity
following I-Entity
are I-Entity
techniques I-Entity
and I-Entity
tools I-Entity
for I-Entity
persistence I-Entity
used B-Action
by O
Cleaver B-Entity
. O
 
TinyZBot B-Entity
is B-Action
a B-Entity
backdoor I-Entity
developed I-Entity
in I-Entity
C I-Entity
# I-Entity
. O
 
This O
bot O
is O
the O
longest O
developed O
malware O
we O
have O
analyzed O
from O
this O
organization O
. O
 
The O
earliest O
known O
version O
was O
compiled O
in O
January O
2013 O
and O
we O
continued O
to O
see O
new O
versions O
being O
created O
actively O
. O
 
The O
purpose O
of O
TinyZBot B-Entity
is O
to O
gather B-Action
information B-Entity
from B-Modifier
an B-Entity
infected I-Entity
computer I-Entity
as O
well O
as O
maintain B-Action
and O
further B-Action
access B-Entity
into I-Entity
a I-Entity
compromised I-Entity
network I-Entity
. O
 
TinyZBot O
was O
developed O
with O
the O
clear O
intention O
of O
targeted O
campaigns O
. O
 
The O
name O
TinyZBot O
is O
assumed O
to O
be O
referring O
to O
this O
project O
as O
a O
less O
versatile O
version O
of O
the O
ZeuS O
botnet O
, O
although O
it O
does O
not O
exhibit O
the O
major O
browser O
injection O
features O
of O
ZeuS O
. O
 
To O
be O
clear O
, O
TinyZBot O
shares O
no O
code O
with O
ZeuS O
or O
its O
variants O
, O
and O
is O
developed O
in O
a O
different O
programming O
language O
. O
 
The O
majority O
of O
the O
code O
in O
TinyZBot O
was O
created O
by O
Cleaver O
. O
 
TinyZBot O
supports O
a O
wide O
array O
of O
features O
that O
continually O
evolved O
over O
time O
. O
 
For O
the O
evolution O
of O
features O
, O
see O
the O
History O
section O
. O
 
The O
following O
is O
a O
list O
of O
supported O
features O
: O
The B-Entity
command I-Entity
and I-Entity
control I-Entity
mechanism I-Entity
for I-Entity
TinyZBot I-Entity
utilizes B-Action
SOAP B-Entity
communicating I-Entity
over I-Entity
HTTP I-Entity
. O
 
Potential O
reasons O
for O
using O
SOAP O
are O
: O
1 O
. O
 
SOAP-based O
communications O
are O
simple O
to O
implement O
in O
C O
# O
. O
 
2 O
. O
 
SOAP B-Entity
traffic I-Entity
could O
easily O
be B-Action
considered I-Action
benign B-Entity
traffic I-Entity
, O
as O
it O
is O
not O
commonly O
seen O
in O
malware O
. O
 
As O
part O
of O
SOAP O
communications O
, O
a O
URI O
is O
specified O
. O
 
This O
is O
internal O
to O
the O
sub-protocol O
, O
and O
does O
not O
necessarily O
reflect O
the O
URI O
of O
the O
host O
running O
the O
SOAP O
server O
( O
ASMX O
file O
) O
. O
 
In O
the O
case O
of O
TinyZBot O
, O
and O
many O
examples O
for O
developing O
SOAP O
applications O
, O
this O
URI O
is O
tempuri.org O
. O
 
Since O
the O
first O
version O
of O
the B-Entity
SOAP-based I-Entity
command I-Entity
and I-Entity
control I-Entity
protocol I-Entity
was B-Action
implemented I-Action
, O
TinyZBot O
used O
what O
is O
referred O
to O
as O
a O
'' O
dynamic O
password O
'' O
. O
 
The O
result O
of O
this O
is O
a O
cryptographically O
hashed O
version O
of O
the O
server O
time O
( O
which O
must O
be O
obtained O
through O
a O
SOAP O
query O
) O
, O
the O
TinyZBot O
's O
GUID O
, O
and O
the O
TinyZBot O
's O
AppUsageID O
( O
campaign O
identifier O
) O
. O
 
For O
the O
command O
and O
control O
examples O
below O
, O
red O
text O
represents O
TCP B-Entity
data I-Entity
sent B-Action
from B-Modifier
the B-Entity
TinyZBot I-Entity
infection I-Entity
while O
blue O
text O
represents O
TCP B-Entity
data I-Entity
sent B-Action
from B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
. O
 
The O
server O
time O
lookup O
query O
invokes O
the O
SOAP O
command O
GetServerTime O
. O
 
This O
is O
the B-Entity
first I-Entity
query I-Entity
done B-Action
by O
a B-Entity
running I-Entity
TinyZBot I-Entity
instance I-Entity
, O
and O
needs O
to O
be O
done O
shortly O
before O
most O
other O
queries O
, O
in O
order O
to O
update O
the O
dynamic O
password O
. O
 
Commands B-Entity
, I-Entity
updates I-Entity
and I-Entity
files I-Entity
to I-Entity
drop I-Entity
and I-Entity
execute I-Entity
are B-Action
stored I-Action
as B-Modifier
files B-Entity
on I-Entity
the I-Entity
SOAP I-Entity
server I-Entity
, O
and O
access O
is O
restricted O
by O
the O
AppUsageID O
as O
well O
as O
the O
bot O
GUID O
. O
 
This O
allows O
for O
commands B-Entity
to O
be B-Action
sent I-Action
to B-Modifier
all B-Entity
bots I-Entity
for I-Entity
a I-Entity
campaign I-Entity
as O
well O
as O
individual O
control O
. O
 
The B-Entity
TinyZBot I-Entity
queries B-Action
the B-Entity
server I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
enumerate B-Entity
all I-Entity
files I-Entity
currently I-Entity
available I-Entity
to I-Entity
it I-Entity
. O
 
In O
order O
to O
download B-Action
the B-Entity
file I-Entity
and O
parse O
for O
commands O
to O
execute O
, O
the B-Entity
TinyZBot I-Entity
must O
request B-Action
the B-Entity
file I-Entity
. O
 
The B-Entity
file I-Entity
is B-Action
downloaded I-Action
Base64-encoded B-Entity
inside B-Modifier
of I-Modifier
the B-Entity
SOAP I-Entity
response I-Entity
. O
 
The O
command O
file O
downloaded O
in O
this O
example O
is O
as O
follows O
: O
The O
first O
line O
is O
a O
timestamp O
of O
the O
command O
. O
 
The O
TinyZBot O
command O
parser O
ignores O
it O
. O
 
The O
RUNCMD O
line O
requests O
that O
cmd.exe B-Entity
be B-Action
executed I-Action
, O
with O
the O
command O
ipconfig O
/all O
being O
redirected O
to O
a O
file O
in O
a O
directory O
designated O
for O
files O
to O
be O
uploaded O
. O
 
The O
UPLOAD O
command O
requests O
that O
this B-Entity
file I-Entity
is B-Action
then I-Action
uploaded I-Action
over B-Modifier
SOAP B-Entity
to B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
. O
 
The O
DELETE O
command O
then O
requests O
that O
the B-Entity
file I-Entity
be B-Action
deleted I-Action
from B-Modifier
the B-Entity
infected I-Entity
system I-Entity
. O
 
The O
following O
is O
a B-Entity
list I-Entity
of I-Entity
supported I-Entity
commands I-Entity
that O
TinyZBot B-Entity
responds B-Action
to B-Modifier
: O
Commands B-Entity
such I-Entity
as I-Entity
GETINFO I-Entity
are B-Action
often I-Action
run I-Action
on B-Modifier
newly B-Entity
infected I-Entity
systems I-Entity
, O
as O
they B-Entity
decide B-Action
whether B-Entity
the I-Entity
infection I-Entity
has I-Entity
hit I-Entity
the I-Entity
correct I-Entity
target I-Entity
. O
 
There O
are O
additional O
SOAP O
commands O
, O
but O
they O
will O
not O
be O
covered O
in O
detail O
. O
 
The O
following O
is O
a O
list O
of O
all O
the O
SOAP O
commands O
: O
CheckFileMD5 O
, O
GetFile O
, O
GetFileList O
, O
GetServerTime O
, O
UploadFile O
. O
 
TinyZBot B-Entity
is B-Action
commonly I-Action
installed I-Action
using B-Modifier
some B-Entity
form I-Entity
of I-Entity
deception I-Entity
. O
 
Recent B-Entity
versions I-Entity
use B-Action
the B-Entity
resume- I-Entity
based I-Entity
methods I-Entity
reported I-Entity
in I-Entity
the I-Entity
Initial I-Entity
Compromise I-Entity
sections I-Entity
. O
 
An O
additional O
method O
was O
used O
for O
earlier O
versions O
. O
 
When O
early O
versions O
of O
TinyZBot O
were O
executed O
, O
they B-Entity
opened B-Action
an B-Entity
image I-Entity
stored I-Entity
in I-Entity
the I-Entity
resource I-Entity
section I-Entity
of I-Entity
the I-Entity
executable I-Entity
and O
copied B-Action
the B-Entity
malicious I-Entity
TinyZBot I-Entity
executable I-Entity
to B-Modifier
the B-Entity
% I-Entity
AppData I-Entity
% I-Entity
directory I-Entity
. O
 
Many O
of O
the O
images O
identified O
were O
of O
the O
popular O
Lebanese O
singer O
and O
actress O
Haifa O
Wehbe O
. O
 
The B-Entity
backdoor I-Entity
additionally O
replaced B-Action
the B-Entity
original I-Entity
malicious I-Entity
executable I-Entity
with B-Modifier
an B-Entity
appropriately I-Entity
named I-Entity
image I-Entity
file I-Entity
and O
padded B-Action
the B-Entity
image I-Entity
file I-Entity
with B-Modifier
null B-Entity
bytes I-Entity
in B-Modifier
order I-Modifier
to I-Modifier
mirror B-Entity
the I-Entity
original I-Entity
file I-Entity
size I-Entity
. O
 
The O
earliest O
known O
version O
on O
TinyZBot O
was O
compiled O
on O
January O
27 O
, O
2013 O
. O
 
This O
early O
version O
had O
very O
little O
functionality O
. O
 
It B-Entity
was O
limited O
to O
logging B-Action
keystroke B-Entity
data I-Entity
, O
sending B-Action
emails B-Entity
, O
and O
creating B-Action
a B-Entity
link I-Entity
in B-Modifier
the B-Entity
user I-Entity
's I-Entity
startup I-Entity
folder I-Entity
for B-Modifier
persistence B-Entity
. O
 
Its B-Entity
method I-Entity
of I-Entity
exfiltrating I-Entity
the I-Entity
logged I-Entity
keystrokes I-Entity
relied B-Action
upon B-Modifier
a B-Entity
hardcoded I-Entity
email I-Entity
address I-Entity
stored I-Entity
in I-Entity
the I-Entity
binary I-Entity
. O
 
The O
sender O
email O
address O
was O
dyanachear O
( O
at O
) O
beyondsys.com O
and O
emails O
were O
destined O
for O
testmail00001 O
( O
at O
) O
yahoo.com O
. O
 
The B-Entity
message I-Entity
was O
intended O
to O
look O
like O
common O
Viagra O
spam O
from O
China O
, O
but O
would O
be B-Action
sent I-Action
with B-Modifier
the B-Entity
keystroke I-Entity
logging I-Entity
data I-Entity
as I-Entity
attachments I-Entity
, I-Entity
as I-Entity
well I-Entity
as I-Entity
system I-Entity
information I-Entity
. O
 
The B-Entity
initial I-Entity
version I-Entity
did O
not O
provide O
any O
means O
of O
receiving O
commands O
and O
was B-Action
obfuscated I-Action
with B-Modifier
SmartAssembly B-Entity
. O
 
The O
following O
iteration O
compiled O
on O
March O
12 O
, O
2013 O
, O
only O
contained O
minor O
bug O
fixes O
. O
 
The O
next O
version O
was O
compiled O
on O
April O
24 O
, O
2013 O
. O
 
This O
version O
starts O
to O
look O
more O
like O
an O
average O
bot O
. O
 
A B-Entity
command I-Entity
and I-Entity
control I-Entity
protocol I-Entity
was B-Action
established I-Action
, O
using B-Action
HTTP B-Entity
and I-Entity
SOAP I-Entity
for B-Modifier
the B-Entity
protocol I-Entity
. O
 
The B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
for I-Entity
this I-Entity
version I-Entity
was B-Action
located I-Action
at B-Modifier
173.192.144.68/ B-Entity
DefaultWS I-Entity
( I-Entity
dot I-Entity
) I-Entity
asmx I-Entity
. O
 
This O
new O
command O
and O
control O
protocol O
allowed O
for O
the O
addition O
of O
quite O
a O
few O
other O
features O
. O
 
An O
update O
mechanism O
was O
added O
, O
and O
could O
be O
regularly O
scheduled O
, O
so O
unassisted B-Entity
periodic I-Entity
update I-Entity
checks I-Entity
were B-Action
automatically I-Action
performed I-Action
. O
 
The O
SOAP O
API O
used O
a O
dynamic O
password O
mechanism O
, O
which O
required O
the O
computation O
of O
a O
simple O
key O
in O
order O
to O
access O
certain O
parts O
of O
the O
API O
. O
 
The B-Entity
email I-Entity
data I-Entity
exfiltration I-Entity
method I-Entity
also O
underwent B-Action
modification B-Entity
to B-Modifier
be B-Entity
activated I-Entity
at I-Entity
a I-Entity
scheduled I-Entity
interval I-Entity
. O
 
There O
were O
also O
some O
changes O
, O
which O
looked O
to O
be O
bug O
fixes O
, O
such O
as O
limiting O
the O
number O
of O
times O
sending O
an O
email O
could O
fail O
. O
 
The O
next O
day O
, O
April O
25 O
, O
2013 O
, O
a B-Entity
new I-Entity
version I-Entity
was O
compiled O
which O
allowed B-Action
for B-Modifier
self-deletion B-Entity
. O
 
On O
May O
14 O
, O
2013 O
, O
we O
noticed O
a O
change O
which O
assisted O
in O
the O
identification O
of O
active O
targets O
. O
 
The B-Entity
AppUsageId I-Entity
( I-Entity
at I-Entity
this I-Entity
point I-Entity
named I-Entity
AppType I-Entity
) I-Entity
was O
an O
identifier O
used O
by O
this O
organization O
in O
order O
to O
differentiate B-Action
between B-Entity
targets I-Entity
infected I-Entity
with I-Entity
TinyZBot I-Entity
, O
meaning O
they B-Entity
could O
effectively O
run B-Action
multiple B-Entity
campaigns I-Entity
using B-Modifier
the B-Entity
same I-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
and O
know B-Action
which B-Entity
target I-Entity
was I-Entity
infected I-Entity
. O
 
This O
also O
allowed O
for O
separate B-Entity
commands I-Entity
to O
be B-Action
supplied I-Action
to B-Modifier
different B-Entity
targets I-Entity
without O
the O
need O
for O
per-bot O
commands O
. O
 
At O
this O
time O
, O
the O
AppUsageId O
was O
total0 O
, O
but O
later O
we O
observed O
names O
, O
which O
aligned O
with O
active O
targets O
. O
 
The B-Entity
exfiltration I-Entity
email I-Entity
address I-Entity
was B-Action
also I-Action
changed I-Action
to B-Modifier
TerafficAnalyzer B-Entity
( I-Entity
at I-Entity
) I-Entity
yahoo.com I-Entity
. O
 
On O
June O
17 O
, O
2013 O
, O
there O
was O
an O
addition O
that O
allowed O
for O
the O
loading O
of O
configuration O
data O
from O
the O
PE O
's O
resources O
. O
 
At O
this O
time O
, O
it O
was O
limited O
to O
the O
exfiltration O
email O
address O
. O
 
This O
version O
was O
not O
obfuscated O
with O
SmartAssembly O
We O
do O
not O
see O
a O
new O
version O
of O
TinyZBot O
until O
June O
7 O
, O
2014 O
. O
 
There O
are O
quite O
a O
few O
notable O
improvements O
, O
but O
nowhere O
near O
enough O
to O
indicate O
consistent O
development O
on O
the O
project O
for O
a O
year O
. O
 
SmartAssembly B-Entity
was B-Action
reused I-Action
again O
. O
 
A B-Entity
method I-Entity
was O
added O
to O
detect B-Action
what B-Entity
security I-Entity
related I-Entity
software I-Entity
is I-Entity
installed I-Entity
. O
 
Avira B-Entity
antivirus I-Entity
was B-Action
specifically I-Action
targeted I-Action
and I-Action
disabled I-Action
, O
due O
to O
its O
detection O
of O
the B-Entity
new I-Entity
keystroke I-Entity
logger I-Entity
module I-Entity
added B-Action
in B-Modifier
this B-Entity
version I-Entity
. O
 
This B-Entity
keystroke I-Entity
logger I-Entity
source I-Entity
is B-Action
publicly B-Entity
available I-Entity
and I-Entity
referred I-Entity
to I-Entity
as I-Entity
DeadkeyLogger I-Entity
. O
 
A O
new O
string O
encryption O
class O
is O
added O
, O
but O
the O
code O
was O
copied O
and O
pasted O
from O
a O
Microsoft O
example O
. O
 
The B-Entity
ability I-Entity
to I-Entity
extract I-Entity
Internet I-Entity
Explorer I-Entity
passwords I-Entity
was B-Action
added I-Action
. O
 
Clipboard B-Entity
monitoring I-Entity
code I-Entity
was B-Action
added I-Action
, O
but O
not O
invoked O
. O
 
The O
emailing O
features O
were O
removed O
, O
but O
the O
classes O
which O
previously O
contained O
them O
were O
still O
present O
but O
empty O
. O
 
Many O
more O
options O
were O
enabled O
to O
be O
loaded O
from O
PE O
resources O
. O
 
The O
ability O
to O
add O
PE O
resources O
was O
added O
. O
 
Another O
version O
was O
compiled O
on O
June O
7 O
, O
2014 O
, O
with O
no O
feature O
difference O
. O
 
On O
June O
17 O
, O
2014 O
, O
we O
see2the O
first O
instance O
of O
Binder1 O
, O
which O
is O
aptly O
named O
, O
as O
it O
is O
a O
binder O
. O
 
The O
legitimate O
application O
used O
in O
this O
version O
of O
Binder1 O
was O
compiled O
on O
August O
22 O
, O
2013 O
, O
and O
is O
a O
self-extracting O
archive O
of O
desktop O
wallpapers O
, O
including O
an O
image O
from O
the O
game O
Mirror's O
Edge O
. O
 
The O
TinyZBot O
included O
was O
the O
version O
compiled O
on O
June O
7 O
, O
2014 O
. O
 
The B-Entity
version I-Entity
compiled I-Entity
on I-Entity
June I-Entity
23 I-Entity
, I-Entity
2014 I-Entity
, O
added O
functionality O
which O
allowed B-Action
screenshots B-Entity
of I-Entity
the I-Entity
desktop I-Entity
to B-Modifier
be B-Entity
taken I-Entity
. O
 
On O
August O
2 O
, O
2014 O
, O
we O
see O
another O
version O
without O
SmartAssembly O
obfuscation O
. O
 
A B-Entity
bug I-Entity
fix I-Entity
is B-Action
made I-Action
to B-Modifier
the B-Entity
keystroke I-Entity
logging I-Entity
method I-Entity
, O
and O
clipboard B-Entity
monitoring I-Entity
is B-Action
enabled I-Action
. O
 
Three O
items O
were O
compiled O
on O
August O
18 O
, O
2014 O
. O
 
Two O
of O
them O
are O
TinyZBot O
binaries O
, O
which O
contain O
a O
minor O
key O
logging O
bug O
fix O
. O
 
The O
third O
is O
a O
new O
Binder1 O
instance O
, O
which O
contains O
one O
of O
the O
TinyZBot O
instances O
compiled O
that O
day O
. O
 
The O
legitimate O
application O
included O
in O
this O
binder O
is O
called O
Easyresumecreator O
and O
is O
a O
legitimate O
application O
named O
EasyRésuméCreatorPro O
. O
 
This O
version O
targeted O
a O
major O
Saudi O
Arabian O
oil O
company O
. O
 
From O
August O
23 O
to O
August O
26 O
, O
2014 O
, O
new O
versions O
of O
TinyZBot O
were O
compiled O
with O
the O
AppUsageIds O
targeting O
major O
oil O
and O
gas O
companies O
in O
Qatar O
and O
Kuwait O
, O
Ministries O
of O
Foreign O
Affairs O
in O
the O
Persian O
Gulf O
, O
and O
a O
major O
airline O
holding O
company O
in O
UAE O
. O
 
These O
versions O
of O
TinyZBot O
moved O
towards O
a O
more O
modular O
architecture O
where O
each O
component O
was O
in O
its O
own O
.NET O
 
assembly O
. O
 
This B-Entity
was O
presumably O
done O
to O
limit B-Action
antivirus B-Entity
detection I-Entity
of I-Entity
each I-Entity
individual I-Entity
file I-Entity
as O
well O
as O
allow O
for O
dynamic O
updating O
of O
specific O
modules O
. O
 
All O
of O
these O
were O
included O
in O
their O
own O
Binder1 O
instance O
, O
which O
also O
dropped O
Easyresumecreator O
. O
 
There O
also O
seem O
to O
be O
improved O
software O
engineering O
practices O
in O
many O
locations O
. O
 
FTP B-Entity
upload I-Entity
support I-Entity
was B-Action
added I-Action
, O
with B-Modifier
hardcoded B-Entity
credentials I-Entity
of I-Entity
ano:1 I-Entity
. O
 
This B-Entity
FTP I-Entity
upload I-Entity
functionality I-Entity
points B-Action
to B-Modifier
the B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
, O
and O
is B-Action
invoked I-Action
by B-Modifier
a B-Entity
command I-Entity
in I-Entity
the I-Entity
SOAP I-Entity
command I-Entity
and I-Entity
control I-Entity
channel I-Entity
. O
 
These B-Entity
versions I-Entity
have O
the O
capability O
to O
install B-Action
as B-Modifier
a B-Entity
service I-Entity
. O
 
On O
August O
25 O
, O
2014 O
, O
the O
version O
compiled O
on O
August O
18 O
was O
submitted O
to O
VirusTotal O
in O
a O
ZIP O
archive O
located O
at O
http O
: O
//dl.doosan-job O
( O
dot O
) O
com/cv/EasyResumeCreator- O
v2.0.zip O
. O
 
This O
indicates O
that O
TinyZBot B-Entity
is O
not O
only O
being B-Action
installed I-Action
while B-Modifier
impersonating B-Entity
a I-Entity
résumé I-Entity
creation I-Entity
suite I-Entity
, O
but O
is B-Action
also I-Action
impersonating I-Action
potential B-Entity
employers I-Entity
when B-Modifier
distributed B-Entity
. O
 
On O
September O
9 O
, O
2014 O
, O
a O
ZIP O
file O
containing O
TinyZBot O
and O
a O
configuration O
targeting O
a O
major O
US O
university O
with O
its O
AppUsageId O
was O
created O
. O
 
This O
was O
discovered O
on O
an O
anonymous O
FTP O
server O
in O
the O
same O
IP O
range O
as O
dl.doosan-job O
( O
dot O
) O
com O
along O
with O
other O
malware O
. O
 
From O
September O
11 O
through O
September O
17 O
, O
2014 O
, O
some O
TinyZBot O
components O
were O
compiled O
, O
along O
with O
a O
new O
dropper O
. O
 
This B-Entity
dropper I-Entity
impersonated B-Action
a B-Entity
tool I-Entity
to I-Entity
submit I-Entity
a I-Entity
résumé I-Entity
to I-Entity
Teledyne I-Entity
. O
 
When O
executed O
, O
the O
user O
is O
prompted O
to O
enter O
personal O
information O
, O
and O
at O
the O
end O
is O
given O
a O
button O
to O
submit O
the O
résumé O
to O
Teledyne O
, O
although O
nothing O
is O
actually O
submitted O
. O
 
While B-Modifier
the B-Entity
user I-Entity
enters I-Entity
this I-Entity
information I-Entity
, O
their B-Entity
machine I-Entity
is B-Action
infected I-Action
with B-Modifier
TinyZBot B-Entity
. O
 
The O
AppUsageIds O
for O
these O
versions O
target O
a O
major O
US-based O
university O
as O
well O
as O
an O
Israeli O
aerospace O
company O
. O
 
These B-Entity
versions I-Entity
began O
to O
include B-Action
a B-Entity
new I-Entity
method I-Entity
of I-Entity
installing I-Entity
as I-Entity
a I-Entity
service I-Entity
. O
 
The O
service O
runs O
with O
the O
name O
Network O
Connectivity O
Manager O
. O
 
TinyZBot O
, O
as O
well O
as O
some O
other O
tools O
( O
Csext O
, O
Net O
Crawler O
) O
initially O
would O
not O
run O
without O
a O
command O
line O
parameter O
set O
. O
 
This B-Entity
was O
likely O
to O
avoid B-Action
detonation-based B-Entity
detection I-Entity
engines I-Entity
. O
 
This O
command O
line O
parameter O
was O
opensesemi O
which O
is O
often O
stored O
in O
the O
application O
's O
code O
in O
an O
obfuscated O
manner O
. O
 
The O
binders O
and O
droppers O
for O
TinyZBot O
provided O
this O
command O
line O
argument O
and O
others O
when O
executing O
. O
 
TinyZBot O
uses O
a O
dynamic O
mutex O
. O
 
This O
was O
accomplished O
by O
combining O
a O
static O
preset O
prefix O
with O
the O
active O
process O
ID O
. O
 
This O
allowed O
supplemental B-Entity
tools I-Entity
to O
keep O
TinyZBot O
running O
by O
enumerating B-Action
every B-Entity
process I-Entity
and O
checking O
if O
the O
process O
ID O
and O
mutex O
prefix O
existed O
. O
 
If B-Modifier
no B-Entity
mutex I-Entity
and I-Entity
process I-Entity
pair I-Entity
was I-Entity
located I-Entity
, O
another B-Entity
TinyZBot I-Entity
instance I-Entity
would O
be B-Action
started I-Action
. O
 
Multiple B-Entity
backdoors I-Entity
were B-Action
used I-Action
by O
this B-Entity
organization I-Entity
. O
 
These O
are O
scripts B-Entity
or I-Entity
applications I-Entity
that O
allowed B-Action
for B-Modifier
command B-Entity
or I-Entity
code I-Entity
execution I-Entity
outside I-Entity
of I-Entity
the I-Entity
victim I-Entity
network I-Entity
. O
 
Many B-Entity
of I-Entity
their I-Entity
backdoors I-Entity
were B-Action
web B-Entity
applications I-Entity
, O
added O
to O
web O
servers O
, O
so O
commands B-Entity
can O
be B-Action
executed I-Action
from B-Modifier
a B-Entity
browser I-Entity
or I-Entity
client I-Entity
able I-Entity
to I-Entity
communicate I-Entity
with I-Entity
them I-Entity
. O
 
This B-Entity
group I-Entity
includes B-Action
the B-Entity
results I-Entity
of I-Entity
the I-Entity
Shell I-Entity
Creator I-Entity
mentioned I-Entity
in I-Entity
the I-Entity
Attribution I-Entity
section I-Entity
, I-Entity
as I-Entity
well I-Entity
as I-Entity
ASPX I-Entity
backdoors I-Entity
used I-Entity
by I-Entity
Nesha I-Entity
. O
 
A B-Entity
PHP I-Entity
shell I-Entity
was B-Action
also I-Action
observed I-Action
, O
which O
also O
included O
attribution O
to O
Nesha O
in O
its O
hashed O
password O
. O
 
An B-Entity
ASPX I-Entity
backdoor I-Entity
named I-Entity
Zh0uSh311 I-Entity
was B-Action
located I-Action
on B-Modifier
live B-Entity
servers I-Entity
as O
well O
as O
recovered B-Action
fro B-Modifier
a B-Entity
staging I-Entity
server I-Entity
. O
 
This O
backdoor O
does O
not O
require O
authentication O
, O
and O
its O
use O
appears O
to O
be O
straightforward O
. O
 
Its B-Entity
functionality I-Entity
breaks B-Action
down I-Action
into B-Modifier
three O
fairly O
standard O
components O
: O
SQL B-Entity
queries I-Entity
, O
executing B-Entity
commands I-Entity
, O
and O
uploading B-Entity
files I-Entity
. O
 
This B-Entity
organization I-Entity
utilized B-Action
backdoors B-Entity
which O
masqueraded B-Action
as B-Modifier
varying B-Entity
versions I-Entity
of I-Entity
Notepad I-Entity
. O
 
They O
replace O
the O
existing O
Notepad.exe O
on O
the O
infected O
machine O
, O
and O
when O
run O
they B-Entity
call B-Action
out I-Action
to B-Modifier
a B-Entity
remote I-Entity
server I-Entity
and O
execute B-Action
any B-Entity
shell I-Entity
code I-Entity
returned I-Entity
by I-Entity
the I-Entity
remote I-Entity
server I-Entity
. O
 
There O
will O
be O
a O
detailed O
analysis O
of O
these O
backdoors O
posted O
to O
Cylance O
's O
blog O
in O
the O
future O
. O
 
PVZ O
is O
a O
name O
for O
a O
set O
of O
executables O
used O
together O
to O
create O
a O
botnet O
. O
 
The O
name O
PVZ O
was O
assigned O
by O
us O
as O
this O
is O
one O
of O
the O
few O
tools O
this O
organization O
has O
not O
named O
themselves O
. O
 
The O
components O
are O
as O
follows O
: O
XYNTService O
was O
not O
developed O
by O
the O
Cleaver O
team O
, O
but O
instead O
is O
a B-Entity
publicly I-Entity
available I-Entity
project I-Entity
which O
executes B-Action
an B-Entity
executable I-Entity
as B-Modifier
a B-Entity
service I-Entity
. O
 
The O
purpose O
of O
PVZ-In B-Entity
is O
to O
communicate B-Action
with B-Modifier
a B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
. O
 
Communication O
is O
primarily O
unidirectional O
, O
as O
little O
information O
is O
provided O
from O
the O
bot O
to O
its O
command O
and O
control O
server O
. O
 
The B-Entity
known I-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
is B-Action
located I-Action
at B-Modifier
http B-Entity
: I-Entity
//kundenpflege I-Entity
. I-Entity
menrad I-Entity
( I-Entity
dot I-Entity
) I-Entity
de/js/jquery/default.aspx I-Entity
and O
the B-Entity
command I-Entity
and I-Entity
control I-Entity
protocol I-Entity
only O
uses B-Action
HTTP B-Entity
. O
 
The B-Entity
commands I-Entity
as I-Entity
well I-Entity
as I-Entity
infected I-Entity
computer I-Entity
information I-Entity
are B-Action
transferred I-Action
in B-Modifier
the B-Entity
Content- I-Entity
Disposition I-Entity
HTTP I-Entity
header I-Entity
, O
making O
the B-Entity
traffic I-Entity
easy O
to O
pass B-Action
over I-Action
as B-Modifier
benign B-Entity
. O
 
When O
a B-Entity
command I-Entity
is B-Action
received I-Action
from B-Modifier
the B-Entity
server I-Entity
, O
the B-Entity
results I-Entity
are B-Action
stored I-Action
in B-Modifier
a B-Entity
central I-Entity
location I-Entity
on I-Entity
disk I-Entity
that I-Entity
the I-Entity
PVZ I-Entity
tools I-Entity
utilize I-Entity
. O
 
Command B-Entity
functionality I-Entity
is B-Action
limited I-Action
to B-Modifier
executing B-Entity
supplied I-Entity
commands I-Entity
, O
downloading B-Entity
and O
executing B-Entity
executables I-Entity
as O
well O
as O
self-updating B-Entity
. O
 
The O
debug O
file O
path O
for O
PVZ-In O
is O
: O
PVZ-In O
has O
been O
observed O
using O
the O
file O
name O
ossisvc.exe O
. O
 
PVZ-Out B-Entity
is B-Action
the B-Entity
other I-Entity
half I-Entity
of I-Entity
the I-Entity
command I-Entity
and I-Entity
control I-Entity
channel I-Entity
, O
primarily O
uploading B-Action
results B-Entity
of I-Entity
commands I-Entity
and I-Entity
keystroke I-Entity
logging I-Entity
data I-Entity
to B-Modifier
a B-Entity
remote I-Entity
server I-Entity
. O
 
The B-Entity
known I-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
for I-Entity
PVZ-Out I-Entity
is B-Action
located I-Action
at B-Modifier
http B-Entity
: I-Entity
//www.gesunddurchsjahr I-Entity
( I-Entity
dot I-Entity
) I-Entity
de/tor/default.aspx I-Entity
. O
 
Much O
like O
PVZ-In O
, O
this B-Entity
command I-Entity
and I-Entity
control I-Entity
channel I-Entity
communicates B-Action
with B-Modifier
the B-Entity
Content-Disposition I-Entity
HTTP I-Entity
header I-Entity
, O
but O
for B-Modifier
file B-Entity
data I-Entity
, O
POST B-Entity
data I-Entity
is B-Action
supplied I-Action
. O
 
Data B-Entity
uploaded I-Entity
is B-Action
often I-Action
compressed I-Action
, O
which O
can O
make B-Action
it B-Entity
more B-Entity
difficult I-Entity
to I-Entity
detect I-Entity
the I-Entity
exfiltration I-Entity
of I-Entity
sensitive I-Entity
information I-Entity
. O
 
The O
debug O
file O
path O
for O
PVZ-Out O
is O
: O
PVZ-Out O
has O
been O
observed O
with O
the O
file O
name O
osppsvc.exe O
. O
 
SYN B-Entity
Flooder I-Entity
is B-Action
a B-Entity
simple I-Entity
network I-Entity
based I-Entity
denial I-Entity
of I-Entity
service I-Entity
tool I-Entity
. O
 
It O
is O
a B-Entity
command I-Entity
line I-Entity
utility I-Entity
capable O
of O
being B-Action
invoked I-Action
by O
PVZ-In B-Entity
. O
 
Targeting O
information O
is O
supplied O
via O
command O
line O
parameters O
. O
 
The O
debug O
file O
path O
for O
SYN O
Flooder O
is O
: O
SYN O
Flooder O
has O
been O
observed O
using O
the O
name O
ossysvc.exe O
. O
 
Logger B-Entity
Module I-Entity
observes B-Action
the B-Entity
user I-Entity
's I-Entity
actions I-Entity
and O
records B-Action
them B-Entity
to B-Modifier
a B-Entity
file I-Entity
. O
 
The B-Entity
recorded I-Entity
actions I-Entity
include B-Action
mouse B-Entity
clicks I-Entity
, O
active B-Entity
windows I-Entity
, O
keypresses B-Entity
, O
as O
well O
as O
clipboard B-Entity
data I-Entity
. O
 
The B-Entity
resulting I-Entity
log I-Entity
is B-Action
written I-Action
out I-Action
to O
a O
location O
where O
PVZ-Out B-Entity
can O
exfiltrate B-Action
it B-Entity
to B-Modifier
its B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
. O
 
Logger O
Module O
has O
been O
observed O
using O
the O
name O
ospcsvc.exe O
. O
 
The B-Entity
following I-Entity
command I-Entity
and I-Entity
control I-Entity
servers I-Entity
for I-Entity
Logger I-Entity
Module I-Entity
have O
been B-Action
observed I-Action
: O
WndTest O
is O
the O
evolution O
of O
the O
PVZ O
tool O
chain O
into O
a O
single O
executable O
. O
 
The B-Entity
tool I-Entity
chain I-Entity
is B-Action
minimized I-Action
down I-Action
to B-Modifier
a B-Entity
command I-Entity
and I-Entity
control I-Entity
communications I-Entity
, O
keystroke B-Entity
logging I-Entity
, O
and O
clipboard B-Entity
monitoring I-Entity
. O
 
The B-Entity
command I-Entity
and I-Entity
control I-Entity
still O
supports O
upgrading B-Action
, O
downloading B-Action
, O
and O
executing B-Action
of O
applications B-Entity
, O
as O
well O
as O
executing B-Action
batch B-Entity
scripts I-Entity
. O
 
WndTest B-Entity
installs B-Action
as B-Modifier
a B-Entity
service I-Entity
and O
has O
been O
observed O
attempting O
to O
impersonate B-Action
Adobe B-Entity
Report I-Entity
Service I-Entity
. O
 
WndTest B-Entity
starts O
using B-Action
PHP B-Entity
servers I-Entity
for B-Modifier
its B-Entity
command I-Entity
and I-Entity
control I-Entity
server I-Entity
, O
some O
of O
which O
are O
listed O
as O
defaced O
sites O
. O
 
We O
have O
seen O
wndTest B-Entity
communicate B-Action
with B-Modifier
the B-Entity
following I-Entity
servers I-Entity
: O
Csext B-Entity
is B-Action
a B-Entity
backdoor I-Entity
application I-Entity
developed I-Entity
in I-Entity
C I-Entity
# I-Entity
which O
runs B-Action
as B-Modifier
a B-Entity
service I-Entity
. O
 
Its O
primary O
functionality O
is O
based O
on O
commands O
supplied O
by O
its O
configuration O
file O
. O
 
The O
configuration O
file O
is O
able O
to O
store O
specific O
commands O
, O
which O
are O
intended O
to O
run O
at O
particular O
times O
. O
 
A O
recovered O
configuration O
is O
as O
follows O
: O
This B-Entity
configuration I-Entity
executes B-Action
zhCat B-Entity
to O
connect B-Action
back B-Modifier
to I-Modifier
srv01.microsoftwindowsupdate B-Entity
( I-Entity
dot I-Entity
) I-Entity
net I-Entity
( I-Entity
a I-Entity
deceptive I-Entity
domain I-Entity
owned I-Entity
by I-Entity
this I-Entity
group I-Entity
with I-Entity
falsified I-Entity
Whois I-Entity
data I-Entity
attributing I-Entity
to I-Entity
Microsoft I-Entity
Investor I-Entity
Relations I-Entity
) I-Entity
with B-Modifier
XORed B-Entity
communication I-Entity
using B-Modifier
the B-Entity
HTTP I-Entity
protocol I-Entity
on B-Modifier
TCP B-Entity
port I-Entity
443 I-Entity
. O
 
This B-Entity
zhCat I-Entity
instance I-Entity
is B-Action
running I-Action
cmd.exe B-Entity
, O
effectively O
making B-Action
it B-Entity
a B-Entity
reverse I-Entity
connecting I-Entity
shell I-Entity
. O
 
This B-Entity
command I-Entity
runs O
at O
00:29 O
in O
the O
morning O
, O
and O
is B-Action
killed I-Action
by O
taskkill B-Entity
at B-Modifier
00:35 B-Entity
. O
 
This O
gives O
the B-Entity
attackers I-Entity
a O
predictable O
method O
to O
regain B-Action
access B-Entity
to I-Entity
a I-Entity
compromised I-Entity
network I-Entity
if B-Modifier
they B-Entity
ever I-Entity
lose I-Entity
access I-Entity
. O
 
Csext B-Entity
also O
has B-Action
email B-Entity
functionality I-Entity
similar I-Entity
to I-Entity
TinyZBot I-Entity
. O
 
This B-Entity
email I-Entity
functionality I-Entity
is O
used O
to O
exfiltrate B-Action
the B-Entity
results I-Entity
of I-Entity
commands I-Entity
from I-Entity
the I-Entity
command I-Entity
file I-Entity
which I-Entity
can I-Entity
also I-Entity
include I-Entity
requests I-Entity
like I-Entity
gathering I-Entity
user I-Entity
information I-Entity
. O
 
We O
have O
seen O
Csext B-Entity
configured O
to O
communicate B-Action
with B-Modifier
the B-Entity
following I-Entity
servers I-Entity
: O
If O
after O
reviewing O
the O
Indicators O
of O
Compromise O
( O
IOC O
) O
listed O
in O
Appendix O
A O
, O
you O
believe O
your O
organization O
to O
be O
a O
victim O
of O
Operation O
Cleaver O
, O
we O
recommend O
you O
consider O
the O
following O
course O
of O
action O
: O
1 O
. O
 
If O
inside O
the O
United O
States O
, O
contact O
the O
Federal O
Bureau O
of O
Investigation O
( O
FBI O
) O
via O
either O
your O
local O
FBI O
team O
or O
FBI O
CYWATCH O
at O
1-855-292-3937 O
or O
cywatch O
@ O
ic.fbi.gov O
. O
 
2 O
. O
 
If O
outside O
the O
United O
States O
, O
contact O
your O
local O
, O
district O
, O
state O
or O
federal O
law O
enforcement O
authorities O
. O
 
3 O
. O
 
If O
you O
have O
visibility O
into O
the O
attacks O
on O
your O
company O
and O
the O
tools O
and O
expertise O
to O
track O
them O
down O
, O
leverage O
the O
IOCs O
in O
Appendix O
A O
to O
identify O
their O
presence O
in O
your O
network O
, O
prevent O
them O
from O
expanding O
the O
scope O
of O
the O
compromise O
, O
and O
remove O
their O
access O
immediately O
. O
 
4 O
. O
 
If O
you O
do O
NOT O
have O
visibility O
into O
the O
attacks O
, O
need O
help O
identifying O
an O
existing O
successful O
compromise O
in O
your O
organization O
, O
or O
more O
importantly O
wish O
to O
prevent O
this O
attack O
or O
attacks O
similar O
to O
Operation O
Cleaver O
, O
please O
contact O
your O
security O
provider O
. O
 
5 O
. O
 
If O
you O
wish O
to O
contact O
Cylance O
for O
additional O
details O
not O
available O
in O
this O
report O
, O
please O
email O
opcleaver O
@ O
cylance.com O
. O
 
6 O
. O
 
If O
you O
would O
like O
to O
learn O
more O
about O
Cylance O
products O
and O
professional O
services O
, O
or O
discuss O
how O
Cylance O
can O
mitigate O
Operation O
Cleaver O
's O
impact O
to O
your O
organization O
, O
please O
contact O
us O
directly O
. O
 
Iran O
in O
2014 O
can O
probably O
be O
best O
described O
as O
galvanizing O
. O
 
They O
have O
long O
been O
an O
'' O
enemy O
'' O
of O
the O
west O
, O
and O
the O
United O
States O
in O
particular O
, O
but O
today O
's O
headlines O
include O
a O
variety O
of O
topics O
from O
nuclear O
talks O
to O
human O
rights O
to O
terrorism O
to O
cyber O
hacking O
. O
 
Iran O
continues O
to O
be O
extremely O
active O
on O
the O
global O
stage O
– O
and O
thereby O
on O
the O
radar O
of O
every O
superpower O
. O
 
Iran O
's O
cyber O
sophistication O
has O
grown O
rapidly O
since O
the O
dawn O
of O
Stuxnet O
and O
they O
have O
used O
hard O
dollars O
combined O
with O
national O
pride O
to O
help O
build O
their O
cyber O
army O
. O
 
Few O
doubt O
their O
commitment O
as O
a O
government O
and O
nation O
state O
to O
funding O
and O
recruiting O
cyber O
warriors O
to O
infiltrate O
and O
damage O
their O
enemies O
. O
 
And O
it O
has O
been O
commonly O
postulated O
that O
almost O
all O
activity O
since O
2010 O
coming O
out O
of O
Iran O
is O
associated O
with O
retaliation O
for O
Stuxnet/Duqu/Flame O
, O
which O
seems O
natural O
given O
the O
severity O
of O
the O
impact O
. O
 
But O
they O
do O
n't O
need O
Stuxnet O
as O
motivation O
to O
want O
to O
hack O
the O
world O
. O
 
They O
have O
long O
desired O
power O
on O
the O
political O
stage O
, O
in O
particular O
in O
the O
fight O
for O
nuclear O
power O
autonomy O
. O
 
With O
the O
deadlines O
around O
the O
Iranian O
nuclear O
discussions O
pushed O
to O
2015 O
, O
the O
attacks O
may O
be O
tied O
to O
negotiating O
power O
when O
discussing O
a O
pact O
with O
the O
nuclear O
superpowers O
of O
United O
States O
, O
Britain O
, O
France O
, O
Germany O
, O
Russia O
and O
China O
. O
 
The O
inner O
workings O
of O
the O
Iranian O
government O
remain O
largely O
a O
mystery O
to O
the O
western O
world O
. O
 
However O
, O
Iran O
's O
control O
over O
its O
people O
and O
the O
private O
businesses O
birthed O
inside O
has O
been O
well O
reported O
. O
 
In O
a O
2014 O
Reuters O
article O
, O
the O
reporters O
detail O
how O
the O
secret O
Iranian O
organization O
called O
'' O
Setad O
Ejraiye O
Farmane O
Hazrate O
Emam O
'' O
has O
become O
one O
of O
the O
most O
powerful O
organizations O
in O
the O
country O
, O
capable O
of O
taking O
over O
properties O
and O
businesses O
, O
buying O
controlling O
interests O
in O
numerous O
sectors O
including O
finance O
, O
oil O
, O
telecommunications O
and O
many O
others O
totaling O
in O
upwards O
of O
$ O
95B O
. O
 
Even O
the O
US O
Treasury O
has O
documented O
an O
extensive O
fronting O
of O
companies O
in O
its O
report O
of O
Execution O
of O
Imam O
Khomeini O
's O
Order O
( O
EIKO O
) O
, O
which O
through O
its O
two O
main O
subsidiaries O
controls O
37 O
private O
businesses O
that O
are O
purely O
front O
companies O
for O
the O
Iranian O
government O
. O
 
The O
history O
of O
Iran O
controlling O
the O
usage O
of O
the O
Internet O
and O
the O
very O
Internet O
on-ramps O
into O
Iran O
is O
well O
known O
, O
. O
 
They O
have O
controlled O
much O
of O
the O
country O
's O
Internet O
access O
to O
date O
and O
have O
taken O
over O
controlling O
interests O
in O
those O
companies O
to O
carry O
out O
their O
work O
. O
 
Given O
Operation O
Cleaver's O
frequent O
spin-up O
and O
take-down O
of O
large O
IP O
blocks O
inside O
the O
AFRANET O
IP O
space O
inside O
Iran O
, O
and O
Iran O
's O
well O
recorded O
investment O
in O
cyber O
warfare O
leads O
us O
to O
one O
simple O
conclusion O
: O
Iran O
is O
extremely O
active O
in O
the O
world O
of O
hacking O
. O
 
Operation O
Cleaver O
's O
intense O
focus O
on O
critical O
infrastructure O
companies O
, O
especially O
in O
South O
Korea O
, O
hints O
at O
information O
sharing O
or O
joint O
operations O
with O
Iran O
's O
partner O
, O
North O
Korea O
. O
 
In O
September O
, O
2012 O
, O
Iran O
signed O
an O
extensive O
agreement O
for O
technology O
cooperation O
agreement O
with O
North O
Korea O
, O
which O
allows O
for O
collaboration O
on O
a O
variety O
of O
efforts O
including O
IT O
and O
security O
. O
 
Operation O
Cleaver O
's O
carefully O
selected O
targets O
like O
the O
oil O
and O
gas O
industry O
, O
energy O
and O
utility O
companies O
, O
as O
well O
as O
airlines O
and O
airports O
, O
indicates O
Iran O
's O
desire O
to O
gain O
deep O
access O
into O
the O
world O
's O
most O
critical O
environments O
. O
 
The O
end O
goal O
of O
this O
operation O
is O
not O
known O
at O
this O
time O
. O
 
University O
student O
recruitment O
was O
hinted O
at O
within O
Operation O
Cleaver O
and O
is O
consistent O
with O
Iran O
's O
reported O
history O
of O
active O
warrior O
recruitment O
in O
the O
educational O
space O
. O
 
Overall O
, O
there O
are O
many O
reasons O
that O
Iran O
may O
be O
pursuing O
the O
targets O
they O
did O
in O
Operation O
Cleaver O
. O
 
While O
we O
may O
never O
truly O
know O
, O
it O
is O
important O
to O
consider O
all O
the O
above O
and O
more O
when O
trying O
to O
understand O
the O
why O
. O
 
After O
tracking O
the O
Operation O
Cleaver O
team O
for O
over O
two O
years O
, O
we O
're O
led O
to O
the O
inexorable O
conclusion O
: O
the O
government O
of O
Iran O
, O
and O
particularly O
the O
Islamic O
Revolutionary O
Guard O
Corps O
( O
IRGC O
) O
, O
is O
backing O
numerous O
groups O
and O
front O
entities O
to O
attack O
the O
world O
's O
critical O
infrastructure O
. O
 
As O
security O
experts O
in O
Critical O
Infrastructure O
and O
Key O
Resources O
( O
CIKR O
) O
, O
Industrial O
Control O
Systems O
( O
ICS O
) O
, O
Supervisory O
Control O
and O
Data O
Acquisition O
( O
SCADA O
) O
systems O
, O
Building O
Management O
Systems O
( O
BMS O
) O
, O
embedded O
systems O
and O
fixed-function O
systems O
, O
we O
know O
how O
easy O
they O
are O
to O
hack O
. O
 
We O
have O
worked O
with O
countless O
customers O
and O
vendors O
throughout O
the O
years O
to O
notify O
them O
of O
vulnerabilities O
, O
assist O
with O
remediatation O
efforts O
, O
and O
help O
mitigate O
threats O
to O
their O
environments O
. O
 
Unfortunately O
, O
many O
critical O
infrastructure O
organizations O
are O
unable O
to O
secure O
their O
complex O
envirnoments O
against O
modern O
attacks O
. O
 
They O
fall O
victim O
to O
the O
'' O
glue O
flu O
'' O
, O
a O
malaise O
of O
feeling O
stuck O
, O
not O
wanting O
to O
change O
the O
status O
quo O
for O
fear O
they O
will O
find O
problems O
that O
they O
have O
no O
idea O
how O
to O
prevent O
. O
 
This O
'' O
security O
anaphylaxis O
'' O
spells O
real O
disaster O
. O
 
If O
Operation O
Cleaver O
does O
n't O
get O
the O
world O
to O
wake O
up O
to O
what O
is O
happening O
in O
the O
silent O
world O
of O
cyber O
, O
then O
perhaps O
nothing O
will O
. O
 
Prevention O
is O
everything O
and O
we O
should O
never O
give O
up O
until O
it's O
achieved O
. O
 
Challenge O
your O
trusted O
advisors O
. O
 
Challenge O
your O
security O
vendors O
. O
 
Demand O
better O
technology O
and O
services O
to O
detect O
, O
respond O
, O
but O
most O
importantly O
PREVENT O
not O
just O
contemporary O
attacks O
, O
but O
future O
exotic O
attacks O
that O
have O
yet O
to O
be O
imagined O
. O
 
That O
is O
what O
truly O
disruptive O
and O
innovative O
technology O
is O
. O
 
Do O
n't O
settle O
for O
anything O
less O
. O
 
We O
hope O
that O
by O
exposing O
the O
Operation O
Cleaver O
team O
to O
the O
world O
, O
current O
global O
critical O
infrastructure O
victims O
can O
be O
notified O
, O
and O
prevent O
future O
victimization O
from O
suffering O
the O
consequences O
of O
'' O
status O
quo O
'' O
security O
. O
 
Unlike O
United O
Flight O
811 O
, O
perhaps O
we O
can O
prevent O
the O
next O
disaster O
. O
 
DEFENDERS O
, O
NEVER O
GIVE O
UP O
! O
In O
the O
face O
of O
growing O
and O
evolving O
threats O
, O
traditional O
cyber O
protection O
technologies O
are O
now O
widely O
considered O
inadequate O
. O
 
The O
only O
way O
to O
regain O
the O
upper O
hand O
against O
a O
new O
generation O
of O
attackers O
, O
is O
to O
embrace O
something O
entirely O
new O
. O
 
Something O
that O
'' O
thinks O
'' O
like O
an O
attacker O
. O
 
Something O
that O
does O
n't O
rely O
on O
a O
trust O
model O
or O
care O
about O
hash O
lookups O
. O
 
Something O
with O
a O
brain O
. O
 
Cylance O
has O
eschewed O
the O
old O
foundations O
that O
existing O
cybersecurity O
products O
are O
built O
upon O
. O
 
Instead O
, O
we O
've O
based O
our O
approach O
on O
mathematics O
, O
machine O
learning O
, O
and O
data O
science O
. O
 
This O
algorithmic O
approach O
has O
been O
proven O
to O
detect O
– O
and O
stop O
– O
exponentially O
more O
modern O
threats O
. O
 
Leveraging O
algorithmic O
risk O
modeling O
, O
CylancePROTECT O
protects O
endpoints O
from O
everyday O
viruses O
, O
worms O
, O
trojans O
, O
and O
spyware O
, O
but O
unlike O
other O
security O
products O
, O
CylancePROTECT O
offers O
true O
future-proof O
protection O
against O
the O
most O
malicious O
threats O
in O
the O
world O
. O
 
Advanced O
Persistent O
Threats O
( O
APT O
) O
, O
0-days O
, O
and O
exotic O
exploitation O
techniques O
are O
easily O
detected O
and O
halted O
with O
little-to-no O
impact O
on O
the O
end-user O
. O
 
Existing O
reactive O
solutions O
rely O
on O
a O
constant O
stream O
of O
signature O
updates O
for O
threat O
detection O
, O
which O
is O
not O
only O
costly O
and O
inconvenient O
, O
but O
also O
requires O
'' O
sacrificial O
lambs O
'' O
. O
 
Only O
after O
a O
previously O
unseen O
threat O
has O
inflicted O
damage O
can O
the O
rest O
of O
the O
industry O
begin O
to O
detect O
it O
. O
 
CylancePROTECT O
does O
n't O
require O
constant O
updates O
or O
even O
a O
network O
connection O
to O
protect O
against O
so-called O
'' O
previously O
undetectable O
'' O
threats O
. O
 
By O
identifying O
and O
defusing O
attacks O
in O
near O
real O
time O
, O
before O
the O
attack O
can O
execute O
, O
we O
can O
finally O
do O
away O
with O
the O
need O
for O
a O
'' O
patient O
zero O
'' O
. O
 
As O
Richard O
Stiennon O
, O
Chief O
Research O
Analyst O
at O
IT-Harvest O
, O
put O
it O
, O
'' O
Many O
vendors O
are O
trying O
to O
solve O
the O
endpoint O
problem O
, O
yet O
Cylance O
is O
the O
only O
one O
using O
the O
power O
of O
math O
to O
stop O
malware O
and O
with O
more O
effectiveness O
and O
efficiency O
than O
current O
solutions O
'' O
. O
 
Interested O
in O
seeing O
what O
CylancePROTECT O
can O
do O
for O
your O
organization O
? O
Contact O
us O
! O
Cylance O
is O
one O
of O
the O
fastest O
growing O
cybersecurity O
technology O
firms O
in O
the O
US O
. O
 
Cylance O
's O
flagship O
product O
CylancePROTECT O
has O
been O
adopted O
by O
Fortune O
500 O
companies O
and O
government O
agencies O
across O
the O
globe O
. O
 
Cylance O
was O
founded O
by O
27-year O
security O
industry O
luminary O
, O
Stuart O
McClure O
, O
former O
Global O
CTO O
of O
McAfee O
, O
original O
founder O
of O
Foundstone O
, O
and O
lead O
author O
of O
the O
international O
best-selling O
book O
Hacking O
Exposed O
. O
 
In O
building O
Cylance O
, O
Stuart O
brought O
together O
the O
best O
scientific O
and O
executive O
minds O
from O
the O
likes O
of O
Cisco O
, O
Sourcefire O
, O
Google O
and O
McAfee O
. O
 
The O
Cylance O
board O
of O
advisors O
includes O
former O
high-ranking O
officials O
from O
the O
DHS O
, O
the O
FBI O
, O
CIA O
, O
and O
executive O
titans O
of O
business O
. O
 
CylancePROTECT O
is O
the O
only O
next O
generation O
endpoint O
security O
product O
that O
applies O
math O
to O
mute O
existing O
and O
future O
malware O
, O
viruses O
, O
worms O
, O
trojans O
, O
bots O
, O
APTs O
, O
0-days O
, O
exploits O
, O
adware O
, O
spyware O
and O
hacking O
tools O
– O
without O
needing O
any O
updates O
or O
even O
a O
connection O
to O
the O
Internet O
. O
 
The O
technology O
is O
founded O
on O
the O
principle O
that O
to O
fix O
the O
industry O
, O
you O
must O
start O
from O
scratch O
with O
a O
way O
as O
yet O
unseen O
. O
 
CylancePROTECT O
does O
not O
rely O
on O
signatures O
of O
any O
sort O
( O
blacklist O
or O
whitelist O
) O
, O
behavioral O
analysis O
using O
IOCs O
, O
sandboxing O
analysis O
, O
heuristics O
, O
micro-virtualization O
, O
or O
dynamic O
detonation O
– O
to O
detect O
and O
prevent O
malicious O
files O
from O
executing O
on O
a O
target O
endpoint O
. O
 
While O
every O
other O
endpoint O
security O
product O
must O
collect O
a O
sample O
, O
analyze O
, O
and O
write O
a O
signature O
to O
detect O
it O
, O
CylancePROTECT O
can O
detect O
malware O
before O
it O
executes O
by O
statically O
analyzing O
features O
found O
in O
the O
binary O
itself O
. O
 
Features O
and O
Benefits O
of O
CylancePROTECT O
: O
• O
Near O
real O
time O
detection O
of O
malicious O
files O
, O
even O
if O
they O
've O
never O
been O
seen O
in O
the O
wild O
. O
 
• O
Can O
be O
used O
to O
augment O
existing O
endpoint O
security O
or O
be O
deployed O
as O
a O
complete O
replacement O
. O
 
• O
Does O
not O
require O
any O
signature O
updates O
or O
connection O
to O
the O
cloud O
. O
 
• O
An O
easy-to-use O
web O
management O
console O
with O
intuitive O
workflows O
. O
 
• O
Low-impact O
endpoint O
agent O
. O
 
For O
a O
demo O
of O
CylancePROTECT O
, O
contact O
a O
Cylance O
expert O
today O
! O
Cylance O
's O
Professional O
Services O
team O
is O
available O
to O
assist O
companies O
affected O
by O
this O
campaign O
. O
 
Cylance O
is O
providing O
consulting O
to O
companies O
that O
may O
have O
been O
targeted O
by O
these O
advanced O
threat O
actors O
. O
 
Cylance O
will O
perform O
initial O
triage O
in O
order O
to O
determine O
the O
extent O
to O
which O
your O
company O
has O
been O
affected O
by O
this O
campaign O
and O
work O
towards O
establishing O
a O
containment O
strategy O
. O
 
Cylance O
has O
two O
tailored O
offerings O
for O
clients O
affected O
by O
this O
campaign O
. O
 
The O
first O
one O
includes O
ICS O
in O
our O
incident O
response O
since O
many O
companies O
affected O
are O
in O
the O
Critical O
Infrastructure O
and O
Key O
Resources O
( O
CIKR O
) O
vertical O
. O
 
The O
second O
offering O
's O
focus O
is O
to O
deploy O
our O
proprietary O
tools O
and O
methodologies O
to O
detect O
and O
mitigate O
the O
threats O
posed O
by O
Operation O
Cleaver O
. O
 
For O
more O
information O
on O
how O
the O
Cylance O
Professional O
Services O
team O
can O
assess O
and O
respond O
to O
attacks O
like O
the O
ones O
obseved O
in O
Operation O
Cleaver O
, O
contact O
sales O
@ O
cylance.com O
today O
. O
 
Brian O
is O
a O
Sr. O
Security O
Researcher O
for O
Cylance O
who O
joined O
shortly O
after O
the O
company O
was O
established O
. O
 
He O
is O
best O
known O
for O
his O
avid O
botnet O
research O
( O
often O
going O
by O
'' O
botnethunter O
'' O
) O
and O
for O
his O
novel O
malware O
analysis O
in O
the O
A O
Study O
in O
Bots O
blog O
series O
hosted O
by O
Cylance O
. O
 
Brian O
has O
been O
a O
dedicated O
open-source O
developer O
as O
well O
as O
an O
advocate O
for O
public O
and O
private O
anti-botnet O
operations O
. O
 
Brian O
actively O
develops O
techniques O
to O
combat O
cyber O
oppositions O
in O
positions O
where O
resources O
and O
leverage O
are O
in O
too O
limited O
of O
supply O
for O
conventional O
means O
. O
 
These O
techniques O
, O
cultivated O
by O
Stuart O
McClure O
, O
are O
the O
Art O
of O
Deterrence O
. O
 
In O
a O
previous O
investigation O
, O
Art O
of O
Deterrence O
techniques O
were O
successfully O
used O
to O
divert O
Indonesian O
hackers O
motivated O
by O
monetary O
gain O
away O
from O
their O
highest O
yielding O
target O
group O
. O
 
Brian O
's O
botnet O
research O
covers O
a O
wide O
range O
of O
topics O
, O
from O
using O
graph O
analysis O
to O
estimate O
the O
amount O
of O
ransom O
that O
has O
been O
paid O
to O
a O
ransomware O
operator O
, O
to O
utilizing O
IPv4 O
scanning O
techniques O
to O
identify O
and O
take O
down O
point O
of O
sale O
malware O
panels O
. O
 
Stuart O
is O
founder O
, O
CEO/President O
and O
Chairman O
of O
Cylance O
. O
 
Widely O
recognized O
for O
his O
extensive O
and O
in-depth O
knowledge O
of O
security O
products O
, O
Stuart O
McClure O
is O
considered O
one O
of O
the O
industry O
's O
leading O
authorities O
in O
information O
security O
today O
. O
 
A O
well-published O
and O
acclaimed O
security O
visionary O
with O
currently O
eleven O
books O
in O
print O
, O
McClure O
is O
the O
originating O
founder O
of O
the O
Hacking O
Exposed O
series O
of O
books O
, O
the O
most O
successful O
security O
book O
ever O
written O
. O
 
From O
his O
work O
, O
he O
founded O
Foundstone O
in O
October O
of O
1999 O
which O
sold O
to O
McAfee O
in O
2004 O
. O
 
McClure O
brings O
over O
two O
decades O
of O
technology O
and O
executive O
leadership O
with O
profound O
technical O
, O
operational O
, O
and O
financial O
experience O
. O
 
Besides O
Foundstone O
, O
Stuart O
held O
leadership O
positions O
at O
InfoWorld O
, O
Ernst O
& O
Young O
, O
Kaiser O
Permanente O
and O
a O
number O
of O
government O
agencies O
. O
 
At O
McAfee O
, O
McClure O
held O
numerous O
positions O
including O
SVP/General O
Manager O
for O
the O
Security O
Management O
BU O
as O
well O
as O
EVP/Global O
Chief O
Technology O
Officer O
responsible O
for O
almost O
$ O
3B O
worth O
of O
revenues O
. O
 
Today O
, O
McClure O
is O
CEO O
of O
Cylance O
, O
a O
disruptive O
and O
innovative O
startup O
applying O
math O
to O
the O
problem O
of O
security O
. O
 
Cylance O
products O
such O
as O
CylancePROTECT O
prevent O
the O
most O
advanced O
attacks O
in O
the O
world O
without O
signatures O
or O
sandboxing O
in O
realtime O
on O
the O
endpoint O
. O
 
Cylance O
Services O
offer O
highly O
specialized O
security O
services O
such O
as O
incident O
response O
, O
forensics O
, O
compromise O
assessments O
and O
advanced O
penetration O
assessments O
for O
global O
critical O
infrastructure O
. O
 
Cylance O
employees O
work O
passionately O
and O
tirelessly O
every O
day O
to O
achieve O
one O
goal O
: O
Protect O
the O
world O
from O
cyber O
attacks O
. O
 
And O
with O
their O
efforts O
in O
tracking O
Operation O
Cleaver O
, O
they O
have O
achieved O
that O
goal O
. O
 
Our O
endless O
thanks O
to O
all O
the O
Cylancers O
who O
contributed O
to O
this O
report O
. O
 
The O
Operation O
Cleaver O
logo O
, O
created O
by O
Cylance O
specifically O
for O
this O
report O
, O
was O
inspired O
by O
the O
infamous O
logo O
used O
by O
the O
Army O
of O
the O
Guardians O
of O
the O
Islamic O
Revolution O
, O
also O
known O
in O
the O
west O
as O
the O
Iranian O
Revolutionary O
Guard O
Corps O
( O
IRGC O
) O
. O
 
Due O
to O
the O
close O
connection O
between O
the O
members O
tracked O
in O
this O
report O
and O
the O
IRGC O
, O
it O
was O
only O
fitting O
to O
replicate O
the O
look O
and O
feel O
of O
the O
IRGC O
's O
iconography O
as O
the O
anchor O
for O
this O
document O
's O
branding O
. O
 
The O
striking O
visual O
elements O
that O
make O
up O
the O
logo O
of O
the O
IRGC O
have O
very O
specific O
meanings O
: O
• O
The O
clenched O
fist O
holding O
a O
rifle O
, O
most O
likely O
an O
AK-47 O
, O
represents O
armed O
resistance O
. O
 
• O
The O
globe O
symbolizes O
the O
IRGC O
's O
worldwide O
ambitions O
. O
 
• O
The O
book O
, O
from O
which O
the O
clenched O
first O
emanates O
, O
represents O
the O
Qur'an O
, O
connecting O
the O
religious O
ideals O
on O
which O
the O
group O
was O
founded O
to O
the O
armed O
struggle O
. O
 
• O
The O
plants O
, O
possibly O
wheat O
, O
represent O
prosperity O
. O
 
• O
The O
name O
of O
the O
group O
in O
Persian O
, O
the O
year O
in O
which O
it O
was O
founded O
and O
a O
passage O
from O
the O
Qur'an O
( O
8:60 O
) O
'And O
make O
ready O
against O
them O
all O
you O
can O
of O
power O
' O
, O
are O
represented O
in O
text O
. O
 
Several O
of O
the O
visual O
elements O
present O
in O
the O
IRGC O
logo O
have O
been O
carried O
over O
to O
the O
Operation O
Cleaver O
logo O
including O
: O
• O
A O
clenched O
fist O
, O
this O
time O
holding O
a O
cleaver O
, O
represents O
the O
group O
's O
likely O
connection O
with O
the O
IRGC O
as O
well O
as O
armed O
resistence O
in O
general O
. O
 
• O
The O
globe O
in O
the O
background O
represents O
Operation O
Cleaver O
's O
worldwide O
reach O
. O
 
• O
An O
ethernet O
cable O
connected O
to O
the O
clenched O
first O
represents O
the O
nature O
of O
these O
attacks O
( O
cyber O
as O
opposed O
to O
traditional O
warfare O
) O
. O
 
• O
The O
hex O
string O
translates O
to O
'' O
Think O
Evil O
, O
Do O
Good O
'' O
, O
a O
mantra O
our O
research O
team O
lives O
by O
. O
 
This O
Appendix O
details O
the O
IOCs O
discovered O
in O
the O
investigation O
of O
Operation O
Cleaver O
. O
 
CylancePROTECT O
prevents O
the O
malware O
used O
in O
Operation O
Cleaver O
from O
ever O
executing O
. O
 
These O
mutexes O
are O
used O
with O
the O
process O
ID O
of O
the O
malware O
as O
a O
suffix O
: O
Listed O
below O
are O
both O
the O
MD5 O
and O
SHA-256 O
hashes O
for O
samples O
related O
to O
Operation O
Cleaver O
. O
 
