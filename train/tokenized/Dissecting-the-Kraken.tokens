G O
Data O
International O
G O
Data O
Germany O
RSS O
Feed O
back O
07.05.2015 O
, O
Author O
: O
Paul O
Rascagn O
res O
In O
January O
2015 O
, O
unidentified O
attackers O
attempted O
to O
infiltrate O
a O
multi O
- O
national O
enterprise O
based O
in O
the O
United O
Arab O
Emirates O
, O
using O
a O
spear O
phishing O
attack O
with O
a O
crafted O
MS O
Word O
document O
attached O
to O
the O
message O
. O

Once O
it O
has O
reached O
its O
target O
, O
the B-Entity
payload I-Entity
used O
was O
designed O
to O
work B-Action
as B-Modifier
an O
information B-Entity
stealer I-Entity
and O
reconnaissance B-Entity
tool I-Entity
. O

G O
DATA O
's O
security O
experts O
identified O
the O
malware O
behind O
this O
attack O
and O
reveal O
information O
about O
the O
actual O
power O
of O
the O
malware O
's O
tentacles O
. O

In O
this O
article O
, O
the O
G O
DATA O
SecurityLabs O
will O
have O
a O
look O
at O
the O
following O
topics O
: O
an O
example O
of O
the O
spear O
phishing O
campaign O
, O
sent O
only O
a O
few O
days O
after O
the O
malware O
has O
been O
advertised O
the O
marketing O
approach O
to O
sell O
the O
malware O
the O
analysis O
of O
some O
of O
Kraken O
's O
features O
theories O
about O
why O
Kraken O
has O
been O
used O
as O
malware O
in O
a O
targeted O
attack O
The O
attacker(s O
) O
sent O
a O
specially O
crafted O
email O
to O
at O
least O
one O
employee O
of O
the O
attacked O
enterprise O
. O

The O
email O
's O
body O
reveals O
a O
business O
- O
related O
topic O
: O
an O
offer O
to O
become O
member O
of O
this O
year O
's O
International O
Trade O
Council O
. O

Nevertheless O
, O
the O
offer O
is O
directed O
at O
the O
Philippine O
National O
Bank O
, O
not O
the O
enterprise O
actually O
receiving O
the O
email O
. O

This O
could O
be O
a O
trick O
to O
make O
the O
recipient O
even O
more O
curious O
to O
look O
at O
the O
attached O
document O
, O
because O
he O
/ O
she O
received O
documents O
not O
issued O
for O
him O
/ O
her O
. O

The O
G O
DATA O
experts O
alerted O
the O
aeCERT O
about O
the O
incident O
and O
their O
analysis O
results O
. O

Search O
Recent O
entries O
: O
10.04.2015 O
: O
Staying O
alert O
when O
buying O
banners O
: O
Google O
's O
advertising O
service O
misused O
for O
distributing O
malware O
31.03.2015 O
: O
IoT O
: O
The O
Internet O
of O
Things O
... O

ehm O
... O

Trouble O
? O
! O
16.03.2015 O
: O
The O
Andromeda O
/ O
Gamarue O
botnet O
is O
on O
the O
rise O
again O
06.03.2015 O
: O
Casper O
: O
the O
newest O
member O
of O
the O
cartoon O
malware O
family O
22.02.2015 O
: O
The O
power O
of O
trust O
: O
" O
Superfish O
" O
case O
turns O
into O
a O
worst O
case O
scenario O
Category O
Adware O
Bots O
& O
Botnets O
CyberCrime O
eCrime O
economy O
Legal O
issues O
Exploits O
Funny O
findings O
Web O
threats O
Scareware O
Phishing O
Security O
products O
Vulnerabilities O
Social O
engineering O
Mails O
Mobile O
Mobile O
Social O
Network O
Tags O
1337 O
crew O
adware O
aldi O
amtso O
analysis O
android O
android O
market O
apple O
apt O
authentication O
autorun O
av O
products O
award O
badusb O
banking O
blog O
bot O
botnet O
bredolab O
browser O
brwoser O
bug O
carbon O
caro O
casino O
cebit O
cellphone O
chat O
cloud O
cms O
cobra O
coding O
conference O
credit O
card O
cve O
cyber O
espionage O
cyber O
espionage O
; O
malware O
cyper O
espionage O
. O

targattacks O
dll O
dns O
domain O
eicar O
email O
exploit O
exploits O
eyjafjallajoekull O
facebook O
fake O
fake O
alert O
fake O
av O
false O
positive O
fifa O
firefox O
fix O
flame O
flash O
fraud O
ftp O
gaming O
google O
google O
play O
hack O
heartbleed O
ie O
iframe O
i O
m O
infection O
injection O
iot O
java O
khobe O
likejacking O
link O
links O
lizamoon O
lnk O
lottery O
mac O
mail O
mails O
In O
this O
case O
, O
the O
attachment O
is O
a O
Microsoft O
Word O
document O
which O
tries O
to O
exploit O
the O
vulnerability O
described O
in O
CVE-2012 O
- O
0158 O
in O
order O
to O
drop O
and O
execute O
malware O
dubbed O
" O
Kraken O
HTTP O
" O
. O

The O
G O
DATA O
security O
solutions O
detect O
the O
malicious O
document O
( O
08E834B6D4123F0AEA27D042FCEAF992 O
) O
as O
Exploit O
. O
CVE-2012 O
- O
0158.AH O
and O
G O
DATA O
's O
proactive O
Exploit O
Protection O
technology O
also O
prevents O
the O
attack O
before O
the O
PC O
can O
be O
infected O
. O

" O
Kraken O
HTTP O
" O
is O
sold O
on O
at O
least O
one O
underground O
market O
as O
a O
commercial O
product O
. O

Someone O
, O
who O
claims O
not O
to O
be O
the O
author O
of O
the O
malware O
, O
promoted O
the O
malware O
with O
a O
kind O
of O
banner O
which O
has O
quite O
a O
visual O
impact O
. O

Have O
a O
look O
at O
the O
" O
ad O
" O
that O
was O
published O
back O
in O
December O
2014 O
. O

The O
banner O
describes O
the O
botnet O
. O

its O
technical O
features O
the O
available O
commands O
( O
classic O
ones O
, O
such O
as O
visiting B-Action
a O
website B-Entity
using B-Modifier
the O
infected B-Entity
bot I-Entity
, O
download B-Action
and O
execute B-Action
a O
command B-Entity
or O
a B-Entity
library I-Entity
, O
update B-Action
and O
uninstall B-Action
) O
the O
plugins O
one O
can O
use O
: O
file O
stealer O
, O
ad O
- O
clicker O
, O
form O
grabber O
, O
… O
The O
command O
" O
visiting O
a O
website O
" O
using O
the O
infected O
bot O
could O
be O
used O
by O
the O
attackers O
as O
an O
entry O
point O
for O
blackmailing O
the O
infected O
user O
. O

The O
attackers O
could O
visit O
websites O
that O
are O
regarded O
as O
illegal O
in O
the O
respective O
country O
and O
could O
then O
ask O
for O
ransom O
and O
threaten O
to O
release O
information O
about O
the O
alleged O
violation O
to O
any O
seemingly O
official O
entity O
who O
would O
then O
investigate O
against O
the O
victim O
. O

The O
flyer O
also O
reveals O
the O
price O
of O
the O
malware O
: O
The O
basic O
binary O
costs O
$ O
320 O
and O
each O
plugin O
must O
be O
paid O
for O
separately O
, O
for O
example O
$ O
50 O
for O
the O
file O
stealer O
, O
$ O
60 O
for O
the O
ad O
- O
clicker O
and O
up O
to O
$ O
350 O
for O
a O
configurable O
form O
grabber O
. O

Accepted O
payment O
methods O
are O
the O
usual O
virtual O
currencies O
and O
pre O
- O
paid O
options O
. O

malware O
malware O
windows O
matousec O
microsoft O
microsoft O
windows O
mobile O
network O
news O
osama O
bin O
laden O
password O
pdf O
pharmacy O
phishing O
picture O
pinterest O
playstation O
poker O
pos O
privacy O
pup O
ransom O
rat O
removal O
instructions O
riskware O
rsa O
scan O
scareware O
shopping O
short O
url O
snowden O
socail O
engineering O
soccer O
social O
engineering O
social O
network O
spain O
spam O
spyeye O
sql O
stuxnet O
targattacks O
testing O
tool O
trojan O
uefa O
uefa O
euro O
2012 O
underground O
update O
url O
uroburos O
usb O
virus O
bulletin O
vulnerabilities O
warning O
wifi O
windows O
windows O
8 O
wordpress O
worm O
youtube O
zero O
day O
zeus O
zynga O
404 O
419 O
A O
price O
list O
found O
on O
a O
different O
website O
, O
also O
posted O
in O
December O
2014 O
, O
lists O
the O
binary O
's O
price O
as O
$ O
270 O
and O
some O
additional O
modules O
, O
such O
as O
a O
" O
Edit O
Hosts O
module O
" O
( O
$ O
15 O
) O
, O
a O
" O
Botkill O
module O
" O
( O
$ O
30 O
) O
and O
a O
" O
Bitcoin O
monitor O
module"($20 O
) O
. O

Furthermore O
, O
" O
Kraken O
HTTP O
" O
is O
advertised O
as O
" O
a O
new O
, O
revolutionary O
botnet O
[ O
… O
] O
and O
very O
noob O
- O
friendly O
" O
. O

Noob O
is O
a O
word O
describing O
" O
that O
someone O
is O
new O
to O
a O
game O
, O
concept O
, O
or O
idea O
; O
implying O
a O
lack O
of O
experience O
. O
" O
But O
now O
let O
's O
have O
a O
look O
at O
what O
the O
botnet O
really O
is O
. O

After O
having O
a O
glimpse O
at O
the O
ad O
designed O
to O
promote O
the O
malware O
, O
we O
analyzed O
a O
sample O
of O
it O
: O
3917107778F928A6F65DB34553D5082A O
, O
which O
is O
detected O
as O
Gen O
: O
Variant O
. O
Zusy.118945 O
. O

We O
decided O
to O
analyze O
some O
features O
mentioned O
in O
the O
flyer O
and O
on O
the O
other O
website O
to O
evaluate O
their O
power O
and O
implementation O
. O

Feature O
: O
" O
Bypass O
UAC O
" O
As O
expected O
, O
the O
malware O
does O
not O
really O
bypass O
the O
UAC O
. O

It O
rather O
uses O
a O
classic O
trick O
already O
used O
by O
several O
malware O
instances O
. O

It O
uses O
a O
legitimate O
Microsoft O
binary O
in O
order O
to O
execute O
itself O
with O
administrator O
permissions O
. O

We O
already O
presented O
this O
technique O
in O
our O
G O
DATA O
SecurityBlog O
article O
about O
the O
Beta O
Bot O
. O

Feature O
: O
" O
Anti O
- O
VM O
" O
The O
flyer O
explains O
that O
the B-Entity
botnet I-Entity
wo O
n't B-Action
work I-Action
in O
a B-Entity
virtual I-Entity
machine I-Entity
. O

To B-Modifier
detect O
whether B-Entity
the I-Entity
malware I-Entity
is I-Entity
running I-Entity
in I-Entity
a I-Entity
virtual I-Entity
machine I-Entity
, O
the B-Entity
malware I-Entity
author I-Entity
checks B-Action
if B-Modifier
the O
following B-Entity
directories I-Entity
and I-Entity
the I-Entity
one I-Entity
file I-Entity
exist I-Entity
. O

C:\Program O
Files\VMWare\VMware O
Tools\ O
C:\Program O
Files O
( O
x86)\VMware\WMware O
Tools\ O
C:\WINDOWS\system32\VBoxtray.exe O
Furthermore O
, O
the O
malware O
checks O
if O
following O
applications O
analysts O
usually O
use O
are O
being O
executed O
. O

Wireshark O
: O
a O
network O
analyzer O
Fiddler O
: O
a O
web O
proxy O
used O
to O
debug O
HTTP O
flow O
. O

We O
can O
see O
the O
tools O
detection O
. O

If O
one O
of O
the O
elements O
mentioned O
above O
is O
detected O
, O
the O
malware O
will O
display O
a O
rather O
poetic O
dialog O
popup O
. O

So O
, O
the O
anti O
- O
VM O
is O
really O
rudimentary O
. O

If O
the O
additional O
tools O
are O
not O
installed O
on O
the O
virtual O
machine O
the O
malware O
can O
be O
perfectly O
executed O
. O

Feature O
: O
" O
Folder O
, O
Bot O
file O
& O
All O
file O
dropped O
are O
hidden O
" O
The O
folders O
& O
bot O
files O
simply O
have O
the O
" O
hidden O
" O
attribute O
set O
in O
Microsoft O
Windows O
. O

If O
you O
configure O
you O
system O
to O
show O
hidden O
files O
and O
directories O
, O
you O
can O
perfectly O
see O
them O
. O

So O
, O
the O
botnet O
does O
not O
use O
advanced O
techniques O
to O
hide O
itself O
. O

Feature O
: O
" O
Process O
& O
registry O
persistence O
" O
The B-Entity
malware I-Entity
persistence I-Entity
uses B-Action
a O
registry B-Entity
key I-Entity
in O
order B-Modifier
to I-Modifier
be O
executed B-Entity
automatically I-Entity
in I-Entity
case I-Entity
the I-Entity
system I-Entity
is I-Entity
rebooted I-Entity
. O

The O
key O
is O
HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Windows O
. O

The O
malware O
repeatedly O
checks O
whether O
this O
entry O
is O
removed O
. O

In O
case O
the O
entry O
is O
removed O
, O
the O
malware O
will O
create O
a O
new O
one O
. O

However O
, O
instead O
of O
removing O
it O
, O
we O
can O
simple O
rename O
the O
path O
to O
the O
executable O
in O
order O
to O
switch O
off O
the O
persistence O
mechanism O
. O

So O
, O
the O
malware O
does O
not O
have O
any O
clever O
persistence O
features O
either O
. O

Feature O
: O
" O
Path O
& O
variable O
encrypted O
" O
We O
identified O
two O
kinds O
of O
" O
encrypted O
" O
data O
. O

Feature O
: O
" O
Bitcoin O
monitor O
plugin O
" O
The O
Bitcoin O
monitor O
plugin O
is O
even O
more O
amusing O
. O

It O
is O
not O
advertised O
on O
the O
flyer O
but O
on O
the O
other O
website O
we O
found O
. O

The O
malware O
monitors O
the O
infected O
user O
's O
clipboard O
. O

If O
the O
user O
copies O
a O
Bitcoin O
address O
to O
the O
clipboard O
, O
it O
will O
be O
replaced O
by O
an O
address O
pre O
- O
configured O
by O
the O
botmaster O
. O

A O
Bitcoin O
address O
is O
an O
identifier O
of O
26 O
- O
35 O
alphanumeric O
characters O
which O
represent O
the O
owner O
of O
a O
Bitcoin O
wallet O
, O
for O
example O
something O
like O
3J98t1WpEZ73CNmQviecrnyiWrnqRhWNLy O
. O

We O
can O
easily O
imagine O
that O
the O
plugin O
's O
" O
test O
" O
is O
prone O
to O
produce O
false O
positives O
, O
because O
any O
alphanumeric O
text O
copied O
by O
the O
user O
will O
be O
automatically O
changed O
without O
reason O
if O
it O
has O
a O
length O
between O
26 O
and O
35 O
characters O
. O

Ok O
, O
we O
admit O
that O
the O
German O
word O
" O
Kraftfahrzeughaftpflichtversicherung O
" O
( O
36 O
) O
would O
not O
be O
harmed O
when O
copied O
, O
but O
what O
about O
" O
Bundesausbildungsfoerderungsgesetz O
" O
( O
34 O
) O
or O
" O
radioimmunoelectrophoresis O
" O
( O
27 O
) O
? O
Just O
kidding O
. O

But O
any O
string O
, O
from O
strong O
passwords O
to O
bank O
account O
numbers O
and O
more O
could O
be O
affected O
. O

Feature O
: O
" O
Download O
& O
Execute O
" O
, O
the O
next O
Step O
This B-Entity
feature I-Entity
allows O
installing B-Action
further O
malware B-Entity
on B-Modifier
the O
affected B-Entity
PC I-Entity
in O
case O
the O
attackers O
decide O
the O
current O
machine O
is O
interesting O
enough O
. O

" O
Kraken O
HTTP O
" O
is O
only O
the O
first O
stage O
in O
this O
attack O
and O
can O
be O
seen O
as O
reconnaissance O
tool O
. O

The O
experts O
of O
the O
G O
DATA O
SecurityLabs O
had O
access O
to O
the O
panel O
used O
by O
" O
Kraken O
HTTP O
" O
but O
the O
source O
code O
is O
protected O
by O
a O
commercial O
packer O
called O
IonCube O
loader O
. O

Nevertheless O
, O
we O
can O
reveal O
some O
screenshots O
of O
the O
administration O
panel O
which O
are O
available O
on O
the O
underground O
. O

Note O
that O
some O
of O
the O
texts O
contain O
mistakes O
. O

We O
suppose O
that O
the O
Kraken O
botnet O
was O
developed O
by O
a O
beginner O
. O

The O
malware O
does O
not O
include O
advanced O
malware O
technologies O
and O
no O
groundbreaking O
innovations O
, O
even O
though O
those O
were O
advertised O
. O

Many O
sensitive O
strings O
are O
not O
encrypted O
, O
such O
as O
installation O
paths O
, O
anti O
- O
virus O
listings O
, O
insults O
against O
the O
analysts O
and O
much O
more O
. O

To O
sell O
the O
botnet O
malware O
, O
the O
author O
used O
a O
quite O
sexy O
marketing O
flyer O
, O
but O
, O
actually O
, O
the O
malware O
turned O
out O
to O
be O
rather O
simple O
. O

" O
Kraken O
HTTP O
" O
was O
said O
to O
be O
used O
during O
an O
espionage O
campaign O
against O
the O
energy O
sector O
, O
especially O
against O
targets O
in O
the O
UAE O
. O

We O
have O
now O
identified O
a O
specific O
target O
from O
this O
geographical O
region O
and O
have O
obtained O
one O
of O
the O
spear O
phishing O
emails O
used O
. O

Even O
though O
the O
targets O
that O
are O
known O
by O
now O
are O
rather O
high O
- O
level O
targets O
, O
the O
malware O
code O
as O
well O
as O
its O
features O
is O
not O
advanced O
. O

We O
are O
surprised O
to O
see O
this O
piece O
of O
code O
has O
been O
used O
carrying O
out O
targeted O
attacks O
rather O
than O
broader O
criminal O
activities O
. O

It O
is O
not O
surprising O
that O
attackers O
use O
vulnerabilities O
that O
are O
older O
, O
because O
, O
unfortunately O
, O
many O
computers O
are O
likely O
to O
be O
still O
out O
of O
date O
and O
so O
the O
attack O
works O
. O

Despite O
the O
fact O
that O
the O
vulnerability O
used O
is O
not O
a O
new O
one O
, O
the O
malware O
does O
not O
have O
the O
common O
features O
that O
we O
saw O
during O
other O
targeted O
attack O
campaigns O
. O

Compared O
to O
incidents O
like O
Uroburos O
, O
the O
Kraken O
malware O
is O
not O
good O
enough O
to O
" O
catch O
the O
big O
fish O
" O
if O
we O
want O
to O
stick O
with O
to O
the O
metaphor O
. O

So O
, O
from O
the O
current O
point O
of O
view O
, O
there O
are O
three O
theories O
. O

The O
attackers O
who O
developed O
the O
Kraken O
malware O
might O
have O
chosen O
to O
diversify O
their O
business O
and O
chose O
to O
attack O
special O
interest O
targets O
themselves O
. O

The O
attackers O
identified O
infected O
machines O
in O
the O
business O
sector O
and O
followed O
the O
tracks O
to O
see O
what O
else O
they O
might O
be O
able O
to O
get O
from O
the O
companies O
. O

The O
actual O
espionage O
team O
voluntary O
chose O
to O
use O
a O
kind O
of O
usual O
and O
rather O
simply O
botnet O
malware O
in O
order O
to O
distract O
analysts O
from O
seeing O
a O
deeper O
meaning O
behind O
this O
attack O
and O
make O
them O
disregard O
it O
as O
' O
daily O
cybercrime O
business O
' O
. O

Attached O
Files O
. O

back O
2007 O
- O
2015 O
G O
Data O
Software O
AG O
. O

All O
rights O
reserved O
Contact O
| O
Imprint O

